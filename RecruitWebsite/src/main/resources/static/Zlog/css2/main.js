function loadCss(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}function seriesLoadScripts(e,t){if("object"!=typeof e)var e=[e];var i=document.getElementsByTagName("head").item(0)||document.documentElement,a=new Array,n=e.length-1,s=function(o){a[o]=document.createElement("script"),a[o].setAttribute("type","text/javascript"),a[o].setAttribute("charset","UTF-8"),a[o].onload=a[o].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),o!=n?s(o+1):"function"==typeof t&&t()},a[o].setAttribute("src",e[o]),i.appendChild(a[o])};s(0)}function getQueryString(e,t){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(i);return t&&(a=t.split("?")[1].match(i)),null!=a?unescape(a[2]):null}function EventManger(){var e={};this.subscribe=function(t,i){void 0===e[t]&&(e[t]=[]),e[t].push({context:this,callback:i})},this.unsubscribe=function(t){return void 0!==e[t]&&(e[t]=[]),this},this.publish=function(t){if(void 0===e[t])return!1;for(var i=Array.prototype.slice.call(arguments,1),a=0,n=e[t].length;a<n;a++){var s=e[t][a];s.callback.apply(s.context,i)}}}function Utemplate(e,t){function i(e,t){return s+=t?e.match(n)?e+"\n":"arr.push("+e+");\n":""!=e?"arr.push('"+e.replace(/"/g,'\\"')+"');\n":"",arguments.callee}for(var a=/<%([^%>]+)?%>/g,n=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,s="var arr = []; \n",o=0;match=a.exec(e);)i(e.slice(o,match.index))(match[1],!0),o=match.index+match[0].length;return i(e.substr(o,e.length-o)),s+="return arr.join('')",new Function(s.replace(/[\r\t\n]/g,"")).apply(t)}function EventManger(){var e={};this.subscribe=function(t,i){void 0===e[t]&&(e[t]=[]),e[t].push({context:this,callback:i})},this.unsubscribe=function(t){return void 0!==e[t]&&(e[t]=[]),this},this.publish=function(t){if(void 0===e[t])return!1;for(var i=Array.prototype.slice.call(arguments,1),a=0,n=e[t].length;a<n;a++){var s=e[t][a];s.callback.apply(s.context,i)}}}function getQueryString(e,t){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(i);return t&&(a=t.split("?")[1].match(i)),null!=a?unescape(a[2]):null}function getQueryParams(e){for(var t={},i=e.split("?").length>1?e.split("?")[1]:e,a=i.split("&"),n=0;n<a.length;n++){var s=a[n].split("=");s.length>1&&(t[s[0]]=s[1])}return t}function isVisiable(e){if(e){var t=e.getBoundingClientRect();return t.top>0&&window.innerHeight-t.top>0||t.top<=0&&t.bottom>=0}}function CopyToClipboard(e){var t=!0;if(window.clipboardData)window.clipboardData.setData("Text",e);else{var i=CreateElementForExecCommand(e);SelectContent(i);try{window.netscape&&netscape.security&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),t=document.execCommand("copy",!1,null)}catch(e){t=!1}document.body.removeChild(i)}t?alert("复制成功"):alert("复制失败，请手动复制该链接")}function filterXss(e){return e&&!/^\<img.*\>$/.test(e)?e.replace(/&amp;/g,"&").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("<phone>","").replace("</phone>","").replace("<copy>","").replace("</copy>",""):e}function localStorageInstance(e,t){if(window.localStorage)if(""==t)window.localStorage.removeItem(e);else{if(!t)return window.localStorage[e];window.localStorage[e]=t}}function getUuid(e,t){var i,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(t=t||a.length,e)for(i=0;i<e;i++)n[i]=a[0|Math.random()*t];else{var s;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",i=0;i<36;i++)n[i]||(s=0|16*Math.random(),n[i]=a[19==i?3&s|8:s])}return n.join("")}function __conversion(e){try{_T.sendEvent(e)}catch(e){}}function getVipSaveText(e){if("number"==typeof e)var t=e;else var t=parseInt(e.originalPrice,10)-parseInt(e.price,10);return t>0?'<p class="vip-save-desc"><i class="vip-discount-sign"></i>为您节省<span class="vip-save-amount">¥'+t+"</span></p>":""}function ConsumeConfirm(e){$.dialog({title:e.title,content:e.content,closeLayer:!1,confirmText:e.confirmText,cancelText:"取消",wrapClass:"prop-consume flex-dialog-wrap "+(e.wrapClass||""),inline:!1,onOpen:e.open,onConfirm:e.confirm,onClose:e.close})}function Prompt(e,t){var i=$('<div class="kz_tishi" style="position:absolute;z-index:9999;"/>').html(e);0==$(".kz_tishi").length&&(i.appendTo("body").delay(1500).fadeOut(500,function(){$(this).remove()}),i.css({left:1==t?($(window).width()-i.outerWidth())/2:0,top:1==t?($(window).height()-i.outerHeight())/2:0,width:1==t?"auto":"100%",position:"fixed"}))}function Utemplate(e,t){function i(e,t){return s+=t?e.match(n)?e+"\n":"arr.push("+e+");\n":""!=e?"arr.push('"+e.replace(/"/g,'\\"')+"');\n":"",arguments.callee}for(var a=/<%([^%>]+)?%>/g,n=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,s="var arr = []; \n",o=0;match=a.exec(e);)i(e.slice(o,match.index))(match[1],!0),o=match.index+match[0].length;return i(e.substr(o,e.length-o)),s+="return arr.join('')",new Function(s.replace(/[\r\t\n]/g,"")).apply(t)}function formatDiscountList(e){var t=e.discount.name,i=e.discount.highlightList;if(i&&i.length){var a=i[0].startIndex,n=i[0].endIndex,s=n-a,o=t.substr(0,a);o+='<a target="_blank" href="'+e.discount.url+'">'+t.substr(a,s)+"</a>",o+=t.substr(n,-1),t=o}return{discountTag:e.discountTag,name:t}}function ProtobufMessage(){this.init()}function interviewOnline(){var e={loaded:!1,singlePC:!1,slideShowMode:!1,videoWindow:{width:360,height:640},audioWindow:{width:300,height:420},canvasParams:{answerBtnSize:15,answerBtnTimeout:5},localStreamDomId:"video-local-box",oppositeStreamDomId:"video-opposite-box"},t={localConfigForVideo:{video:!0,audio:!0,data:!0,videoSize:[320,240,320,240],videoFrameRate:[10,20]},localConfigForAudio:{video:!1,audio:!0,data:!0},appInfoForVideo:{audio:!1,video:!0,bossId:_PAGE.uid,geekId:"",callType:"1",jobId:0,downType:"0",mediaType:"1",clientType:"web"},appInfoForAudio:{audio:!0,video:!1,bossId:_PAGE.uid,geekId:"",callType:"1",jobId:0,downType:"0",mediaType:"0",clientType:"web"},roomData:{userId:""+_PAGE.uid,role:"presenter",roomId:_PAGE.uid+"@"+(new Date).getTime(),type:"fmslive",mediaConfiguration:"default",host:"v-bossbjfms-01.zpurl.cn:800",secure:!0,signature:"ZTNiMWQ5OTk4ZDZjMTE0NjIxMzA2YzBjMDlkMWZjZDEwY2M5MjZiOQ==",tokenId:"5b877ed3f8948f95afc92124",clientType:"web",serviceType:"interview",connectTimeout:30,appInfo:""}},i={checkStatus:function(e){var t=$.Deferred();return $.get("/wapi/zprelation/interview/media/get",{mediaRoomId:e}).done(function(e){0===e.code?t.resolve(e.zpData):t.reject(e)}).fail(function(e){t.reject(e)}),t},getEdgeSync:function(){var e,t=window.location.hostname;t.indexOf("boss-m.weizhipin.com")>-1?e="http://192.168.1.12":t.indexOf("boss-m-qa.weizhipin.com")>-1?e="https://qa-fms.weizhipin.com":t.indexOf("boss-m-qa3.weizhipin.com")>-1?e="http://192.168.1.224":t.indexOf("pre-www.zhipin.com")>-1?e="https://pre-router-fms.zhipin.com":t.indexOf("zhipin.com")>-1&&(e="https://router-fms.zhipin.com");var i=$.Deferred();return $.ajax({url:e+"/getEdgeForWebRtc/",type:"post",token:"",success:function(e){i.resolve(e.edge)},error:function(e){i.reject(e)}}),i},reportBeginInterview:function(e){var t=$.Deferred();return $.get("/wapi/zprelation/interview/media/report",{mediaRoomId:e}).done(function(e){0===e.code?t.resolve(e.zpData):t.reject(e)}).fail(function(e){t.reject(e)}),t},getGeekInfo:function(e){var t;return $.ajax({url:"/wapi/zpboss/h5/chat/geek.json",type:"get",dataType:"json",async:!1,data:e,success:function(e){t=0===e.code?e.zpData.data:null},error:function(){t=null}}),t},reportStatus:function(e,t){$.ajax({url:"/wapi/zprelation/interview/media/status",type:"GET",dataType:"json",data:{mediaRoomId:t,status:e}})},reportStatusSync:function(e,t){$.ajax({url:"/wapi/zprelation/interview/media/status",type:"GET",dataType:"json",async:!1,data:{mediaRoomId:t,status:e}})}},a=function(){this.getLocalStream=function(e){try{var i;return i="audio"===e?$.extend({},t.localConfigForAudio):$.extend({},t.localConfigForVideo),FmsLive.Stream(i)}catch(e){p.myConsole(e)}return null},this.getAppInfoData=function(e){var i;return i="audio"===e.type?$.extend({},t.appInfoForAudio):$.extend({},t.appInfoForVideo),p.myConsole("=========================================="),p.myConsole(i),i.geekId=e.geekId,i.jobId=e.jobId,i},this.getRoomData=function(e,i){var a=$.extend({},t.roomData);return i&&i.roomId?a.roomId=i.roomId:a.roomId=_PAGE.uid+"@"+(new Date).getTime(),e&&(a.appInfo=JSON.stringify(e)),a},this.createRoom=function(e){return FmsLive.Room({token:JSON.stringify(e)})}},n=function(){this.video=function(){var a=function(t){var a={avatar:"",name:"",positionName:"",salaryDesc:""};try{var n,s=i.getGeekInfo({uid:t.geekId});n="passive"===t.behaviour&&t.geekId?Chat.usersData[t.geekId]||{}:Chat.curUserData||{},a.avatar=n.avatar||s.avatar,a.name=n.name||s.name,a.positionName=n.infoData&&n.infoData.positionName||s.positionName,a.salaryDesc=n.infoData&&n.infoData.salaryDesc||s.salaryDesc||s.lowSalary+"-"+s.highSalary+"K"}catch(e){}return'<div class="video-container" style="width: '+e.videoWindow.width+"px; height: "+e.videoWindow.height+'px">\n    <div class="top-bar">       <i class="top-btn btn-close iboss-guanbi"></i>       <i class="top-btn btn-minimize iboss-suoxiao"></i>       <i class="top-btn btn-maximize iboss-quanping"></i>    </div>\n    <div id="'+e.oppositeStreamDomId+'" class="small-video-box hide"></div>\n    <div id="'+e.localStreamDomId+'" class="big-video-box"></div>\n    <div class="content">\n        <div class="geek-info">\n            <img src="'+a.avatar+'" alt=""/>\n            <span>'+a.name+"</span>\n            <span>"+a.positionName+'<em class="vline"></em>'+a.salaryDesc+'</span>\n        </div>\n        <div class="text-tips">正在等待对方接受视频</div>\n        <div class="loading">           <div class="dot cur"></div>           <div class="dot"></div>           <div class="dot"></div>        </div>\n        <div class="timer hide"></div>\n        <div class="control-btns">\n            <div class="btn-hang-up"></div>\n            <div class="btn-answer-box '+("passive"===t.behaviour?" ":" hide ")+'">               <canvas class="canvas-answer" width="'+(46+4*e.canvasParams.answerBtnSize)+'" height="'+(46+4*e.canvasParams.answerBtnSize)+'" style="left: '+2*-e.canvasParams.answerBtnSize+"px; top: "+2*-e.canvasParams.answerBtnSize+'px"></canvas>               <div class="btn-answer"></div>            </div>\n        </div>\n        <div class="hover-style">\n            <div class="top"></div>\n            <div class="top-right"></div>\n            <div class="right"></div>\n            <div class="bottom-right"></div>\n            <div class="bottom"></div>\n            <div class="bottom-left"></div>\n            <div class="left"></div>\n            <div class="top-left"></div>\n        </div>\n    </div>\n</div>'},n=function(e){e.on("click",".small-video-box",function(){s(e)}),e.on("click",".btn-answer",function(){e.find(".text-tips").text("连接中"),e.find(".btn-answer-box").addClass("hide"),t.clearTimer(),mediator.publish("INTERVIEW_ACTION",{type:"report-status",status:7}),mediator.publish("INTERVIEW_ACTION",{type:"answer"})}),e.on("click",".btn-hang-up",function(){mediator.publish("INTERVIEW_ACTION",{type:"report-status",action:"hang-up"}),mediator.publish("INTERVIEW_ACTION",{type:"hang-up"})}),e.on("click",".btn-close",function(){$.dialog({title:"确定要结束视频通话吗？",content:'<div class="tip-text">关闭窗口将结束视频通话</div>',wrapClass:"dialog-icons-default",type:"warning",inline:!0,onConfirm:function(e){e.remove(),mediator.publish("INTERVIEW_ACTION",{type:"report-status",action:"hang-up"}),mediator.publish("INTERVIEW_ACTION",{type:"close"})}})})},s=function(e){var t=e.find(".big-video-box"),i=e.find(".small-video-box");t.removeClass("big-video-box").addClass("small-video-box"),i.removeClass("small-video-box").addClass("big-video-box")},o=function(){$("#"+e.localStreamDomId).removeClass("big-video-box").addClass("small-video-box"),$("#"+e.oppositeStreamDomId).removeClass("small-video-box").addClass("big-video-box")},r=function(){$("#"+e.oppositeStreamDomId).removeClass("big-video-box").addClass("small-video-box"),$("#"+e.localStreamDomId).removeClass("small-video-box").addClass("big-video-box")},c=function(e){e.find(".text-tips").addClass("hide"),e.find(".loading").addClass("hide"),e.find(".timer").removeClass("hide"),e.find(".geek-info").addClass("hide"),e.find(".btn-answer-box").addClass("hide"),e.find(".small-video-box").removeClass("hide"),o(),t.clearTimer()},l=function(e){r(),e.find(".small-video-box").addClass("hide"),e.find(".geek-info").removeClass("hide")},d=function(e){t.clearTimer(),e&&e.fadeOut(function(){e.remove()})};return{rendContainer:function(t){$.dialog({title:"",content:a(t),confirmText:"",cancelText:"",closeText:"",closeLayer:!1,wrapClass:"interview-online interview-video",onOpen:function(t){var i=$("body");t.find(".dialog-container").css("top",(i.height()-e.videoWindow.height)/2+"px"),t.find(".dialog-container").css("left",(i.width()-e.videoWindow.width)/2+"px"),n(t),mediator.publish("INTERVIEW_ACTION",{type:"dialog-open",wrap:t})}})},rendByStatus:function(e,t){switch(e){case 4:c(t);break;case 4.2:l(t);break;case 6:d(t)}}}},this.audio=function(){var a=function(t){var a={avatar:"",name:"",positionName:"",salaryDesc:""};try{var n,s=i.getGeekInfo({uid:t.geekId});n="passive"===t.behaviour&&t.geekId?Chat.usersData[t.geekId]||{}:Chat.curUserData||{},a.avatar=n.avatar||s.avatar,a.name=n.name||s.name,a.positionName=n.infoData&&n.infoData.positionName||s.positionName,a.salaryDesc=n.infoData&&n.infoData.salaryDesc||s.salaryDesc||s.lowSalary+"-"+s.highSalary+"K"}catch(e){}return'<div class="video-container" style="width: '+e.audioWindow.width+"px; height: "+e.audioWindow.height+'px">\n    <div class="avatar-bg" style="background-image: url('+a.avatar+')"></div>    <div class="top-bar">       <i class="top-btn btn-close iboss-guanbi"></i>    </div>\n    <div id="'+e.localStreamDomId+'" class="hide"></div>\n    <div id="'+e.oppositeStreamDomId+'" class="hide"></div>\n    <div class="content">\n        <div class="geek-info">\n            <img src="'+a.avatar+'" alt=""/>\n            <span>'+a.name+"</span>\n            <span>"+a.positionName+'<em class="vline"></em>'+a.salaryDesc+'</span>\n        </div>\n        <div class="text-tips">'+("passive"===t.behaviour?"邀请你语音通话":"正在等待对方接受邀请")+'</div>\n        <div class="loading">           <div class="dot cur"></div>           <div class="dot"></div>           <div class="dot"></div>        </div>\n        <div class="timer hide"></div>\n        <div class="control-btns">\n            <div class="btn-hang-up"></div>\n            <div class="btn-answer-box '+("passive"===t.behaviour?" ":" hide ")+'">               <canvas class="canvas-answer" width="'+(46+4*e.canvasParams.answerBtnSize)+'" height="'+(46+4*e.canvasParams.answerBtnSize)+'" style="left: '+2*-e.canvasParams.answerBtnSize+"px; top: "+2*-e.canvasParams.answerBtnSize+'px"></canvas>               <div class="btn-answer"></div>            </div>\n        </div>\n    </div>\n</div>'},n=function(e){var i=e.find(".canvas-answer")[0].getContext("2d");t.drawAnswerBtn(i)},s=function(e){e.on("click",".btn-answer",function(){e.find(".text-tips").text("连接中"),e.find(".btn-answer-box").addClass("hide"),t.clearTimer(),mediator.publish("INTERVIEW_ACTION",{type:"report-status",status:7}),mediator.publish("INTERVIEW_ACTION",{type:"answer"})}),e.on("click",".btn-hang-up",function(){mediator.publish("INTERVIEW_ACTION",{type:"report-status",action:"hang-up"}),mediator.publish("INTERVIEW_ACTION",{type:"hang-up"})}),e.on("click",".btn-close",function(){$.dialog({title:"确定要结束视频通话吗？",content:'<div class="tip-text">关闭窗口将结束视频通话</div>',wrapClass:"dialog-icons-default",type:"warning",inline:!0,onConfirm:function(e){e.remove(),mediator.publish("INTERVIEW_ACTION",{type:"report-status",action:"hang-up"}),mediator.publish("INTERVIEW_ACTION",{type:"close"})}})})},o=function(e){e.find(".text-tips").addClass("hide"),e.find(".loading").addClass("hide"),e.find(".btn-answer-box").addClass("hide"),e.find(".timer").removeClass("hide"),t.clearTimer()},r=function(e){t.clearTimer(),e&&e.fadeOut(function(){e.remove()})};return{rendContainer:function(t){$.dialog({title:"",content:a(t),confirmText:"",cancelText:"",closeText:"",closeLayer:!1,wrapClass:"interview-online interview-audio",onOpen:function(t){var i=$("body");t.find(".dialog-container").css("top",(i.height()-e.audioWindow.height)/2+"px"),t.find(".dialog-container").css("left",(i.width()-e.audioWindow.width)/2+"px"),n(t),s(t),mediator.publish("INTERVIEW_ACTION",{type:"dialog-open",wrap:t})}})},rendByStatus:function(e,t,i){switch(e){case 4:o(t);break;case 6:r(t)}}}};var t={timer:{answerBtnTimer:0},clearTimer:function(){t.timer.answerBtnTimer&&(cAF(t.timer.answerBtnTimer),t.timer.answerBtnTimer=0)},drawAnswerBtn:function(i){var a=23+2*e.canvasParams.answerBtnSize,n=[{r:20,opacity:.6},{r:10,opacity:.8},{r:0,opacity:1}],s=function(e,t){i.beginPath(),i.arc(a,a,e,0,2*Math.PI),i.closePath(),i.fillStyle="rgba(83,202,195,"+t+")",i.fill()},o=function(){i.clearRect(0,0,46+4*e.canvasParams.answerBtnSize,46+4*e.canvasParams.answerBtnSize),$.each(n,function(t,i){if(i.r+=.2,i.opacity-=.004,i.r<=0)return!0;i.r>23+2*e.canvasParams.answerBtnSize?(i.r=10,i.opacity=.8):s(i.r,i.opacity)}),t.timer.answerBtnTimer=rAF(o)};o()}}},s=function(){var e,t,a,n={serverStatus:-1,localStatus:[]},s=0,o=0;this.roomId="",this.isInit=!0,this.room=void 0,this.localStream=void 0,this.behaviour=void 0,this.type=void 0,this.wrap=void 0,this.beginConnectTiming=function(e){var t=this.behaviour,i=this.type;a=this.wrap.find(".loading .dot");var n=function(){if(e<=0&&o)clearTimeout(o),o=0,mediator.publish("INTERVIEW_ACTION",{type:"no-answer"}),"active"===t&&("video"===i?$.toast({content:"对方不在线，请稍后再次尝试",type:"info"}):"audio"===i&&$.toast({content:"对方未能接听，请稍后再次尝试",type:"info"}));else{--e;var s=a.filter(".cur").index();s=++s>=a.length?0:s,a.removeClass("cur").eq(s).addClass("cur"),o=setTimeout(n,1e3)}};n()},this.clearConnectTimer=function(){o&&(clearTimeout(o),o=0)},this.beginTiming=function(){s=Date.now(),t=this.wrap.find(".timer"),r()},this.stopTiming=function(){clearTimeout(e)};var r=function(){var i=Math.floor((Date.now()-s)/1e3),a=String(i%60+100).substr(-2,2),n=Math.floor(i/60),o=String(n%60+100).substr(-2,2);n=Math.floor(n/60);var c=n,l="";l=c?String(c+100).substr(-2,2)+":"+o+":"+a:o+":"+a,t.text(l),e=setTimeout(r,1e3)};this.setServerStatus=function(e,t){n.serverStatus=e,t&&c(e,t)},this.setLocalStatus=function(e){n.localStatus.push(e)},this.getCurLocalStatus=function(){return n.localStatus[n.localStatus.length-1]},this.getLocalStatus=function(){return n.localStatus};var c=function(e,t){if([2,4,5,7].indexOf(e)<0)return!0;i.reportStatus(e,t)}},o=function(){var t;this.beCalled=function(n){if(!_PAGE.canInterviewOnline)return!1;if(!n.data)return!1;var s=JSON.parse(n.data);if(!s)return!1;s.toast&&$.toast({content:s.toast,type:"info"}),i.checkStatus(s.mediaRoomId).then(function(c){0===c.mediaStatus&&(e.loaded?(t=a("passive",n.kind),i.reportBeginInterview(s.mediaRoomId),o({roomId:s.mediaRoomId,bossId:s.bossId,geekId:s.geekId})):(r(),setTimeout(function r(){e.loaded?(t=a("passive",n.kind),i.reportBeginInterview(s.mediaRoomId),o({roomId:s.mediaRoomId,bossId:s.bossId,geekId:s.geekId})):setTimeout(r,300)},300)))})},this.call=function(e){t=a("active",e.kind),$.toast({type:"loading",content:"正在获取本地设备，请稍等"}),o(e)},this.answer=function(){if(!t)return!1;t.setLocalStatus(2.4),t.room.connect({singlePC:e.singlePC})},this.noAnswer=function(){if(!t)return!1;var e=t.getCurLocalStatus();switch(!0){case e>=1&&e<2:t.setLocalStatus(1.3);break;case e>=2&&e<3:t.setLocalStatus(2.3);break;case e>=3&&e<4:default:t.setLocalStatus(3.6)}p.reportStatus({status:2}),l()},this.reportStatus=function(e){if(!t)return!1;if(e.status)t.setServerStatus(e.status,t.roomId);else switch(e.action){case"hang-up":var i=t.getCurLocalStatus();i>=0&&i<2||i>=3&&i<4?t.setServerStatus(5,t.roomId):i>=2&&i<3&&t.setServerStatus(4,t.roomId)}},this.hangUp=function(e){if(e&&e.data){var t=JSON.parse(e.data);t&&t.toast&&$.toast({content:t.toast,type:"info"})}n()},this.rememberWrap=function(e){t.wrap=e.wrap},this.myConsole=function(e){interviewOnlineDebug&&console.log(e)};var a=function(e,t){var i=new s;return i.behaviour=e,i.type=t,i},n=function(){if(!t)return!1;var e=t.getCurLocalStatus();switch(!0){case e>=1&&e<2:t.setLocalStatus(1.1);break;case e>=2&&e<3:t.setLocalStatus(2.1);break;case e>=3&&e<4:t.setLocalStatus(3.1);break;case e>=4&&e<5:t.setLocalStatus(4.3);break;case e>=5&&e<6:t.setLocalStatus(5.3);break;case e>=6&&e<7:t.setLocalStatus(6);break;default:t.setLocalStatus(7)}l()},o=function(a){try{a.type=t.type,t.setLocalStatus(0);var n=c.getLocalStream(t.type),s="passive"===t.behaviour?null:c.getAppInfoData(a),o=c.getRoomData(s,a),r=c.createRoom(o);t.localStream=n,t.roomId=o.roomId,t.room=r,t.bossId=a.bossId||_PAGE.uid,t.geekId=a.geekId||Chat.curUserData.uid,n.init(),$("#toast").remove(),p.myConsole("roomData"+JSON.stringify(o)),n.addEventListener("access-accepted",function(){switch(m.rendContainer({geekId:t.geekId}),f(n,e.localStreamDomId),g(),t.behaviour){case"passive":t.setLocalStatus(2),t.beginConnectTiming(30);break;case"active":t.setLocalStatus(1),r.connect({singlePC:e.singlePC}),t.beginConnectTiming(30);try{Block.action({action:"video"===t.type?"chat-video-interview":"chat-voice-call",uid:t.bossId,bg:1,p:t.geekId,p2:0,p3:a.jobId,p4:a.expectId})}catch(e){}break;default:t.setLocalStatus(1),r.connect({singlePC:e.singlePC}),t.beginConnectTiming(30)}}),n.addEventListener("access-denied",function(){t.setLocalStatus(.1),$.toast({content:"请开启权限后进行呼叫",type:"error"})}),$(window).on("unload",function(){"active"===t.behaviour?i.reportStatusSync(5,t.roomId):"passive"===t.behaviour&&(i.reportStatusSync(4,t.roomId),p.hangUp())})}catch(e){p.myConsole(e)}},l=function(){var e=t.room,i=t.localStream;if(t.stopTiming(),e)try{e.unpublish(i),e.disconnect()}catch(e){}t.setLocalStatus(6),m.rendByStatus(6,t.wrap),h(),$(window).off("unload")},h=function(){p.myConsole(t.getLocalStatus()),t.clearConnectTimer(),t.stopTiming(),t=null},f=function(e,t){e.show(t)},m={rendContainer:function(e){switch(e.behaviour=t.behaviour,t.type){case"video":d.rendContainer(e);break;case"audio":u.rendContainer(e)}},rendByStatus:function(e,i){switch(t.type){case"video":d.rendByStatus(e,i);break;case"audio":u.rendByStatus(e,i)}}},g=function(){var i=t.room,a=t.localStream;i.addEventListener("room-connected",function(e){t.setLocalStatus(3);var n={metadata:{type:"publisher"}};p.myConsole("=================== localStream ID :",a.getID()),p.myConsole("=============local stream :",a),i.publish(a,n),p.myConsole("=================== localStream ID :",a.getID()),p.myConsole("==================  roomEvent.streams,",e.streams)}),i.addEventListener("room-disconnect-loss",function(e){t.setLocalStatus(3.3),p.myConsole("room-disconnect-loss",e.message)}),i.addEventListener("room-reconnecting",function(e){t.setLocalStatus(3.2),p.myConsole("room-reconnecting",e.message)}),i.addEventListener("room-reconnected",function(e){t.setLocalStatus(3),p.myConsole("room-reconnected",e.message)}),i.addEventListener("room-disconnected",function(e){t.setLocalStatus(3.4),p.myConsole("room-disconnected",e.message)}),i.addEventListener("room-published-error",function(){t.setLocalStatus(3.5),p.myConsole("room-published-error",event.message)}),i.addEventListener("stream-added",function(e){var t=[e.stream];if(p.myConsole("【stream-added】streamId :",e.stream.getID(),";label :",e.stream.getLabel(),";streams size :",t.length),1===t.length&&a.getID()===t[0].getID())return!0;b(i,t,a)}),i.addEventListener("stream-subscribed",function(i){t.setLocalStatus(4),p.myConsole("【stream-subscribed】streamId :",i.stream.getID(),";label :",i.stream.getLabel(),";time :",new Date);var a=i.stream;f(a,e.oppositeStreamDomId),t.isInit&&(t.isInit=!1,m.rendByStatus(4,t.wrap),t.beginTiming(),t.clearConnectTimer(),$(window).off("unload"))}),i.addEventListener("stream-removed",function(e){t.setLocalStatus(5);var i=e.stream;p.myConsole("removed stream id,",i.getID()),p.myConsole("localstream id,",a.getID()),void 0!==i.elementID&&p.myConsole("----------------stream-removed-----------------")}),i.addEventListener("stream-failed",function(){t.setLocalStatus(5.4),p.myConsole("##############################Stream Failed, act accordingly")}),i.addEventListener("update-firfox-h264-addon",function(){p.myConsole("##############################update-firfox-h264-addon"),n(),$.dialog({title:"需要安装插件",content:'<div class="tip-text">火狐浏览器需要安装 "h264ify" 插件才能继续使用 视频/语音面试功能。<br/>点击确认会打开插件页面，或者直接在火狐扩展插件商店搜索中 "h264ify" 自助安装。(如果已安装请忽略)</div>',wrapClass:"dialog-icons-default",type:"info",onConfirm:function(e){window.open("https://addons.mozilla.org/en-US/firefox/addon/h264ify/"),e.remove()}})}),i.addEventListener("clientPriMsg",function(e){switch(p.myConsole("client msg info :",JSON.stringify(e)),e.message.eventName){case"sdkClientVersion":break;case"userLeaved":v();break;case"userReconnectTimeout":case"busyline":break;case"selfbusyline":p.hangUp()}})},v=function(){if(!t)return!1;var e=t.getCurLocalStatus();e>=4&&e<8&&m.rendByStatus(4.2,t.wrap),n()},b=function(t,i,a){$.each(i,function(n,s){p.myConsole("------------------------------------------"),p.myConsole("localsream id:",a.getID()),p.myConsole("localstream :",a),p.myConsole("stream : ",s),p.myConsole("------------------------------------------"),a.getID()!==s.getID()&&(p.myConsole("【subscribeToStreams】streamId :",s.getID(),";label :",s.getLabel(),";time :",new Date,";streams size :",i.length),t.subscribe(s,{slideShowMode:e.slideShowMode,metadata:{type:"subscriber"}}),s.addEventListener("bandwidth-alert",function(e){p.myConsole("Bandwidth Alert",e.msg,e.bandwidth)}))})}},r=function(){i.getEdgeSync().done(function(e){t.roomData.host=e[0]}).fail(function(){var e=window.location.hostname;e.indexOf("boss-m.weizhipin.com")>-1?t.roomData.host="192.168.1.12:800":e.indexOf("boss-m-qa.weizhipin.com")>-1?t.roomData.host="192.168.1.13:800":e.indexOf("boss-m-qa3.weizhipin.com")>-1?t.roomData.host="192.168.1.224:800":e.indexOf("pre-www.zhipin.com")>-1?t.roomData.host="pre-fms.zpurl.cn:800":e.indexOf("www.zhipin.com")>-1&&(t.roomData.host="v-bossbjfms-01.zpurl.cn:800")}).always(function(){e.loaded=!0,p.myConsole("loaded")})},c=new a,l=new n,d=l.video(),u=l.audio(),p=new o;mediator.subscribe("INTERVIEW_ACTION",function(t){switch(t.type){case"called":p.beCalled(t);break;case"call":try{Block.action({action:"video"===t.kind?"chat-video-interview-click":"chat-voice-call-click",uid:_PAGE.uid,bg:1,p:t.geekId,p2:0,p3:t.jobId,p4:t.expectId})}catch(e){}e.loaded?p.call(t):($.toast({type:"loading",content:"正在获取视频服务器地址"}),r(),setTimeout(function i(){e.loaded?($("#toast").remove(),p.call(t)):setTimeout(i,300)},300));break;case"hang-up":p.hangUp(t);break;case"report-status":p.reportStatus(t);break;case"no-answer":p.noAnswer(t);break;case"close":p.hangUp();break;case"dialog-open":p.rememberWrap(t);break;case"answer":p.answer()}})}function seriesLoadScripts(e,t){if("object"!=typeof e)var e=[e];var i=document.getElementsByTagName("head").item(0)||document.documentElement,a=new Array,n=e.length-1,s=function(o){a[o]=document.createElement("script"),a[o].setAttribute("type","text/javascript"),a[o].onload=a[o].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),o!=n?s(o+1):"function"==typeof t&&t()},a[o].setAttribute("src",e[o]),i.appendChild(a[o])};s(0)}function isVisiable(e){if(e){var t=e.getBoundingClientRect();return t.top>0&&window.innerHeight-t.top>0||t.top<=0&&t.bottom>=0}}function localStorageInstance(e,t){if(window.localStorage)if(""==t)window.localStorage.removeItem(e);else{if(!t)return window.localStorage[e];window.localStorage[e]=t}}var loadScript=function(e){var t,i;if(e&&""!=e)for(t=e.split(","),i=0;i<t.length;i++)$.getScript(t[i])},DEBUG=!0;if(void 0===staticPath)var staticPath="/v2/web/boss/";else staticPath+="/web/boss/";window.INTERFACE_URLS={homeUrl:"/",receiveUrl:"/chatsync.json",sendmsgUrl:"/chat/sendmsg.json",requestResumeUrl:"/chat/requestResume.json",acceptResumeUrl:"/chat/acceptResume.json",rejectResumeUrl:"/chat/rejectResume.json",niurenInfoUrl:"/chat/geek/info",getUserInfoUrl:"/chat/geek.json",lookYouListUrl:"/chat/view.json",likeYouListUrl:"/chat/recommend.json",bossInfoUrl:"/chat/job/info",addRelationUrl:"/chat/addRelation.json",historyMsgUrl:"/wapi/zpchat/boss/historyMsg",userlistUrl:"/wapi/zprelation/friend/getBossFriendList.json",jobInfoUrl:"/bossweb/jobinfo",readMessageUrl:"/chat/readmsg.json",chatProtoUrl:"/v2/web/boss/js/module/chat.proto",requestPhoneUrl:"/chat/requestContact.json",acceptPhoneUrl:"/chat/acceptContact.json",rejectPhoneUrl:"/chat/rejectContact.json",saveEmailUrl:"/user/updateEmail.json",expressionDataUrl:"/v2/chat_v2/js/pages/expression_data.txt",getIsFirstTalkUrl:"/chat/firstTalk.json",validationEmail:"/user/getEmail.json",feedbackReadUrl:"/chat/receiveMsgRead.json",feedbackReadSyncUrl:"/chat/receiveMsgReadSync.json",assetUrl:"/v2/chat_v2/",feedbackReceiveUrl:"/chat/receiveMsg.json",weixin:"",saveWeixinUrl:"/user/updateWeixin.json",validationWeixin:"/chat/validWeixin.json",requestWeixinUrl:"/chat/requestWeixin.json",acceptWeixinUrl:"/chat/acceptWeixin.json",rejectWeixinUrl:"/chat/rejectWeixin.json",jobValidationUrl:"/chat/jobValidation.json",colleaguesListUrl:"/chat/brandUserList.json",colleaguesSubmitUrl:"/chat/shareGeek.json",getJobListUrl:"/chat/user/joblist.json",setTopUrl:"/wapi/zprelation/friend/friendIsTop.json",setBelongGroupL2Url:"/chat/friend/addGroup.json",sendInterviewUrl:"/wapi/zprelation/boss/interview/invite.json",candidateMsgUrl:"/candidate/status.json",chatFilterUsersUrl:"/chat/userfilterlist.json",chatRankUsersUrl:"/chat/userlistrank.json",chatAddUsersUrl:"/chat/userfriend.json",candidateJs:staticPath+"js/candidate.js"},function(){var e=e||{};e={form:{Prompt:function(e,t){var i=$('<div class="kz_tishi" style="position:absolute;z-index:9999;"/>').html(e);0==$(".kz_tishi").length&&(i.appendTo("body").delay(1500).fadeOut(500,function(){$(this).remove()}),i.css({left:1==t?($(window).width()-i.outerWidth())/2:0,top:1==t?($(window).height()-i.outerHeight())/2:0,width:1==t?"auto":"100%",position:"fixed"}))}},pageLock:{show:function(t,i,a,n,s){if(0==$(window.parent.document).find(i.selector).length)var o=($(window.parent.document).width()-$(i).outerWidth())/2,r=($(window).height()-$(i).outerHeight())/2;else var o=($(window.parent.document).width()-$(window.parent.document).find(i.selector).outerWidth())/2,r=($(window).height()-$(window.parent.document).find(i.selector).outerHeight())/2;if(!$(window.parent.document).find("#lockpage").length>0){$("<div id='lockpage'/>").css({position:"absolute",zIndex:t||20,left:0,top:0,width:"100%",height:"100%",background:"#000",opacity:.8}).appendTo($(window.parent.document.body))}0==$(window.parent.document).find(i.selector).length?($(i).appendTo($(window.parent.document.body)),$(window.parent.document).find(i).css({position:"fixed",zIndex:t+1,left:o,top:r,display:"block"})):$(window.parent.document).find(i.selector).css({position:"fixed",zIndex:t+1,left:o,top:r,display:"block"}),e.pageLock.hide(a,i,s),"function"==typeof n&&n()},hide:function(e,t,i){$(window.parent.document).find(e).click(function(e){void 0===i&&$(window.parent.document).find(t).appendTo("body"),$(t).hide(),$(window.parent.document).find("#lockpage").remove(),e.preventDefault()})},runHide:function(e){$(window.parent.document).find(e.selector).length>0?setTimeout(function(){$(window.parent.document).find(e).remove()},100):$(window.parent.document).find(e).hide(),$(window.parent.document).find("#lockpage").remove()},runRemove:function(e){$(window.parent.document).find(e).appendTo("body"),$(e).hide(),$(window.parent.document).find("#lockpage").remove()}}};var t=($("img.uploading"),$("#add_photo")),i=$("div.add_photo"),a=$("#cropWrap"),n=null;window.cropInit=function(){function t(e){
$("#cropWrap").find("#x").val(parseInt(e.x,10)),$("#cropWrap").find("#y").val(parseInt(e.y,10)),$("#cropWrap").find("#w").val(parseInt(e.w,10)),$("#cropWrap").find("#h").val(parseInt(e.h,10))}instanceCrop=$("#cropbox").Jcrop({aspectRatio:2,onSelect:t,bgFade:!0,allowMove:!0,bgOpacity:.2,minSize:[2,1],maxSize:[500,500],setSelect:[0,0,200,100]}),$("#cropWrap a.cancle").on("click",function(){i.removeClass("change_bg"),$("div.jcrop-holder").remove(),a.find("#cropbox").remove(),e.pageLock.runHide("#cropWrap"),"function"==typeof n&&n()})},window.runCrop=function(i,a,s){$(".crop_container").find(".jcrop-holder").remove(),$(".crop_container").find("#cropbox").remove(),$(".crop_container").append('<img src="'+i+'" id="cropbox" alt="">'),$("#cropWrap #saveCrop").unbind("click").bind("click",a),$("#deletePop").on("click","a.confirm",function(){var e=$(this);$.ajax({url:e.data("url"),type:e.data("method"),data:{id:orderArr[deleteIndex]},dataType:"json",success:function(e){e=e||{},1==e.rescode&&($("div.photo").eq(deleteIndex).remove(),photoFun(),$photoWrap.find("div.photo").length<5&&t.is(":hidden")&&(t.show(),initWebUpload(),$("div.add_photo").show()),orderArr.splice(deleteIndex,1),$order.val(orderArr.join(",")),hasBtn(),$(window.parent.document).find("#deletePop").hide(),$(window.parent.document).find("#lockpage").remove())}})}),n=s,e.pageLock.show(100,"#cropWrap","#cropWrap .cancle",window.cropInit)}}(),$.fn.hoverDelay=function(e){var t,i,a={hoverDuring:200,outDuring:200,hoverEvent:function(){$.noop()},outEvent:function(){$.noop()}},n=$.extend(a,e||{});return $(this).each(function(){$(this).hover(function(){clearTimeout(i),t=setTimeout(n.hoverEvent,n.hoverDuring)},function(){clearTimeout(t),i=setTimeout(n.outEvent,n.outDuring)})})};var mediator=window.mediator||new EventManger,BatchWapi={add:function(e,t,i,a){var n=BatchWapi[e];n||(n={},BatchWapi[e]=n),n[t]={},n[t].params=i,n[t].callback=a},request:function(e){var t=BatchWapi[e];if(!t||!Object.keys(t).length)return!1;var i="";if(Object.keys(t).forEach(function(e){var a=t[e],n="";a&&a.params&&Object.keys(a.params).forEach(function(e){var t=a.params[e];t&&(n="&"+n+e+"="+encodeURIComponent(t))}),i+=',"method='+e+n+'"'}),!i||!i.length)return!1;i="["+i.substring(1)+"]",$.ajax({url:"/wapi/batch/batchRunV3",type:"get",dataType:"json",data:{batch_method_feed:i},success:function(i){0===i.code?i.zpData&&(Object.keys(i.zpData).forEach(function(e){var a=t[e].callback;"function"==typeof a&&a(i.zpData[e])}),delete BatchWapi[e]):mediator.publish("WEB_GATE_INTERCEPTOR",{code:i.code,message:i.message})},error:function(){$.toast({type:"error",content:"服务器异常"})}})}},WapiInterceptor={addListener:function(){mediator.subscribe("WEB_GATE_INTERCEPTOR",function(e){switch(e.code){case 31:window.location.href="/antispam/forbidden/page?code=31";break;case 32:window.location.href="/antispam/forbidden/page?code=32";break;case 35:case 36:window.location.href="/wapi/zpAntispam/verify/sliderNew?callbackUrl="+window.location.href}})}};$(document).ready(function(){WapiInterceptor.addListener()});var UA=window.navigator.userAgent,isIE,isZpdesk,isWebkit;(UA.indexOf("Edge/")>-1||UA.indexOf("MSIE ")>-1||UA.indexOf("Trident/")>-1)&&(isIE=!0),UA.indexOf("WebKit")>-1&&(isWebkit=!0),UA.indexOf("ZhipinDesktop/")>-1&&(isZpdesk=!0);var supportsCalcVh=!!window.CSS&&CSS.supports("height","calc(100vh - 0px)");isWebkit&&!supportsCalcVh&&alert("您使用的浏览器太老了，会造成显示异常，请下载最新版本的浏览器");var VersionStatus={isHunter:!("undefined"==typeof _PAGE||!_PAGE.isHunter),preKa:"undefined"!=typeof _PAGE&&_PAGE.isHunter?"hunter":""};isZpdesk&&seriesLoadScripts("/v2/web/boss/js/zpdesk.js");var PAGE_ACTIVITY=!0;!function(){function e(e){var i={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};e=e||window.event,PAGE_ACTIVITY=e.type in i?i[e.type]:!this[t],__conversion(PAGE_ACTIVITY?"boss_webpage_active":"boss_webpage_inactivity")}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e,window.addEventListener("message",function(e){var t=e.data;"wordhrRouter"==t.type&&Menu.updateWordhrTopNav(t),"handleClickDoc"==t.type&&$(document).click()},!1)}();var isEmpty=function(e){return Array.isArray(e)&&0===e.length||Object.prototype.isPrototypeOf(e)&&0===Object.keys(e).length};Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},Array.prototype.unique=function(e){if(this.length<2)return[this[0]]||[];for(var t={},i=[],a=0;a<this.length;a++){var n=this[a],s=!!e&&typeof t[n]!=typeof n;(void 0===t[n]||s)&&(t[n]=n,i.push(n))}return i},Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var a=[],n=arguments.length>=2?arguments[1]:void 0,s=0;s<i;s++)if(s in t){var o=t[s];e.call(n,o,s,t)&&a.push(o)}return a}),Array.prototype.map||(Array.prototype.map=function(e,t){var i,a,n;if(null==this)throw new TypeError(" this is null or not defined");var s=Object(this),o=s.length>>>0;if("[object Function]"!=Object.prototype.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(i=t),a=new Array(o),n=0;n<o;){var r,c;n in s&&(r=s[n],c=e.call(i,r,n,s),a[n]=c),n++}return a}),Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,i=Object(this),a=i.length>>>0,n=0;if(arguments.length>=2)t=arguments[1];else{for(;n<a&&!(n in i);)n++;if(n>=a)throw new TypeError("Reduce of empty array with no initial value");t=i[n++]}for(;n<a;)n in i&&(t=e(t,i[n],n,i)),n++;return t}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var i;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(0===n)return-1;var s=0|t;if(s>=n)return-1;for(i=Math.max(s>=0?s:n-Math.abs(s),0);i<n;){if(i in a&&a[i]===e)return i;i++}return-1}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var a=arguments[1],n=0;n<i;){var s=t[n];if(e.call(a,s,n,t))return s;n++}}}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var i,a,n=this.length>>>0,s=!1;for(1<arguments.length&&(a=t,s=!0),i=0;n>i;++i)this.hasOwnProperty(i)&&(s?a=e(a,this[i],i,this):(a=this[i],s=!0));if(!s)throw new TypeError("Reduce of empty array with no initial value");return a});var mediator=window.mediator||new EventManger,cookie={get:function(e){var t,i=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(i))?unescape(t[2]):null},add:function(e,t,i,a,n,s){var o=new Date;o.setTime(o.getTime()),i&&(i=1e3*i*60*60*24);var r=new Date(o.getTime()+i);document.cookie=e+"="+escape(t)+(i?";expires="+r.toGMTString():"")+(a?";path="+a:"")+(n?";domain="+n:"")+(s?";secure":"")},set:function(e,t,i){if(i){var a=new Date;a.setMinutes(i),document.cookie=e+"="+encodeURIComponent(t)+";expires="+a.toGMTString()}else document.cookie=e+"="+encodeURIComponent(t)},clearcookie:function(e,t,i){cookie.get(e)&&(document.cookie=e+"="+(t?";path="+t:"")+(i?";domain="+i:"")+";expires=Thu,01-Jan-1970 00:00:01 GMT")}},__stringify=function(){function e(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=n[e];return t||(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+e+'"'}function t(e){var t,i,a,n=["["],s=e.length;for(i=0;i<s;i++)switch(typeof(a=e[i])){case"undefined":case"function":case"unknown":break;default:t&&n.push(","),n.push(__stringify(a)),t=1}return n.push("]"),n.join("")}function i(e){return e<10?"0"+e:e}function a(e){return'"'+e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+"T"+i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+'"'}var n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(i){switch(typeof i){case"undefined":return"undefined";case"number":return isFinite(i)?String(i):"null";case"string":return e(i);case"boolean":return String(i);default:if(null===i)return"null";if(i instanceof Array)return t(i);if(i instanceof Date)return a(i);var n,s,o=["{"],r=__stringify;for(var c in i)if(Object.prototype.hasOwnProperty.call(i,c))switch(typeof(s=i[c])){case"undefined":case"unknown":case"function":break;default:n&&o.push(","),n=1,o.push(r(c)+":"+r(s))}return o.push("}"),o.join("")}}}(),__throttle=function(e,t,i){var a=null;return function(){(new Date).getTime();clearTimeout(a),a=setTimeout(e,t)}},recommendRecordTimeFresh=function(e){e||(e={});var t=e.keepMinitues||12e5,i=e.localKey||"recordTime",a=e.subLocalKey||"recommendLevelTime",n=function(e,t){if(e||(e=i),t||(t={},t[a]=(new Date).getTime()),localStorage.getItem(e)){var n=JSON.parse(localStorage.getItem(e));t=$.extend(n,t)}localStorage.setItem(e,JSON.stringify(t))},s=function(e,t){e||(e=i),t||(t=a);var n=JSON.parse(localStorage.getItem(e));return n&&n[t]?Number(n[t]):0};return{setTimeToLocal:n,getTimeFromLocal:s,isOver20Minitue:function(e){e||(e=t);var n=s(i,a);return(new Date).getTime()-n>=e},publishToVue:function(e){window.top.frames.syncFrame.postMessage({name:"recommend-over20-refresh",data:{refresh:e}},"*")}}}({keepMinitues:12e5,localKey:"recordTime",subLocalKey:"recommendLevelTime"}),Menu={init:function(){Menu.sideEl=$(".side-menu"),Menu.chatEl=Menu.sideEl.find(".menu-chat"),Menu.recommendEl=Menu.sideEl.find(".menu-recommend"),Menu.geeksearchEl=Menu.sideEl.find(".menu-geeksearch"),Menu.items=Menu.sideEl.find("dl"),Menu.continerEls=$(".page-container"),Menu.chatEl=$(".chat-container"),Menu.toSyncEl=$(".sync-container"),Menu.toViewedEl=$(".viewed-container"),Menu.toSearchEl=$(".geeksearch-container"),Menu.toVueEl=$(".vue-container"),Menu.toRsyncEl=$(".rsync-container"),Menu.toSetEl=$(".set-container"),Menu.topContainer=$("#header"),Menu.positionRecommendId=null,Menu.positionCommunicaionId=null,Menu.isSuportCalc=supportsCalcVh;var e="wordhr.zhipin.com",t={dev:"wordhr-pc.weizhipin.com",pre:"preon-hr.wordhr.com",online:"wordhr.zhipin.com"};$(".link-help").on("click",function(){Menu.showHelpTip()}),$(".link-promotion").on("click",function(){Menu.showPopFrame($(this))});var i=getQueryString("mu"),a=decodeURIComponent(window.location.href);if(i&&i.indexOf("javascript")>-1)return window.location.href="/chat/im",!1;if(this.jumpExternalPart(),i&&a.indexOf("dashboard/candidate/recommend")>-1){var n=getQueryParams(i);!n.jobid&&a.indexOf("jobid")>-1&&(n=getQueryParams(window.location.hash));var s=Menu.topContainer.find('.top-recommend li[data-jobid="'+n.jobid+'"]');s.length&&s.addClass("cur")}var o,r=$(".top-user .dropdown-help-and-feedback");r.on("mouseenter",function(){o&&clearTimeout(o),r.addClass("dropdown-menu-open");try{_T.sendEvent("help_feedback")}catch(e){}}).on("mouseleave",function(){o=setTimeout(function(){r.removeClass("dropdown-menu-open")},300)}).find(".header-pop-feedback").on("click",function(){Feedback.getContent()});var c="";if($(".link-vipaccount").on("click",function(){clearInterval(c),$(this).closest(".dropdown-wrap").find(".vip-frame").html('<iframe src="'+$(this).attr("data-url")+'" />')}),$(".dropdown-vipaccount").hover(function(){var e=$(this);c=setTimeout(function(){e.find(".vip-frame iframe").length&&"none"!==e.find(".dropdown-menu").css("display")||e.find(".vip-frame").html('<iframe src="/mpa/html/vip/privilege" />').end().addClass("dropdown-menu-open")},500)},function(){clearInterval(c),$(this).removeClass("dropdown-menu-open")}),$(".vip-detail").on("click",function(){Menu.sideEl.find("dl.cur").hasClass("menu-recommend")&&sessionStorage.setItem("recommond_position",Menu.toSyncEl.children("iframe.frame-container").contents().scrollTop()),Menu.items.removeClass("cur"),Menu.gotoFramePage("/boss/item/vipprivilege.html","/boss/item/vipprivilege.html",$(this).attr("data-op"))}),$(".top-user .top-message-menu").on("click",function(){Menu.sideEl.find("dl").removeClass("cur"),$(this).find(".message-red-point").remove(),Menu.setUrl("/vue/index/#/dashboard/message/"),$("body").addClass("page-iframe"),Menu.continerEls.hide(),Menu.toVueEl.show(),$(".top-inner .top-op").hide(),$(".top-inner .top-message").show(),Menu.vueIframeChange("/vue/index/#/dashboard/message/"),Menu.isSuportCalc||Menu.toVueEl.find(".frame-container").css("height",$(window).height()-68+"px");try{_T.sendEvent("notitication_main_click")}catch(e){}}),$(".records-center").on("click",function(){Menu.sideEl.find("dl.cur").hasClass("menu-recommend")&&sessionStorage.setItem("recommond_position",Menu.toSyncEl.children("iframe.frame-container").contents().scrollTop()),Menu.sideEl.find("dl").removeClass("cur"),$(this).find(".num").remove(),Menu.setUrl("/vue/index/#/dashboard/recordscenter/"),$("body").addClass("page-iframe"),Menu.continerEls.hide(),Menu.toVueEl.show(),$(".top-inner .top-op").hide(),Menu.vueIframeChange("/vue/index/#/dashboard/recordscenter/"),Menu.isSuportCalc||Menu.toVueEl.find(".frame-container").css("height",$(window).height()-68+"px"),$("#page_key_name").val("recruit_data_center");try{_T.sendPageView()}catch(e){}}),$(".interview-detail").on("click",function(){menuInterview.view()}),Menu.sideEl.find(".menu-resume").length){var l=Menu.sideEl.find(".menu-resume a"),d=$(".top-resume a");window.top.location.host.indexOf(".weizhipin.com")>-1&&(l.attr("data-url",l.attr("data-url").replace(e,t.dev)),d.each(function(){$(this).attr("data-url",$(this).attr("data-url").replace(e,t.dev))})),"pre-www.zhipin.com"===window.top.location.host&&(l.attr("data-url",l.attr("data-url").replace(e,t.pre)),d.each(function(){$(this).attr("data-url",$(this).attr("data-url").replace(e,t.pre))}))}$(".top-slogan").on("click",function(){var e=Menu.sideEl.find(".menu-prop"),t=e.find("a").attr("data-url");Menu.sideEl.find(".menu-prop").hasClass("cur")||(t.indexOf("tab=mall")<0&&e.find("a").attr("data-url",t+"?tab=mall"),Menu.sideEl.find(".menu-prop a").click(),e.find("a").attr("data-url",t),__conversion("promotion_threeYears_slogan"))});var u,p=$(".top-user .dropdown-logout");p.on("mouseover",function(){u&&clearTimeout(u),p.addClass("dropdown-menu-open")}).on("mouseout",function(){u=setTimeout(function(){p.removeClass("dropdown-menu-open"),p.find(".recruit-tip").hide()},300)}),p.find("li").on("click",function(){var e=$(this).find("a");e.hasClass("link-profile")&&Menu.sideEl.find(".menu-user a").click(),e.hasClass("link-account")&&Menu.sideEl.find(".menu-account a").click(),e.hasClass("link-company")&&$.get("/wapi/zpboss/h5/enterprise/getBossRoleType.json",function(e){var t=e.zpData;2===t.roleType||3===t.roleType?(Menu.sideEl.find("dl").removeClass("cur"),Menu.sideEl.find(".menu-colleague").addClass("cur"),Menu.topContainer.find(".top-colleague a.J-company-home").click(),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-colleague").show()):(Menu.sideEl.find("dl").removeClass("cur"),Menu.sideEl.find(".menu-user").addClass("cur"),Menu.topContainer.find(".top-company a").eq(1).click(),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-company").show())}),e.hasClass("link-profile")&&Menu.sideEl.find(".menu-user a").click(),e.hasClass("link-account")&&Menu.sideEl.find(".menu-account a").click(),e.hasClass("link-msgset")&&Menu.sideEl.find(".menu-msgset a").click()}),p.find(".link-apply").on("click",function(e){p.find(".recruit-tip").fadeIn();try{_T.sendEvent("menu_dropdown_apply")}catch(e){}return!1}),$("#guide-wrap").on("click",function(){$(this).find(".guide-box").each(function(e){if(1==e&&$(this).is(":visible"))try{_T.sendEvent("newpx_autoclose")}catch(e){}}),$("#guide-wrap").hide()}),$(".link-pop-wordhr").on("click",function(){Menu.showPopWordhr($(this))}),window.getSourceForVue=function(){return Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li.cur").data("open")},mediator.subscribe("fullContainer",function(e){}),mediator.subscribe("switchRouteFromVue",function(e){Menu.setUrl&&Menu.gotoPage&&(Menu.setUrl(e),Menu.gotoPage())});var h,f=0;window.Recommend||(Recommend={}),Recommend.changeTableByStatus||(Recommend.changeTableByStatus=function(e){var t=$(".sync-container iframe").contents().find(".op-category .group-btns a[data-status="+e+"]");if(t.length>0)t[0].click();else{$(".menu-recommend a")[0].click();var i=$(".sync-container iframe");i.load(function(){i.contents().find(".op-category .group-btns a[data-status="+e+"]")[0].click()})}}),mediator.subscribe("recommendToParent",function(e){var t=e&&e.status;if(Recommend.para||(Recommend.para={}),Recommend.para.status=t,Menu.topContainer.find(".top-recommend .dropdown-wrap").length>0){try{var i=Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li");i.length&&i.each(function(){2===$(this).data("open")&&(0!==t?$(this).hide():$(this).show())})}catch(e){}var a=Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li.cur").index();5===t?(Menu.topContainer.find(".top-recommend .dropdown-wrap").hide(),Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).click()):0===t?(Menu.topContainer.find(".top-recommend .dropdown-wrap").show(),Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).hide(),h>1?Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(h).click():0===a?Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(1).click():Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(a).click()):(Menu.topContainer.find(".top-recommend .dropdown-wrap").show(),Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).show(),0===f?(h=a,Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).click()):0===f||5===f?Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).click():a>=0?Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(a).click():Menu.topContainer.find(".top-recommend .dropdown-wrap").find("li").eq(0).click())}else{var n=$(".menu-recommend a").data("url"),s="?jobid=0&status="+(Recommend.para.status||0)+"&source="+getSourceForVue(),o=n+s;Menu.syncIframeChange(o,s,null,null),$(".menu-recommend a").attr("data-url",o)}f=t}),sessionStorage.getItem("recommond_position")&&window.top==window.self&&sessionStorage.setItem("recommond_position",0),$(".top-user").on("click",".records-center, .vip-detail, .dropdown-logout a",function(){Menu.sideEl.find("dl.cur").hasClass("menu-recommend")&&sessionStorage.setItem("recommond_position",Menu.toSyncEl.children("iframe.frame-container").contents().scrollTop())}),Menu.sideEl.find("dl.cur").hasClass("menu-chat")&&"block"===Menu.chatEl.css("display")&&(BatchWapi.add("isCattleManageGray","/wapi/zprelation/friend/manage/isGray",null,function(e){if(0===e.code&&e.zpData&&e.zpData.result){if($("#toCattleManageBtn").length)$("#toCattleManageBtn").show();else{$(".chat-container .op-filter").append('<div id="toCattleManageBtn" class="to-cattle-manage-btn"><i class="iboss-niurenguanliv" style="color:#5DD5C8; margin-right:9px;"></i>牛人管理</div>')}$("#toCattleManageBtn").on("click",function(){Menu.showChatAndHideVue(!1)})}}),BatchWapi.request("isCattleManageGray")),Menu.sideEl.on("click","a",function(){if(!$(this).hasClass("link-pop-wordhr")){var e=Menu.sideEl.find("dl.cur");if(Menu.items.removeClass("cur"),$(this).closest("dl").addClass("cur"),Menu.topContainer.find(".top-op").hide(),e.hasClass("menu-recommend")){sessionStorage.setItem("recommond_position",Menu.toSyncEl.children("iframe.frame-container").contents().scrollTop());try{recommendRecordTimeFresh.setTimeToLocal()}catch(e){}}if(e.hasClass("menu-geeksearch")&&!$(this).closest("dl").hasClass("menu-geeksearch")&&localStorageInstance("search-pos",Menu.toSearchEl.children("iframe.frame-container").contents().scrollTop()),$(this).closest("dl").hasClass("menu-chat")){Menu.continerEls.hide(),Menu.chatEl.show(),e.hasClass("menu-chat")?$(document).trigger("MENU_ROUTE_CHAT",{action:"flush"}):$(document).trigger("MENU_ROUTE_CHAT",{}),Menu.topContainer.find(".top-chat").show(),"undefined"!=typeof Recommend&&(Recommend.visiable=!1),$("#page_key_name").val(VersionStatus.preKa+"bpc_chat");try{_T.sendPageView()}catch(e){}Menu.setUrl("chat"),BatchWapi.add("isCattleManageGray","/wapi/zprelation/friend/manage/isGray",null,function(e){0===e.code&&e.zpData&&e.zpData.result&&Menu.showChatAndHideVue(!0)}),BatchWapi.request("isCattleManageGray")}else Menu.chatEl.hide(),Menu.topContainer.find(".top-chat").hide(),$(document).trigger("MENU_ROUTE_CHAT",{});if($(this).closest("dl").hasClass("menu-recommend")){if("undefined"==typeof Recommend&&(window.Recommend={}),Menu.toSyncEl.show(),Menu.setUrl($(this).attr("data-url")),Menu.topContainer.find(".top-recommend").show(),Recommend.para||(Recommend.para={}),void 0===Recommend.para.status&&(Recommend.para.status=0),$(this).closest("dl").hasClass("menu-recommend"))if(0===Recommend.para.status&&$(".top-recommend").find("li").eq(0).hide(),Menu.topContainer.find(".top-recommend .dropdown-wrap").length<=0){var t=$(".menu-recommend a").data("url"),i="?jobid=-1&status"+Recommend.para.status+"&source="+getSourceForVue(),a=t+i;Menu.syncIframeChange(a,i,null,null),$(".menu-recommend a").attr("data-url",a)}else $(".top-recommend").find("li").hasClass("cur")?$(".top-recommend").find("li.cur").length?$(".top-recommend").find("li.cur").click():window.location.href.indexOf("recommend")>=0&&$(".top-recommend").find("li").eq(1).click():$(".top-recommend").find("li").eq(1).click();try{recommendRecordTimeFresh.getTimeFromLocal()&&(recommendRecordTimeFresh.isOver20Minitue(12e5)&&recommendRecordTimeFresh.publishToVue(1),recommendRecordTimeFresh.setTimeToLocal("recordTime",{recommendLevelTime:0}))}catch(e){}Menu.topContainer.find(".top-recommend li").length||Menu.topContainer.find(".top-recommend .dropdown-wrap").hide(),$("#page_key_name").val(VersionStatus.preKa+"bpc_geek_rcmd");try{_T.sendPageView()}catch(e){}Menu.fixSafari11ScrollBug()}if($(this).closest("dl").hasClass("menu-position")||$(this).closest("dl").hasClass("menu-user")||$(this).closest("dl").hasClass("menu-account")||$(this).closest("dl").hasClass("menu-msgset")||$(this).closest("dl").hasClass("menu-company-prop")||$(this).parent().hasClass("figure")||$(this).closest("dl").hasClass("menu-resume")?($("body").addClass("page-iframe"),Menu.toRsyncEl.html('<iframe class="frame-container" name="frameContainer" src="'+$(this).attr("data-url")+'"></iframe>'),Menu.continerEls.hide(),Menu.toRsyncEl.show(),Menu.setUrl($(this).attr("data-url")),"undefined"!=typeof Recommend&&(Recommend.visiable=!1),Menu.isSuportCalc||Menu.toRsyncEl.find(".frame-container").css("height",$(window).height()-68+"px"),Menu.vueIframeClear()):$("body").removeClass("page-iframe"),$(this).closest("dl").hasClass("menu-recommend")||$(this).closest("dl").hasClass("menu-colleague")||$(this).closest("dl").hasClass("menu-prop")||$(this).closest("dl").hasClass("menu-geeksearch-inner")||$(this).closest("dl").hasClass("menu-geekinterview-inner")){var n=$(this);$("body").addClass("page-iframe"),Menu.continerEls.hide();var i={};if(n.closest("dl").hasClass("menu-geekinterview-inner")){var s=decodeURIComponent(window.location.search.substr(1));if(s.indexOf("&")>-1){s=s.substr(s.indexOf("&")+1);var o=s.split("&");$.each(o,function(e,t){var a=t.split("=");a&&2==a.length&&(i[a[0]]=a[1])})}}Menu.setUrl(n.attr("data-url")),"undefined"!=typeof Recommend&&(Recommend.visiable=!1),Menu.vueIframeChange(n.attr("data-url"),i),Menu.toVueEl.show(),Menu.isSuportCalc||(Menu.toVueEl.find(".frame-container").css("height",$(window).height()-68+"px"),Menu.toSyncEl.find(".frame-container").css("height",$(window).height()-68+"px"))}if($(this).closest("dl").hasClass("menu-recommend")?($("body").addClass("page-iframe"),Menu.continerEls.hide(),Menu.toSyncEl.show(),Menu.setUrl($(this).attr("data-url")),Menu.syncIframeChange($(this).attr("data-url"),i,null,null)):Menu.toSyncEl.hide(),$(this).closest("dl").hasClass("menu-position")&&(Menu.topContainer.find(".top-position").show(),$("#page_key_name").val(VersionStatus.preKa+"bpc_job_list")),$(this).closest("dl").hasClass("menu-geeksearch")){$("body").addClass("page-iframe"),0===Menu.toSearchEl.children("iframe.frame-container").length&&Menu.toSearchEl.html('<iframe class="frame-container" name="frameContainer" src="'+$(this).attr("data-url")+'"></iframe>'),e.hasClass("menu-geeksearch")?Menu.toSearchEl.children("iframe.frame-container").attr("src",$(".menu-geeksearch a").data("url")):mediator.publish("SEARCH_LIST_FLUSH"),Menu.continerEls.hide(),Menu.toSearchEl.show(),Menu.fixSafari11ScrollBug(!0),Menu.topContainer.find(".top-geeksearch").show(),"undefined"!=typeof Recommend&&(Recommend.visiable=!1),localStorageInstance("search-pos")&&$(".geeksearch-container iframe").contents().scrollTop(localStorageInstance("search-pos"));try{_T.sendPageView();var r={action:"super-search"};Block.action(r)}catch(e){}$("#page_key_name").val(VersionStatus.preKa+"bpc_geek_search");var c=getQueryParams(window.top.location.href),l="search#/"==c.mu||"search"==c.mu;if($(".top-menu .goSearchIndex").length>0&&l?$(".top-menu .goSearchIndex").click():l&&window.top.frames.frameContainer.postMessage({name:"search-candidate-refresh"},"*"),"search"==getQueryString("mu"))return;Menu.setUrl("search"),window.top.frames.frameContainer.postMessage({name:"search-candidate-refresh"},"*"),Menu.isSuportCalc||$(".geeksearch-container .frame-container").css("height",$(window).height()-68+"px")}if($(this).closest("dl").hasClass("menu-prop")&&(Menu.topContainer.find(".top-prop").show(),Menu.topContainer.find(".top-prop a").removeClass("cur"),Menu.topContainer.find(".top-prop a").eq(0).addClass("cur"),$("#page_key_name").val(VersionStatus.preKa+"bpc_item_mine")),$(this).closest("dl").hasClass("menu-user")&&(Menu.topContainer.find(".top-company").show(),Menu.topContainer.find(".top-company a").removeClass("cur"),Menu.topContainer.find(".top-company a").eq(0).addClass("cur"),$("#page_key_name").val(VersionStatus.preKa+"bpc_boss_info_v1")),($(this).closest("dl").hasClass("menu-account")||$(this).closest("dl").hasClass("menu-msgset"))&&(Menu.topContainer.find(".top-account").show(),Menu.topContainer.find(".top-account a").removeClass("cur"),Menu.topContainer.find(".top-account a").eq(0).addClass("cur"),$("#page_key_name").val(VersionStatus.preKa+"bpc_boss_info_account")),$(this).closest("dl").hasClass("menu-company-prop")&&$("#page_key_name").val(VersionStatus.preKa+"bpc_meritem_item"),$(this).closest("dl").hasClass("menu-colleague")&&(Menu.topContainer.find(".top-colleague").show(),Menu.topContainer.find(".top-colleague a").removeClass("cur").eq(0).addClass("cur"),$("#page_key_name").val(VersionStatus.preKa+"bpc_colleagues")),$(this).closest("dl").hasClass("menu-resume")?(Menu.topContainer.find(".top-resume").show(),Menu.topContainer.find(".top-resume a").removeClass("cur").eq(0).addClass("cur"),Menu.topContainer.find(".interview-cell").hide(),$("#page_key_name").val(VersionStatus.preKa+"bpc_wordhr_resume")):Menu.topContainer.find(".interview-cell").show(),$(this).closest("dl").hasClass("menu-geeksearch-inner")&&(seriesLoadScripts(INTERFACE_URLS.candidateJs),Menu.topContainer.find(".top-geeksearch").show(),$("#page_key_name").val(VersionStatus.preKa+"bpc_geek_search_inner")),$(this).closest("dl").hasClass("menu-geekinterview-inner")){seriesLoadScripts(INTERFACE_URLS.candidateJs);var d=Menu.topContainer.find(".top-interview");$.ajax({url:"/wapi/zpboss/h5/inner/interview/getTodayInterviewNum",type:"get",dataType:"json",success:function(e){0===e.code&&e.zpData&&!isNaN(e.zpData.interviewNum)&&d.find(".interview-count em").html(e.zpData.interviewNum)}}),d.show(),$("#page_key_name").val(VersionStatus.preKa+"bpc_geek_interview_inner")}if($(this).parent().hasClass("figure")&&(Menu.topContainer.find(".top-company").show(),Menu.topContainer.find(".top-company a").removeClass("cur"),Menu.topContainer.find(".top-company a").eq(0).addClass("cur"),$("#page_key_name").val(VersionStatus.preKa+"bpc_boss_info_v1")),$(this).closest("dl").hasClass("menu-recommend")){var u=sessionStorage.getItem("recommond_position")||0,p=$(".sync-container iframe").contents();p.find("body")&&p.find("body").length&&("auto"==p.find("body").get(0).style.height?p.find("body").get(0).style.height="100%":p.find("body").get(0).style.height="auto"),p.scrollTop(0),p.scrollTop(u)}Menu.vueIframeClear(),$("#backChatBtn").length&&$("#backChatBtn").hide()}}),Menu.topContainer.find(".top-recommend").on("click","li",function(){var e=$(this);if(e.closest(".dropdown-wrap").find(".dropdown-select").html(e.html()),e.parent().find("li").removeClass("cur"),e.addClass("cur"),e.closest(".dropdown-wrap").removeClass("dropdown-menu-open"),1===e.length){Recommend.para||(Recommend.para={});var t=e.data("jobid");Recommend.para.jobid=t;var i=$(".menu-recommend a").data("url"),a="?jobid="+t+"&status="+(Recommend.para.status||0)+"&source="+getSourceForVue(),n=i+a;Menu.syncIframeChange(n,a,null,null),$(".menu-recommend a").attr("data-url",n)}}),Menu.topContainer.find(".top-menu a").on("click",function(){var e=$(this);if(e.parent().find("a").removeClass("cur"),e.addClass("cur"),Menu.continerEls.hide(),e.attr("data-url")){if($("body").addClass("page-iframe"),e.attr("data-message"))window.frames.frameContainer.postMessage({type:"routerLink",url:e.attr("data-message")},"*"),Menu.toRsyncEl.show();else if(e.attr("data-url").indexOf("/dashboard")>-1){var t={};Menu.vueIframeChange(e.attr("data-url"),t),Menu.toVueEl.show()}else Menu.toRsyncEl.html('<iframe class="frame-container" src="'+$(this).attr("data-url")+'" name="frameContainer"></iframe>'),Menu.toRsyncEl.show();Menu.setUrl($(this).attr("data-url")),Menu.isSuportCalc||Menu.toRsyncEl.find(".frame-container").css("height",$(window).height()-68+"px")}Menu.vueIframeClear()}),Menu.gotoPage(),"onpopstate"in window&&-1==window.navigator.userAgent.indexOf("Edge")&&(window.onpopstate=function(){Menu.gotoPage()}),mediator.subscribe("APP_RECOMMEND_TAB",function(e){"Recommend"in window?Recommend.changeTableByStatus(8):Menu.setUrl("recommend","-1","8"),!Menu.sideEl.find("dl.cur").hasClass("menu-recommend")&&Menu.gotoCategory("recommend")}),$(".link-signout").on("click",function(e){e.preventDefault(),$.ajax({type:"get",url:"/wapi/zppassport/user/logout",dataType:"json",success:function(e){if(0==e.code){var t=window.location.hostname;t=t.substring(t.indexOf(".")),cookie.clearcookie("t","/",t),cookie.clearcookie("wt","/",t),e.zpData.toUrl?window.location.href=e.zpData.toUrl:window.location.href="/"}else $.toast({type:"error",content:"服务器异常"})},error:function(){$.toast({type:"error",content:"服务器异常"})}})}),window.top.mediator.subscribe("ITEM_PUBLISH_STORE",function(e){var t=e||{};t.itemType?PropStore.buy({
itemType:t.itemType}):Menu.topContainer.find(".top-menu a").eq(0).click()})},syncIframeChange:function(e,t,i,a){if(!e)return!1;var n=function(e){if(!t)return!1;e.postMessage({type:"vue-message",params:t,router:i},"*")},s=Menu.toSyncEl.find("iframe");s.length?(s.attr("src",e),n(window.frames.syncFrame),a&&a()):(Menu.toSyncEl.html('<iframe class="frame-container" name="syncFrame" src="'+e+'"></iframe>'),s=Menu.toSyncEl.find("iframe"),s.load(function(){n(window.frames.syncFrame)}))},vueIframeChange:function(e,t,i,a){if(!e)return!1;var n=function(e){if(!t)return!1;e.postMessage({type:"vue-message",params:t,router:i},"*")},s=Menu.toVueEl.find("iframe");s.length?(s[0].src=e,n(window.frames.vueContainer),a&&a()):(Menu.toVueEl.html('<iframe class="frame-container" name="vueContainer" src="'+e+'"></iframe>'),s=Menu.toVueEl.find("iframe"),s.load(function(){n(window.frames.vueContainer)}))},vueIframeClear:function(){Menu.toVueEl.is(":hidden")&&Menu.toVueEl.find("iframe").length>0&&Menu.vueIframeChange("/vue/index/#/")},showChatAndHideVue:function(e){function t(){try{_T.sendEvent("geek_manage")}catch(e){}Menu.showChatAndHideVue(!1)}function i(){try{_T.sendEvent("chat_list_return")}catch(e){}Menu.showChatAndHideVue(!0)}if(e){if($("#backChatBtn").hide(),Menu.toVueEl.hide(),$("body").removeClass("page-iframe"),$(".top-chat").show(),Menu.chatEl.show(),Menu.vueIframeClear(),!$("#toCattleManageBtn").length){$(".chat-container .op-filter").append('<div id="toCattleManageBtn" class="to-cattle-manage-btn"> <i class="iboss-niurenguanliv" style="color:#5DD5C8; margin-right:9px;"></i>牛人管理</div>')}$("#toCattleManageBtn").show(),$("#toCattleManageBtn").unbind(),$("#toCattleManageBtn").on("click",t)}else{if(Menu.chatEl.hide(),$(".top-chat").hide(),Menu.toVueEl.show(),$("body").addClass("page-iframe"),!$("#backChatBtn").length){$(".top-inner").append('<div class="top-op top-cattle-manage" id="backChatBtn" style="cursor: pointer;"><div class="top-menu"><i class="iboss-right"></i><span>返回消息列表</span></div></div>')}$("#backChatBtn").show(),$("#backChatBtn").unbind(),$("#backChatBtn").on("click",i),Menu.vueIframeChange("/vue/index/#/dashboard/cattleManage")}},gotoCategory:function(e,t){var i=".side-menu .menu-"+e,a=$(i);"postjob"===e?(Menu.sideEl.find(".cur").removeClass("cur"),Menu.sideEl.find(".menu-position").addClass("cur"),$("body").addClass("page-iframe"),Menu.toRsyncEl.html('<iframe class="frame-container" name="frameContainer" src="/bossweb/jobedit/0.html"></iframe>'),Menu.continerEls.hide(),Menu.toRsyncEl.show(),Menu.setUrl("/bossweb/jobedit/0.html"),Menu.vueIframeClear()):a.length&&a.find("a").click()},showHelpTip:function(){$.dialog({title:"",content:$(".hunter-help").prop("outerHTML"),closeText:!0,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-hunter-welcome",lock:!0,onOpen:function(e){},onConfirm:function(e){e.remove()}})},toggleTopMenu:function(e){$(".top-op").hide(),$("."+e).show()},jumpExternalPart:function(){var e=decodeURIComponent(location.href),t=e.indexOf("mu=/hunter/index");e.match(/\?mu=(.+)/gim),-1!==t&&(Menu.gotoFramePage(RegExp.$1,RegExp.$1,$(this).attr("data-op")),Menu.items.removeClass("cur"),$(".menu-position").addClass("cur"))},gotoFramePage:function(e,t,i){Menu.setUrl(e),$("body").addClass("page-iframe"),Menu.toRsyncEl.html('<iframe class="frame-container" name="frameContainer" src="'+t+'"></iframe>'),Menu.continerEls.hide(),Menu.toRsyncEl.show(),$(".top-inner .top-op").hide(),Menu.vueIframeClear(),i&&$(".top-inner").find("."+i).show()},gotoPage:function(){var e=getQueryString("mu"),t=window.location.href,i=!1;e&&(-1==e.indexOf("/dashboard/candidate/recommend")&&Menu.toSyncEl.hide(),"viewed"==e||e.indexOf("/bossweb/tag/2/")>-1?(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-viewed").addClass("cur"),Menu.sideEl.find(".menu-viewed a").trigger("click")):"recommend"==e||e.indexOf("/dashboard/candidate/recommend")>-1||t.indexOf("/dashboard/candidate/recommend")>-1?(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-recommend").addClass("cur"),Menu.sideEl.find(".menu-recommend a").trigger("click")):"chat"==e||e.indexOf("/candidate/")>-1?(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-chat").addClass("cur"),Menu.sideEl.find(".menu-chat a").trigger("click")):"search"==e||e.indexOf("/boss/search")>-1?(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-geeksearch").addClass("cur"),Menu.sideEl.find(".menu-geeksearch a").trigger("click")):e&&((e.indexOf("/bossweb/joblist.html")>-1||e.indexOf("/bossweb/jobedit")>-1)&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-position").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-position").show(),i=!0),e.indexOf("/dashboard/prop/store")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-prop").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-prop").show(),Menu.topContainer.find(".top-prop .top-menu a").removeClass("cur").eq(0).addClass("cur").trigger("click")),e.indexOf("/dashboard/prop/mine")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-prop").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-prop").show(),Menu.topContainer.find(".top-prop .top-menu a").removeClass("cur").eq(1).addClass("cur").trigger("click")),e.indexOf("/dashboard/prop/notice")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-prop").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-prop").show(),Menu.topContainer.find(".top-prop .top-menu a").removeClass("cur").eq(2).addClass("cur").trigger("click")),e.indexOf("/boss/item/vipprivilege")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-prop").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-vip-detail").show(),i=!0),e.indexOf("/dashboard/business")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-colleague").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-colleague").show(),e.indexOf("/dashboard/business/colleague")>-1?Menu.topContainer.find(".top-colleague .top-menu a").removeClass("cur").eq(0).addClass("cur").trigger("click"):e.indexOf("/dashboard/business/bprop")>-1?Menu.topContainer.find(".top-colleague .top-menu a").removeClass("cur").eq(1).addClass("cur").trigger("click"):e.indexOf("/dashboard/business/account")>-1?Menu.topContainer.find(".top-colleague .top-menu a").removeClass("cur").eq(2).addClass("cur").trigger("click"):Menu.sideEl.find(".menu-colleague a").trigger("click")),(e.indexOf("/user/company")>-1||e.indexOf("/dashboard/company")>-1)&&(Menu.items.removeClass("cur"),$.get("/wapi/zpboss/h5/enterprise/getBossRoleType.json",function(e){var t=e.zpData;2===t.roleType||3===t.roleType?(Menu.sideEl.find(".menu-colleague").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-colleague").show(),Menu.topContainer.find(".top-colleague .top-menu a").removeClass("cur"),Menu.topContainer.find(".top-colleague .top-menu a.J-company-home").addClass("cur")):(Menu.sideEl.find(".menu-user").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-company").show(),Menu.topContainer.find(".top-company .top-menu a").removeClass("cur").eq(1).addClass("cur"))}),i=!0),e.indexOf("/enterprise/resume/pool")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-colleague").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-colleague").show(),Menu.topContainer.find(".top-colleague .top-menu a").removeClass("cur").eq(4).addClass("cur"),i=!0),e.indexOf("/boss/user/")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-user").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-company").show(),Menu.topContainer.find(".top-company .top-menu a").removeClass("cur").eq(0).addClass("cur"),i=!0),e.indexOf("/boss/account/management")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-account").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-account").show(),Menu.topContainer.find(".top-account .top-menu a").removeClass("cur").eq(0).addClass("cur"),i=!0),e.indexOf("/boss/account/management/?type=1")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-msgset").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-account").show(),Menu.topContainer.find(".top-account .top-menu a").removeClass("cur").eq(0).addClass("cur"),i=!0),e.indexOf("zhipin/")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-resume").addClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-resume").show(),Menu.topContainer.find(".top-resume .top-menu a").removeClass("cur").eq(0).addClass("cur"),i=!0),e.indexOf("/dashboard/inner/search")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-geeksearch-inner").addClass("cur"),Menu.sideEl.find(".menu-geeksearch-inner a").trigger("click")),e.indexOf("/dashboard/inner/interview")>-1&&(Menu.items.removeClass("cur"),Menu.sideEl.find(".menu-geekinterview-inner").addClass("cur"),Menu.sideEl.find(".menu-geekinterview-inner a").trigger("click")),e.indexOf("/dashboard/recordscenter")>-1&&(Menu.items.removeClass("cur"),Menu.topContainer.find(".top-op").hide(),$(".records-center").trigger("click").find(".num").remove()),e.indexOf("/dashboard/message")>-1&&(Menu.items.removeClass("cur"),Menu.topContainer.find(".top-op").hide(),Menu.topContainer.find(".top-message").show(),Menu.topContainer.find(".top-message-menu").trigger("click").find(".message-red-point").remove()),i&&($("body").addClass("page-iframe"),1===Menu.toRsyncEl.find("frame-container[name=frameContainer]").length?Menu.toRsyncEl.find("frame-container[name=frameContainer]").attr("src",e):Menu.toRsyncEl.html('<iframe class="frame-container" name="frameContainer" src="'+e+'"></iframe>'),Menu.continerEls.hide(),Menu.toRsyncEl.show(),Menu.isSuportCalc||Menu.toRsyncEl.find(".frame-container").css("height",$(window).height()-68+"px"))))},setUrl:function(e,t,i){var e=e||"",a=getQueryString("debug"),t=t||getQueryString("jobid"),i=i||getQueryString("status");e&&""!=e&&(e="?mu="+encodeURIComponent(e)),t&&e.indexOf("mu=recommend")>-1&&(e+="&jobid="+t),i&&e.indexOf("mu=recommend")>-1&&(e+="&status="+i),a&&(e+="&debug=1"),"pushState"in history&&(t&&i?window.history.replaceState(null,null,e):window.history.pushState(null,null,e)),Menu.sideEl.trigger("urlchange",e)},showPopFrame:function(e){var e=e,t=e.attr("data-url");$.dialog({title:"",content:'<iframe class="pop-frame" src="'+t+'"></iframe>',closeText:!0,confirmText:"",cancelText:"",preKa:"zd_gift_",wrapClass:"dialog-promotion-iframe",lock:!0,onOpen:function(e){},onConfirm:function(e){e.remove()}})},showPopWordhr:function(e){$.dialog({title:"",content:'<div class="content-wordhr"><a href="https://www.wordhr.com" target="_blank" ka="pop_wordhr_link"><img src="https://z.zhipin.com/web/boss/resource/provision/wordhr-pop-banner.jpg" /></a></div>',closeText:!0,confirmText:"",cancelText:"",preKa:"pop_wordhr",wrapClass:"dialog-promotion-worhr",lock:!0,onOpen:function(e){},onConfirm:function(e){e.remove()}})},updateWordhrTopNav:function(e){var t=e.url;t.indexOf("/zhipin/setting")>-1?Menu.topContainer.find(".top-resume a").removeClass("cur").eq(2).addClass("cur"):t.indexOf("/zhipin/interview")>-1?Menu.topContainer.find(".top-resume a").removeClass("cur").eq(1).addClass("cur"):Menu.topContainer.find(".top-resume a").removeClass("cur").eq(0).addClass("cur")},fixSafari11ScrollBug:function(e){try{if(UA.indexOf("safari")&&UA.indexOf("11")){var t=e?$(".geeksearch-container iframe"):$(".sync-container iframe"),i=t.contents().find("#main");"0px"===i.css("border-width")?i.css("border","1px solid #f1f1f1"):"1px"===i.css("border-width")&&i.css("border","0px solid #f1f1f1")}}catch(e){}}},Tab={init:function(){var e=$(".mod-tab .data-tab");e.each(function(t){var i=$(this).attr("event");i||(i="click"),e.eq(t).on(i,"a",function(){var e=$(this).index(),t=$(this).closest(".data-tab").children(),i=$(this).closest(".mod-tab").children(".tab-con");t.removeClass("cur"),$(this).addClass("cur"),i.hide(),i.eq(e).show()})})}},PageSet={local:function(e,t){return void 0===t?localStorage.getItem(e):(localStorage.setItem(e,t),localStorage.getItem(e))},settings:function(e,t){var i=PageSet.local("__Local__Setting")?JSON.parse(PageSet.local("__Local__Setting")):{};return void 0===t?i[e]:(i[e]=t,PageSet.local("__Local__Setting",__stringify(i)),i)},markerInfo:{},getTipData:function(e){if($(".chat-container").is(":visible")||VersionStatus.isHunter){if(PageSet.markerInfo.rescode)return e(PageSet.markerInfo);$("#guide-wrap");$.get("/setting/notify/marker.json?types=1,5,9,10,11,12,13,15,18",function(t){1==t.rescode&&1==t.showGuide&&t[1]&&(PageSet.hasShowReplyTip=!1),VersionStatus.isHunter&&window.top==window.self&&1==t.rescode&&t[15]&&Menu.showHelpTip(),PageSet.markerInfo=t,"function"==typeof e&&e(PageSet.markerInfo)})}},bindEvent:function(e,t){var i=e||Menu.toSetEl;i.on("click",".radio-list .link-modify",function(){$(this).closest(".radio").find('input[type="radio"]').prop("checked","checked"),$(this).closest("dl").find(".defined-form").addClass("show-defined-form").removeClass("show-defined-tab"),$(this).closest("form").find('input[type="reasonType"]').val(""),$(this).closest("form").find(".ipt-area").text($(this).closest("form").find(".ipt-area").attr("data-text")),$(this).closest("dl").find(".defined-form .tip-text").text("请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！"),$(this).closest("dl").find(".count-num").length&&PageSet.countArea($(this).closest("dl").find(".ipt-area"))}),i.find(".defined-form .ipt-area").on("input",function(){PageSet.countArea($(this))}),i.find('.radio-list input[type="radio"]').on("change",function(){"0"===$(this).val()&&$(this).closest("form").find(".defined-form").removeClass("show-defined-form")}),i.on("click",".defined-form .btns .btn",function(){if($(this).hasClass("btn-back"))$(this).closest("dl").find(".defined-form").removeClass("show-defined-form");else if(""==$(this).closest("dl").find(".defined-form .ipt-area").val().replace(/(\s*$)/g,"")){if(!$(this).closest(".show-defined-tab").length)return $(this).closest("dl").find(".defined-form .tip-text").text("请输入内容"),$(this).closest("dl").find(".defined-form .ipt-area").focus(),!1;PageSet.postData($(this))}else{if($(this).closest("dl").find(".defined-form .count-num .red").length)return $(this).closest("dl").find(".defined-form .tip-text").text("内容不能超过200个字"),$(this).closest("dl").find(".defined-form .ipt-area").focus(),!1;$(this).closest("dl").find(".defined-form .tip-text").text("请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！"),PageSet.postData($(this))}})},countArea:function(e){var e=e,t=e.attr("data-range"),i=PageSet.getLength(e.val()),a=e.closest(".defined-form").find(".count-num");a&&a.length&&(t=t.split(","),a.html("<em"+(i>t[1]?' class="red"':"")+">"+i+"</em>/"+t[1]))},postData:function(e,t){var i=e.closest("form"),a=i.attr("action"),n=i.serialize(),s=e.closest(".show-defined-tab").length;return i.find(".ipt-area").length&&""==i.find(".ipt-area").val().replace(/(\s*$)/g,"")&&!s?void i.find(".ipt-area").focus():!e.hasClass("disabled")&&(e.addClass("disabled"),void $.ajax({url:a,type:"POST",data:n,dataType:"JSON",timeout:3e4,success:function(a){if(a.rescode)if(s)"radioChange"!=t&&$.toast({content:"保存成功",type:"success"}),e.closest(".show-defined-tab").find("li.cur").attr("data-text",filterXss(i.find(".ipt-area").val()));else{if(e.closest("dl").find(".defined-form").removeClass("show-defined-form"),"radio"!=e.attr("type")&&(i.find(".ipt-area").attr("data-text",filterXss(i.find(".ipt-area").val())),e.closest("dl").find(".link-modify").closest("label").find("span").html("发送信息“"+filterXss(i.find(".ipt-area").val())+"”")),e.closest("dl").find(".sentence-list").length){var n=e.closest("dl").find("input[name=id]").val();n?e.closest("dl").find('.sentence-list a[data-id="'+n+'"]').closest("li").replaceWith(a.html):(e.closest("dl").find(".sentence-list ul").append(a.html),Menu.toSetEl.find(".set-nav li").eq(1).html("常用语（"+e.closest("dl").find(".sentence-list li").length+"条）"))}e.closest("dl").find(".sayhello-list").length&&(i.find('input[name="templateId"]').val()?e.closest("dl").find('input[value="'+i.find('input[name="templateId"]').val()+'"]').closest("li").find("span").text(filterXss(i.find(".ipt-area").val())):(e.closest("dl").find(".sayhello-list ul").append(a.html),e.closest("dl").find(".op-sentence").hide()))}else $.toast({content:a.resmsg,type:"error"});e.removeClass("disabled")},error:function(t){e.removeClass("disabled"),$.toast({content:"保存失败，请检查网络后重试",type:"error"})}}))},getLength:function(e){for(var t=0,e=e.replace(/(^[\s\n\r]*)|([\s\n\r]*$)/g,""),i=e.length,a=-1,n=0;n<i;n++)a=e.charCodeAt(n),t+=55357==a?0:a>255?1:.5;return Math.ceil(t)}},util=function(){return{get:function(e,t,i,a){if(!e||!e instanceof Object)return i||"";var n=[].concat(t.split(".")),s=e instanceof Array?[].concat(e):$.extend({},e),o=void 0===a||a;$.each(n,function(e,t){if(/^(\w+)\[(\w+)\]$/.test(t)){var i=t.match(/^(\w+)\[(\w+)\]$/);n.splice(e,1,i[1],i[2])}});for(var r=n.length,c=0;c<r;){if(!s[n[c]])return i;s=s[n[c]],c++}return o?s:e instanceof Array?[].concat(s):e instanceof Object?$.extend({},s):void 0},getArrEqual:function(e,t){return e.filter(function(e){return t.indexOf(e)>-1})},lightKeyword:function(e,t){var i=""+t,a=(t+"").toLowerCase(),n=(e+"").toLowerCase(),s=a.indexOf(n),o=n.length;if(t.indexOf(e)<0)return t;var a=i.substr(0,s)+'<u class="h">'+i.substr(s,o)+"</u>"+i.substr(s+o);return a}}}(),FPS=0,Loop=function(){var e,t=0,i=0,a=Date.now(),n=Date.now(),s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),o=function(){var r=Date.now();n=r,i++,t++,r>1e3+a&&(e=Math.round(1e3*t/(r-a)),t=0,a=r,FPS=e),s(o)},r=function(){return FPS>20};return o(),{fps:function(){return FPS},visible:r}}();$(function(){Menu.init(),Tab.init()}),function(e,t,i){"use strict";var a=(e(t),e(document),!1),n=function(t){if("string"==typeof t)var t={content:t};this.settings=e.extend({},n.defaults,t),this.init()};n.defaults={content:"提示",lock:!1,wrapClass:null,type:null,position:"top",parentWrap:"body",time:2300,pending:""},n.prototype={init:function(){this.create(),this.settings.lock&&this.lock()},create:function(){var t="",i="",a=this;this.settings.type&&(t='<i class="icon-toast-'+this.settings.type+'"></i>'),i='<div data-pending="'+this.settings.pending+'" id="toast"><div class="toast-con">'+t+this.settings.content+"</div></div>",e("#toast").length&&e("#toast").remove(),this.toast=e(i).appendTo(this.settings.parentWrap),this.settings.wrapClass&&this.toast.addClass(this.settings.wrapClass),this.settings.position&&this.position(),this.time(),this.toast.on("click",function(){a.close()})},position:function(){"top"==this.settings.position&&this.toast.css("top",0),"center"==this.settings.position&&this.toast.css("bottom",0),"bottom"==this.settings.position&&this.toast.css("bottom",0)},lock:function(){a||(e("html,body").css("overflow","hidden"),a=!0)},unLock:function(){this.settings.lock&&a&&(e("html,body").css("overflow","visible"),a=!1)},close:function(){var e=this;e.toast.addClass("slideup"),setTimeout(function(){e.toast.removeClass("slideup").remove()},500),e.unLock()},time:function(){var e=this;this.settings.time&&"loading"!=this.settings.type&&(this.closeTimer=setTimeout(function(){e.close()},this.settings.time))}},e.toast=function(e){new n(e)}}(jQuery,window),function(e,t,i){"use strict";var a=(e(t),e(document),!-[1]&&t.XMLHttpRequest,!1),n=function(t){this.settings=e.extend({},n.defaults,t),this.init()};n.defaults={bind:!1,wrapClass:"",content:"请稍等...",title:"提示",onCancel:null,onOpen:null,onConfirm:null,onClose:null,closeText:!0,confirmText:"确定",cancelText:"取消",position:"center",inline:!1,isSelecter:!1,element:null,preKa:"",autoTime:null,lock:!0,closeLayer:!0,opacityLock:!1},n.prototype={init:function(){this.create()},create:function(){var t="",i="",a="",n="",s="",o="",r="";this.settings.type&&(t='<i class="icon-dialog icon-dialog-'+this.settings.type+'"></i>'),this.settings.lock&&(a='<div class="dialog-layer"></div>',this.settings.opacityLock&&(a='<div class="dialog-layer dialog-opacity-layer"></div>')),this.settings.preKa&&(n=this.settings.preKa+"_"),("around"==this.settings.position||this.settings.inline)&&(s='<span class="icon-dialog-arrow"></span>'),this.settings.closeText&&(o='<a href="javascript:;" class="close" ka="'+n+'dialog_close"><i class="icon-close"></i></a>'),(this.settings.confirmText||this.settings.cancelText)&&(r='<div class="dialog-footer"><div class="btns"></div></div>'),i='<div class="dialog-wrap">'+a+'<div class="dialog-container">'+s+'<div class="dialog-title">'+t+'<h3 class="title">'+this.settings.title+"</h3>"+o+'</div><div class="dialog-con">'+this.settings.content+"</div>"+r+"</div></div>",e(".dialog-wrap").length&&!this.settings.inline&&e(".dialog-wrap").each(function(){e(this).hasClass("v-transfer-dom")||e(this).remove()}),this.settings.inline&&this.settings.element?this.dialog=e(i).appendTo(e(this.settings.element).parent()):this.dialog=e(i).appendTo("body"),(this.settings.onConfirm||this.settings.confirmText)&&this.onConfirm(),(this.settings.onCancel&&!1!==this.settings.cancelText||this.settings.cancelText)&&this.onCancel(),this.settings.wrapClass&&this.dialog.addClass(this.settings.wrapClass),this.settings.type&&this.dialog.addClass("dialog-icons-default"),this.settings.position&&this.position(),this.bindEvent(),e("body").addClass("dialog-open"),e.isFunction(this.settings.onOpen)&&(this.settings.bind?this.settings.onOpen.apply(this,this.dialog):this.settings.onOpen(this.dialog)),this.settings.lock&&this.lock(),this.autoInter&&clearInterval(this.autoInter),e.isNumeric(this.settings.autoTime)&&this.autoCloseTimer()},onConfirm:function(){var t=this,i=this.dialog.find(".dialog-footer .btns");e("<span>",{ClASS:"btn btn-sure",text:t.settings.confirmText,ka:(t.settings.preKa?t.settings.preKa+"_":"")+"dialog_confirm",click:function(){e.isFunction(t.settings.onConfirm)?t.settings.bind?t.settings.onConfirm.apply(t,t.dialog):t.settings.onConfirm(t.dialog):t.close("confirm")}}).prependTo(i)},onCancel:function(){var t=this,i=this.dialog.find(".dialog-footer .btns");e("<span>",{ClASS:"btn btn-outline btn-cancel",text:t.settings.cancelText,ka:(t.settings.preKa?t.settings.preKa+"_":"")+"dialog_cancel",click:function(){e.isFunction(t.settings.onCancel)?t.settings.bind?t.settings.onCancel.apply(t,t.dialog):t.settings.onCancel(t.dialog):t.close("cancel")}}).prependTo(i)},size:function(){var e=this.dialog.find(".dialog-con");this.dialog.find(".dialog-container");e.css({width:this.settings.width,height:this.settings.height})},position:function(){if(this.settings.element){var i=this,a=i.settings.element,n=i.dialog.find(".dialog-container").outerWidth(),s=e(a).offset(),o=s.left+a.width()/2;o<n&&(o=n/2),i.settings.inline||"around"!=i.settings.position||i.dialog.css({left:o+"px",top:s.top+"px"}),i.settings.inline&&(i.dialog.get(0).getBoundingClientRect().top>330&&t.innerHeight-i.dialog.get(0).getBoundingClientRect().top<280&&i.dialog.addClass("dialog-up-default"),i.settings.isSelecter&&e(document).on("click",function(t){t.target==a.get(0)||t.target.parentNode==a.get(0)||e(t.target).closest(".dialog-selecter-default").length||(i.dialog.closest(".dropdown-wrap").removeClass("dropdown-menu-open"),i.close())}))}},lock:function(){if(!a){var e=this;e.dialog.find(".dialog-container");this.settings.closeLayer&&e.dialog.find(".dialog-layer").on("click",function(){e.close()})}},unLock:function(){this.settings.lock&&a&&(e("html,body").css("overflow","visible"),a=!1)},close:function(t){e.isFunction(this.settings.onClose)&&this.settings.onClose(this.dialog,t||""),this.dialog.remove(),this.unLock(),this.autoInter&&clearInterval(this.autoInter),e("body").removeClass("dialog-open")},hide:function(t){e.isFunction(this.settings.onClose)&&this.settings.onClose(this.dialog,t||""),this.dialog.hide(),this.unLock(),e("body").removeClass("dialog-open")},autoCloseTimer:function(){var e=this,t=e.dialog.find(".btn-sure"),i=e.settings.autoTime,a=t.text();i&&(e.autoInter&&clearInterval(e.autoInter),e.autoInter=setInterval(function(){i<=1?(clearInterval(e.autoInter),e.close("timer")):(i--,t.text(a+"("+i+"s)"))},1e3))},bindEvent:function(){var i=this;this.dialog.find(".close").on("click",function(){i.close("")}),e(t).on("resize.dialog",function(){i.settings.onResize&&i.settings.onResize(i.dialog)})}},e.dialog=function(e){return new n(e)}}(jQuery,window);var DropDown={init:function(e){var e=e||$("body"),t=e.find(".dropdown-wrap").not(".sync-container .dropdown-wrap");t.each(function(){var e=$(this),i=e.attr("role-type"),a=e.find(".dropdown-select,.dropdown-label"),n=a.find("input[readonly]"),s=a.find('input[type="hidden"]'),o="false"!=e.attr("data-fill");i&&"customize-event"==i||(a.on("click",function(i){e.hasClass("dropdown-disabled")||($(i.target).closest(".dropdown-menu-open").length?e.removeClass("dropdown-menu-open"):(t.not(this.parent).removeClass("dropdown-menu-open"),e.toggleClass("dropdown-menu-open")))}),e.on("click","li",function(){var t=s.val();if(!$(this).hasClass("disabled")){if($(this).hasClass("tip-blank"))return void e.removeClass("dropdown-menu-open");n.length&&t!=$(this).attr("data-val")&&!$(this).hasClass("no-set")&&(o&&n.val($(this).text()),n.addClass("sel-active"),e.find(".tip-text").remove(),$(this).parent().find("li").removeClass("cur"),$(this).addClass("cur"),$(this).attr("data-val")&&s.val($(this).attr("data-val")),e.trigger("dropdown.selected",$(this).attr("data-val"))),e.removeClass("dropdown-menu-open")}}))}),$(document).on("click",function(e){$(e.target).parents(".dropdown-wrap").length||(t.removeClass("dropdown-menu-open"),t.trigger("dropdown.close")),e.stopPropagation()}),$(document).on("click",".js-report",function(e){t.removeClass("dropdown-menu-open"),t.trigger("dropdown.close"),e.stopPropagation()})}};if($(function(){DropDown.init()}),"undefined"==typeof jQuery)throw new Error("jquery-confirm requires jQuery");var jconfirm,Jconfirm;!function(e){"use strict";e.fn.confirm=function(t,i){return void 0===t&&(t={}),"string"==typeof t&&(t={content:t,title:i||!1}),e(this).each(function(){var i=e(this);i.on("click",function(a){a.preventDefault();var n=e.extend({},t);i.attr("data-title")&&(n.title=i.attr("data-title")),i.attr("data-content")&&(n.content=i.attr("data-content")),n.$target=i,i.attr("href")&&!t.confirm&&(n.confirm=function(){location.href=i.attr("href")}),e.confirm(n)})}),e(this)},e.confirm=function(e,t){return void 0===e&&(e={}),"string"==typeof e&&(e={content:e,title:t||!1}),jconfirm(e)},e.alert=function(e,t){return void 0===e&&(e={}),"string"==typeof e&&(e={content:e,title:t||!1}),e.cancelButton=!1,jconfirm(e)},jconfirm=function(t){void 0===t&&(t={}),jconfirm.defaults&&e.extend(jconfirm.pluginDefaults,jconfirm.defaults);var t=e.extend({},jconfirm.pluginDefaults,t);return new Jconfirm(t)},Jconfirm=function(t){e.extend(this,t),this._init()},Jconfirm.prototype={_init:function(){var e=this;this._rand=Math.round(99999*Math.random()),this._buildHTML(),this._bindEvents(),setTimeout(function(){e.open(),e._watchContent()},0)},_buildHTML:function(){var t=this;this.animation="anim-"+this.animation.toLowerCase(),this.closeAnimation="anim-"+this.closeAnimation.toLowerCase(),this.theme="jconfirm-"+this.theme.toLowerCase(),"anim-none"==this.animation&&(this.animationSpeed=0),this._lastFocused=e("body").find(":focus"),this.$el=e(this.template).appendTo(this.container).addClass(this.theme),this.$el.find(".jconfirm-box-container").addClass(this.columnClass),this.$el.find(".jconfirm-bg").css(this._getCSS(this.animationSpeed,1)),this.$el.find(".jconfirm-bg").css("opacity",this.opacity),this.$b=this.$el.find(".jconfirm-box").css(this._getCSS(this.animationSpeed,this.animationBounce)).addClass(this.animation),this.$body=this.$b,this.rtl&&this.$el.addClass("rtl"),this._contentReady=e.Deferred(),this._modalReady=e.Deferred(),this.$title=this.$el.find(".title"),this.contentDiv=this.$el.find("div.content"),this.$content=this.contentDiv,this.$contentPane=this.$el.find(".content-pane"),this.$icon=this.$el.find(".icon-c"),this.$closeIcon=this.$el.find(".closeIcon"),this.$contentPane.css(this._getCSS(this.animationSpeed,1)),this.setTitle(),this.setIcon(),this._setButtons(),this.closeIconClass&&this.$closeIcon.html('<i class="'+this.closeIconClass+'"></i>'),t._contentHash=this._hash(t.$content.html()),e.when(this._contentReady,this._modalReady).then(function(){t.setContent(),t.setTitle(),t.setIcon()}),this._getContent(),this._imagesLoaded(),this.autoClose&&this._startCountDown()},_unwatchContent:function(){clearInterval(this._timer)},_hash:function(){if("function"==typeof btoa)return btoa(encodeURIComponent(this.$content.html()))},_watchContent:function(){var e=this;this._timer=setInterval(function(){var t=e._hash(e.$content.html());e._contentHash!=t&&(e._contentHash=t,e.setDialogCenter(),e._imagesLoaded())},this.watchInterval)},_bindEvents:function(){var t=this,i=!1;this.$el.find(".jconfirm-scrollpane").click(function(e){i||t.backgroundDismiss&&(t.cancel(),t.close()),i=!1}),this.$el.find(".jconfirm-box").click(function(e){i=!0}),this.$confirmButton&&this.$confirmButton.click(function(e){e.preventDefault();var i=t.confirm(t.$b);t._stopCountDown(),t.onAction("confirm"),(void 0===i||i)&&t.close()}),this.$cancelButton&&this.$cancelButton.click(function(e){e.preventDefault();var i=t.cancel(t.$b);t._stopCountDown(),t.onAction("cancel"),(void 0===i||i)&&t.close()}),this.$closeButton&&this.$closeButton.click(function(e){e.preventDefault(),t._stopCountDown(),t.cancel(),t.onAction("close"),t.close()}),this.keyboardEnabled&&setTimeout(function(){e(window).on("keyup."+this._rand,function(e){t.reactOnKey(e)})},500),e(window).on("resize."+this._rand,function(){t.setDialogCenter(!0)})},_getCSS:function(e,t){return{"-webkit-transition-duration":e/1e3+"s","transition-duration":e/1e3+"s","-webkit-transition-timing-function":"cubic-bezier(.36,1.1,.2, "+t+")","transition-timing-function":"cubic-bezier(.36,1.1,.2, "+t+")"}},_imagesLoaded:function(){var t=this;e.each(this.$content.find("img:not(.loaded)"),function(i,a){var n=setInterval(function(){"0px"!==e(a).css("height")&&(e(a).addClass("loaded"),t.setDialogCenter(),clearInterval(n))},40)})},_setButtons:function(){this.$btnc=this.$el.find(".buttons"),this.confirmButton&&""!==e.trim(this.confirmButton)&&(this.$confirmButton=e('<button type="button" class="btn">'+this.confirmButton+"</button>").appendTo(this.$btnc).addClass(this.confirmButtonClass)),this.cancelButton&&""!==e.trim(this.cancelButton)&&(this.buttonsReverse?this.$cancelButton=e('<button type="button" class="btn">'+this.cancelButton+"</button>").prependTo(this.$btnc).addClass(this.cancelButtonClass):this.$cancelButton=e('<button type="button" class="btn">'+this.cancelButton+"</button>").appendTo(this.$btnc).addClass(this.cancelButtonClass)),this.buttonOther&&""!==e.trim(this.buttonOther)&&e(this.buttonOther).prependTo(this.$btnc),this.confirmButton||this.cancelButton||this.$btnc.hide(),this.confirmButton||this.cancelButton||null!==this.closeIcon||(this.$closeButton=this.$b.find(".closeIcon").show()),!0===this.closeIcon&&(this.$closeButton=this.$b.find(".closeIcon").show())},setTitle:function(e){this.title=void 0!==e?e:this.title,this.$title.html(this.title||"")},setIcon:function(e){this.title="undefined"!=typeof string?e:this.title,this.$icon.html(this.icon?'<i class="'+this.icon+'"></i>':"")},setContent:function(e){this.content=void 0===e?this.content:e,""==this.content?(this.$content.html(this.content),this.$contentPane.hide()):(this.$content.html(this.content),this.$contentPane.show()),this.$content.hasClass("loading")&&(this.$content.removeClass("loading"),this.$btnc.find("button").prop("disabled",!1))},_getContent:function(t){var i=this
;if(t=t||this.content,this._isAjax=!1,this.content)if("string"==typeof this.content)if("url:"===this.content.substr(0,4).toLowerCase()){this._isAjax=!0,this.$content.addClass("loading"),this.$btnc.find("button").prop("disabled",!0);var a=this.content.substring(4,this.content.length);e.get(a).done(function(e){i.content=e,i._contentReady.resolve()}).always(function(e,t,a){"function"==typeof i.contentLoaded&&i.contentLoaded(e,t,a)})}else this.setContent(this.content),this._contentReady.reject();else if("function"==typeof this.content){this.$content.addClass("loading"),this.$btnc.find("button").attr("disabled","disabled");var n=this.content(this);"object"!=typeof n?console.error("The content function must return jquery promise."):"function"!=typeof n.always?console.error("The object returned is not a jquery promise."):(this._isAjax=!0,n.always(function(e,t){i._contentReady.resolve()}))}else console.error("Invalid option for property content, passed: "+typeof this.content);else this.content="",this.setContent(this.content),this._contentReady.reject();this.setDialogCenter()},_stopCountDown:function(){clearInterval(this.timerInterval),this.$cd&&this.$cd.remove()},_startCountDown:function(){var t=this.autoClose.split("|");if(/cancel/.test(t[0])&&"alert"===this.type)return!1;if(/confirm|cancel/.test(t[0])){this.$cd=e('<span class="countdown"></span>').appendTo(this["$"+t[0]+"Button"]);var i=this;i.$cd.parent().click();var a=t[1]/1e3;this.timerInterval=setInterval(function(){i.$cd.html(" ("+(a-=1)+")"),0===a&&(i.$cd.html(""),i.$cd.parent().trigger("click"),clearInterval(i.timerInterval))},1e3)}else console.error("Invalid option "+t[0]+", must be confirm/cancel")},reactOnKey:function(t){var i=e(".jconfirm");if(i.eq(i.length-1)[0]!==this.$el[0])return!1;var a=t.which;if(this.contentDiv.find(":input").is(":focus")&&/13|32/.test(a))return!1;-1!==e.inArray(a,this.cancelKeys)&&(this.$cancelButton?this.$cancelButton.click():this.close()),-1!==e.inArray(a,this.confirmKeys)&&this.$confirmButton&&this.$confirmButton.click()},setDialogCenter:function(){if("none"==this.$contentPane.css("display"))var t=0,i=0;else{var t=this.$content.outerHeight(),i=this.$contentPane.height();0==i&&(i=t)}var a=this.$content.outerWidth();this.$content.css({clip:"rect(0px "+(100+a)+"px "+t+"px -100px)"}),this.$contentPane.css({height:t});var n=e(window).height(),s=this.$b.outerHeight()-i+t,o=(n-s)/2;if(s>n-100){var r={"margin-top":50,"margin-bottom":50};e("body").addClass("jconfirm-noscroll")}else{var r={"margin-top":o};e("body").removeClass("jconfirm-noscroll")}this.$b.css(r)},close:function(){var t=this;if(this.isClosed())return!1;"function"==typeof this.onClose&&this.onClose(),this._unwatchContent(),t._lastFocused.focus(),e(window).unbind("resize."+this._rand),this.keyboardEnabled&&e(window).unbind("keyup."+this._rand),t.$el.find(".jconfirm-bg").removeClass("seen"),e("body").removeClass("jconfirm-noscroll"),this.$b.addClass(this.closeAnimation);var i="anim-none"==this.closeAnimation?0:this.animationSpeed;return setTimeout(function(){t.$el.remove()},25*i/100),jconfirm.record.closed+=1,jconfirm.record.currentlyOpen-=1,!0},open:function(){var e=this;if(this.isClosed())return!1;e.$el.find(".jconfirm-bg").addClass("seen"),this.$b.removeClass(this.animation),this.$b.find("input[autofocus]:visible:first").focus(),jconfirm.record.opened+=1,jconfirm.record.currentlyOpen+=1,"function"==typeof this.onOpen&&this.onOpen();var t="jconfirm-box"+this._rand;return this.$b.attr("aria-labelledby",t).attr("tabindex",-1).focus(),this.$title?this.$title.attr("id",t):this.$content&&this.$content.attr("id",t),setTimeout(function(){e.$b.css({"transition-property":e.$b.css("transition-property")+", margin"}),e._modalReady.resolve()},this.animationSpeed),!0},isClosed:function(){return""===this.$el.css("display")}},jconfirm.pluginDefaults={template:'<div class="jconfirm"><div class="jconfirm-bg"></div><div class="jconfirm-scrollpane"><div class="container"><div class="row"><div class="jconfirm-box-container"><div class="jconfirm-box" role="dialog" aria-labelledby="labelled" tabindex="-1"><div class="closeIcon">&times;</div><div class="title-c"><span class="icon-c"></span><span class="title"></span></div><div class="content-pane"><div class="content"></div></div><div class="buttons"></div><div class="jquery-clear"></div></div></div></div></div></div></div>',title:"提示",content:"确定吗",contentLoaded:function(){},icon:"",opacity:null,confirmButton:"确定",cancelButton:"取消",confirmButtonClass:"btn",cancelButtonClass:"btn btn-slight",buttonsReverse:!1,theme:"white",animation:"scale",closeAnimation:"none",animationSpeed:500,animationBounce:1.2,keyboardEnabled:!1,rtl:!1,confirmKeys:[13],cancelKeys:[27],container:"body",confirm:function(){},cancel:function(){},backgroundDismiss:!0,autoClose:!1,closeIcon:null,closeIconClass:!1,watchInterval:100,columnClass:"pop-container",onOpen:function(){},onClose:function(){},onAction:function(){}},jconfirm.record={opened:0,closed:0,currentlyOpen:0}}(jQuery),function(e){"use strict";var t=function(t,i){var a={};this.option=e.extend({},a,i),this.config=[{type:"revocation",disabled:void 0!=i.revocation&&i.revocation}],this.$body=e(document.body),this.$element=e(t),this.init()};t.prototype.init=function(){var t=this;this.$element.on("contextmenu",function(e){Chat.editorEl.offset().top+20>=t.$element.offset().top+t.$element.height()&&(t.render(),e.preventDefault(),__conversion("dblclick_revocation_panel"))}),e(document).on("click",function(t){e(t.target).parent().hasClass("right-click-panel")||e(t.target).hasClass("right-click-panel")||e(".right-click-panel").remove()}),e(document).off("click.wdblclick").on("click.wdblclick",".right-click-panel li",function(i){e(i.target).hasClass("disabled")||(t.$element.trigger("revocation.right",t.$element),e(".right-click-panel").remove())}),t.render()},t.prototype.destory=function(){},t.prototype.render=function(){var t=this;e(".right-click-panel").remove();var i=this.$element.offset(),a=e('<ul class="right-click-panel"></ul>'),n="",s=function(e){var i="",a="";if("revocation"==e.type){var n=parseInt(t.$element.parents("li").attr("data-time"),10);a=(new Date).getTime()-n<12e4?"":"disabled",i="disabled"==a?"撤回（已超过两分钟）":"撤回"}return{text:i,style:a}};e.each(this.config,function(e,t){var i=s(t);n+='<li class="'+i.style+'">'+i.text+"</li>"});var o=Math.ceil(i.left)+Math.ceil(this.$element.width())-8,r=Math.ceil(i.top)+Math.ceil(this.$element.height())-8;a.html(n).css({top:r,left:o}),this.$body.append(a)};var i=function(i){return this.each(function(){var a=e(this),n=a.data("boss.dblclick");n||a.data("boss.dblclick",n=new t(this,i)),"string"==typeof i&&n[i].call(a)})},a=e.fn.dblclick;e.fn.dblclick=i,e.fn.dblclick.Constructor=t,e.fn.dblclick.noConflict=function(){return e.fn.dblclick=a,this}}(jQuery),jQuery&&function(e){function t(t,n){var s=t?e(this):n,o=e(s.attr("data-jq-dropdown")),r=s.hasClass("jq-dropdown-open");if(t){if(e(t.target).hasClass("jq-dropdown-ignore"))return;t.preventDefault(),t.stopPropagation()}else if(s!==n.target&&e(n.target).hasClass("jq-dropdown-ignore"))return;if(i(),!r&&!s.hasClass("jq-dropdown-disabled")){s.addClass("jq-dropdown-open"),o.data("jq-dropdown-trigger",s).show(),a();var c,l,d=s.find('input[type="text"]'),u=s.find("[name]");d.focus(),o.unbind("click").on("click","[data-jq-value]",function(){l=e(this).attr("data-jq-value"),c=e(this).text(),d.val(c),u.val(l),o.find("[data-jq-value]").removeClass("current"),e(this).addClass("current"),""!=l&&0!=l||d.val("")}),o.trigger("show",{jqDropdown:o,trigger:s})}}function i(t){var i=t?e(t.target).parents().addBack():null;if(i&&i.is(".jq-dropdown")){if(!i.is(".jq-dropdown-menu"))return;if(!i.is("A"))return}e(document).find(".jq-dropdown:visible").each(function(){var t=e(this);t.hide().removeData("jq-dropdown-trigger").trigger("hide",{jqDropdown:t})}),e(document).find(".jq-dropdown-open").removeClass("jq-dropdown-open")}function a(){var t=e(".jq-dropdown:visible").eq(0),i=t.data("jq-dropdown-trigger"),a=i?parseInt(i.attr("data-horizontal-offset")||0,10):null,n=i?parseInt(i.attr("data-vertical-offset")||0,10):null;0!==t.length&&i&&(t.hasClass("jq-dropdown-relative")?t.css({left:t.hasClass("jq-dropdown-anchor-right")?i.position().left-(t.outerWidth(!0)-i.outerWidth(!0))-parseInt(i.css("margin-right"),10)+a:i.position().left+parseInt(i.css("margin-left"),10)+a,top:i.position().top+i.outerHeight(!0)-parseInt(i.css("margin-top"),10)+n}):t.css({left:t.hasClass("jq-dropdown-anchor-right")?i.offset().left-(t.outerWidth()-i.outerWidth())+a:i.offset().left+a,top:i.offset().top+i.outerHeight()+n}))}e.extend(e.fn,{jqDropdown:function(a,n){switch(a){case"show":return t(null,e(this)),e(this);case"hide":return i(),e(this);case"attach":return e(this).attr("data-jq-dropdown",n);case"detach":return i(),e(this).removeAttr("data-jq-dropdown");case"disable":return e(this).addClass("jq-dropdown-disabled");case"enable":return i(),e(this).removeClass("jq-dropdown-disabled")}}}),e(document).on("click.jq-dropdown","[data-jq-dropdown]",t),e(document).on("click.jq-dropdown",i),e(window).on("resize",a)}(jQuery),function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}var i=function(t,i){var s=this;this.element=e(t),this.container=i.container||"body",this.inDate=i.inDate||[],this.language=i.language||this.element.data("date-language")||"en",this.language=this.language in a?this.language:"en",this.isRTL=a[this.language].rtl||!1,this.formatType=i.formatType||this.element.data("format-type")||"standard",this.format=n.parseFormat(i.format||this.element.data("date-format")||a[this.language].format||n.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.bootcssVer=this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2,this.component=!!this.element.is(".date")&&(3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar").parent()),this.componentReset=!!this.element.is(".date")&&(3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-remove").parent():this.element.find(".add-on .icon-remove").parent()),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.linkField=i.linkField||this.element.data("link-field")||!1,this.linkFormat=n.parseFormat(i.linkFormat||this.element.data("link-format")||n.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=i.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=i.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=i.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=i.initialDate||new Date,this.minLimitYear=i.minLimitYear||!1,this._attachEvents(),this.formatViewType="datetime","formatViewType"in i?this.formatViewType=i.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in i?this.minView=i.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=n.convertViewMode(this.minView),this.maxView=n.modes.length-1,"maxView"in i?this.maxView=i.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=n.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in i?this.wheelViewModeNavigation=i.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in i?this.wheelViewModeNavigationInverseDirection=i.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in i?this.wheelViewModeNavigationDelay=i.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in i?this.startViewMode=i.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=n.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in i?this.viewSelect=i.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=n.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in i?this.forceParse=i.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse")),this.picker=e(3==this.bootcssVer?n.templateV3:n.template).appendTo(this.isInline?this.element:this.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(e.fn.mousewheel?this.picker.on({mousewheel:e.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition),this.isRTL&&(this.picker.addClass("datetimepicker-rtl"),3==this.bootcssVer?this.picker.find(".prev span, .next span").toggleClass("glyphicon-arrow-left glyphicon-arrow-right"):this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.minLimitYear&&this.picker.addClass("date-showminyear"),e(document).on("click",function(t){0===e(t.target).closest(".datetimepicker").length&&s.hide()}),this.autoclose=!1,"autoclose"in i?this.autoclose=i.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in i?this.keyboardNavigation=i.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=i.todayBtn||this.element.data("date-today-btn")||!1,this.todayHighlight=i.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=(i.weekStart||this.element.data("date-weekstart")||a[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-1/0,this.endDate=1/0,this.daysOfWeekDisabled=[],this.setStartDate(i.startDate||this.element.data("date-startdate")),this.setEndDate(i.endDate||this.element.data("date-enddate")),this.setDaysOfWeekDisabled(i.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.timer=null,this.isInline&&this.show()};i.prototype={constructor:i,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{click:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{click:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:e.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]];for(var t,i,a=0;a<this._events.length;a++)t=this._events[a][0],i=this._events[a][1],t.on(i)},_detachEvents:function(){for(var e,t,i=0;i<this._events.length;i++)e=this._events[i][0],t=this._events[i][1],e.off(t);this._events=[]},show:function(t){if(this.picker.is(":visible"))return void this.picker.hide();e(".datetimepicker").hide(),e(".dropdown-select-open").removeClass("dropdown-select-open"),e(".dropdown-menu-open").removeClass("dropdown-menu-open"),this.element.closest(".dropdown-select").addClass("dropdown-select-open"),this.element.closest(".dropdown-wrap").addClass("dropdown-menu-open"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(t){this.isVisible&&(this.isInline||(this.element.closest(".dropdown-select").removeClass("dropdown-select-open"),this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){this.format=n.parseFormat(e,this.formatType);var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t):(this.component&&this.element.find("input").val(t),this.element.data("date",t)),this.linkField&&e("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return void 0==e&&(e=this.format),n.formatDate(this.date,e,this.language,this.formatType)},setStartDate:function(e){this.startDate=e||-1/0,this.startDate!==-1/0&&(this.startDate=n.parseDate(this.startDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||1/0,this.endDate!==1/0&&(this.endDate=n.parseDate(this.endDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(t){this.daysOfWeekDisabled=t||[],e.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=e.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=0;e("div").each(function(){var i=parseInt(e(this).css("zIndex"),10);i>t&&(t=i)});var i,a,n,s,o=t+10;s=this.container instanceof e?this.container.offset():e(this.container).offset(),this.component?(i=this.component.offset(),n=i.left,"bottom-left"!=this.pickerPosition&&"top-left"!=this.pickerPosition||(n+=this.component.outerWidth()-this.picker.outerWidth())):(i=this.element.offset(),n=i.left),n+220>document.body.clientWidth&&(n=document.body.clientWidth-220),a="top-left"==this.pickerPosition||"top-right"==this.pickerPosition?i.top-this.picker.outerHeight():i.top+this.height,a-=s.top,n-=s.left,this.picker.css({top:a,left:n,zIndex:o})}},update:function(){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):("string"==typeof(e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate)||e instanceof String)&&(e=e.replace(/^\s+|\s+$/g,"")),e||(e=new Date,t=!1),this.date=n.parseDate(e,this.format,this.language,this.formatType),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+a[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+a[this.language].monthsShort[t++]+"</span>";this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(null!=this.date&&null!=this.viewDate){var i=new Date(this.viewDate),s=i.getUTCFullYear(),o=i.getUTCMonth(),r=i.getUTCDate(),c=i.getUTCHours(),l=i.getUTCMinutes(),d=this.startDate!==-1/0?this.startDate.getUTCFullYear():-1/0,u=this.startDate!==-1/0?this.startDate.getUTCMonth():-1/0,p=this.endDate!==1/0?this.endDate.getUTCFullYear():1/0,h=this.endDate!==1/0?this.endDate.getUTCMonth():1/0,f=new t(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),m=new Date;if(this.picker.find(".datetimepicker-days thead th:eq(1)").text(a[this.language].months[o]+" "+s),"time"==this.formatViewType){var g=c%12?c%12:12,v=(g<10?"0":"")+g,b=(l<10?"0":"")+l,y=a[this.language].meridiem[c<12?0:1];this.picker.find(".datetimepicker-hours thead th:eq(1)").text(v+":"+b+" "+(y?y.toUpperCase():"")),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(v+":"+b+" "+(y?y.toUpperCase():""))}else this.picker.find(".datetimepicker-hours thead th:eq(1)").text(r+" "+a[this.language].months[o]+" "+s),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(r+" "+a[this.language].months[o]+" "+s);this.picker.find("tfoot th.today").html('<div class="today-btn">'+a[this.language].today+"</div>").toggle(!1!==this.todayBtn),this.fillMonths();var w=t(s,o-1,28,0,0,0,0),C=n.getDaysInMonth(w.getUTCFullYear(),w.getUTCMonth());w.setUTCDate(C),w.setUTCDate(C-(w.getUTCDay()-this.weekStart+7)%7);var x=new Date(w);x.setUTCDate(x.getUTCDate()+42),x=x.valueOf();for(var k,T=[],I="";w.valueOf()<x;){var $="";if(w.getUTCDay()==this.weekStart&&T.push("<tr>"),k="",I=w.getUTCDate(),w.getUTCFullYear()<s||w.getUTCFullYear()==s&&w.getUTCMonth()<o?k+=" old":(w.getUTCFullYear()>s||w.getUTCFullYear()==s&&w.getUTCMonth()>o)&&(k+=" new"),this.todayHighlight&&w.getUTCFullYear()==m.getFullYear()&&w.getUTCMonth()==m.getMonth()&&I==m.getDate()&&(k+=" today",I="今日"),w.valueOf()==f&&(k+=" active"),w.valueOf()+864e5<=this.startDate||w.valueOf()>this.endDate||-1!==e.inArray(w.getUTCDay(),this.daysOfWeekDisabled))k+=" disabled";else{var S=""+w.getUTCFullYear()+w.getUTCMonth()+w.getUTCDate();this.inDate.filter(function(e){return""+e.year+e.month+e.day===S}).length&&($='<i class="indate-dot"></i>')}T.push('<td class="day'+k+'"><em>'+w.getUTCDate()+"</em>"+$+"</td>"),w.getUTCDay()==this.weekEnd&&T.push("</tr>"),w.setUTCDate(w.getUTCDate()+1)}this.picker.find(".datetimepicker-days tbody").empty().append(T.join("")),T=[];for(var _="",D="",E="",P=0;P<24;P++){var M=t(s,o,r,P);k="",M.valueOf()+36e5<=this.startDate||M.valueOf()>this.endDate?k+=" disabled":c==P&&(k+=" active"),this.showMeridian&&2==a[this.language].meridiem.length?(D=P<12?a[this.language].meridiem[0]:a[this.language].meridiem[1],D!=E&&(""!=E&&T.push("</fieldset>"),T.push('<fieldset class="hour"><legend>'+D.toUpperCase()+"</legend>")),E=D,_=P%12?P%12:12,T.push('<span class="hour'+k+" hour_"+(P<12?"am":"pm")+'">'+_+"</span>"),23==P&&T.push("</fieldset>")):(_=P+":00",T.push('<span class="hour'+k+'">'+_+"</span>"))}this.picker.find(".datetimepicker-hours td").html(T.join("")),T=[],_="",D="",E="";for(var P=0;P<60;P+=this.minuteStep){var M=t(s,o,r,c,P,0);k="",M.valueOf()<this.startDate||M.valueOf()>this.endDate?k+=" disabled":Math.floor(l/this.minuteStep)==Math.floor(P/this.minuteStep)&&(k+=" active"),this.showMeridian&&2==a[this.language].meridiem.length?(D=c<12?a[this.language].meridiem[0]:a[this.language].meridiem[1],D!=E&&(""!=E&&T.push("</fieldset>"),T.push('<fieldset class="minute"><legend>'+D.toUpperCase()+"</legend>")),E=D,_=c%12?c%12:12,T.push('<span class="minute'+k+'">'+_+":"+(P<10?"0"+P:P)+"</span>"),59==P&&T.push("</fieldset>")):(_=P+":00",T.push('<span class="minute'+k+'">'+c+":"+(P<10?"0"+P:P)+"</span>"))}this.picker.find(".datetimepicker-minutes td").html(T.join(""));var L=this.date.getUTCFullYear(),j=this.picker.find(".datetimepicker-months").find("th:eq(1)").text(s).end().find("span").removeClass("active");L==s&&j.eq(this.date.getUTCMonth()).addClass("active"),(s<d||s>p)&&j.addClass("disabled"),s==d&&j.slice(0,u).addClass("disabled"),s==p&&j.slice(h+1).addClass("disabled"),T="",s=10*parseInt(s/10,10);var U=this.picker.find(".datetimepicker-years").find("th:eq(1)").text(s+"-"+(s+9)).end().find("td");s-=1;for(var P=-1;P<11;P++){var A=s;if(this.minLimitYear&&s<this.minLimitYear)return;this.minLimitYear&&s==this.minLimitYear&&(A=s+1+"以前"),T+='<span class="year'+(-1==P||10==P?" old":"")+(L==s?" active":"")+(s<d||s>p?" disabled":"")+'" data-year="'+s+'">'+A+"</span>",s+=1}U.html(T),this.place(),this.updateNavArrows()}},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth(),a=e.getUTCDate(),n=e.getUTCHours(),s=this.picker.find(".datetimepicker-years").find(".year").last().hasClass("disabled");switch(this.viewMode){case 0:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&a<=this.startDate.getUTCDate()&&n<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&a>=this.endDate.getUTCDate()&&n>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&a<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&a>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):s?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(t){if(t.preventDefault(),t.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var i=t.originalEvent,a=i.wheelDelta,n=a>0?1:0===a?0:-1;this.wheelViewModeNavigationInverseDirection&&(n=-n),this.showMode(n),setTimeout(e.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(i){i.stopPropagation(),i.preventDefault();var a=e(i.target).closest("span, td, th, legend");if(a.is(".glyphicon")&&(a=e(a).parent().closest("span, td, th, legend")),1==a.length){if(a.is(".disabled"))return void this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});switch(a[0].nodeName.toLowerCase()){case"th":switch(a[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.picker.find(".prev").css({visibility:"hidden"}),this.picker.find(".next").css({visibility:"hidden"}),this.throttle(function(){var e=n.modes[this.viewMode].navStep*("prev"==a[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,e);break;case 1:this.viewDate=this.moveDate(this.viewDate,e);break;case 2:this.viewDate=this.moveMonth(this.viewDate,e);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,e)}this.fill(),this.element.trigger({type:a[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate})},300);break;case"today":var s=new Date;s=t(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),0),s<this.startDate?s=this.startDate:s>this.endDate&&(s=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(s),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!a.is(".disabled")){var o=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),c=this.viewDate.getUTCDate(),l=this.viewDate.getUTCHours(),d=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();if(a.is(".month")?(this.viewDate.setUTCDate(1),r=a.parent().find("span").index(a),c=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(r),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(t(o,r,c,l,d,u,0))):a.is(".year")?(this.viewDate.setUTCDate(1),o=parseInt(a.text(),10)||0,a.text().indexOf("以前")>-1&&(o-=1),this.viewDate.setUTCFullYear(o),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(t(o,r,c,l,d,u,0)),this.minLimitYear&&this.minLimitYear==o&&(this.viewMode=this.startViewMode,this.showMode(0),this._setDate(t(o,0,c,l,d,u,0)),this.fill(),this.hide())):a.is(".hour")?(l=parseInt(a.text(),10)||0,(a.hasClass("hour_am")||a.hasClass("hour_pm"))&&(12==l&&a.hasClass("hour_am")?l=0:12!=l&&a.hasClass("hour_pm")&&(l+=12)),this.viewDate.setUTCHours(l),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(t(o,r,c,l,d,u,0))):a.is(".minute")&&(d=parseInt(a.text().substr(a.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(d),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(t(o,r,c,l,d,u,0))),0!=this.viewMode){var p=this.viewMode;this.minLimitYear&&this.minLimitYear==o?this.showMode(0):this.showMode(-1),this.fill(),p==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(a.is(".day")&&!a.is(".disabled")){var c=parseInt(a.text(),10)||1,o=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),l=this.viewDate.getUTCHours(),d=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();a.is(".old")?0===r?(r=11,o-=1):r-=1:a.is(".new")&&(11==r?(r=0,o+=1):r+=1),this.viewDate.setUTCFullYear(o),this.viewDate.setUTCMonth(r,c),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(t(o,r,c,l,d,u,0))}var p=this.viewMode;this.showMode(-1),this.fill(),p==this.viewMode&&this.autoclose&&this.hide()}}},throttle:function(e,t){var i=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.call(i)},t)},_setDate:function(e,t){t&&"date"!=t||(this.date=e),t&&"view"!=t||(this.viewDate=e),this.fill(),this.setValue();var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),this.autoclose),this.element.trigger({type:"changeDate",date:this.date})},moveMinute:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCMinutes(i.getUTCMinutes()+t*this.minuteStep),i},moveHour:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCHours(i.getUTCHours()+t),i},moveDate:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCDate(i.getUTCDate()+t),i},moveMonth:function(e,t){if(!t)return e;var i,a,n=new Date(e.valueOf()),s=n.getUTCDate(),o=n.getUTCMonth(),r=Math.abs(t);if(t=t>0?1:-1,1==r)a=-1==t?function(){return n.getUTCMonth()==o}:function(){
return n.getUTCMonth()!=i},i=o+t,n.setUTCMonth(i),(i<0||i>11)&&(i=(i+12)%12);else{for(var c=0;c<r;c++)n=this.moveMonth(n,t);i=n.getUTCMonth(),n.setUTCDate(s),a=function(){return i!=n.getUTCMonth()}}for(;a();)n.setUTCDate(--s),n.setUTCMonth(i);return n},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27==e.keyCode&&this.show());var t,i,a,n=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;t=37==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),a=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),a=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,t),a=this.moveDate(this.viewDate,t)):1==viewMode?(i=this.moveHour(this.date,t),a=this.moveHour(this.viewDate,t)):0==viewMode&&(i=this.moveMinute(this.date,t),a=this.moveMinute(this.viewDate,t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=a,this.setValue(),this.update(),e.preventDefault(),n=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;t=38==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),a=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),a=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,7*t),a=this.moveDate(this.viewDate,7*t)):1==viewMode?this.showMeridian?(i=this.moveHour(this.date,6*t),a=this.moveHour(this.viewDate,6*t)):(i=this.moveHour(this.date,4*t),a=this.moveHour(this.viewDate,4*t)):0==viewMode&&(i=this.moveMinute(this.date,4*t),a=this.moveMinute(this.viewDate,4*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=a,this.setValue(),this.update(),e.preventDefault(),n=!0);break;case 13:if(0!=this.viewMode){var s=this.viewMode;this.showMode(-1),this.fill(),s==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(n){var o;this.isInput?o=this.element:this.component&&(o=this.element.find("input")),o&&o.change(),this.element.trigger({type:"changeDate",date:this.date})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(n.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+n.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(e){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}},e.fn.datetimepicker=function(t){var a=Array.apply(null,arguments);a.shift();var n;return this.each(function(){var s=e(this),o=s.data("datetimepicker"),r="object"==typeof t&&t;if(o||s.data("datetimepicker",o=new i(this,e.extend({},e.fn.datetimepicker.defaults,r))),"string"==typeof t&&"function"==typeof o[t]&&void 0!==(n=o[t].apply(o,a)))return!1}),void 0!==n?n:this},e.fn.datetimepicker.defaults={},e.fn.datetimepicker.Constructor=i;var a=e.fn.datetimepicker.dates={en:{days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:["周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三","四","五","六","日"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"至今",suffix:[],meridiem:["上午","下午"]}},n={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if("standard"==e)return"input"==t?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"==e)return"input"==t?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if("standard"==e)return/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"==e)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var i=e.replace(this.validParts(t),"\0").split("\0"),a=e.match(this.validParts(t));if(!i||!i.length||!a||0==a.length)throw new Error("Invalid date format.");return{separators:i,parts:a}},parseDate:function(n,s,o,r){if(n instanceof Date){var c=new Date(n.valueOf()-6e4*n.getTimezoneOffset());return c.setMilliseconds(0),c}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(n)&&(s=this.parseFormat("yyyy-mm-dd",r)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(n)&&(s=this.parseFormat("yyyy-mm-dd hh:ii",r)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(n)&&(s=this.parseFormat("yyyy-mm-dd hh:ii:ss",r)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(n)){var l,d,u=/([-+]\d+)([dmwy])/,p=n.match(/([-+]\d+)([dmwy])/g);n=new Date;for(var h=0;h<p.length;h++)switch(l=u.exec(p[h]),d=parseInt(l[1]),l[2]){case"d":n.setUTCDate(n.getUTCDate()+d);break;case"m":n=i.prototype.moveMonth.call(i.prototype,n,d);break;case"w":n.setUTCDate(n.getUTCDate()+7*d);break;case"y":n=i.prototype.moveYear.call(i.prototype,n,d)}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),0)}var f,m,l,p=n&&n.match(this.nonpunctuation)||[],n=new Date(0,0,0,0,0,0,0),g={},v=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P"],b={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(12==t?0:t)},H:function(e,t){return e.setUTCHours(12==t?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(1==t?e.getUTCHours()+12:e.getUTCHours())}};if(b.M=b.MM=b.mm=b.m,b.dd=b.d,b.P=b.p,n=t(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()),p.length==s.parts.length){for(var h=0,y=s.parts.length;h<y;h++){if(f=parseInt(p[h],10),l=s.parts[h],isNaN(f))switch(l){case"MM":m=e(a[o].months).filter(function(){var e=this.slice(0,p[h].length);return e==p[h].slice(0,e.length)}),f=e.inArray(m[0],a[o].months)+1;break;case"M":m=e(a[o].monthsShort).filter(function(){var e=this.slice(0,p[h].length),t=p[h].slice(0,e.length);return e.toLowerCase()==t.toLowerCase()}),f=e.inArray(m[0],a[o].monthsShort)+1;break;case"p":case"P":f=e.inArray(p[h].toLowerCase(),a[o].meridiem)}g[l]=f}for(var w,h=0;h<v.length;h++)(w=v[h])in g&&!isNaN(g[w])&&b[w](n,g[w])}return n},formatDate:function(t,i,s,o){if(null==t)return"";var r;if("standard"==o)r={yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear(),m:t.getUTCMonth()+1,M:a[s].monthsShort[t.getUTCMonth()],MM:a[s].months[t.getUTCMonth()],d:t.getUTCDate(),D:a[s].daysShort[t.getUTCDay()],DD:a[s].days[t.getUTCDay()],p:2==a[s].meridiem.length?a[s].meridiem[t.getUTCHours()<12?0:1]:"",h:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},2==a[s].meridiem.length?r.H=r.h%12==0?12:r.h%12:r.H=r.h,r.HH=(r.H<10?"0":"")+r.H,r.P=r.p.toUpperCase(),r.hh=(r.h<10?"0":"")+r.h,r.ii=(r.i<10?"0":"")+r.i,r.ss=(r.s<10?"0":"")+r.s,r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m;else{if("php"!=o)throw new Error("Invalid format type.");r={y:t.getUTCFullYear().toString().substring(2),Y:t.getUTCFullYear(),F:a[s].months[t.getUTCMonth()],M:a[s].monthsShort[t.getUTCMonth()],n:t.getUTCMonth()+1,t:n.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()),j:t.getUTCDate(),l:a[s].days[t.getUTCDay()],D:a[s].daysShort[t.getUTCDay()],w:t.getUTCDay(),N:0==t.getUTCDay()?7:t.getUTCDay(),S:t.getUTCDate()%10<=a[s].suffix.length?a[s].suffix[t.getUTCDate()%10-1]:"",a:2==a[s].meridiem.length?a[s].meridiem[t.getUTCHours()<12?0:1]:"",g:t.getUTCHours()%12==0?12:t.getUTCHours()%12,G:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},r.m=(r.n<10?"0":"")+r.n,r.d=(r.j<10?"0":"")+r.j,r.A=r.a.toString().toUpperCase(),r.h=(r.g<10?"0":"")+r.g,r.H=(r.G<10?"0":"")+r.G,r.i=(r.i<10?"0":"")+r.i,r.s=(r.s<10?"0":"")+r.s}for(var t=[],c=e.extend([],i.separators),l=0,d=i.parts.length;l<d;l++)c.length&&t.push(c.shift()),t.push(r[i.parts[l]]);return c.length&&t.push(c.shift()),t.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="fz fz-arrow-left"></i></th><th colspan="5" class="switch"></th><th class="next"><i class="fz fz-arrow-right"></i></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="glyphicon glyphicon-arrow-left"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="glyphicon glyphicon-arrow-right"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot class="tfoot"><tr><th colspan="7" class="today"></th></tr></tfoot>'};n.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-hours"><table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-days"><table class="table-condensed">'+n.headTemplate+"<tbody></tbody>"+n.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+"</table></div></div>",n.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+n.headTemplateV3+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+n.headTemplateV3+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+n.headTemplateV3+"<tbody></tbody>"+n.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+n.headTemplateV3+n.contTemplate+n.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+n.headTemplateV3+n.contTemplate+n.footTemplate+"</table></div></div>",e.fn.datetimepicker.DPGlobal=n,e.fn.datetimepicker.noConflict=function(){return e.fn.datetimepicker=old,this},e(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(t){var i=e(this);i.data("datetimepicker")||(t.preventDefault(),i.datetimepicker("show"))}),e(function(){e('[data-provide="datetimepicker-inline"]').datetimepicker()})}(window.jQuery),function(e){e.Jcrop=function(t,i){function a(e){return Math.round(e)+"px"}function n(e){return U.baseClass+"-"+e}function s(){return e.fx.step.hasOwnProperty("backgroundColor")}function o(t){var i=e(t).offset();return[i.left,i.top]}function r(e){return[e.pageX-j[0],e.pageY-j[1]]}function c(t){"object"!=typeof t&&(t={}),U=e.extend(U,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof U[t]&&(U[t]=function(){})})}function l(e,t,i){if(j=o(q),fe.setCursor("move"===e?e:e+"-resize"),"move"===e)return fe.activateHandlers(u(t),g,i);var a=ue.getFixed(),n=p(e),s=ue.getCorner(p(n));ue.setPressed(ue.getCorner(n)),ue.setCurrent(s),fe.activateHandlers(d(e,a),g,i)}function d(e,t){return function(i){if(U.aspectRatio)switch(e){case"e":case"w":i[1]=t.y+1;break;case"n":case"s":i[0]=t.x+1}else switch(e){case"e":case"w":i[1]=t.y2;break;case"n":case"s":i[0]=t.x2}ue.setCurrent(i),he.update()}}function u(e){var t=e;return me.watchKeys(),function(e){ue.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,he.update()}}function p(e){switch(e){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function h(e){return function(t){return!U.disabled&&(!("move"===e&&!U.allowMove)&&(j=o(q),ae=!0,l(e,r(t)),t.stopPropagation(),t.preventDefault(),!1))}}function f(e,t,i){var a=e.width(),n=e.height();a>t&&t>0&&(a=t,n=t/e.width()*e.height()),n>i&&i>0&&(n=i,a=i/e.height()*e.width()),te=e.width()/a,ie=e.height()/n,e.width(a).height(n)}function m(e){return{x:e.x*te,y:e.y*ie,x2:e.x2*te,y2:e.y2*ie,w:e.w*te,h:e.h*ie}}function g(e){var t=ue.getFixed();t.w>U.minSelect[0]&&t.h>U.minSelect[1]?(he.enableHandles(),he.done()):he.release(),fe.setCursor(U.allowSelect?"crosshair":"default")}function v(e){if(U.disabled)return!1;if(!U.allowSelect)return!1;ae=!0,j=o(q),he.disableHandles(),fe.setCursor("crosshair");var t=r(e);return ue.setPressed(t),he.update(),fe.activateHandlers(b,g,"touch"===e.type.substring(0,5)),me.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function b(e){ue.setCurrent(e),he.update()}function y(){var t=e("<div></div>").addClass(n("tracker"));return R&&t.css({opacity:0,backgroundColor:"white"}),t}function w(e){J.removeClass().addClass(n("holder")).addClass(e)}function C(e,t){function i(){window.setTimeout(b,u)}var a=e[0]/te,n=e[1]/ie,s=e[2]/te,o=e[3]/ie;if(!ne){var r=ue.flipCoords(a,n,s,o),c=ue.getFixed(),l=[c.x,c.y,c.x2,c.y2],d=l,u=U.animationDelay,p=r[0]-l[0],h=r[1]-l[1],f=r[2]-l[2],m=r[3]-l[3],g=0,v=U.swingSpeed;a=d[0],n=d[1],s=d[2],o=d[3],he.animMode(!0);var b=function(){return function(){g+=(100-g)/v,d[0]=Math.round(a+g/100*p),d[1]=Math.round(n+g/100*h),d[2]=Math.round(s+g/100*f),d[3]=Math.round(o+g/100*m),g>=99.8&&(g=100),g<100?(k(d),i()):(he.done(),he.animMode(!1),"function"==typeof t&&t.call(ge))}}();i()}}function x(e){k([e[0]/te,e[1]/ie,e[2]/te,e[3]/ie]),U.onSelect.call(ge,m(ue.getFixed())),he.enableHandles()}function k(e){ue.setPressed([e[0],e[1]]),ue.setCurrent([e[2],e[3]]),he.update()}function T(){return m(ue.getFixed())}function I(){return ue.getFixed()}function $(e){c(e),L()}function S(){U.disabled=!0,he.disableHandles(),he.setCursor("default"),fe.setCursor("default")}function _(){U.disabled=!1,L()}function D(){he.done(),fe.activateHandlers(null,null)}function E(){J.remove(),N.show(),N.css("visibility","visible"),e(t).removeData("Jcrop")}function P(e,t){he.release(),S();var i=new Image;i.onload=function(){var a=i.width,n=i.height,s=U.boxWidth,o=U.boxHeight;q.width(a).height(n),q.attr("src",e),H.attr("src",e),f(q,s,o),V=q.width(),G=q.height(),H.width(V).height(G),re.width(V+2*oe).height(G+2*oe),J.width(V).height(G),pe.resize(V,G),_(),"function"==typeof t&&t.call(ge)},i.src=e}function M(e,t,i){var a=t||U.bgColor;U.bgFade&&s()&&U.fadeTime&&!i?e.animate({backgroundColor:a},{queue:!1,duration:U.fadeTime}):e.css("backgroundColor",a)}function L(e){U.allowResize?e?he.enableOnly():he.enableHandles():he.disableHandles(),fe.setCursor(U.allowSelect?"crosshair":"default"),he.setCursor(U.allowMove?"move":"default"),U.hasOwnProperty("trueSize")&&(te=U.trueSize[0]/V,ie=U.trueSize[1]/G),U.hasOwnProperty("setSelect")&&(x(U.setSelect),he.done(),delete U.setSelect),pe.refresh(),U.bgColor!=ce&&(M(U.shade?pe.getShades():J,U.shade?U.shadeColor||U.bgColor:U.bgColor),ce=U.bgColor),le!=U.bgOpacity&&(le=U.bgOpacity,U.shade?pe.refresh():he.setBgOpacity(le)),Q=U.maxSize[0]||0,X=U.maxSize[1]||0,Z=U.minSize[0]||0,ee=U.minSize[1]||0,U.hasOwnProperty("outerImage")&&(q.attr("src",U.outerImage),delete U.outerImage),he.refresh()}var j,U=e.extend({},e.Jcrop.defaults),A=navigator.userAgent.toLowerCase(),R=/msie/.test(A),O=/msie [1-6]\./.test(A);"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof i&&(i={}),c(i);var B={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},N=e(t),F=!0;if("IMG"==t.tagName){if(0!=N[0].width&&0!=N[0].height)N.width(N[0].width),N.height(N[0].height);else{var z=new Image;z.src=N[0].src,N.width(z.width),N.height(z.height)}var q=N.clone().removeAttr("id").css(B).show();q.width(N.width()),q.height(N.height()),N.after(q).hide()}else q=N.css(B).show(),F=!1,null===U.shade&&(U.shade=!0);f(q,U.boxWidth,U.boxHeight);var V=q.width(),G=q.height(),J=e("<div />").width(V).height(G).addClass(n("holder")).css({position:"relative",backgroundColor:U.bgColor}).insertAfter(N).append(q);U.addClass&&J.addClass(U.addClass);var H=e("<div />"),W=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),Y=e("<div />").width("100%").height("100%").css("zIndex",320),K=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=ue.getFixed();U.onDblClick.call(ge,e)}).insertBefore(q).append(W,Y);F&&(H=e("<img />").attr("src",q.attr("src")).css(B).width(V).height(G),W.append(H)),O&&K.css({overflowY:"hidden"});var Q,X,Z,ee,te,ie,ae,ne,se,oe=U.boundary,re=y().width(V+2*oe).height(G+2*oe).css({position:"absolute",top:a(-oe),left:a(-oe),zIndex:290}).mousedown(v),ce=U.bgColor,le=U.bgOpacity;j=o(q);var de=function(){function e(){var e,t={},i=["touchstart","touchmove","touchend"],a=document.createElement("div");try{for(e=0;e<i.length;e++){var n=i[e];n="on"+n;var s=n in a;s||(a.setAttribute(n,"return;"),s="function"==typeof a[n]),t[i[e]]=s}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}return{createDragger:function(e){return function(t){return!U.disabled&&(!("move"===e&&!U.allowMove)&&(j=o(q),ae=!0,l(e,r(de.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1))}},newSelection:function(e){return v(de.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:function(){return!0===U.touchSupport||!1===U.touchSupport?U.touchSupport:e()}()}}(),ue=function(){function e(e){e=o(e),f=p=e[0],m=h=e[1]}function t(e){e=o(e),d=e[0]-f,u=e[1]-m,f=e[0],m=e[1]}function i(){return[d,u]}function a(e){var t=e[0],i=e[1];0>p+t&&(t-=t+p),0>h+i&&(i-=i+h),G<m+i&&(i+=G-(m+i)),V<f+t&&(t+=V-(f+t)),p+=t,f+=t,h+=i,m+=i}function n(e){var t=s();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function s(){if(!U.aspectRatio)return c();var e,t,i,a,n=U.aspectRatio,s=U.minSize[0]/te,o=U.maxSize[0]/te,d=U.maxSize[1]/ie,u=f-p,g=m-h,v=Math.abs(u),b=Math.abs(g),y=v/b;return 0===o&&(o=10*V),0===d&&(d=10*G),y<n?(t=m,i=b*n,e=u<0?p-i:i+p,e<0?(e=0,a=Math.abs((e-p)/n),t=g<0?h-a:a+h):e>V&&(e=V,a=Math.abs((e-p)/n),t=g<0?h-a:a+h)):(e=f,a=v/n,t=g<0?h-a:h+a,t<0?(t=0,i=Math.abs((t-h)*n),e=u<0?p-i:i+p):t>G&&(t=G,i=Math.abs(t-h)*n,e=u<0?p-i:i+p)),e>p?(e-p<s?e=p+s:e-p>o&&(e=p+o),t=t>h?h+(e-p)/n:h-(e-p)/n):e<p&&(p-e<s?e=p-s:p-e>o&&(e=p-o),t=t>h?h+(p-e)/n:h-(p-e)/n),e<0?(p-=e,e=0):e>V&&(p-=e-V,e=V),t<0?(h-=t,t=0):t>G&&(h-=t-G,t=G),l(r(p,h,e,t))}function o(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>V&&(e[0]=V),e[1]>G&&(e[1]=G),[Math.round(e[0]),Math.round(e[1])]}function r(e,t,i,a){var n=e,s=i,o=t,r=a;return i<e&&(n=i,s=e),a<t&&(o=a,r=t),[n,o,s,r]}function c(){var e,t=f-p,i=m-h;return Q&&Math.abs(t)>Q&&(f=t>0?p+Q:p-Q),X&&Math.abs(i)>X&&(m=i>0?h+X:h-X),ee/ie&&Math.abs(i)<ee/ie&&(m=i>0?h+ee/ie:h-ee/ie),Z/te&&Math.abs(t)<Z/te&&(f=t>0?p+Z/te:p-Z/te),p<0&&(f-=p,p-=p),h<0&&(m-=h,h-=h),f<0&&(p-=f,f-=f),m<0&&(h-=m,m-=m),f>V&&(e=f-V,p-=e,f-=e),m>G&&(e=m-G,h-=e,m-=e),p>V&&(e=p-G,m-=e,h-=e),h>G&&(e=h-G,m-=e,h-=e),l(r(p,h,f,m))}function l(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var d,u,p=0,h=0,f=0,m=0;return{flipCoords:r,setPressed:e,setCurrent:t,getOffset:i,moveOffset:a,getCorner:n,getFixed:s}}(),pe=function(){function t(e,t){f.left.css({height:a(t)}),f.right.css({height:a(t)})}function i(){return n(ue.getFixed())}function n(e){f.top.css({left:a(e.x),width:a(e.w),height:a(e.y)}),f.bottom.css({top:a(e.y2),left:a(e.x),width:a(e.w),height:a(G-e.y2)}),f.right.css({left:a(e.x2),width:a(V-e.x2)}),f.left.css({width:a(e.x)})}function s(){return e("<div />").css({position:"absolute",backgroundColor:U.shadeColor||U.bgColor}).appendTo(h)}function o(){p||(p=!0,h.insertBefore(q),i(),he.setBgOpacity(1,0,1),H.hide(),r(U.shadeColor||U.bgColor,1),he.isAwake()?l(U.bgOpacity,1):l(1,1))}function r(e,t){M(u(),e,t)}function c(){p&&(h.remove(),H.show(),p=!1,he.isAwake()?he.setBgOpacity(U.bgOpacity,1,1):(he.setBgOpacity(1,1,1),he.disableHandles()),M(J,0,1))}function l(e,t){p&&(U.bgFade&&!t?h.animate({opacity:1-e},{queue:!1,duration:U.fadeTime}):h.css({opacity:1-e}))}function d(){U.shade?o():c(),he.isAwake()&&l(U.bgOpacity)}function u(){return h.children()}var p=!1,h=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),f={top:s(),left:s().height(G),right:s().height(G),bottom:s()};return{update:i,updateRaw:n,getShades:u,setBgColor:r,enable:o,disable:c,resize:t,refresh:d,opacity:l}}(),he=function(){function t(t){var i=e("<div />").css({position:"absolute",opacity:U.borderOpacity}).addClass(n(t));return W.append(i),i}function i(t,i){var a=e("<div />").mousedown(h(t)).css({cursor:t+"-resize",position:"absolute",zIndex:i}).addClass("ord-"+t);return de.support&&a.bind("touchstart.jcrop",de.createDragger(t)),Y.append(a),a}function s(e){var t=U.handleSize,a=i(e,T++).css({opacity:U.handleOpacity}).addClass(n("handle"));return t&&a.width(t).height(t),a}function o(e){return i(e,T++).addClass("jcrop-dragbar")}function r(e,t){U.shade||H.css({top:a(-t),left:a(-e)}),K.css({top:a(t),left:a(e)})}function c(e,t){K.width(Math.round(e)).height(Math.round(t))}function l(){var e=ue.getFixed();ue.setPressed([e.x,e.y]),ue.setCurrent([e.x2,e.y2]),d()}function d(e){if(k)return u(e)}function u(e){var t=ue.getFixed();c(t.w,t.h),r(t.x,t.y),U.shade&&pe.updateRaw(t),k||f(),e?U.onSelect.call(ge,m(t)):U.onChange.call(ge,m(t))}function p(e,t,i){(k||t)&&(U.bgFade&&!i?q.animate({opacity:e},{queue:!1,duration:U.fadeTime}):q.css("opacity",e))}function f(){K.show(),U.shade?pe.opacity(le):p(le,!0),k=!0}function g(){w(),K.hide(),U.shade?pe.opacity(1):p(1),k=!1,U.onRelease.call(ge)}function v(){_&&Y.show()}function b(){if(_=!0,U.allowResize)return Y.show(),!0}function w(){_=!1,Y.hide()}function C(e){e?(ne=!0,w()):(ne=!1,b())}function x(){C(!1),l()}var k,T=370,I={},$={},S={},_=!1;U.dragEdges&&e.isArray(U.createDragbars)&&function(e){var t;for(t=0;t<e.length;t++)S[e[t]]=o(e[t])}(U.createDragbars),e.isArray(U.createHandles)&&function(e){var t;for(t=0;t<e.length;t++)$[e[t]]=s(e[t])}(U.createHandles),U.drawBorders&&e.isArray(U.createBorders)&&function(e){var i,a;for(a=0;a<e.length;a++){switch(e[a]){case"n":i="hline";break;case"s":i="hline bottom";break;case"e":i="vline right";break;case"w":i="vline"}I[e[a]]=t(i)}}(U.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()});var D=y().mousedown(h("move")).css({cursor:"move",position:"absolute",zIndex:360});return de.support&&D.bind("touchstart.jcrop",de.createDragger("move")),W.append(D),w(),{updateVisible:d,update:u,release:g,refresh:l,isAwake:function(){return k},setCursor:function(e){D.css("cursor",e)},enableHandles:b,enableOnly:function(){_=!0},showHandles:v,disableHandles:w,animMode:C,setBgOpacity:p,done:x}}(),fe=function(){function t(t){re.css({zIndex:450}),t?e(document).bind("touchmove.jcrop",o).bind("touchend.jcrop",c):p&&e(document).bind("mousemove.jcrop",a).bind("mouseup.jcrop",n)}function i(){re.css({zIndex:290}),e(document).unbind(".jcrop")}function a(e){return d(r(e)),!1}function n(e){return e.preventDefault(),e.stopPropagation(),ae&&(ae=!1,u(r(e)),he.isAwake()&&U.onSelect.call(ge,m(ue.getFixed())),i(),d=function(){},u=function(){}),!1}function s(e,i,a){return ae=!0,d=e,u=i,t(a),!1}function o(e){return d(r(de.cfilter(e))),!1}function c(e){return n(de.cfilter(e))}function l(e){re.css("cursor",e)}var d=function(){},u=function(){},p=U.trackDocument;return p||re.mousemove(a).mouseup(n).mouseout(n),q.before(re),{activateHandlers:s,setCursor:l}}(),me=function(){function t(){U.keySupport&&(s.show(),s.focus())}function i(e){s.hide()}function a(e,t,i){U.allowMove&&(ue.moveOffset([t,i]),he.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function n(e){if(e.ctrlKey||e.metaKey)return!0;se=!!e.shiftKey;var t=se?10:1;switch(e.keyCode){case 37:a(e,-t,0);break;case 39:a(e,t,0);break;case 38:a(e,0,-t);break;case 40:a(e,0,t);break;case 27:U.allowSelect&&he.release();break;case 9:return!0}return!1}var s=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),o=e("<div />").css({position:"absolute",overflow:"hidden"}).append(s);return U.keySupport&&(s.keydown(n).blur(i),O||!U.fixedSupport?(s.css({position:"absolute",left:"-20px"}),o.append(s).insertBefore(q)):s.insertBefore(q)),{watchKeys:t}}();de.support&&re.bind("touchstart.jcrop",de.newSelection),Y.hide(),L(!0);var ge={setImage:P,animateTo:C,setSelect:x,setOptions:$,tellSelect:T,tellScaled:I,setClass:w,disable:S,enable:_,cancel:D,release:he.release,destroy:E,focus:me.watchKeys,getBounds:function(){return[V*te,G*ie]},getWidgetSize:function(){return[V,G]},getScaleFactor:function(){return[te,ie]},getOptions:function(){return U},ui:{holder:J,selection:K}};return R&&J.bind("selectstart",function(){return!1}),N.data("Jcrop",ge),ge},e.fn.Jcrop=function(t,i){var a;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),a=e.Jcrop(this,t),e.isFunction(i)&&i.call(a)}):(e(this).css({display:"block",visibility:"hidden"}),a=e.Jcrop(this,t),e.isFunction(i)&&i.call(a))}),this},e.Jcrop.Loader=function(t,i,a){function n(){o.complete?(s.unbind(".jcloader"),e.isFunction(i)&&i.call(o)):window.setTimeout(n,50)}var s=e(t),o=s[0];s.bind("load.jcloader",n).bind("error.jcloader",function(t){s.unbind(".jcloader"),e.isFunction(a)&&a.call(o)}),o.complete&&e.isFunction(i)&&(s.unbind(".jcloader"),i.call(o))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(e){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),function(e){var t=0,i=Array.prototype.slice;e.cleanData=function(t){return function(i){var a,n,s;for(s=0;null!=(n=i[s]);s++)try{(a=e._data(n,"events"))&&a.remove&&e(n).triggerHandler("remove")}catch(e){}t(i)}}(e.cleanData),e.widget=function(t,i,a){var n,s,o,r,c={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,a||(a=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},s=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,s,{version:a.version,_proto:e.extend({},a),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(a,function(t,a){return e.isFunction(a)?void(c[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,s=this._superApply;return this._super=e,this._superApply=n,t=a.apply(this,arguments),this._super=i,this._superApply=s,t}}()):void(c[t]=a)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:s?r.widgetEventPrefix||t:t},c,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),s?(e.each(s._childConstructors,function(t,i){var a=i.prototype;e.widget(a.namespace+"."+a.widgetName,o,i._proto)}),delete s._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var a,n,s=i.call(arguments,1),o=0,r=s.length;r>o;o++)for(a in s[o])n=s[o][a],s[o].hasOwnProperty(a)&&void 0!==n&&(t[a]=e.isPlainObject(n)?e.isPlainObject(t[a])?e.widget.extend({},t[a],n):e.widget.extend({},n):n);return t},e.widget.bridge=function(t,a){var n=a.prototype.widgetFullName||t;e.fn[t]=function(s){var o="string"==typeof s,r=i.call(arguments,1),c=this;return o?this.each(function(){var i,a=e.data(this,n);return"instance"===s?(c=a,!1):a?e.isFunction(a[s])&&"_"!==s.charAt(0)?(i=a[s].apply(a,r),i!==a&&void 0!==i?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+s+"'")}):(r.length&&(s=e.widget.extend.apply(null,[s].concat(r))),this.each(function(){var t=e.data(this,n);t?(t.option(s||{}),t._init&&t._init()):e.data(this,n,new a(s,this))})),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,a){a=e(a||this.defaultElement||this)[0],this.element=e(a),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),a!==this&&(e.data(a,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===a&&this.destroy()}}),this.document=e(a.style?a.ownerDocument:a.document||a),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var a,n,s,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},a=t.split("."),t=a.shift(),a.length){for(n=o[t]=e.widget.extend({},this.options[t]),s=0;s<a.length-1;s++)n[a[s]]=n[a[s]]||{},n=n[a[s]];if(t=a.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,a){var n,s=this;"boolean"!=typeof t&&(a=i,i=t,t=!1),a?(i=n=e(i),this.bindings=this.bindings.add(i)):(a=i,i=this.element,n=this.widget()),e.each(a,function(a,o){function r(){return t||!0!==s.options.disabled&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}
"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var c=a.match(/^([\w:-]*)\s*(.*)$/),l=c[1]+s.eventNamespace,d=c[2];d?n.delegate(d,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?a[e]:e).apply(a,arguments)}var a=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,a){var n,s,o=this.options[t];if(a=a||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(n in s)n in i||(i[n]=s[n]);return this.element.trigger(i,a),!(e.isFunction(o)&&!1===o.apply(this.element[0],[i].concat(a))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(a,n,s){"string"==typeof n&&(n={effect:n});var o,r=n?!0===n||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=s,n.delay&&a.delay(n.delay),o&&e.effects&&e.effects.effect[r]?a[t](n):r!==t&&a[r]?a[r](n.duration,n.easing,s):a.queue(function(i){e(this)[t](),s&&s.call(a[0]),i()})}}),e.widget}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):window.jQuery)}(function(e){"use strict";var t=0,i=e,a="parseJSON";"JSON"in window&&"parse"in JSON&&(i=JSON,a="parse"),e.ajaxTransport("iframe",function(i){if(i.async){var a,n,s,o=i.initialIframeSrc||"javascript:false;";return{send:function(r,c){a=e('<form style="display:none;"></form>'),a.attr("accept-charset",i.formAcceptCharset),s=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+s+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+s+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+s+"_method=PATCH",i.type="POST"),t+=1,n=e('<iframe src="'+o+'" name="iframe-transport-'+t+'"></iframe>').bind("load",function(){var t,s=e.isArray(i.paramName)?i.paramName:[i.paramName];n.unbind("load").bind("load",function(){var t;try{if(t=n.contents(),!t.length||!t[0].firstChild)throw new Error}catch(e){t=void 0}c(200,"success",{iframe:t}),e('<iframe src="'+o+'"></iframe>').appendTo(a),window.setTimeout(function(){a.remove()},0)}),a.prop("target",n.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&e.each(i.formData,function(t,i){e('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(a)}),i.fileInput&&i.fileInput.length&&"POST"===i.type&&(t=i.fileInput.clone(),i.fileInput.after(function(e){return t[e]}),i.paramName&&i.fileInput.each(function(t){e(this).prop("name",s[t]||i.paramName)}),a.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),i.fileInput.removeAttr("form")),a.submit(),t&&t.length&&i.fileInput.each(function(i,a){var n=e(t[i]);e(a).prop("name",n.prop("name")).attr("form",n.attr("form")),n.replaceWith(a)})}),a.append(n).appendTo(document.body)},abort:function(){n&&n.unbind("load").prop("src",o),a&&a.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&i[a](e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var i=t&&t[0];return i&&e.isXMLDoc(i)?i:e.parseXML(i.XMLDocument&&i.XMLDocument.xml||e(i.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],e):"object"==typeof exports?e(require("jquery"),require("./vendor/jquery.ui.widget")):e(window.jQuery)}(function(e){"use strict";function t(t){var i="dragover"===t;return function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var n=a.dataTransfer;n&&-1!==e.inArray("Files",n.types)&&!1!==this._trigger(t,e.Event(t,{delegatedEvent:a}))&&(a.preventDefault(),i&&(n.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file"/>').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){if(t.isDefaultPrevented())return!1;(i.autoUpload||!1!==i.autoUpload&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var a=e-this.timestamp;return(!this.bitrate||!i||a>i)&&(this.bitrate=(t-this.loaded)*(1e3/a)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var a,n=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&n-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=n,a=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=a-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=a,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(n,a,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,a=t.xhr?t.xhr():e.ajaxSettings.xhr();a.upload&&(e(a.upload).bind("progress",function(e){var a=e.originalEvent;e.lengthComputable=a.lengthComputable,e.loaded=a.loaded,e.total=a.total,i._onProgress(e,t)}),t.xhr=function(){return a})},_deinitProgressListener:function(t){var i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&e(i.upload).unbind("progress")},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,a=this,n=t.files[0],s=t.multipart||!e.support.xhrFileUpload,o="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),s&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.uploadName||n.name)+'"'),s?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:o,value:t.blob}):e.each(t.files,function(a,n){i.push({name:"array"===e.type(t.paramName)&&t.paramName[a]||o,value:n})})):(a._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(o,t.blob,n.uploadName||n.name):e.each(t.files,function(n,s){(a._isInstanceOf("File",s)||a._isInstanceOf("Blob",s))&&i.append("array"===e.type(t.paramName)&&t.paramName[n]||o,s,s.uploadName||s.name)})),t.data=i):(t.contentType=n.type||"application/octet-stream",t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),a=t.paramName;return a?e.isArray(a)||(a=[a]):(a=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)a.push(i),n-=1}),a.length||(a=[i.prop("name")||"files[]"])),a},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,a){var n=e.Deferred(),s=n.promise();return i=i||this.options.context||s,!0===t?n.resolveWith(i,a):!1===t&&n.rejectWith(i,a),s.abort=n.promise,this._enhancePromise(s)},_addConvenienceMethods:function(t,i){var a=this,n=function(t){return e.Deferred().resolveWith(a,t).promise()};i.process=function(t,s){return(t||s)&&(i._processQueue=this._processQueue=(this._processQueue||n([this])).then(function(){return i.errorThrown?e.Deferred().rejectWith(a,[i]).promise():n(arguments)}).then(t,s)),this._processQueue||n([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==a._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)&&a._onSend(t,this)),this.jqXHR||a._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",a._trigger("fail",null,this),a._getXHRPromise(!1))},i.state=function(){return this.jqXHR?a._getDeferredState(this.jqXHR):this._processQueue?a._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===a._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),a=i&&i.length>1&&parseInt(i[1],10);return a&&a+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var a,n,s=this,o=t.files[0],r=o.size,c=t.uploadedBytes,l=t.maxChunkSize||r,d=this._blobSlice,u=e.Deferred(),p=u.promise();return!(!(this._isXHRUpload(t)&&d&&(c||("function"===e.type(l)?l(t):l)<r))||t.data)&&(!!i||(c>=r?(o.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",o.error])):(n=function(){var i=e.extend({},t),p=i._progress.loaded;i.blob=d.call(o,c,c+("function"===e.type(l)?l(i):l),o.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+c+"-"+(c+i.chunkSize-1)+"/"+r,s._trigger("chunkbeforesend",null,i),s._initXHRData(i),s._initProgressListener(i),a=(!1!==s._trigger("chunksend",null,i)&&e.ajax(i)||s._getXHRPromise(!1,i.context)).done(function(a,o,l){c=s._getUploadedBytes(l)||c+i.chunkSize,p+i.chunkSize-i._progress.loaded&&s._onProgress(e.Event("progress",{lengthComputable:!0,loaded:c-i.uploadedBytes,total:c-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=c,i.result=a,i.textStatus=o,i.jqXHR=l,s._trigger("chunkdone",null,i),s._trigger("chunkalways",null,i),c<r?n():u.resolveWith(i.context,[a,o,l])}).fail(function(e,t,a){i.jqXHR=e,i.textStatus=t,i.errorThrown=a,s._trigger("chunkfail",null,i),s._trigger("chunkalways",null,i),u.rejectWith(i.context,[e,t,a])}).always(function(){s._deinitProgressListener(i)})},this._enhancePromise(p),p.abort=function(){return a.abort()},n(),p)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,a,n){var s=n._progress.total,o=n._response;n._progress.loaded<s&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),n),o.result=n.result=t,o.textStatus=n.textStatus=i,o.jqXHR=n.jqXHR=a,this._trigger("done",null,n)},_onFail:function(e,t,i,a){var n=a._response;a.recalculateProgress&&(this._progress.loaded-=a._progress.loaded,this._progress.total-=a._progress.total),n.jqXHR=a.jqXHR=e,n.textStatus=a.textStatus=t,n.errorThrown=a.errorThrown=i,this._trigger("fail",null,a)},_onAlways:function(e,t,i,a){this._trigger("always",null,a)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var a,n,s,o,r=this,c=r._getAJAXSettings(i),l=function(){return r._sending+=1,c._bitrateTimer=new r._BitrateTimer,a=a||((n||!1===r._trigger("send",e.Event("send",{delegatedEvent:t}),c))&&r._getXHRPromise(!1,c.context,n)||r._chunkedUpload(c)||e.ajax(c)).done(function(e,t,i){r._onDone(e,t,i,c)}).fail(function(e,t,i){r._onFail(e,t,i,c)}).always(function(e,t,i){if(r._deinitProgressListener(c),r._onAlways(e,t,i,c),r._sending-=1,r._active-=1,c.limitConcurrentUploads&&c.limitConcurrentUploads>r._sending)for(var a=r._slots.shift();a;){if("pending"===r._getDeferredState(a)){a.resolve();break}a=r._slots.shift()}0===r._active&&r._trigger("stop")})};return this._beforeSend(t,c),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(s=e.Deferred(),this._slots.push(s),o=s.then(l)):(this._sequence=this._sequence.then(l,l),o=this._sequence),o.abort=function(){return n=[void 0,"abort","abort"],a?a.abort():(s&&s.rejectWith(c.context,n),l())},this._enhancePromise(o)):l()},_onAdd:function(t,i){var a,n,s,o,r=this,c=!0,l=e.extend({},this.options,i),d=i.files,u=d.length,p=l.limitMultiFileUploads,h=l.limitMultiFileUploadSize,f=l.limitMultiFileUploadSizeOverhead,m=0,g=this._getParamName(l),v=0;if(!u)return!1;if(h&&void 0===d[0].size&&(h=void 0),(l.singleFileUploads||p||h)&&this._isXHRUpload(l))if(l.singleFileUploads||h||!p)if(!l.singleFileUploads&&h)for(s=[],a=[],o=0;o<u;o+=1)m+=d[o].size+f,(o+1===u||m+d[o+1].size+f>h||p&&o+1-v>=p)&&(s.push(d.slice(v,o+1)),n=g.slice(v,o+1),n.length||(n=g),a.push(n),v=o+1,m=0);else a=g;else for(s=[],a=[],o=0;o<u;o+=p)s.push(d.slice(o,o+p)),n=g.slice(o,o+p),n.length||(n=g),a.push(n);else s=[d],a=[g];return i.originalFiles=d,e.each(s||d,function(n,o){var l=e.extend({},i);return l.files=s?o:[o],l.paramName=a[n],r._initResponseObject(l),r._initProgressObject(l),r._addConvenienceMethods(t,l),c=r._trigger("add",e.Event("add",{delegatedEvent:t}),l)}),c},_replaceFileInput:function(t){var i=t.fileInput,a=i.clone(!0),n=i.is(document.activeElement);t.fileInputClone=a,e("<form></form>").append(a)[0].reset(),i.after(a).detach(),n&&a.focus(),e.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===i[0]?a[0]:t}),i[0]===this.element[0]&&(this.element=a)},_handleFileTreeEntry:function(t,i){var a,n=this,s=e.Deferred(),o=[],r=function(e){e&&!e.entry&&(e.entry=t),s.resolve([e])},c=function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){s.resolve(e)}).fail(r)},l=function(){a.readEntries(function(e){e.length?(o=o.concat(e),l()):c(o)},r)};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,s.resolve(t._file)):t.file(function(e){e.relativePath=i,s.resolve(e)},r):t.isDirectory?(a=t.createReader(),l()):s.resolve([]),s.promise()},_handleFileTreeEntries:function(t,i){var a=this;return e.when.apply(e,e.map(t,function(e){return a._handleFileTreeEntry(e,i)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,a;t.prop("webkitEntries")||t.prop("entries");if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(a=t.prop("value")))return e.Deferred().resolve([]).promise();i=[{name:a.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,a={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(a.fileInput).always(function(n){a.files=n,i.options.replaceFileInput&&i._replaceFileInput(a),!1!==i._trigger("change",e.Event("change",{delegatedEvent:t}),a)&&i._onAdd(t,a)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,a={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&a.files.push(i)}),!1!==this._trigger("paste",e.Event("paste",{delegatedEvent:t}),a)&&this._onAdd(t,a))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,a=t.dataTransfer,n={};a&&a.files&&a.files.length&&(t.preventDefault(),this._getDroppedFiles(a).always(function(a){n.files=a,!1!==i._trigger("drop",e.Event("drop",{delegatedEvent:t}),n)&&i._onAdd(t,n)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(t,i){var a=-1!==e.inArray(t,this._specialOptions);a&&this._destroyEventHandlers(),this._super(t,i),a&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,a=this.element.data();e.each(this.element[0].attributes,function(e,n){var s,o=n.name.toLowerCase();/^data-/.test(o)&&(o=o.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),s=a[o],t._isRegExpOption(o,s)&&(s=t._getRegExp(s)),i[o]=s)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,a,n=this,s=e.Deferred(),o=s.promise();return o.abort=function(){return a=!0,i?i.abort():(s.reject(null,"abort","abort"),o)},this._getFileInputFiles(t.fileInput).always(function(e){if(!a){if(!e.length)return void s.reject();t.files=e,i=n._onSend(null,t),i.then(function(e,t,i){s.resolve(e,t,i)},function(e,t,i){s.reject(e,t,i)})}}),this._enhancePromise(o)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery)}(this,function(e){"use strict";function t(t){if(n.webkit&&!t)return{height:0,width:0};if(!n.data.outer){var i={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"};n.data.inner=e("<div>").css(e.extend({},i)),n.data.outer=e("<div>").css(e.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},i)).append(n.data.inner).appendTo("body")}return n.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(n.data.outer.offset().top-n.data.inner.offset().top||0),width:Math.ceil(n.data.outer.offset().left-n.data.inner.offset().left||0)}}function i(){var e=t(!0);return!(e.height||e.width)}function a(e){var t=e.originalEvent;return(!t.axis||t.axis!==t.HORIZONTAL_AXIS)&&!t.wheelDeltaX}var n={data:{index:0,name:"scrollbar"},macosx:/mac/i.test(navigator.platform),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)};n.scrolls.add=function(e){this.remove(e).push(e)},n.scrolls.remove=function(t){for(;e.inArray(t,this)>=0;)this.splice(e.inArray(t,this),1);return this};var s={autoScrollSize:!0,autoUpdate:!0,debug:!1,disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onInit:null,onScroll:null,onUpdate:null},o=function(a){n.scroll||(n.overlay=i(),n.scroll=t(),c(),e(window).resize(function(){var e=!1;if(n.scroll&&(n.scroll.height||n.scroll.width)){var i=t();i.height===n.scroll.height&&i.width===n.scroll.width||(n.scroll=i,e=!0)}c(e)})),this.container=a,this.namespace=".scrollbar_"+n.data.index++,this.options=e.extend({},s,window.jQueryScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},a.data(n.data.name,this),n.scrolls.add(this)};o.prototype={destroy:function(){if(this.wrapper){this.container.removeData(n.data.name),n.scrolls.remove(this);var t=this.container.scrollLeft(),i=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(t).scrollTop(i),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").andSelf().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").andSelf().off(this.namespace),this.wrapper.remove(),e(document).add("body").off(this.namespace),e.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container])}},init:function(t){var i=this,s=this.container,o=this.containerWrapper||s,r=this.namespace,c=e.extend(this.options,t||{}),l={x:this.scrollx,y:this.scrolly},d=this.wrapper,u={scrollLeft:s.scrollLeft(),scrollTop:s.scrollTop()};if(n.mobile&&c.ignoreMobile||n.overlay&&c.ignoreOverlay||n.macosx&&!n.webkit)return!1;if(d)o.css({height:"auto","margin-bottom":-1*n.scroll.height+"px","margin-right":-1*n.scroll.width+"px","max-height":""});else{if(this.wrapper=d=e("<div>").addClass("scroll-wrapper").addClass(s.attr("class")).css("position","absolute"==s.css("position")?"absolute":"relative").insertBefore(s).append(s),s.is("textarea")&&(this.containerWrapper=o=e("<div>").insertBefore(s).append(s),d.addClass("scroll-textarea")),o.addClass("scroll-content").css({height:"auto","margin-bottom":-1*n.scroll.height+"px","margin-right":-1*n.scroll.width+"px","max-height":""}),s.on("scroll"+r,function(t){e.isFunction(c.onScroll)&&c.onScroll.call(i,{maxScroll:l.y.maxScrollOffset,scroll:s.scrollTop(),size:l.y.size,visible:l.y.visible},{maxScroll:l.x.maxScrollOffset,scroll:s.scrollLeft(),size:l.x.size,visible:l.x.visible}),l.x.isVisible&&l.x.scroll.bar.css("left",s.scrollLeft()*l.x.kx+"px"),l.y.isVisible&&l.y.scroll.bar.css("top",s.scrollTop()*l.y.kx+"px")}),d.on("scroll"+r,function(){d.scrollTop(0).scrollLeft(0)}),c.disableBodyScroll){var p=function(e){a(e)?l.y.isVisible&&l.y.mousewheel(e):l.x.isVisible&&l.x.mousewheel(e)};d.on("MozMousePixelScroll"+r,p),d.on("mousewheel"+r,p),n.mobile&&d.on("touchstart"+r,function(t){var i=t.originalEvent.touches&&t.originalEvent.touches[0]||t,a={pageX:i.pageX,pageY:i.pageY},n={left:s.scrollLeft(),top:s.scrollTop()};e(document).on("touchmove"+r,function(e){var t=e.originalEvent.targetTouches&&e.originalEvent.targetTouches[0]||e;s.scrollLeft(n.left+a.pageX-t.pageX),s.scrollTop(n.top+a.pageY-t.pageY),e.preventDefault()}),e(document).on("touchend"+r,function(){e(document).off(r)})})}e.isFunction(c.onInit)&&c.onInit.apply(this,[s])}e.each(l,function(t,n){var o=null,d=1,u="x"===t?"scrollLeft":"scrollTop",p=c.scrollStep,h=function(){var e=s[u]();s[u](e+p),1==d&&e+p>=f&&(e=s[u]()),-1==d&&e+p<=f&&(e=s[u]()),s[u]()==e&&o&&o()},f=0;n.scroll||(n.scroll=i._getScroll(c["scroll"+t]).addClass("scroll-"+t),c.showArrows&&n.scroll.addClass("scroll-element_arrows_visible"),n.mousewheel=function(e){if(!n.isVisible||"x"===t&&a(e))return!0;if("y"===t&&!a(e))return l.x.mousewheel(e),!0;var o=-1*e.originalEvent.wheelDelta||e.originalEvent.detail,r=n.size-n.visible-n.offset;return(o>0&&f<r||o<0&&f>0)&&(f+=o,f<0&&(f=0),f>r&&(f=r),i.scrollTo=i.scrollTo||{},i.scrollTo[u]=f,setTimeout(function(){i.scrollTo&&(s.stop().animate(i.scrollTo,240,"linear",function(){f=s[u]()}),i.scrollTo=null)},1)),e.preventDefault(),!1},n.scroll.on("MozMousePixelScroll"+r,n.mousewheel).on("mousewheel"+r,n.mousewheel).on("mouseenter"+r,function(){f=s[u]()}),n.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+r,function(a){if(1!=a.which)return!0;d=1;var r={eventOffset:a["x"===t?"pageX":"pageY"],maxScrollValue:n.size-n.visible-n.offset,scrollbarOffset:n.scroll.bar.offset()["x"===t?"left":"top"],scrollbarSize:n.scroll.bar["x"===t?"outerWidth":"outerHeight"]()},l=0,m=0;return e(this).hasClass("scroll-arrow")?(d=e(this).hasClass("scroll-arrow_more")?1:-1,p=c.scrollStep*d,f=d>0?r.maxScrollValue:0):(d=r.eventOffset>r.scrollbarOffset+r.scrollbarSize?1:r.eventOffset<r.scrollbarOffset?-1:0,p=Math.round(.75*n.visible)*d,f=r.eventOffset-r.scrollbarOffset-(c.stepScrolling?1==d?r.scrollbarSize:0:Math.round(r.scrollbarSize/2)),f=s[u]()+f/n.kx),i.scrollTo=i.scrollTo||{},i.scrollTo[u]=c.stepScrolling?s[u]()+p:f,c.stepScrolling&&(o=function(){f=s[u](),clearInterval(m),clearTimeout(l),l=0,m=0},l=setTimeout(function(){m=setInterval(h,40)},c.duration+100)),setTimeout(function(){i.scrollTo&&(s.animate(i.scrollTo,c.duration),i.scrollTo=null)},1),i._handleMouseDown(o,a)}),n.scroll.bar.on("mousedown"+r,function(a){if(1!=a.which)return!0;var o=a["x"===t?"pageX":"pageY"],c=s[u]();return n.scroll.addClass("scroll-draggable"),e(document).on("mousemove"+r,function(e){var i=parseInt((e["x"===t?"pageX":"pageY"]-o)/n.kx,10);s[u](c+i)}),i._handleMouseDown(function(){n.scroll.removeClass("scroll-draggable"),f=s[u]()},a)}))}),e.each(l,function(e,t){var i="scroll-scroll"+e+"_visible",a="x"==e?l.y:l.x;t.scroll.removeClass(i),a.scroll.removeClass(i),o.removeClass(i)}),e.each(l,function(t,i){e.extend(i,"x"==t?{offset:parseInt(s.css("left"),10)||0,size:s.prop("scrollWidth"),visible:d.width()}:{offset:parseInt(s.css("top"),10)||0,size:s.prop("scrollHeight"),visible:d.height()})}),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),e.isFunction(c.onUpdate)&&c.onUpdate.apply(this,[s]),e.each(l,function(e,t){var i="x"===e?"left":"top",a="x"===e?"outerWidth":"outerHeight",n="x"===e?"width":"height",o=parseInt(s.css(i),10)||0,r=t.size,l=t.visible+o,d=t.scroll.size[a]()+(parseInt(t.scroll.size.css(i),10)||0);c.autoScrollSize&&(t.scrollbarSize=parseInt(d*l/r,10),t.scroll.bar.css(n,t.scrollbarSize+"px")),t.scrollbarSize=t.scroll.bar[a](),t.kx=(d-t.scrollbarSize)/(r-l)||1,t.maxScrollOffset=r-l}),s.scrollLeft(u.scrollLeft).scrollTop(u.scrollTop).trigger("scroll")},_getScroll:function(t){var i={advanced:['<div class="scroll-element">','<div class="scroll-element_corner"></div>','<div class="scroll-arrow scroll-arrow_less"></div>','<div class="scroll-arrow scroll-arrow_more"></div>','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_inner-wrapper">','<div class="scroll-element_inner scroll-element_track">','<div class="scroll-element_inner-bottom"></div>',"</div>","</div>",'<div class="scroll-bar">','<div class="scroll-bar_body">','<div class="scroll-bar_body-inner"></div>',"</div>",'<div class="scroll-bar_bottom"></div>','<div class="scroll-bar_center"></div>',"</div>","</div>","</div>"].join(""),simple:['<div class="scroll-element">','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_track"></div>','<div class="scroll-bar"></div>',"</div>","</div>"].join("")};return i[t]&&(t=i[t]),t||(t=i.simple),t="string"==typeof t?e(t).appendTo(this.wrapper):e(t),e.extend(t,{bar:t.find(".scroll-bar"),size:t.find(".scroll-element_size"),track:t.find(".scroll-element_track")}),t},_handleMouseDown:function(t,i){var a=this.namespace;return e(document).on("blur"+a,function(){e(document).add("body").off(a),t&&t()}),e(document).on("dragstart"+a,function(e){return e.preventDefault(),!1}),e(document).on("mouseup"+a,function(){e(document).add("body").off(a),t&&t()}),e("body").on("selectstart"+a,function(e){return e.preventDefault(),!1}),i&&i.preventDefault(),!1},_updateScroll:function(t,i){
var a=this.container,s=this.containerWrapper||a,o="scroll-scroll"+t+"_visible",r="x"===t?this.scrolly:this.scrollx,c=parseInt(this.container.css("x"===t?"left":"top"),10)||0,l=this.wrapper,d=i.size,u=i.visible+c;i.isVisible=d-u>1,i.isVisible?(i.scroll.addClass(o),r.scroll.addClass(o),s.addClass(o)):(i.scroll.removeClass(o),r.scroll.removeClass(o),s.removeClass(o)),"y"===t&&(a.is("textarea")||d<u?s.css({height:u+n.scroll.height+"px","max-height":"none"}):s.css({"max-height":u+n.scroll.height+"px"})),i.size==a.prop("scrollWidth")&&r.size==a.prop("scrollHeight")&&i.visible==l.width()&&r.visible==l.height()&&i.offset==(parseInt(a.css("left"),10)||0)&&r.offset==(parseInt(a.css("top"),10)||0)||(e.extend(this.scrollx,{offset:parseInt(a.css("left"),10)||0,size:a.prop("scrollWidth"),visible:l.width()}),e.extend(this.scrolly,{offset:parseInt(a.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:l.height()}),this._updateScroll("x"===t?"y":"x",r))}};var r=o;e.fn.scrollbar=function(t,i){return"string"!=typeof t&&(i=t,t="init"),void 0===i&&(i=[]),e.isArray(i)||(i=[i]),this.not("body, .scroll-wrapper").each(function(){var a=e(this),s=a.data(n.data.name);(s||"init"===t)&&(s||(s=new r(a)),s[t]&&s[t].apply(s,i))}),this},e.fn.scrollbar.options=s;var c=function(){var e=0,t=0;return function(i){var a,s,o,r,l,d,u;for(a=0;a<n.scrolls.length;a++)r=n.scrolls[a],s=r.container,o=r.options,l=r.wrapper,d=r.scrollx,u=r.scrolly,(i||o.autoUpdate&&l&&l.is(":visible")&&(s.prop("scrollWidth")!=d.size||s.prop("scrollHeight")!=u.size||l.width()!=d.visible||l.height()!=u.visible))&&(r.init(),o.debug&&(window.console&&console.log({scrollHeight:s.prop("scrollHeight")+":"+r.scrolly.size,scrollWidth:s.prop("scrollWidth")+":"+r.scrollx.size,visibleHeight:l.height()+":"+r.scrolly.visible,visibleWidth:l.width()+":"+r.scrollx.visible},!0),t++));clearTimeout(e),e=setTimeout(c,300)}}();window.angular&&function(e){e.module("jQueryScrollbar",[]).provider("jQueryScrollbar",function(){var t=s;return{setOptions:function(i){e.extend(t,i)},$get:function(){return{options:e.copy(t)}}}}).directive("jqueryScrollbar",["jQueryScrollbar","$parse",function(e,t){return{restrict:"AC",link:function(i,a,n){var s=t(n.jqueryScrollbar),o=s(i);a.scrollbar(o||e.options).on("$destroy",function(){a.scrollbar("destroy")})}}}])}(window.angular)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t="dmUploader",i={PENDING:0,UPLOADING:1,COMPLETED:2,FAILED:3,CANCELLED:4},a={auto:!0,queue:!0,dnd:!0,hookDocument:!0,multiple:!0,url:document.URL,method:"POST",extraData:{},headers:{},dataType:null,fieldName:"file",maxFileSize:0,allowedTypes:"*",extFilter:null,onInit:function(){},onComplete:function(){},onFallbackMode:function(){},onNewFile:function(){},onBeforeUpload:function(){},onUploadProgress:function(){},onUploadSuccess:function(){},onUploadCanceled:function(){},onUploadError:function(){},onUploadComplete:function(){},onFileTypeError:function(){},onFileSizeError:function(){},onFileExtError:function(){},onDragEnter:function(){},onDragLeave:function(){},onDocumentDragEnter:function(){},onDocumentDragLeave:function(){}},n=function(e,t){this.data=e,this.widget=t,this.jqXHR=null,this.status=i.PENDING,this.id=Math.random().toString(36).substr(2)};n.prototype.upload=function(){var t=this;if(!t.canUpload())return t.widget.queueRunning&&t.status!==i.UPLOADING&&t.widget.processQueue(),!1;var a=new FormData;a.append(t.widget.settings.fieldName,t.data);var n=t.widget.settings.extraData;return"function"==typeof n&&(n=n.call(t.widget.element,t.id)),e.each(n,function(e,t){a.append(e,t)}),t.status=i.UPLOADING,t.widget.activeFiles++,t.widget.settings.onBeforeUpload.call(t.widget.element,t.id),t.jqXHR=e.ajax({url:t.widget.settings.url,type:t.widget.settings.method,dataType:t.widget.settings.dataType,data:a,headers:t.widget.settings.headers,cache:!1,contentType:!1,processData:!1,forceSync:!1,xhr:function(){return t.getXhr()},success:function(e){t.onSuccess(e)},error:function(e,i,a){t.onError(e,i,a)},complete:function(){t.onComplete()}}),!0},n.prototype.onSuccess=function(e){this.status=i.COMPLETED,this.widget.settings.onUploadSuccess.call(this.widget.element,this.id,e)},n.prototype.onError=function(e,t,a){this.status!==i.CANCELLED&&(this.status=i.FAILED,this.widget.settings.onUploadError.call(this.widget.element,this.id,e,t,a))},n.prototype.onComplete=function(){this.widget.activeFiles--,this.status!==i.CANCELLED&&this.widget.settings.onUploadComplete.call(this.widget.element,this.id),this.widget.queueRunning?this.widget.processQueue():this.widget.settings.queue&&0===this.widget.activeFiles&&this.widget.settings.onComplete.call(this.element)},n.prototype.getXhr=function(){var t=this,i=e.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",function(e){var i=0,a=e.loaded||e.position,n=e.total||e.totalSize;e.lengthComputable&&(i=Math.ceil(a/n*100)),t.widget.settings.onUploadProgress.call(t.widget.element,t.id,i)},!1),i},n.prototype.cancel=function(e){e=void 0!==e&&e;var t=this.status;return!!(t===i.UPLOADING||e&&t===i.PENDING)&&(this.status=i.CANCELLED,this.widget.settings.onUploadCanceled.call(this.widget.element,this.id),t===i.UPLOADING&&this.jqXHR.abort(),!0)},n.prototype.canUpload=function(){return this.status===i.PENDING||this.status===i.FAILED};var s=function(t,i){return this.element=e(t),this.settings=e.extend({},a,i),this.checkSupport()?(this.init(),this):(alert("您的浏览器版本太低，不支持上传文件"),e.error("Browser not supported by jQuery.dmUploader"),this.settings.onFallbackMode.call(this.element),!1)};s.prototype.checkSupport=function(){return void 0!==window.FormData&&(!new RegExp("/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1.0|2.0|2.5|3.0))/").test(window.navigator.userAgent)&&!e('<input type="file" />').prop("disabled"))},s.prototype.init=function(){var t=this;this.queue=[],this.queuePos=-1,this.queueRunning=!1,this.activeFiles=0,this.draggingOver=0,this.draggingOverDoc=0;var i=t.element.is("input[type=file]")?t.element:t.element.find("input[type=file]");return i.length>0&&(i.prop("multiple",this.settings.multiple),i.on("change.dmUploader",function(i){var a=i.target&&i.target.files;a&&a.length&&(t.addFiles(a),e(this).val(""))})),this.settings.dnd&&this.initDnD(),0!==i.length||this.settings.dnd?(this.settings.onInit.call(this.element),this):(e.error("Markup error found by jQuery.dmUploader"),null)},s.prototype.initDnD=function(){var t=this;t.element.on("drop.dmUploader",function(e){e.preventDefault(),t.draggingOver>0&&(t.draggingOver=0,t.settings.onDragLeave.call(t.element));var i=e.originalEvent&&e.originalEvent.dataTransfer;if(i&&i.files&&i.files.length){var a=[];t.settings.multiple?a=i.files:a.push(i.files[0]),t.addFiles(a)}}),t.element.on("dragenter.dmUploader",function(e){e.preventDefault(),0===t.draggingOver&&t.settings.onDragEnter.call(t.element),t.draggingOver++}),t.element.on("dragleave.dmUploader",function(e){e.preventDefault(),0===--t.draggingOver&&t.settings.onDragLeave.call(t.element)}),t.settings.hookDocument&&(e(document).off("drop.dmUploader").on("drop.dmUploader",function(e){e.preventDefault(),t.draggingOverDoc>0&&(t.draggingOverDoc=0,t.settings.onDocumentDragLeave.call(t.element))}),e(document).off("dragenter.dmUploader").on("dragenter.dmUploader",function(e){e.preventDefault(),0===t.draggingOverDoc&&t.settings.onDocumentDragEnter.call(t.element),t.draggingOverDoc++}),e(document).off("dragleave.dmUploader").on("dragleave.dmUploader",function(e){e.preventDefault(),0===--t.draggingOverDoc&&t.settings.onDocumentDragLeave.call(t.element)}),e(document).off("dragover.dmUploader").on("dragover.dmUploader",function(e){e.preventDefault()}))},s.prototype.releaseEvents=function(){this.element.off(".dmUploader"),this.element.find("input[type=file]").off(".dmUploader"),this.settings.hookDocument&&e(document).off(".dmUploader")},s.prototype.validateFile=function(t){if(this.settings.maxFileSize>0&&t.size>this.settings.maxFileSize)return this.settings.onFileSizeError.call(this.element,t),!1;if("*"!==this.settings.allowedTypes&&!t.type.match(this.settings.allowedTypes))return this.settings.onFileTypeError.call(this.element,t),!1;if(null!==this.settings.extFilter){var i=t.name.toLowerCase().split(".").pop();if(e.inArray(i,this.settings.extFilter)<0)return this.settings.onFileExtError.call(this.element,t),!1}return new n(t,this)},s.prototype.addFiles=function(e){for(var t=0,i=0;i<e.length;i++){var a=this.validateFile(e[i]);if(a){!1!==this.settings.onNewFile.call(this.element,a.id,a.data)&&(this.settings.auto&&!this.settings.queue&&a.upload(),this.queue.push(a),t++)}}return 0===t?this:(this.settings.auto&&this.settings.queue&&!this.queueRunning&&this.processQueue(),this)},s.prototype.processQueue=function(){return++this.queuePos>=this.queue.length?(0===this.activeFiles&&this.settings.onComplete.call(this.element),this.queuePos=this.queue.length-1,this.queueRunning=!1,!1):(this.queueRunning=!0,this.queue[this.queuePos].upload())},s.prototype.restartQueue=function(){this.queuePos=-1,this.queueRunning=!1,this.processQueue()},s.prototype.findById=function(e){for(var t=!1,i=0;i<this.queue.length;i++)if(this.queue[i].id===e){t=this.queue[i];break}return t},s.prototype.cancelAll=function(){var e=this.queueRunning;this.queueRunning=!1;for(var t=0;t<this.queue.length;t++)this.queue[t].cancel();e&&this.settings.onComplete.call(this.element)},s.prototype.startAll=function(){if(this.settings.queue)this.restartQueue();else for(var e=0;e<this.queue.length;e++)this.queue[e].upload()},s.prototype.methods={start:function(t){if(this.queueRunning)return!1;var a=!1;return void 0===t||(a=this.findById(t))?a?(a.status===i.CANCELLED&&(a.status=i.PENDING),a.upload()):(this.startAll(),!0):(e.error("File not found in jQuery.dmUploader"),!1)},cancel:function(t){var i=!1;return void 0===t||(i=this.findById(t))?i?i.cancel(!0):(this.cancelAll(),!0):(e.error("File not found in jQuery.dmUploader"),!1)},reset:function(){return this.cancelAll(),this.queue=[],this.queuePos=-1,this.activeFiles=0,!0},destroy:function(){this.cancelAll(),this.releaseEvents(),this.element.removeData(t)}},e.fn.dmUploader=function(i){var a=arguments;if("string"!=typeof i)return this.each(function(){e.data(this,t)||e.data(this,t,new s(this,i))});this.each(function(){var n=e.data(this,t);n instanceof s?"function"==typeof n.methods[i]?n.methods[i].apply(n,Array.prototype.slice.call(a,1)):e.error("Method "+i+" does not exist in jQuery.dmUploader"):e.error("Unknown plugin data found by jQuery.dmUploader")})}}),function(e,t,i,a){"use strict";var n=function(){return this.init.apply(this,arguments)};n.prototype={defaults:{onstatechange:function(){},ondragend:function(){},onbarclicked:function(){},isRange:!1,showLabels:!0,showScale:!0,step:1,format:"%s",theme:"",width:300,disable:!1,snap:!1},template:'<div class="slider-container">\t\t\t<div class="back-bar">                <div class="selected-bar"></div>                <div class="pointer low"></div><div class="pointer-label low">123456</div>                <div class="pointer high"></div><div class="pointer-label high">456789</div>                <div class="clickable-dummy"></div>            </div>            <div class="scale"></div>            <button class="btn btn-sure">确定</button>\t\t</div>',init:function(t,i){this.options=e.extend({},this.defaults,i),this.inputNode=e(t),this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:""+this.options.from),this.domNode=e(this.template),this.domNode.addClass(this.options.theme),this.inputNode.after(this.domNode),this.domNode.on("change",this.onChange),this.pointers=e(".pointer",this.domNode),this.lowPointer=this.pointers.first(),this.highPointer=this.pointers.last(),this.direction="right",this.startPosition=null,this.endPosition=null,this.labels=e(".pointer-label",this.domNode),this.lowLabel=this.labels.first(),this.highLabel=this.labels.last(),this.scale=e(".scale",this.domNode),this.bar=e(".selected-bar",this.domNode),this.clickableBar=this.domNode.find(".clickable-dummy"),this.confirmBtn=e(".btn-sure",this.domNode),this.interval=this.options.to-this.options.from,this.render()},render:function(){if(0===this.inputNode.width()&&!this.options.width)return void console.log("jRange : no width found, returning");this.options.width=this.options.width||this.inputNode.width(),this.domNode.width(this.options.width),this.inputNode.hide(),this.isSingle()&&(this.lowPointer.hide(),this.lowLabel.hide()),this.options.showLabels||this.labels.hide(),this.attachEvents(),this.options.showScale&&this.renderScale(),this.options.showConfirm||this.confirmBtn.remove(),this.setValue(this.options.value)},isSingle:function(){return"number"==typeof this.options.value||-1===this.options.value.indexOf(",")&&!this.options.isRange},attachEvents:function(){var t=this;this.clickableBar.click(e.proxy(this.barClicked,this)),this.pointers.on("mousedown touchstart",e.proxy(this.onDragStart,this)),this.pointers.bind("dragstart",function(e){e.preventDefault()}),this.confirmBtn.on("click",function(){"function"==typeof t.options.onConfirm&&t.options.onConfirm(t.options.value,t.domNode,e(this))})},onDragStart:function(t){if(!(this.options.disable||"mousedown"===t.type&&1!==t.which)){t.stopPropagation(),t.preventDefault();var a=e(t.target);this.pointers.removeClass("last-active"),a.addClass("focused last-active"),this[(a.hasClass("low")?"low":"high")+"Label"].addClass("focused"),e(i).on("mousemove.slider touchmove.slider",e.proxy(this.onDrag,this,a)),e(i).on("mouseup.slider touchend.slider touchcancel.slider",e.proxy(this.onDragEnd,this))}},onDrag:function(e,t){t.stopPropagation(),t.preventDefault(),t.originalEvent.touches&&t.originalEvent.touches.length?t=t.originalEvent.touches[0]:t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length&&(t=t.originalEvent.changedTouches[0]);var i=t.clientX-this.domNode.offset().left;this.startPosition||(this.startPosition=t.clientX),this.endPosition=t.clientX,this.endPosition<this.startPosition?this.direction="left":this.endPosition>this.startPosition&&(this.direction="right"),this.domNode.trigger("change",[this,e,i])},onDragEnd:function(t){this.pointers.removeClass("focused").trigger("rangeslideend"),this.labels.removeClass("focused"),e(i).off(".slider"),this.options.ondragend.call(this,this.options.value)},barClicked:function(e){if(!this.options.disable){var t=e.pageX-this.clickableBar.offset().left;if(this.isSingle())this.setPosition(this.pointers.last(),t,!0,!0);else{var i,a=Math.abs(parseFloat(this.pointers.first().css("left"),10)),n=this.pointers.first().width()/2,s=Math.abs(parseFloat(this.pointers.last().css("left"),10)),o=this.pointers.first().width()/2,r=Math.abs(a-t+n),c=Math.abs(s-t+o);i=r==c?t<a?this.pointers.first():this.pointers.last():r<c?this.pointers.first():this.pointers.last(),this.setPosition(i,t,!0,!0)}this.options.onbarclicked.call(this,this.options.value)}},onChange:function(e,t,i,a){var n,s;n=0,s=t.domNode.width(),t.isSingle()||(n=i.hasClass("high")?parseFloat(t.lowPointer.css("left"))+t.lowPointer.width()/2:0,s=i.hasClass("low")?parseFloat(t.highPointer.css("left"))+t.highPointer.width()/2:t.domNode.width());var o=Math.min(Math.max(a,n),s);t.setPosition(i,o,!0)},setPosition:function(e,t,i,a,n){var s,o=parseFloat(this.lowPointer.css("left")),r=parseFloat(this.highPointer.css("left"))||0,c=this.highPointer.width()/2;if(i||(t=this.prcToPx(t)),this.options.snap){var l=this.correctPositionForSnap(t);if(-1===l)return;t=l}e[0]===this.highPointer[0]?r=Math.round(t-c):o=Math.round(t-c),n?this.lowPointer.css({"z-index":5}):this.lowPointer.css("z-index",""),e[a?"animate":"css"]({left:Math.round(t-c)}),this.isSingle()?s=0:s=o+c;var d=Math.round(r+c-s);this.bar[a?"animate":"css"]({width:Math.abs(d),left:d>0?s:s+d}),this.showPointerValue(e,t,a),this.isReadonly()},correctPositionForSnap:function(e){var t=this.positionToValue(e)-this.options.from,i=this.options.width/(this.interval/this.options.step),a=t/this.options.step*i;return e<=a+i/2&&e>=a-i/2?a:-1},setValue:function(e){var t=e.toString().split(","),i=!1;t[0]=Math.min(Math.max(t[0],this.options.from),this.options.to)+"",t.length>1&&(t[1]=Math.min(Math.max(t[1],this.options.from),this.options.to)+""),this.options.value=e;var a=this.valuesToPrc(2===t.length?t:[0,t[0]]);this.isSingle()?this.setPosition(this.highPointer,a[1]):(i=a[0]==a[1]&&t[0]>1,this.setPosition(this.lowPointer,a[0],null,null,null),this.setPosition(this.highPointer,a[1],null,null,i))},setWidth:function(e){this.options.width=e,this.domNode.width(e),this.inputNode.hide()},renderScale:function(){for(var t=this.options.scale||[this.options.from,this.options.to],i=Math.round(100/(t.length-1)*10)/10,a="",n=0;n<t.length;n++)a+='<span style="left: '+n*i+'%">'+("|"!=t[n]?"<ins>"+t[n]+"</ins>":"")+"</span>";this.scale.html(a),e("ins",this.scale).each(function(){e(this).css({marginLeft:-e(this).outerWidth()/2})})},getBarWidth:function(){var e=this.options.value.split(",");return e.length>1?parseFloat(e[1])-parseFloat(e[0]):parseFloat(e[0])},showPointerValue:function(t,i,a){var n,s=e(".pointer-label",this.domNode)[t.hasClass("low")?"first":"last"](),o=this.positionToValue(i);if(e.isFunction(this.options.format)){var r=this.isSingle()?void 0:t.hasClass("low")?"low":"high";n=this.options.format(o,r)}else n=this.options.format.replace("%s",o);var c=s.html(n).width()||40,l=i-c/2;s[a?"animate":"css"]({left:l}),this.setInputValue(t,o),"function"==typeof this.options.afterDrag&&this.options.afterDrag(o,this.domNode)},valuesToPrc:function(e){return[100*(parseFloat(e[0])-parseFloat(this.options.from))/this.interval,100*(parseFloat(e[1])-parseFloat(this.options.from))/this.interval]},prcToPx:function(e){return this.domNode.width()*e/100},isDecimal:function(){return-1!==(this.options.value+this.options.from+this.options.to).indexOf(".")},positionToValue:function(e){var t=e/this.domNode.width()*this.interval;if(t=parseFloat(t,10)+parseFloat(this.options.from,10),this.isDecimal()){var i=Math.round(Math.round(t/this.options.step)*this.options.step*100)/100;if(0!==i)for(i=""+i,-1===i.indexOf(".")&&(i+=".");i.length-i.indexOf(".")<3;)i+="0";else i="0.00";return i}return Math.round(t/this.options.step)*this.options.step},setInputValue:function(e,t){if(this.isSingle())this.options.value=t.toString();else{var i=this.options.value.split(",");e.hasClass("low")?this.options.value=t+","+i[1]:this.options.value=i[0]+","+t}this.inputNode.val()!==this.options.value&&(this.inputNode.val(this.options.value).trigger("change"),this.options.onstatechange.call(this,this.options.value))},getValue:function(){return this.options.value},getOptions:function(){return this.options},getRange:function(){return this.options.from+","+this.options.to},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=!0,this.isReadonly()},enable:function(){this.options.disable=!1,this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable,this.isReadonly()},updateRange:function(e,t){var i=e.toString().split(",");this.interval=parseInt(i[1])-parseInt(i[0]),t?this.setValue(t):this.setValue(this.getValue())}};e.fn.jRange=function(i){var a,s=arguments;return this.each(function(){var o=e(this),r=e.data(this,"plugin_jRange"),c="object"==typeof i&&i;r||(o.data("plugin_jRange",r=new n(this,c)),e(t).resize(function(){r.setValue(r.getValue())})),"string"==typeof i&&(a=r[i].apply(r,Array.prototype.slice.call(s,1)))}),a||this}}(jQuery,window,document),"_PAGE"in window&&_PAGE.token?$.ajaxSettings.beforeSend=function(e,t){e.setRequestHeader("token",_PAGE.token)}:"_PAGE"in window.top&&window.top._PAGE.token&&($.ajaxSettings.beforeSend=function(e,t){e.setRequestHeader("token",window.top._PAGE.token)}),$.ajaxSettings.statusCode={200:function(e){if([31,32,35,36].indexOf(e.code)>=0&&mediator)return mediator.publish("WEB_GATE_INTERCEPTOR",{code:e.code,message:e.message}),!1},602:function(){try{_T.sendTracking("boss_code_602_logout")}catch(e){}},603:function(){window.top.location.href="/geek/complete/guide.html"},5003:function(){window.top.$&&window.top.$.dialog&&$.dialog({title:"",content:'<div class="captcha-pop-frame"><iframe src="/captcha/popUpCaptcha"></iframe></div>',closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-captcha-pop",lock:!0,onOpen:function(e){try{_T.sendEvent("captcha_dialog_show")}catch(e){}},onClose:function(){try{_T.sendEvent("captcha_dialog_hide")}catch(e){}},onConfirm:function(e){}})}};var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,qq:" qq"==e.match(/\sQQ/i)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},VerrifyCode=window.VerrifyCode||function(){var e=new Date,t=e.getFullYear()+""+e.getMonth()+e.getDay(),i=function(e,i){seriesLoadScripts("//g.alicdn.com/sd/ncpc/nc.js?t="+t,function(){var t=["BOSS_PC",(new Date).getTime(),Math.random().toString(16)].join(":"),a={renderTo:"#"+e.id,appkey:e.appkey||"FFFF0N00000000006DC1",scene:e.scene||"nc_login",token:t,customWidth:i.find(".row-code").width(),trans:{position:"sign-sms"},elementID:["sign-sms"],is_Opt:0,language:"cn",isEnabled:!0,timeout:3e3,times:5,apimap:{},callback:function(e){i.find("input[name=csig]").length||(i.find("form").append('<input type="hidden" name="csig" />'),i.find("form").append('<input type="hidden" name="ctoken" />'),i.find("form").append('<input type="hidden" name="csessionId" />'),i.find("form").append('<input type="hidden" value="FFFF0N00000000006DC1" name="cappKey" />'),i.find("form").append('<input type="hidden" value="nc_login" name="cscene" />')),i.find("input[name=csig]").val(e.sig),i.find("input[name=ctoken]").val(t),i.find("input[name=csessionId]").val(e.csessionid)}};new noCaptcha(a).upLang("cn",{_startTEXT:"请按住滑块，拖动到最右边",_yesTEXT:"验证通过",_error300:'哎呀，出错了，点击<a href="javascript:__nc.reset()">刷新</a>再来一次',_errorNetwork:'网络不给力，请<a href="javascript:__nc.reset()">点击刷新</a>'})})},a=function(e,i){seriesLoadScripts("//g.alicdn.com/sd/nch5/index.js?t="+t,function(){var t=["BOSS_H5",(new Date).getTime(),Math.random().toString(16)].join(":"),a=NoCaptcha.init({renderTo:"#"+e.id,appkey:e.appkey||"FFFF0N00000000006DC1",scene:"nc_login_h5",token:t,customWidth:"100%",trans:{position:"sign-h5"},elementID:["sign-h5"],is_Opt:0,language:"cn",timeout:1e4,retryTimes:5,errorTimes:5,inline:!1,apimap:{},bannerHidden:!1,initHidden:!1,callback:function(e){i.find("input[name=csig]").length||(i.find("form").append('<input type="hidden" name="csig" />'),i.find("form").append('<input type="hidden" name="ctoken" />'),i.find("form").append('<input type="hidden" name="csessionId" />'),i.find("form").append('<input type="hidden" value="FFFF0N00000000006DC1" name="cappKey" />'),i.find("form").append('<input type="hidden" value="nc_login" name="cscene" />')),i.find("input[name=csig]").val(e.sig),i.find("input[name=ctoken]").val(t),i.find("input[name=csessionId]").val(e.csessionid)},error:function(e){}});NoCaptcha.setEnabled(!0),a.reset(),NoCaptcha.upLang("cn",{LOADING:"加载中...",SLIDER_LABEL:"请向右滑动验证",CHECK_Y:"验证通过",CHECK_N:"验证未通过"})})},n=function(e,t){var n=e||{},s=t||$(".sign-form:visible");if(e||(n.id=s.find(".row-code").attr("id"),n.scene=s.find("input[name=cscene]").val(),n.appkey=s.find("input[name=cappKey]").val()),!n.id)return!1;browser.versions.mobile?a(n,s):i(n,s)},s=function(e){if(!e||!e.length)return!1;var t=e.parents(".sign-form").length?e.parents(".sign-form"):e.parents("form"),i="verrify"+Math.random().toString(32).substr(-6,6);t.find("input[name=csig]").val(""),t.find("input[name=ctoken]").val(""),t.find("input[name=csessionId]").val(""),e.empty(),e.attr("id",i),n({id:i,scene:t.find("input[name=cscene]").val(),appkey:t.find("input[name=cappKey]").val()},t)},o=function(){$(".sign-form .row-code").each(function(){s($(this))})};return o(),{build:o,reset:s}}(),rAF=rAF||window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3)},cAF=cAF||cancelAnimationFrame||webkitCancelAnimationFrame||mozCancelAnimationFrame||oCancelAnimationFrame||msCancelAnimationFrame||function(e){clearTimeout(e)},BossCanvas={useNTimesCanvas:function(e,t){var i=e.width,a=e.height,n=e.scrollWidth,s=e.scrollHeight;e.style.width=i+"px",e.style.height=a+"px",e.width=n*t,e.height=s*t},_drawGauge1:function(e){var t=e.ctx,i=e.canvasWidth,a=e.canvasHeight,n=e.point,s=e.text,o=e.percentDraw,r=e.textWidth,c=e.lineWidth,l=e.strokeStyleBg,d=e.strokeStyleFe;t.clearRect(0,0,i,a),t.beginPath(),t.arc(n.x,n.y,n.x-c/2-1,Math.PI,0),t.strokeStyle=l,t.stroke(),t.beginPath(),t.arc(n.x,n.y,n.x-c/2-1,Math.PI,(o/100+1)*Math.PI),t.strokeStyle=d,t.stroke(),t.fillText(s,n.x-r/2,n.y)},drawGauge1:function(e,t,i){var a=i&&i.times||2,n=i&&i.speed;BossCanvas.useNTimesCanvas(e,a);var s=e.getContext("2d");t.ctx=s,t.times=a,t.canvasWidth=e.width,t.canvasHeight=e.height,t.point={x:t.canvasWidth/2,y:t.canvasHeight-10},t.lineWidth=t.lineWidth*a||8*a,t.lineCap=t.lineCap||"round",t.fillStyle=t.fillStyle||"#FFAA33",t.font=t.font*a||20*a+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif",t.strokeStyleBg=t.strokeStyleBg||"#EEF0F5",t.strokeStyleFe=t.strokeStyleFe||"#FFAA33",s.lineWidth=t.lineWidth,s.lineCap=t.lineCap,s.fillStyle=t.fillStyle,s.font=t.font,t.textWidth=s.measureText(t.text).width;var o=0,r=t.percent;if(n)var c=rAF(function e(){o+n>=r?(o=r,cAF(c)):(o+=n,rAF(e)),t.percentDraw=o,BossCanvas._drawGauge1(t)});else t.percentDraw=r,BossCanvas._drawGauge1(t)},_drawLine1:function(e){var t=e.ctx,i=e.times,a=e.canvasWidth,n=e.canvasHeight,s=e.paddingTop,o=e.paddingBottom,r=e.paddingLeft,c=(e.paddingRight,e.columnCount,e.canvasInnerHeight),l=e.canvasInnerWidth,d=e.columnWidth,u=e.firstPointX,p=e.lineWidth,h=e.strokeStyleFe,f=e.lineCap,m=e.textColorCur,g=e.textColor,v=e.labelArr,b=e.percentArrDraw,y=e.tipIndex,w=e.tipIndex2,C=e.isSame,x=e.tipTextColor1,k=e.tipBgColor1,T=e.tipRadius,I=e.tipShadowBlur,$=e.tipShadowColor,S=e.tipText,_=e.tipText2,D=e.tipText3;t.clearRect(0,0,a,n),t.beginPath(),t.rect(r+y*d,s,d,c+o);var E=t.createLinearGradient(0,0,s,n);E.addColorStop(0,"rgba(251, 251, 251, 0)"),E.addColorStop(1,"rgba(251, 251, 251, 1)"),t.fillStyle=E,t.fill(),t.beginPath();for(var P=r;P<=l+r;)t.moveTo(P,s),t.lineTo(P,n),P+=d;t.strokeStyle="#EEF0F5",t.lineWidth=1,t.stroke();var M=0,L=0;t.beginPath(),b.forEach(function(e,i){var a={x:u+d*i,y:BossCanvas._formatPercent(e,s,c)};M=a.y<M?a.y:M,L=a.y>L?a.y:L,0===i?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y)}),t.strokeStyle=h,t.lineWidth=p,t.lineCap=f,t.stroke(),t.lineTo(u+(b.length-1)*d,L),t.lineTo(u,L),t.closePath();var j=t.createLinearGradient(0,M,0,L-10);j.addColorStop(0,"rgba(75, 135, 255, 0.3)"),j.addColorStop(1,"rgba(75, 135, 255, 0)"),t.fillStyle=j,t.fill(),t.beginPath();var U={x:y*d+u,y:BossCanvas._formatPercent(b[y],s,c)};if(C)BossCanvas._drawTips(t,D,U,i,x,k,T,I,$);else if(BossCanvas._drawTips(t,S,U,i,x,k,T,I,$),w>=0){var A={x:w*d+u,y:BossCanvas._formatPercent(b[w],s,c)};BossCanvas._drawTips(t,_,A,i,x,k,T,I,$)}t.lineWidth=2,t.beginPath(),t.arc(U.x,U.y,7,0,2*Math.PI),t.fillStyle="#fff",t.shadowBlur=5,t.shadowColor="rgba(0, 0, 0, 0.08)",t.fill(),t.beginPath(),t.arc(U.x,U.y,3,0,2*Math.PI),t.fillStyle="#4B87FF",t.shadowBlur=0,t.fill(),b.forEach(function(e,a){var n={x:u+d*a,y:BossCanvas._formatPercent(e,s,c)};a===y?BossCanvas._drawPercent(t,e,n,10,m,i):BossCanvas._drawPercent(t,e,n,10,g,i)}),v.forEach(function(e,a){var s={x:u+d*a,y:n};a===y?BossCanvas._drawLabel(t,e,s,m,i):BossCanvas._drawLabel(t,e,s,g,i)})},drawLine1:function(e,t,i){var a=i&&i.times||2,n=i&&i.speed;BossCanvas.useNTimesCanvas(e,a);var s=e.getContext("2d");t.ctx=s,t.times=a,t.canvasWidth=e.width,t.canvasHeight=e.height,t.paddingTop=void 0===t.paddingTop?22*a:t.paddingTop*a,t.paddingBottom=void 0===t.paddingBottom?22*a:t.paddingBottom*a,t.paddingLeft=void 0===t.paddingLeft?40*a:t.paddingLeft*a,t.paddingRight=void 0===t.paddingRight?40*a:t.paddingRight*a,t.columnCount=t.columnCount||5,t.canvasInnerHeight=t.canvasInnerHeight||t.canvasHeight-t.paddingTop-t.paddingBottom,t.canvasInnerWidth=t.canvasInnerWidth||t.canvasWidth-t.paddingLeft-t.paddingRight,t.columnWidth=t.columnWidth*a||t.canvasInnerWidth/t.columnCount,t.firstPointX=t.firstPointX||t.columnWidth/2+t.paddingLeft,t.point={x:t.canvasWidth/2,y:t.canvasHeight-10},t.lineWidth=t.lineWidth*a||2*a,t.lineCap=t.lineCap||"round",t.font=t.font*a||20*a+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif",t.textWidth=s.measureText(t.text).width,t.strokeStyleBg=t.strokeStyleBg||"#EEF0F5",t.strokeStyleFe=t.strokeStyleFe||"#4B87FF",t.textColorCur=t.textColorCur||"#414A60",t.textColor=t.textColor||"#8D92A1",t.tipTextColor1=t.tipTextColor1||"#fff",t.tipBgColor1=t.tipBgColor1||"#4B87FF",t.tipRadius=t.tipRadius||5,t.tipShadowBlur=t.tipShadowBlur||5,t.tipShadowColor=t.tipShadowColor||"rgba(0, 0, 0, 0.3)",s.lineWidth=t.lineWidth,s.lineCap=t.lineCap,s.fillStyle=t.fillStyle,s.font=t.font;for(var o=0,r=[],c=[],l=t.percentArr,d=0,u=0;u<t.columnCount;u++){var p=Math.pow(2,u);r.push(p),d+=p,c.push(0)}if(n)var h=rAF(function e(){o>=d?cAF(h):(l.forEach(function(e,t){c[t]+n>=e?(c[t]=e,o|=r[t]):c[t]+=n}),t.percentArrDraw=c,BossCanvas._drawLine1(t),rAF(e))});else t.percentArrDraw=l,BossCanvas._drawLine1(t)},_drawInterval1:function(e){var t=e.ctx,i=e.times,a=e.canvasWidth,n=e.canvasHeight,s=e.paddingTop,o=(e.paddingBottom,e.paddingLeft,e.paddingRight,e.columnCount,e.canvasInnerHeight),r=(e.canvasInnerWidth,e.columnWidth),c=e.firstPointX,l=e.lineWidth,d=e.strokeStyleFeCur,u=e.strokeStyleFe,p=e.strokeStyleBg,h=(e.lineCap,e.textColorCur),f=e.textColor,m=e.labelArr,g=e.percentArrDraw,v=e.tipIndex,b=e.tipTextColor1,y=e.tipBgColor1,w=e.tipRadius,C=e.tipShadowBlur,x=e.tipShadowColor,k=e.tipText;t.clearRect(0,0,a,n),g.forEach(function(e,a){var g=c+a*r,T=BossCanvas._formatPercent(e,s,o);t.beginPath(),t.moveTo(g,s+o),t.lineTo(g,s),t.strokeStyle=p,t.stroke(),t.beginPath(),t.moveTo(g,T),t.lineTo(g,s+o),t.strokeStyle=a===v?d:u,t.stroke(),BossCanvas._drawPercent(t,e,{x:g,y:T},10,v===a?h:f,i),BossCanvas._drawLabel(t,m[a],{x:g,y:n},v===a?h:f,i),v===a&&(BossCanvas._drawTips(t,k,{x:g,y:T},i,b,y,w,C,x),t.lineWidth=l)})},drawInterval1:function(e,t,i){var a=i&&i.times||2,n=i&&i.speed;BossCanvas.useNTimesCanvas(e,a);var s=e.getContext("2d");t.ctx=s,t.times=a,t.canvasWidth=e.width,t.canvasHeight=e.height,t.paddingTop=void 0===t.paddingTop?22*a:t.paddingTop*a,t.paddingBottom=void 0===t.paddingBottom?22*a:t.paddingBottom*a,t.paddingLeft=void 0===t.paddingLeft?0:t.paddingLeft*a,t.paddingRight=void 0===t.paddingRight?0:t.paddingRight*a,t.columnCount=t.columnCount||5,t.canvasInnerHeight=t.canvasInnerHeight||t.canvasHeight-t.paddingTop-t.paddingBottom,t.canvasInnerWidth=t.canvasInnerWidth||t.canvasWidth-t.paddingLeft-t.paddingRight,t.columnWidth=t.columnWidth*a||t.canvasInnerWidth/t.columnCount,t.firstPointX=t.firstPointX||t.columnWidth/2+t.paddingLeft,t.point={x:t.canvasWidth/2,y:t.canvasHeight-10},t.lineWidth=t.lineWidth*a||8*a,t.lineCap=t.lineCap||"round",t.font=t.font*a||20*a+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif",t.textWidth=s.measureText(t.text).width,t.strokeStyleBg=t.strokeStyleBg||"#EEF0F5",
t.strokeStyleFe=t.strokeStyleFe||"rgba(75, 135, 255, 0.3)",t.strokeStyleFeCur=t.strokeStyleFeCur||"rgba(75, 135, 255, 0.8)",t.textColorCur=t.textColorCur||"#414A60",t.textColor=t.textColor||"#8D92A1",t.tipTextColor1=t.tipTextColor1||"#fff",t.tipBgColor1=t.tipBgColor1||"#4B87FF",t.tipRadius=t.tipRadius||5,t.tipShadowBlur=t.tipShadowBlur||5,t.tipShadowColor=t.tipShadowColor||"rgba(0, 0, 0, 0.3)",s.lineWidth=t.lineWidth,s.lineCap=t.lineCap,s.fillStyle=t.fillStyle,s.font=t.font;for(var o=0,r=[],c=[],l=t.percentArr,d=0,u=0;u<t.columnCount;u++){var p=Math.pow(2,u);r.push(p),d+=p,c.push(0)}if(n)var h=rAF(function e(){o>=d?cAF(h):(l.forEach(function(e,t){c[t]+n>=e?(c[t]=e,o|=r[t]):c[t]+=n}),t.percentArrDraw=c,BossCanvas._drawInterval1(t),rAF(e))});else t.percentArrDraw=l,BossCanvas._drawInterval1(t)},_drawTips:function(e,t,i,a,n,s,o,r,c){e.font=12*a+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif";var l=e.measureText(t).width,d=l+18*a,u=26*a,p=4*a,h=i.y-29*a-27*a>=0;o*=a;var f={},m={},g={},v={},b={},y={},w={},C={},x={};h?(w.x=i.x,w.y=i.y-27*a,b.x=i.x-p,b.y=w.y-p,y.x=w.x+p,y.y=b.y,C.x=w.x,C.y=b.y-p,m.x=i.x-d/2,m.y=b.y,v.x=i.x+d/2,v.y=m.y,f.x=m.x,f.y=m.y-u,g.x=v.x,g.y=f.y,x.x=i.x-l/2,x.y=m.y-8*a):(C.x=i.x,C.y=i.y,b.x=i.x-p,b.y=C.y+p,y.x=C.x+p,y.y=b.y,w.x=C.x,w.y=b.y+p,f.x=i.x-d/2,f.y=b.y,g.x=i.x+d/2,g.y=f.y,m.x=f.x,m.y=f.y+u,v.x=g.x,v.y=m.y,x.x=i.x-l/2,x.y=m.y-8*a),e.fillStyle=s,e.strokeStyle=s,e.beginPath(),h?(e.moveTo(w.x,w.y),e.lineTo(b.x,b.y),e.lineTo(m.x+o,m.y),e.arc(m.x+o,m.y-o,o,.5*Math.PI,Math.PI),e.lineTo(f.x,f.y+o),e.arc(f.x+o,f.y+o,o,Math.PI,1.5*Math.PI),e.lineTo(g.x-o,g.y),e.arc(g.x-o,g.y+o,o,1.5*Math.PI,2*Math.PI),e.lineTo(v.x,v.y-o),e.arc(v.x-o,v.y-o,o,0,.5*Math.PI),e.lineTo(y.x,y.y),e.lineTo(w.x,w.y)):(e.moveTo(C.x,C.y),e.lineTo(b.x,b.y),e.lineTo(f.x+o,f.y),e.arc(f.x+o,f.y+o,o,1.5*Math.PI,Math.PI,!0),e.lineTo(m.x,m.y-o),e.arc(m.x+o,m.y-o,o,Math.PI,.5*Math.PI,!0),e.lineTo(v.x-o,v.y),e.arc(v.x-o,v.y-o,o,.5*Math.PI,0,!0),e.lineTo(g.x,g.y+o),e.arc(g.x-o,g.y+o,o,0,1.5*Math.PI,!0),e.lineTo(y.x,y.y),e.lineTo(C.x,C.y)),e.shadowBlur=r*a,e.shadowColor=c,e.fill(),e.shadowBlur=0,e.fillStyle=n,e.fillText(t,x.x,x.y)},_drawPercent:function(e,t,i,a,n,s){t+="%",e.font=12*s+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif";var o=e.measureText(t).width;e.beginPath(),e.fillStyle=n,e.fillText(t,i.x-o/2,i.y-a*s)},_drawLabel:function(e,t,i,a,n){e.font=12*n+"px arial, verdana, helvetica,'PingFang SC','HanHei SC','STHeitiSC-Light', Microsoft Yahei,sans-serif";var s=e.measureText(t).width;e.beginPath(),e.fillStyle=a,e.fillText(t,i.x-s/2,i.y-2*n)},_formatPercent:function(e,t,i){return t+i-i*e/100}},vipBusinessBlock=function(){var e,t,i,a,n,s,o,r,c,l,d={},u={},p=0,h=!1,f={header:function(){if(!d.hlShortDesc.name)return"";return Utemplate('<div class="business-block-header"><h3 class="title"><%this.hlShortDesc.name%><%if(this.hlShortDesc.description) {%><p class="title-subhead"><% this.hlShortDesc.description %></p><%}%></h3></div>',d)},footer:function(){return'<div class="business-block-footer"><div class="price-box"><span class="ruling J_ruling">---</span><span class="unit J_nuit">直豆</span><span class="original J_original"></span></div><a href="javascript:;" class="btn btn-orange J_submit" action="buy_submit">立即购买</a></div>'},cardHeader:function(e){if(!e)return"";return Utemplate('<header class="card-header"><h4 class="title"><%this.title%></h4><p class="subhead"><%this.subTitle%></p></header>',e)},vipCardTable:function(e,t){if(!t||!e)return"";return Utemplate('<ul class="card-vip-list"><li class="table-header"><%for(var i=0;i<this.headerList.length;i++){%><span><%this.headerList[i]%></span><%}%></li><%for(var i=0;i<this.categoryList.length;i++){%><li class="table-body"><span><%this.categoryList[i].name%></span><span><%this.categoryList[i].currentRight%></span><span><%this.categoryList[i].vipRight%></span></li><%}%></ul>',{headerList:e,categoryList:t})},normalCardTable:function(e,t){if(!t||!e)return"";return Utemplate('<ul class="card-vip-list card-normal-list"><li class="table-header"><%for(var i=0;i<this.headerList.length;i++){%><span><%this.headerList[i]%></span><%}%></li><%for(var i=0;i<this.categoryList.length;i++){%><li class="table-body"><span><%this.categoryList[i].bottomDesc%></span><span><%this.categoryList[i].count%><%this.categoryList[i].unitDesc%></span></li><%}%></ul>',{headerList:e,categoryList:t})},otherCardTable:function(e,t,i){if(!t||!e)return"";var a=!0;t.forEach(function(e){e.select&&(a=!1)}),a&&(t[0].select=!0);return Utemplate('<form class="card-form J_equity_form"><ul class="card-table"><li class="table-header"><div><%this.headerList[0]%></div><div><%this.headerList[1]%></div><div><%this.headerList[2]%></div><div>&nbsp;</div></li><%for(var i=0;i<this.priceList.length;i++){%><li class="table-body"><%if(this.cardId === 22 || this.cardId === 23) {%><div><p class="price"><i><%this.priceList[i].descList[0].count%></i>直豆</p><p class="type"><%this.priceList[i].descList[0].bottomDesc%></p></div><div><p><%this.priceList[i].descList[1].count%><%this.priceList[i].descList[1].unitDesc%></p></div><div><p><%this.priceList[i].descList[2].count%><%this.priceList[i].descList[2].unitDesc%></p></div><%}else{%><div><p class="price"><i><%this.priceList[i].beanCount%></i>直豆</p><%if(this.priceList[i].priceName){%><p class="type"><%this.priceList[i].priceName%>（<%this.priceList[i].expireDays%>天）</p><%}%></div><div><p><%this.priceList[i].descList[0].count%><%this.priceList[i].descList[0].unitDesc%></p></div><div><p><%this.priceList[i].descList[1].count%><%this.priceList[i].descList[1].unitDesc%></p></div><%}%><div><label><input type="radio" name="equity" value="<%i%>" <%if(this.priceList[i].select){%>checked<%}%>  action="equity_checked"><span class="radio-substitute"></span></label></div></li><%}%></ul></form>',{headerList:e,priceList:t,cardId:i})},vipCardEquity:function(e){if(!e)return"";var t=e.items.length;e.len=t;return Utemplate('<div class="card-equity"><h4><%this.title%></h4><ul class="equity-list" <%if(this.len < 6){%>style="text-align: center;"<%}%> ><%for(var i=0;i<this.items.length;i++){%><li><div class="icon-box"><img src="<%this.items[i].icon%>" alt="<%this.items[i].desc%>"></div><p><%this.items[i].desc%></p></li><%}%></ul></div>',e)},vipPanelDeadline:function(e){if(!e)return"";var t=!0;e.forEach(function(e){e.select&&(t=!1)}),t&&(e[0].select=!0);return Utemplate('<form class="panel-form J_vip_form"><div class="panel-deadline"><%for(var i=0;i<this.priceList.length;i++){%><label class="deadline-cell"><input type="radio" name="deadline" value="<%i%>" <%if(this.priceList[i].select){%>checked<%}%> action="vip_checked"><div class="radio-substitute"><p class="price"><span><%this.priceList[i].beanCount%></span><%this.priceList[i].unitDesc%><%if(this.priceList[i].averagePrice){%>&nbsp;&nbsp;<%this.priceList[i].averagePrice%><%}%></p><p class="deadline"><%this.priceList[i].expireName%></p></div></label><%}%></div></form>',{priceList:e})},panelDiscount:function(e){if(!e)return"";return Utemplate('<div class="panel-discount"><div class="discount-title">优惠</div><ul class="discount-list"><%for(var i=0;i<this.discountList.length;i++){%><li><span class="marke"><%this.discountList[i].discountTag%></span><span class="text"><%this.discountList[i].discount.name%></span></li><%}%></ul></div>',{discountList:e})},panelDescription:function(e){return Utemplate('<div class="panel-description"><%if(this.bottomTipList && this.bottomTipList.length !== 0){%><%for(var i=0;i<this.bottomTipList.length;i++){%><p>*<%this.bottomTipList[i].name%></p><%}%><%}%><p>*组合套餐，高性价、低成本，详情：<a href="javascript:;" action="charRobot">在线咨询</a>或<a href="javascript:;" action="charSell">请销售顾问联系我</a></p></div>',{bottomTipList:e})},tabCell:function(e,t){if(!e)return"";var i=v(e.cardId);return Utemplate('<div class="tab-cell <%this.theme%>" action="tab_change" stop="true" data-index="<%this.index%>"><h4 class="title"><%this.cardListItem.title%></h4><p class="subhead"><%this.cardListItem.subTitle%></p><%if(this.index === 0){%><div class="recommend-tips"><span>推荐</span></div><%}%></div>',{theme:i,cardListItem:e,index:t})},keyTabCell:function(e,t){if(!e)return"";var i=v(e.cardId);return Utemplate('<div class="tab-cell cell-key <%this.theme%>" action="tab_change" stop="true" data-index="<%this.index%>"><h4 class="title"><%this.cardListItem.title%></h4><p class="subhead"><%this.cardListItem.subTitle%></p><p class="price"><%this.cardListItem.beanCount%>直豆/<%this.cardListItem.cardId === 32 ? "次" : "月"%></p></div>',{theme:i,cardListItem:e,index:t})},keyCard:function(){return'<div class="card-key"><div class="icon-box"><i class="iboss-suo1"></i></div><p class="text">一键解锁心仪牛人，沟通畅聊无阻</p><p class="text">解锁后，该牛人长期沟通有效</p></div>'}},m=function(e,t){if(!e)return"";var i='<div class="panel-card">';return i+=f.cardHeader(e),"vip"===t&&(i+=f.vipCardTable(e.headerList,e.categoryList),i+=f.vipCardEquity(e.retainRight)),"normal"===t&&(e.priceList&&e.priceList.length>0?i+=f.otherCardTable(e.headerList,e.priceList,e.cardId):32===e.cardId?i+=f.keyCard():i+=f.normalCardTable(e.headerList,e.categoryList)),i+="</div>"},g=function(e){var t=v(e.cardId);if(""===t)return"";var i='<div class="business-block-panel '+t+'">';return"black"===t?(i+=m(e,"vip"),i+=f.vipPanelDeadline(e.priceList)):i+=m(e,"normal"),i+=f.panelDiscount(e.discountList),i+=f.panelDescription(e.bottomTipList),i+="</div>"},v=function(e){if(!e)return"";var t="";switch(e){case 18:case 19:t="black";break;case 20:t="pink";break;case 21:t="gray";break;case 22:case 23:t="green";break;case 24:t="pink";break;case 25:t="black";break;case 32:t="green";break;case 33:t="black";break;default:t=""}return t},b=function(){var e=d.cardList,t=e.length;if(!t)return"";var i='<div class="business-block-content">';return i+=f.header(),i+='<div class="business-block-body">',1===t?i+=g(e[0]):2===t&&(i+='<div class="business-block-tab J_tab_head">',e.forEach(function(e,t){32===e.cardId||33===e.cardId?i+=f.keyTabCell(e,t):i+=f.tabCell(e,t)}),i+="</div>",i+='<div class="business-block-tab-content J_tab_body">',e.forEach(function(e){i+=g(e)}),i+="</div>"),i+="</div>",i+="</div>",i+=f.footer()},y={add:document.addEventListener?function(e,t,i,a){"mousewheel"===t&&void 0!==document.mozFullScreen&&(t="DOMMouseScroll"),e.addEventListener(t,i,!!a)}:function(e,t,i){e.attachEvent("on"+t,i)},remove:document.removeEventListener?function(e,t,i){e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent("on"+t,i)},target:function(e){return e.target?e.target:window.event.srcElement},stop:function(e){e&&e.stopPropagation?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1)},attFather:function(e,t,i){return e&&t&&e.parentNode?(i?null!==e.getAttribute(t):e.getAttribute(t))?{node:e,attr:e.getAttribute(t)}:this.attFather(e.parentNode,t):null}},w=function(){t&&y.add(t,"click",C)},C=function(e){var t=y.target(e),i=y.attFather(t,"action");if(y.attFather(t,"stop")&&y.stop(e),i&&"tab_change"===i.attr&&x(i),i&&"buy_submit"===i.attr&&I(),i&&"equity_checked"===i.attr&&k(),i&&"vip_checked"===i.attr&&T(),i&&"charRobot"===i.attr){ChatBot.open();try{var a=S();Block.action({action:"help-robot-call",p2:5,p3:a.blockConfigId,p4:a.encryptPriceId})}catch(e){}}if(i&&"charSell"===i.attr){CallMeDialog();try{var a=S();Block.action({action:"help-passive-call-click",p2:5,p3:a.blockConfigId,p4:a.encryptPriceId})}catch(e){}}},x=function(e){var t=+e.node.dataset.index;if(t===p)return!1;p=t,U(),j()},k=function(){j()},T=function(){j()},I=function(){var t=S();if(!t.encryptPriceId)return $.toast({type:"error",content:"请先选择需要购买的商品类型"}),!1;if(u.onConfirm&&"function"==typeof u.onConfirm&&u.onConfirm(t))return!1;if(D(t),h=!0,e&&e.close(),t.button){var i=getQueryParams(t.button.url),a=Block.formatBA(i.ba);Block.action(a)}},S=function(){var e=M().currentCardData,t=L(),i={};return i=e,i.priceId=t.priceId,i.encryptPriceId=t.encryptPriceId,i.priceName=t.priceName,i.beanCount=t.beanCount,i},_=function(e,t,i){top.Payment.success({article:e||"购买成功",text:t||"",confirm:function(){i.confirm&&i.confirm()},close:function(){i.confirm&&i.confirm()}})},D=function(e){var t={priceId:e.encryptPriceId,targetId:e.encryptTargetId,business:e.business||"",targetType:e.targetType};if(u.parameter&&"[Object Object]"===Object.prototype.toString.call(u.parameter))for(var i in u.parameter)u.parameter[i]&&(t[i]=u.parameter[i]);var a=OrderStore.push({blockPageData:d,option:u}),n={data:t},s=E(e);s.storeId=a.id,s.noBack=e.noBack,window.top.Payment&&window.top.Payment.purchase(n,s)},E=function(e){var t=function(e){if(!u.payComplete||"function"!=typeof u.payComplete||!u.payComplete(e))return 1===e.experience?void(6===e.auditStatus||7===e.auditStatus?PositionCheckDialog.jobSave(u.parameter.jobId,function(){u.success&&"function"==typeof u.success&&u.success()}):_("免费试用火爆职位",e.dialog.content,{confirm:u.success})):e.bzbParam?void $.get("/wapi/zpblock/order/bzbquery",{bzbParam:e.bzbParam}).success(function(e){if(0!==e.code)return $.toast({type:"error",content:e.message}),!1;6===e.zpData.auditStatus||7===e.zpData.auditStatus?PositionCheckDialog.jobSave(u.parameter.jobId,function(){u.success&&"function"==typeof u.success&&u.success()}):_(e.zpData.dialog.title,e.zpData.dialog.content,{confirm:u.success})}):void 0};return{buy:function(t){var i={action:"confirm-payment",p:"",p2:e.beanCount,p3:t.balance,p4:t.pay,p5:t.pay};Block.action(i)},success:t,cancel:function(){u.payCancel&&"function"==typeof u.payCancel&&u.payCancel()},fail:function(){u.payFail&&"function"==typeof u.payFail&&u.payFail()}}},P=function(){i=t.querySelector(".J_ruling"),a=t.querySelector(".J_nuit"),n=t.querySelector(".J_original"),o=t.querySelector(".J_tab_head"),r=t.querySelector(".J_tab_body"),c=t.querySelector(".J_equity_form"),l=t.querySelector(".J_vip_form"),s=t.querySelector(".J_submit")},M=function(){var e=d.cardList[p];return{theme:v(e.cardId),currentCardData:e}},L=function(){var e=M(),t=e.currentCardData,i=null,a="",n={};return t.priceList&&t.priceList.length?(t.priceList.map(function(e){e.select=!1}),i="black"===e.theme?l.querySelector('input[type="radio"]:checked'):c.querySelector('input[type="radio"]:checked'),null!==i&&(a=+i.value,n=t.priceList[a]),n.select=!0):n=t,n},j=function(){var e=M().currentCardData.button,t=L();void 0!==t.bzbPriceCount?0===t.bzbPriceCount?(i.innerText="免费",a.innerText=""):(i.innerText=t.bzbPriceCount,a.innerText=t.bzbUnitDesc):i.innerText="---",void 0!==t.originPriceDesc?n.innerText=t.originPriceDesc:n.innerText="",e&&e.text&&(s.innerText=e.text)},U=function(){var e=[].slice.call(o.querySelectorAll(".tab-cell")),t=[].slice.call(r.querySelectorAll(".business-block-panel")),i=function(e,t){t===p?e.classList.add("cur"):e.classList.remove("cur")};e.forEach(i),t.forEach(i)},A=function(){var e=d.cardList,i=e.length;if(!i||null===t)return!1;p=0,P(),w(),j(),i>1&&U()},R=function(){h=!1;var i=b();e=$.dialog({bind:!0,title:"",closeLayer:!1,content:i,wrapClass:"business-block-wrap w-540",cancelText:"",confirmText:"",onOpen:function(e){t=e,A(),u.onOpen&&"function"==typeof u.onOpen&&u.onOpen(e)},onClose:function(){t&&y.remove(t,"click",C),!h&&u.onClose&&"function"==typeof u.onClose&&u.onClose()}})};return{show:function(e,t){return!!e&&(d=e||{},u=t||{},!(!d.templateId||25!==d.templateId&&31!==d.templateId)&&(31===d.templateId&&(d.hlShortDesc={},d.hlShortDesc.name="今日沟通人数已达上限",d.hlShortDesc.description="购买沟通钥匙，或升级VIP账号"),R(),!0))},buy:function(e,t){return!!e&&(u=t||{},D(e),!0)}}}(),commonBusinessBlock=function(){var e=null,t=null,i=null,a=null,n=!1,s=null,o=null,r=null,c=null,l=null,d=null,u={header:function(){if(!e.shortDesc.name)return"";var t={shortDesc:e.shortDesc.name,hlShortDesc:e.hlShortDesc.name,dynamicBar:e.dynamicBar,templateId:e.templateId};return Utemplate('<div class="business-block-header"><h3 class="title"><% this.shortDesc %><%if(this.hlShortDesc) {%><p class="title-subhead"><% this.hlShortDesc %><i class="iboss-wenhao"></i><span class="title-tips">当您招聘的职位BOSS竞争很激烈时，这个职位就会被判定为火爆职位，需要付费发布</span></p><%}%></h3><%if(this.templateId !== 36 && this.dynamicBar) {%><div class="notice-wrap J_notice"><ul class="notice"><% for(var i=0;i<this.dynamicBar.length;i++){ %><li><% this.dynamicBar[i] %></li><% } %></ul></div><%}%></div>',t)},footer:function(){var t=e.buttonList;return Utemplate('<div class="business-block-footer"><div class="price-box"><span class="ruling J_ruling">---</span><span class="unit J_nuit">直豆</span><span class="original J_original"></span></div><div class="btn_box"><% if(this.buttonList){ %><% for(var i=0;i<this.buttonList.length;i++){ %><a href="javascript:;" class="btn btn-orange" action="form_submit"><% this.buttonList[i].text %></a><% } %><% }else{ %><a href="javascript:;" class="btn btn-orange" action="form_submit">立即购买</a><% } %></div></div>',{buttonList:t})},panelDiscount:function(){if(!e.discountList||0===e.discountList.length)return"";var t=e.discountList;return Utemplate('<div class="panel-discount"><div class="discount-title">优惠</div><ul class="discount-list"><%for(var i=0;i<this.discountList.length;i++){%><li><span class="marke"><%this.discountList[i].discountTag%></span><span class="text"><%this.discountList[i].discount.name%></span></li><%}%></ul></div>',{discountList:t})},panelDescription:function(){var t=e.bottomTipList;return Utemplate('<div class="panel-description"><%if(this.bottomTipList && this.bottomTipList.length !== 0){%><%for(var i=0;i<this.bottomTipList.length;i++){%><p>*<%this.bottomTipList[i].name%></p><%}%><%}%><p>*组合套餐，高性价、低成本，详情：<a href="javascript:;" action="charRobot">在线咨询</a>或<a href="javascript:;" action="charSell">请销售顾问联系我</a></p></div>',{bottomTipList:t})},multipleCard:function(e){if(!e)return"";var t=0===e.color||1===e.color?"gray":"pink";return Utemplate('<div class="panel-card <% this.theme %>"><header class="card-header"><h3 class="title"><% this.cardData.name %></h3><div class="equity-list"><ul class="equity-name"><%for(var i=0;i<this.cardData.privilegeItems.length;i++){%><li><% this.cardData.privilegeItems[i].key %></li><%}%></ul><ul class="equity-amount"><%for(var i=0;i<this.cardData.privilegeItems.length;i++){%><li><% this.cardData.privilegeItems[i].value %></li><%}%></ul></div></header><ul class="card-table tree-cell"><%for(var i=0;i<this.cardData.priceList.length;i++){%><li class="table-body"><div><p><%this.cardData.priceList[i].expireName%><span class="discount"><%this.cardData.priceList[i].discountDesc%></span></p></div><div><p><%this.cardData.priceList[i].unitDesc%></p></div><div><label><input type="radio" name="radio" value="<%this.cardData.priceList[i].priceId%>" <%if(this.cardData.priceList[i].select){%>checked<%}%> action="price_change"><span class="radio-substitute"></span></label></div><%if(this.cardData.priceList[i].promoteDesc) {%><p class="recommend-tips"><span><%this.cardData.priceList[i].promoteDesc%></span></p><%}%></li><%}%></ul></div>',{cardData:e,theme:t})},singleCard:function(){return Utemplate('<div class="panel-card pink"><header class="card-header"><h3 class="title"><% this.priceTitle %></h3><div class="equity-list"><ul class="equity-name"><%for(var i=0;i<this.privilegeItems.length;i++){%><li><% this.privilegeItems[i].key %></li><%}%></ul><ul class="equity-amount"><%for(var i=0;i<this.privilegeItems.length;i++){%><li><% this.privilegeItems[i].value %></li><%}%></ul></div></header><div class="card-price"><p class="content"><span class="title"><%if(this.templateId === 28){%>升级所需价格<%}else{%>权益总价值<%}%></span><span class="price"><%this.currentPrice%><%this.currentUnit%></span></p><%if(this.templateId === 28 && this.upgradeDesc) {%><p class="description"><%this.upgradeDesc%></p><%}%></div></div>',e)},cheerCard:function(e){if(!e)return"";var t=30===e.cardId?"gray":"green";return Utemplate('<div class="panel-card <% this.theme %>"><header class="card-header"><h3 class="title"><% this.cardData.title %></h3><div class="equity-list"><ul class="equity-name"><%for(var i=0;i<this.cardData.chatDescList.length;i++){%><li><%this.cardData.chatDescList[i].key%></li><%}%></ul><ul class="equity-amount"><%for(var i=0;i<this.cardData.chatDescList.length;i++){%><li><%this.cardData.chatDescList[i].value%></li><%}%></ul></div></header><ul class="card-table two-cell"><%for(var i=0;i<this.cardData.priceList.length;i++){%><li class="table-body"><div><p><%this.cardData.priceList[i].beanCount%><%this.cardData.priceList[i].unitDesc%></p></div><div><label><input type="radio" name="radio" value="<%this.cardData.priceList[i].priceId%>" <%if(this.cardData.priceList[i].select){%>checked<%}%> action="price_change"><span class="radio-substitute"></span></label></div></li><%}%></ul></div>',{cardData:e,theme:t})}},p={add:document.addEventListener?function(e,t,i,a){"mousewheel"===t&&void 0!==document.mozFullScreen&&(t="DOMMouseScroll"),e.addEventListener(t,i,!!a)}:function(e,t,i){e.attachEvent("on"+t,i)},remove:document.removeEventListener?function(e,t,i){e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent("on"+t,i)},target:function(e){return e.target?e.target:window.event.srcElement},stop:function(e){e&&e.stopPropagation?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1)},attFather:function(e,t,i){return e&&t&&e.parentNode?(i?null!==e.getAttribute(t):e.getAttribute(t))?{node:e,attr:e.getAttribute(t)}:this.attFather(e.parentNode,t):null}},h=function(){a&&p.add(a,"click",f)},f=function(e){var t=p.target(e),i=p.attFather(t,"action");if(p.attFather(t,"stop")&&p.stop(e),i&&"price_change"===i.attr&&m(i),i&&"form_submit"===i.attr&&g(i),i&&"charRobot"===i.attr){ChatBot.open();try{var a=y();Block.action({action:"help-robot-call",p2:5,p3:a.blockConfigId,p4:a.encryptPriceId})}catch(e){}}if(i&&"charSell"===i.attr){CallMeDialog();try{var a=y();Block.action({action:"help-passive-call-click",p2:5,p3:a.blockConfigId,p4:a.encryptPriceId})}catch(e){}}},m=function(){x()},g=function(e){C(e.node)},v=function(){b(),h(),x(),k()},b=function(){s=a.querySelector(".J_notice"),o=a.querySelector(".J_ruling"),r=a.querySelector(".J_nuit"),c=a.querySelector(".J_original"),l=a.querySelector(".J_form")},y=function(){var t=null,i=l.querySelector('input[type="radio"]:checked')&&l.querySelector('input[type="radio"]:checked').value;return i?(26!==e.templateId&&27!==e.templateId||e.priceCardList.forEach(function(a){a.priceList.forEach(function(a){a.priceId===+i&&(t={blockConfigId:e.blockConfigId,encryptTargetId:e.encryptTargetId,priceId:a.priceId,encryptPriceId:a.encryptPriceId,bzbPriceCount:a.bzbPriceCount,bzbUnitDesc:a.bzbUnitDesc,originPriceDesc:a.originPriceDesc,business:a.business?a.business:e.business,targetType:e.targetType}),a.select=a.priceId===+i})}),36===e.templateId&&e.cardList.forEach(function(e){e.priceList.forEach(function(a){a.priceId===+i&&(t={blockConfigId:e.blockConfigId,encryptTargetId:e.encryptTargetId,priceId:a.priceId,encryptPriceId:a.encryptPriceId,bzbPriceCount:a.bzbPriceCount,bzbUnitDesc:a.bzbUnitDesc,originPriceDesc:a.originPriceDesc,business:e.business,targetType:e.targetType}),a.select=a.priceId===+i})})):t={blockConfigId:e.blockConfigId,encryptTargetId:e.encryptTargetId,priceId:e.priceId,encryptPriceId:e.encryptPriceId,bzbPriceCount:e.bzbPriceCount,bzbUnitDesc:e.bzbUnitDesc,originPriceDesc:e.originPriceDesc,business:e.business,targetType:e.targetType?e.targetType:2,freeDesc:e.freeDesc?e.freeDesc:"限时免费"},t},w=function(i){return(!t.payComplete||"function"!=typeof t.payComplete||!t.payComplete(i))&&(30===e.templateId?(6===i.auditStatus||7===i.auditStatus?PositionCheckDialog.jobSave(t.jobId,function(){t.success&&"function"==typeof t.success&&t.success()}):Payment.success({article:i.dialog.title,text:i.dialog.content,confirm:function(){t.success&&"function"==typeof t.success&&t.success()},close:function(){t.success&&"function"==typeof t.success&&t.success()}}),!0):void $.get("/wapi/zpblock/order/bzbquery",{bzbParam:i.bzbParam}).success(function(e){if(0!==e.code)return $.toast({type:"error",content:e.message}),!1;6===e.zpData.auditStatus||7===e.zpData.auditStatus?PositionCheckDialog.jobSave(t.jobId||e.zpData.jobId,function(){t.success&&"function"==typeof t.success&&t.success()}):Payment.success({article:e.zpData.dialog.title,text:e.zpData.dialog.content,confirm:function(){t.success&&"function"==typeof t.success&&t.success()},close:function(){t.success&&"function"==typeof t.success&&t.success()}})}))},C=function(a){var s=y(),o=a.innerText;if(!s)return $.toast({type:"error",content:"数据发生了错误，请关闭弹窗，重新尝试"}),!1;if(n=!0,i&&i.close(),t.onConfirm&&"function"==typeof t.onConfirm&&t.onConfirm(s))return!1;var r={priceId:s.encryptPriceId,targetId:s.encryptTargetId?s.encryptTargetId:t.targetId,targetType:s.targetType?s.targetType:t.targetType,business:s.business?s.business:t.business};t.jobId&&(r.jobId=t.jobId);var c=OrderStore.push({blockPageData:e,option:t}),l={storeId:c.id,success:w,cancel:function(){t.payCancel&&"function"==typeof t.payCancel&&t.payCancel()},fail:function(){t.payFail&&"function"==typeof t.payFail&&t.payFail()}};Payment.purchase({data:r},l);var d=e.buttonList.filter(function(e){return e.text===o})[0],u=decodeURIComponent(d.url),p=getQueryParams(u);p.ba&&36!==e.templateId&&Block.action(Block.formatBA(p.ba))},x=function(){var e=y();if(!e)return!1;var t=e.bzbPriceCount,i=e.originPriceDesc;t||0===t?0===t?(o.innerText=e.freeDesc,r.innerText="",o.classList.add("free")):(o.innerText=t,r.innerText=e.bzbUnitDesc,o.classList.remove("free")):(o.innerText="---",o.classList.remove("free")),c.innerText=i||0===i?i:""},k=function(){function e(e,t){r&&clearInterval(r),r=setInterval(function(){var i=t-e.offsetTop;Math.abs(i)>Math.abs(-2)?e.style.top=e.offsetTop+-2+"px":(e.style.top=t+"px",clearInterval(r))},20)}function t(){i++,i>n.length&&(a.style.top=0,i=1),e(a,-i*o)}if(!s)return!1;var i=0,a=s.querySelector(".notice"),n=[].slice.call(a.querySelectorAll("li")),o=n[0].offsetHeight,r=null;a.appendChild(a.firstChild.cloneNode(!0)),d=setInterval(t,3e3)},T=function(e){if(!e)return!1;n=!1;i=$.dialog({bind:!0,title:"",closeLayer:!1,content:e,wrapClass:"business-block-wrap w-640",cancelText:"",confirmText:"",onOpen:function(e){a=e,v(),t.onOpen&&"function"==typeof t.onOpen&&t.onOpen(e)},onClose:function(){a&&p.remove(a,"click",f),d&&clearInterval(d),!n&&t.onClose&&"function"==typeof t.onClose&&t.onClose()}})},I=function(){var t=e.templateId,i='<form class="card-form J_form">';i+=26===t||36===t?'<div class="panel-card-wrap multiple">':'<div class="panel-card-wrap">';var a=!1;if(26===t||27===t){var n=e.priceCardList;n&&n.length>0&&(n.forEach(function(e){e.priceList.forEach(function(e){e.select&&(a=!0)})}),a||(n[0].priceList[0].select=!0),1===n.length&&(n[0].color=2),n.forEach(function(e){i+=u.multipleCard(e)}))}else if(36===t){var s=e.cardList;s&&s.length>0&&(s.forEach(function(e){e.priceList.forEach(function(e){e.select&&(a=!0)})}),a||(s[0].priceList[0].select=!0),s.forEach(function(e){i+=u.cheerCard(e)}))}else i+=u.singleCard();return i+="</div>",i+="</form>"},S=function(){var e='<div class="business-block-content">';e+=u.header(),e+='<div class="business-block-body"><div class="business-block-panel">',e+=I(),e+=u.panelDiscount(),e+=u.panelDescription(),e+="</div></div></div>",e+=u.footer(),T(e)};return{show:function(i,a){if(!i)return!1;t=a||{},e=i||{};var n=[26,27,28,29,30,36];return!!(i.templateId&&n.indexOf(i.templateId)>-1)&&(S(),!0)}}}(),OrderStore=function(){var e=[],t=function(t){var i={id:[(new Date).getTime(),Math.random().toString(16)].join("."),config:t};return e.push(i),i};return query=function(t){return e.find(function(e){return e.id===t})},{push:t,query:query}}(),ImFriends=function(){var friendListStore=function(url,option){function getFriendLis(e){var t=$.Deferred();return $.get(url,{slm:0,page:e},function(i){e>self.page&&(self.page=e),i.zpData&&i.zpData.length?friendStore[e]=i.zpData.map(function(e){return e.gid=e.uid,1===e.friendSource&&(e.uid=e.uid+1e8),e.loadTS=e.lastTS,e}):(hasMore=!1,friendStore[e]=[]),t.resolve(i)}),t}var self=this,curPage=1,hasMore=!0,friendList=[],agent=new EventManger,friendStore={0:{list:[]}};self.page=1,self.max=option.max||10,self.pageSize=option.pageSize||100,self.change=function(){},self.count=function(){},self.geekListLoaded=!1,self.unReadFriends=function(){},self.action=function(e){try{Block.action(e)}catch(e){}},self.sendKaEvent=function(e){try{_T.sendEvent(e)}catch(e){}},self.publishSyncData=function(e){agent.publish("IM_FRIENDS_SYNC",e)},self.subscribeSyncData=function(e){agent.subscribe("IM_FRIENDS_SYNC",e)},self.getTotalNewMsgCount=function(){return Chat.usersID&&Chat.usersID.length&&0!==Chat.usersID.length?Chat.usersID.map(function(e){if(1400400===e.uid||e.uid<=1e3)return 0;var t=Chat.getGeekById(e.gid,e.friendSource);return t&&t.newMsgCount&&8!==t.relationType&&!t.isFiltered?t.newMsgCount:0}).reduce(function(e,t){return e+t}):0},self.getFriendById=function(e,t,i){var a=Chat.getGeekById(e,t);if(a)return i(a);self.getUserInfo(e,t).then(function(e){return i(e)})},self.complete=function(e){self.geekListLoaded?e():agent.subscribe("IM_FRIENDS_COMPLETE",e)},self.getUserInfo=function(uid,source){var defer=$.Deferred();return $.get("/wapi/zpboss/h5/chat/geek.json",{uid:uid,geekSource:source},function(result){"string"==typeof e&&(result=eval("("+result+")")),1===result.zpData.status&&defer.resolve(result.zpData.data)}),defer},self.getFriendsByPage=function(e,t){return t(friendList[e-1]?friendList[e-1]:[])},self.setFriendById=function(){},self.setFriendList=function(e){friendList=[].concat(e),agent.publish("IM_FRIENDS_COMPLETE"),self.geekListLoaded=!0};var fetch=function(){getFriendLis(self.page).then(function(){self.page<self.max&&-1!==self.max&&hasMore?(self.page++,fetch()):(initialize=!0,agent.publish("IM_FRIENDS_COMPLETE"))})}};return new friendListStore("/wapi/zprelation/friend/getBossFriendList.json",{max:-1})}(),InstantMessage=function(uid){var self=this;self.uid=uid;var messageTypes={1:"text",2:"audio",3:"image",4:"action",6:"notice",7:"dialog",8:"jobDesc",9:"resume",10:"redEnvelope",11:"orderDetail",12:"hyperLink",13:"video",14:"interview",16:"articles",18:"jobShare",19:"resumeShare",20:"sticker",22:"chatShare",23:"interviewShare"},filterXss=function(e){return e?e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("&lt;phone&gt;","").replace("&lt;/phone&gt;","").replace("&lt;copy&gt;","").replace("&lt;/copy&gt;",""):e},dateFormat=function(e,t){var i={Z:"","M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"H+":e.getHours()>12?e.getHours()-12:e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t};self.isSelf=function(e){return self.selfVideo(e)?e.to.uid===self.uid:e.from.uid===self.uid},self.selfVideo=function(e){var t=!1;if(13===e.body.type){var i=JSON.parse(e.body.video.videoText||e.body.video.text);(1==i.status&&e.from.uid==self.uid||0==i.status&&e.to.uid==Chat.myselfData.uid)&&(t=!0)}return t},self.type=function(e){return messageTypes[e.body.type]},self.count=function(e){return 1===e.uncount||2===e.status||self.isSelf(e)?0:1},getStyle=function(e){var t={1:function(e){return 5===e.body.templateId?"item-system":""},3:function(e){return e.body.image?"item-image":""},4:function(e){var t=e.body.action||{};return 27===t.aid||32===t.aid||37===t.aid||75===t.aid?"item-system":""},7:function(e){var t=[0,1,2,11];return e.body.dialog?t.indexOf(e.body.dialog.type)>-1?"dialog":17===e.body.dialog.type?"item-image":"item-system":""},12:function(e){var t=e.body.hyperLink?e.body.hyperLink.hyperLinkType:"";return e.body.hyperLink&&1===e.body.hyperLink.hyperLinkType?"hyperLink":3===t?"item-system":""},14:function(e){return"interview"},16:function(e){return"item-question item-center"},
99:function(e){return"item-system"}};return t[e.body.type]?t[e.body.type](e):""},self.style=function(e){var t=self.isSelf(e)?"item-myself":"item-friend";if(3===e.status)return"item-system";var i=["item-question item-center","item-article item-center","item-system"],a=getStyle(e);if(""!==a)return i.indexOf(a)>-1?a:a+" "+t;var n={1:"",2:"",3:"item-system",4:"",5:"",6:"item-system",7:"",8:"",9:""}[e.body.templateId];return""!==n&&n?n:t},self.timeText=function(e){var t=e.time,i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate()),n=a-t;return i.getFullYear()!==new Date(t).getFullYear()&&i.getFullYear()-new Date(t).getFullYear()>1?i.getFullYear()-new Date(t).getFullYear()+"年前":n>864e5?dateFormat(new Date(t),"MM月dd日"):n>0?"昨天":dateFormat(new Date(t),"hh:mm")};var getText=function(e){var t={1:function(e){var t=e.body.text;return 5===e.body.templateId&&e.to.uid===self.uid?(t||"").replace(/\<\/?[a-zA-Z]+\>/g,"").replace(/<\/?phone>/g,"").replace(/<\/?copy>/g,"").replace(/&lt;phone&gt;/g,"").replace(/&lt;\/phone&gt;/g,"").replace(/&lt;copy&gt;/g,"").replace(/&lt;\/copy&gt;/g,""):t},2:function(){return e.body.text?e.body.text:"收到语音消息，请登录APP端查收"},4:function(e){var t=e.body.action||{};if(t&&75===t.aid){return(self.isSelf(e)?"你":e.from.name)+"撤回了一条消息"}return 27===t.aid?"请求交换联系方式已发送":32===t.aid?"请求交换微信已发送":void 0},7:function(e){return self.isSelf(e)?"":9===e.body.dialog.type?"面试时间到":-1===[0,1,2,9,11].indexOf(e.body.dialog.type)?"收到一条消息，请在手机上查看。":e.body.dialog.text},10:function(e){return self.isSelf(e)?"发出一个红包，请登录APP查看":"收到红包消息，请登录APP端查收"},12:function(e){var t=e.body.hyperLink?e.body.hyperLink.hyperLinkType:"";return 2===t&&(e.body.hyperLink.text.indexOf("面试提醒")>-1||e.body.hyperLink.text.indexOf("面试邀请")>-1)&&e.to.uid===self.uid?e.body.hyperLink.text:3===t&&e.to.uid===self.uid?e.body.hyperLink.text:1===t?"附件简历已经发送到您的邮箱":""},14:function(){return e.pushText.replace(e.from.name,"").replace("给你","")},16:function(e){var t=e.body.articles.length?e.body.articles[0]:{};return 3===e.type&&1===e.body.templateId?"收到一条消息，请在手机上查看。":8===t.templateId?"您的新招呼问题"+t.subTitle:""}};return t[e.body.type]?t[e.body.type](e):""};self.text=function(e){if(3===e.status){return(self.isSelf(e)?"你":e.from.name)+"撤回了一条消息"}return filterXss(getText(e))||""},self.formateTime=function(e){var t,i=new Date(e.time);return t=(new Date).getTime()-e.time>864e5?"MM-dd hh:mm":"Z hh:mm",dateFormat(i,t)},self.audio=function(e){return e.body.sound||null};var getImage=function(e){var t={3:function(e){if(e.body.image){var t=e.body.image,i=t.tinyImage.width,a=t.tinyImage.height;return i>300&&(a/=Math.floor(i/300),a=Math.floor(a)),{originUrl:t.originImage.url,originWidth:t.originImage.width,originHeight:t.originImage.height,url:t.tinyImage.url,width:t.tinyImage.width,height:t.tinyImage.height,calcWidth:i,calcHeight:a}}},20:function(e){if(e.body.sticker&&e.body.sticker.image){var t=e.body.sticker.image,i=t.originImage.width,a=t.originImage.height;return i>300&&(a/=Math.floor(i/300),a=Math.floor(a)),{originUrl:t.originImage.url,originWidth:t.originImage.width,originHeight:t.originImage.height,url:"",width:0,height:0,calcWidth:i,calcHeight:a}}}};return t[e.body.type]?t[e.body.type](e):null};self.image=function(e){return getImage(e)},self.action=function(e){return e.body.action||null},self.articles=function(e){return e.body.articles||[]},self.notify=function(e){return e.body.notify||null},self.dialog=function(e){return e.body.dialog||null},self.jobDesc=function(e){return e.body.jobDesc||null},self.resume=function(e){return e.body.resume||null},self.redEnvelope=function(e){return e.body.redEnvelope||null},self.orderDetail=function(e){return e.body.orderDetail||null},self.hyperLink=function(e){return e.body.hyperLink||null},self.video=function(e){return e.body.video||null},self.interview=function(e){return e.body.interview||null},self.jobShare=function(e){return e.body.jobShare||null},self.resumeShare=function(e){return e.body.resumeShare||null},self.sticker=function(e){return e.body.sticker||null},self.chatShare=function(e){return e.body.chatShare||null},self.interviewShare=function(e){return e.body.interviewShare||null},self.time=function(e){return e.time},self.isLocation=function(e){return 3===e.type&&7===e.body.type&&e.body.dialog&&17===e.body.dialog.type},self.needSetUnRead=function(e){return!(3===e.type&&1===e.body.type&&3===e.body.templateId||!self.count(e)||self.isSelf(e)||4===e.type||4===e.body.type&&1===e.body.templateId&&!e.pushText||!e.pushText&&!e.body.text||e.body&&[4,8,9].indexOf(e.body.type)>-1)};var getPushText=function(message){var strategyBase={2:function(e){return e.body.text?"":"收到语音消息，请登录APP端查收"},3:function(e){return e.body.image?"[图片]":""},4:function(message){var action=message.body.action||{};if(action&&75===action.aid){var __from=self.isSelf(message)?"你":message.from.name;return __from+"撤回了一条消息"}if(27===action.aid)return"请求交换联系方式已发送";if(32===action.aid)return"请求交换微信已发送";if(54===action.aid)return 0;if(37===action.aid){var email="";if(message.body.action.extend&&message.body.action.extend.indexOf("{")>-1){var extend=eval("("+message.body.action.extend+")");email=extend.resumeEmail}return"简历请求已发送。如果牛人同意，TA的简历将发送到"+email}return""},7:function(e){return 17===e.body.dialog.type?"您是否接受此工作地点？":self.isSelf(e)?0:9===e.body.dialog.type?"面试时间到":-1===[0,1,2,9,11].indexOf(e.body.dialog.type)?"收到一条消息，请在手机上查看。":e.body.dialog.text},13:function(e){return 1===e.body.video.videoType?"[语音通话]":2===e.body.video.videoType?"[视频通话]":""},14:function(e){return 3===e.type?e.pushText.replace(e.from.name,"").replace("给你",""):""},16:function(e){return""},20:function(e){return e.body.sticker?0!==e.body.sticker.packId&&e.body.sticker.name?"["+e.body.sticker.name+"]":"[动画表情]":""}};return strategyBase[message.body.type]?strategyBase[message.body.type](message):""};self.pushText=function(e){var t=e.body.text||e.pushText,i=getPushText(e);return 0===i?"":""!==i?i:null===filterXss(t)?"":filterXss(t)},self.status=function(e){return e.status},self.encryptedBody=function(e){return e.encryptedBody?e.encryptedBody:""},self.mid=function(e){return e.mid},self.fromSource=function(e){return e.from.source},self.toSource=function(e){return e.to.source},self.fromId=function(e){return e.from.uid},self.toId=function(e){return e.to.uid},self.messageType=function(e){return e.type},self.fromName=function(e){return e.from.name||""},self.fromAvatar=function(e){return e.from.avatar||""},self.received=function(e){return e.received},self.offline=function(e){return e.offline},self.formate=function(e){return{isLocation:self.isLocation(e),messageType:self.messageType(e),toId:self.toId(e),fromId:self.fromId(e),toSource:self.toSource(e),fromSource:self.fromSource(e),fromName:self.fromName(e),fromAvatar:self.fromAvatar(e),received:self.received(e),offline:self.offline(e),mid:self.mid(e),type:self.type(e),count:self.count(e),style:self.style(e),text:self.text(e),isSelf:self.isSelf(e),selfVideo:self.selfVideo(e),needSetUnRead:self.needSetUnRead(e),pushText:self.pushText(e),timeText:self.timeText(e),formateTime:self.formateTime(e),time:self.time(e),encryptedBody:self.encryptedBody(e),status:self.status(e),image:self.image(e),video:self.video(e),audio:self.audio(e),action:self.action(e),articles:self.articles(e),notify:self.notify(e),dialog:self.dialog(e),jobDesc:self.jobDesc(e),resume:self.resume(e),redEnvelope:self.redEnvelope(e),orderDetail:self.orderDetail(e),interview:self.interview(e),hyperLink:self.hyperLink(e),jobShare:self.jobShare(e),resumeShare:self.resumeShare(e),sticker:self.sticker(e),chatShare:self.chatShare(e),interviewShare:self.interviewShare(e)}}},BlockSence=function(){return{include:function(e,t){return!!e&&(e.template&&!e.templateId&&(e.templateId=e.template),e.ba&&Block.action(Block.formatBA(e.ba)),!!commonBusinessBlock.show(e,t)||(!!vipBusinessBlock.show(e,t)||(!!PositionRiseBag.include(e,t)||(!!PositionShop.include(e,t)||(14==e.templateId||13==e.templateId||14==e.template||13==e.template)&&(Commercial.block(e,function(i,a){var n=$.extend({isPurchase:!0,jobId:i.jobId||"",business:i.business,targetType:i.targetType},a),s={jobId:n.jobId,priceId:n.encryptPriceId,targetId:i.encryptTargetId,business:n.business||"",targetType:void 0!=e.targetType?e.targetType:n.targetType},o=$.extend({item:n,blockPageData:e},t);window.top.Purchase.commercial(s,o)}),!0)))))}}}(),PositionRiseBag=function(){function e(){var e=a.header(),s=a.discount(),o=e+a.content()+s;$.dialog({bind:!0,title:"",closeLayer:!1,content:o,wrapClass:"flex-dialog-wrap position-rise-bag",cancelText:"",confirmText:"立即购买",onOpen:function(e){$(e).on("click",".item-card",function(){$(e).find(".selected").removeClass("selected"),$(this).addClass("selected")}),i.ba&&Block.action(Block.formatBA(i.ba))},onConfirm:function(e){var a=$(e).find(".selected").index(),s=i.cardList[a],o={data:{priceId:s.priceList[0].encryptPriceId,targetId:t.encryptTargetId?t.encryptTargetId:s.encryptTargetId,targetType:s.targetType,business:s.business},amount:s.priceList[0].beanCount},r={success:n};Payment.purchase(o,r),this.close();var c=i.buttonList.length-1,l=i.buttonList[c],d=getQueryParams(l.url||"");d.ba&&Block.action(Block.formatBA(d.ba))},onClose:function(){}})}var t={},i={},a={header:function(){return Utemplate('<div class="position-top"><h4><%this.shortDesc.name%></h4><p class="description"><%this.hlShortDesc.name%></p></div>',i)},discount:function(){return Utemplate('<%if(this.discountList && this.discountList.length){%><div class="item-discount-list"><p>优惠</p><ul><%for(var i=0;i<this.discountList.length;i++){%><li><i><%this.discountList[i].discountTag%></i><%this.discountList[i].discount.name%></li><%}%></ul></div><%}%><%if(this.bottomTipList){%><%for(var j=0;j<this.bottomTipList.length;j++){%><p class="item-bottom-desc"><%this.bottomTipList[j].name%></p><%}%><%}%>',i)},card:function(e){return Utemplate('<div class="item-card <%if(this.priceList[0].select){%>selected<%}%> "><dl><dt><%this.title%></dt><%for(var i=0;i<this.chatDescList.length;i++){%><dd><span class="right"><% this.chatDescList[i][ Object.keys(this.chatDescList[i])[0] ]%></span><span class="key"><% Object.keys(this.chatDescList[i])[0] %></span></dd><%}%></dl><div class="item-price"><span class="item-check"><i class="iboss-checked-solid"></i></span><span class="bean-count"><%this.priceList[0].beanCount%></span><%this.priceList[0].unitDesc%></div></div>',e)},content:function(){var e='<div class="item-list clearfix item-combo">';return e+=i.cardList.map(function(e){return a.card(e)}).join(""),e+="</div>"},footer:function(){}},n=function(e){if(t.success)return t.success(e);$.get("/wapi/zpblock/order/bzbquery",{bzbParam:e.bzbParam}).success(function(e){0==e.code&&Payment.success({article:e.zpData.dialog.title,text:e.zpData.dialog.content,confirm:function(){t.complete&&t.complete()},close:function(){t.close&&t.close()}})})};return{include:function(a,n){return 36===a.templateId&&(t=$.extend({},n||{}),i=$.extend({},a),e(),!0)}}}(),GeekBombshell=function(){var e=function(){},t=function(e,t){var i=this;i.get={},i.post={},i.position={};var a={},n={},s=[];this.commend=function(e){s=e},this.select=function(e,a){$.get("/wapi/zpitem/web/geekBomb/detail.json",{encryptJobId:e,encryptItemId:t.itemId},function(e){return i.position=e.zpData,e.zpData.experienceTip?i.experienceTip=e.zpData.experienceTip:i.experienceTip=null,a(i.position)})},this.getSelected=function(){return i.position},this.getCommend=function(){return s};var o=function(e){$.toast({content:e,type:"error"}),$("#toast").addClass("slideUp"),setTimeout(function(){$("#toast").remove()},2e3)};this.get.job=function(){var i=$.Deferred(),n="/wapi/zpitem/web/geekBomb/geekBombJobList/"+t.itemId+".json",s="buy"===e?{}:{encryptUserItemId:t.itemId};return $.get(n,s).success(function(e){0==e.code&&(i.resolve(e.zpData.jobList),a=e.zpData)}).error(function(){$.toast({type:"error",content:"加载职位列表失败"})}),i},this.post.buy=function(){var a=$.Deferred(),o=function(t){__conversion("prop_geekbomb_"+e+"_"+n.encryptId),a.resolve()},r={url:"/boss/item/pay/geekbomb.json",description:"购买道具：「牛人炸弹」- 100人",amount:i.position.price,data:{source:t.source,Degree:0==i.position.job.expandDegreeCode?"":i.position.job.expandDegreeCode,WorkYear:0==i.position.job.expandLowYear?"":i.position.job.expandLowYear+","+i.position.job.expandHighYear,encryptTargetId:i.position.job.encryptId,positionCode:s.join(",")},itemId:t.itemId,success:o},c={success:o};return window.top.Payment.purchase(r,c),a},this.post.modify=function(e){var t=$.Deferred();return $.post("/boss/item/geekbomb/update/job.json",e,function(e){1==e.rescode?t.resolve():$.toast({type:"error",content:e.message})}),t},this.post.consume=function(){var a=$.Deferred(),n=i.position.job.encryptId?i.position.job:i.getSelected();return $.post("/wapi/zpitem/web/geekBomb/useGeekBomb/"+n.encryptId+".json",{encryptUserItemId:t.encryptUserItemId,positionCodeStr:s.join(",")}).success(function(t){0==t.code?(a.resolve(),__conversion("prop_geekbomb_"+e+"_"+n.encryptId)):o(t.message)}),a},i.freeVipPreorder=function(){var e=$.Deferred();if(!i.experienceTip)return!1;var t={priceId:i.experienceTip.priceId,targetId:i.experienceTip.targetId,targetType:i.experienceTip.targetType,bz:i.experienceTip.bz,sf:i.experienceTip.sf};return $.post("/wapi/zpblock/order/preorder",t,function(t){var i=t.code,a=t.zpData.status;0===i?e.resolve(a):$.toast({type:"error",content:t.message})}),e}},i=function(){var t=this;this.toggleDisable=function(e){e?$(".prop-consume .btn-sure").addClass("disabled"):$(".prop-consume .btn-sure").removeClass("disabled")},t.message={10:"审核中",15:"即将过期",30:"不可用",35:"不可用",40:"即将过期"},this.close=function(){t.wrap.fadeOut("normal",function(){t.wrap.remove()})},this.consume=function(){},this.html=function(e){$(".prop-bombshell-box").html(PropTemplate.bomPosition(e)),t.position=e,t.addEvent(),t.setCommend(),t.setTotal(e)},this.setCommend=function(){var i=[],a=0,n=t.position.canBombGeekCount;$.each($(".prop-bombshell-recommend dd.selected"),function(e,s){var o=$(s).index(),r=t.position.bombPositionList[o].bombCount,c=t.position.canBombGeekCount>0?t.position.canBombGeekCount:1;i.push(o),a+=Math.floor(100*parseInt(r)/parseInt(c)),n+=parseInt(r)}),e.setRecommend(i),$(".J_recommendImprove").text("效果提升"+a+"%"),n<50?$(".prop-bombshell .prop-error").show():$(".prop-bombshell .prop-error").hide(),t.toggleDisable(n<t.position.bombRange)},this.addEvent=function(){$(".prop-bombshell-recommend dd").on("click",function(){$(this).toggleClass("selected"),t.setCommend()}),$(".prop-consume").on("click",".J_robot",function(){ChatBot.open();try{Block.action({action:"help-robot-call",p2:3,p3:t.position.encryptItemId})}catch(e){}}),$(".prop-consume").on("click",".J_call",function(){CallMeDialog();try{Block.action({action:"help-passive-call-click",p2:3,p3:t.position.encryptItemId})}catch(e){}})}},a=function(t){var a={};return a.buy=function(){var t=this;i.call(this,arguments),this.setTotal=function(t){e.getSelectionPrice().then(function(e){if(0!==e.status)return!1;if($(".prop-consume .btns").find(".prop-total").remove(),2==t.vipPriceStatus){var i='<p class="prop-total multi-row prop-total-vip">￥<em>'+e.price+'</em><i class="vip-discount-sign"></i><br><span class="gray">原价'+e.originalPrice+"</span></p>";$(".prop-consume .btns").prepend(i)}else $(".prop-consume .btns").prepend('<p class="prop-total">￥<em>'+e.price+'</em><i class="vip-discount-sign"></i></p>');var a=e.discountList,n=$(".J_discount_wrap");a&&a.length>0?n.html(PropTemplate.discount(a)):n.empty()})},this.render=function(i){ConsumeConfirm({title:"购买牛人炸弹",content:PropTemplate.bombshell(),confirmText:"购买并使用",wrapClass:"prop-bombshell",open:function(e){t.wrap=e,$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(i,t.message)),DropDown.init(e),t.toggleDisable(!0),$(e).on("click",".extension-item",function(){$(this).find("i").toggleClass("selected")})},confirm:function(i){if($(".prop-consume .btn-sure").hasClass("disabled"))return!1;var a=t.position.job;if($(i).find(".extension-item .selected").length){var n={jobId:a.encryptId};"degree"==$(i).find(".extension-item .selected").attr("data-type")?n.degree=a.expandDegreeCode:(n.lowSalary=a.expandLowSalary,n.highSalary=a.expandHighSalary),e.buy(n)}else e.buy({});if($(".prop-consume .btn-sure").addClass("disabled"),$(i).find(".extension-item").length){var s=$(i).find(".extension-item i"),o="prop_expend_"+s.type+(s.hasClass("selected")?"checked":"uncheck");window.top.__conversion(o)}$(i).remove()}})}},a.use=function(){var t=this;i.call(this,arguments),this.setTotal=function(){},this.render=function(i,a){ConsumeConfirm({title:"使用牛人炸弹",content:PropTemplate.bombshell(),confirmText:"使用",wrapClass:"prop-bombshell",open:function(e){t.wrap=e,$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(i,t.message)),DropDown.init(e),t.toggleDisable(!0),$(e).on("click",".extension-item",function(){$(this).find("i").toggleClass("selected")})},confirm:function(i){if($(".prop-consume .btn-sure").hasClass("disabled"))return!1;if($(i).find(".extension-item .selected").length){var a={jobId:t.position.encryptId};"degree"==$(i).find(".extension-item .selected").attr("data-type")?a.degree=t.position.expandDegree:(a.lowSalary=t.position.expandLowSalary,a.highSalary=t.position.expandHighSalary),e.consume(a)}else e.consume({});$(".prop-consume .btn-sure").addClass("disabled")}}),t.fromListEl=a}},new a[t]},n=function(e,i,n){var s=new t(e,i),o=new a(e),r=function(e){var t=s.getSelected(),i=$(".J_stickPosition input[type=hidden]").val();if(0!=t.expandDegree||0!=t.expandHighYear||0!=t.expandLowYear){var a=0==t.expandDegree?"":"degree="+t.expandDegreeName,n=0==t.expandLowYear?"":"workyear="+t.expandYearName,o=s.getCommend(),r=o.length>0?"positionStr="+o.join(","):"",c=[a,n,r].filter(function(e){return""!=e});__conversion("geekbomb_expand_"+i+"_"+c.join("_"))}},c=function(e,t){var i=t||$(".J_stickPosition input[type=hidden]").val();$.toast({type:"loading",content:"正在加载"}),s.select(i,function(e){if(o.html(e),o.toggleDisable(!1),s.experienceTip){var t=$('<div class="experience-tip J_experience"><span class="experience-text J_text">'+s.experienceTip.desc+'</span><a href="javascript:;" class="experience-btn J_experience_buy">'+s.experienceTip.buttonText+"</a></div>");$(".dialog-title .title").find(".J_experience").off("click","**").remove(),$(".dialog-title .title").append(t),t.on("click",".J_experience_buy",function(){s.freeVipPreorder().then(function(e){1===e?($.toast({type:"success",content:"恭喜您，领取成功！"}),t.find(".J_text").text("已领取 VIP3天体验，抓紧享受道具折扣吧"),t.find(".J_experience_buy").remove(),setTimeout(function(){$(".J_stickPosition").find(".dropdown-menu li.cur").eq(0).trigger("dropdown.selected")},1e3)):$.toast({type:"error",content:"领取失败，请稍后再试！"})})})}setTimeout(function(){$("#toast").remove()},400)}),window.top.__conversion("geekbomb_job_"+i)};s.get.job().then(function(e){GeekBombshell.status="fulfilled",o.render(e,n),$(".J_stickPosition").on("dropdown.selected",c);var t=$(".J_stickPosition").find(".dropdown-menu li").not(".disabled");t.length&&t.eq(0).click()}),GeekBombshell.status="pending",this.setRecommend=function(e){var t=s.getSelected(),i=[];$.each(e,function(e,a){i.push(t.bombPositionList[a].position)}),s.commend(i)},this.getSelectionPrice=function(){var e=$.Deferred(),t={Degree:0==s.position.job.expandDegreeCode?"":s.position.job.expandDegreeCode,WorkYear:0==s.position.job.expandLowYear?"":s.position.job.expandLowYear+","+s.position.job.expandHighYear,encryptTargetId:s.position.job.encryptId,positionCode:s.getCommend().join(",")},a="/wapi/zpitem/web/itemMall/getDiscountInfo/"+i.itemId;return $.post(a,{paramsJson:encodeURIComponent(JSON.stringify(t))},function(t){var i=t.code,a=t.zpData.itemDiscountInfo;0===i?e.resolve(a):$.toast({type:"error",content:t.message})}),e},this.buy=function(e){r();var t=function(){s.post.buy().then(function(){o.close(),setTimeout(function(){window.top.Payment.success({article:"使用成功",text:"您可以在「我的道具」中查看使用效果",close:function(){i.success&&i.success()}})},50)}),window.top.__conversion("geekbomb_pay_"+$(".J_stickPosition input[type=hidden]").val())};e.jobId?s.post.modify(e).then(t):t()},this.consume=function(e){r();var t=function(){s.post.consume().then(function(){o.close(),o.consume(),setTimeout(function(){window.top.Payment.success({article:"使用成功",text:"您可以在「我的道具」中查看使用效果",close:function(){i.success&&i.success()}})},50)})};e.jobId?s.post.modify(e).then(t):t(),window.top.__conversion("geekbomb_pay_"+$(".J_stickPosition input[type=hidden]").val())},__conversion("prop_geekbomb_"+e)};return{status:"fulfilled",factory:function(t,i){i.itemId?e=new n(t,i):$.get("/wapi/zpitem/web/item/get?itemType="+i.itemType,function(a){i.itemId=a.zpData[i.itemType],e=new n(t,i)})}}}(),GeekBoomPro=function(){var e=function(){var e={header:function(e){return Utemplate('<header class="prop-header"><h3 class="title"><% this.title %><span class="title-bar">Pro</span></h3></header>',e)},footer:function(e){return Utemplate('<footer class="business-prop-footer"><div class="J_discount"></div><div class="footer-bottom"><div class="price-box J_price_box"></div><div class="btn_box"><a href="javascript:;" class="btn btn-orange disabled J_submit" action="submit"><% this.bottonText %></a></div></div></footer>',e)},position:function(){return Utemplate('<div class="dropdown-wrap J_stickPosition"><span class="dropdown-select"><i class="icon-select-arrow"></i><input type="text" placeholder="未选择" class="ipt" readonly><p class="input-mask text-placeholder">未选择</p><input type="hidden"></span><div class="dropdown-menu"><ul></ul></div></div>')},positionDetail:function(e){return Utemplate('<ul class="prop-position-detail"><li class="name" title="<%this.jobName%>"><i class="iboss-qiwangzhiwei"></i><%this.jobName%></li><li class="site" title="<%this.locationName%>"><i class="iboss-dizhi"></i><%this.locationName%></li><%if(this.expandDegreeDesc) {%><li><i class="iboss-jiaoyujingyan"></i>最低学历扩大至<em><%this.expandDegreeDesc%></em></li><%}else{%><li><i class="iboss-jiaoyujingyan"></i><%this.degreeName%></li><%}%><%if(this.expandWorkYearDesc) {%><li><i class="iboss-gongzuojingyan"></i>经验扩大至<em><%this.expandWorkYearDesc%></em></li><%}else{%><li><i class="iboss-gongzuojingyan"></i><%this.experienceName%></li><%}%></ul>',e)},positionSync:function(e){return Utemplate('<label class="prop-position-sync" for="positionSync"><span class="checkbox-wrap"><input type="checkbox" name="positionSync" id="positionSync" value="<%this.expandDegreeCode%>" checked><i class="checkbox-replacer"></i></span><span class="position-sync-text">同步修改职位中的最低学历为<em><%this.expandDegreeDesc%></em></span></label>',e)},positionRelative:function(e){return Utemplate('<%for(var i=0;i<this.bombPositionList.length;i++) {%><li class="<%if(this.bombPositionList[i].selected){%>cur<%}%>" data-value="<%this.bombPositionList[i].position%>" action="change_job_relative"><%this.bombPositionList[i].positionName%></li><%}%>',{bombPositionList:e})},inviteType:function(e){return Utemplate('<div class="basic-check-box"><p class="title">批量向牛人询问</p><ul class="basic-check-list J_invite_type"><%for(var i=0;i<this.inviteTypeList.length;i++) {%><li class="<%if(this.inviteTypeList[i].selected) {%>cur<%}%>" data-value="<%this.inviteTypeList[i].code%>" action="change_invite_type"><%this.inviteTypeList[i].name%></li><%}%></ul></div>',{inviteTypeList:e})},inviteCount:function(e){return Utemplate('<div class="basic-check-box"><p class="title">沟通人数</p><ul class="basic-check-list J_invite_count"><%for(var i=0;i<this.inviteCountList.length;i++) {%><li class="<%if(this.inviteCountList[i].selected) {%>cur<%}%> <%if(!this.inviteCountList[i].available) {%>disabled<%}%>" data-value="<%this.inviteCountList[i].code%>" action="change_invite_count"><%this.inviteCountList[i].name%><%if(!(this.inviteCountList[i].code <= 100) && this.inviteCountList[i].available){%><span class="discount"></span><%}%></li><%}%></ul></div>',{inviteCountList:e})},heightFilterCell:function(e,t,i,a){return Utemplate('<div class="superior-check-box"><p class="title"><%this.title%></p><%if(this.description) {%><p class="description"><%this.description%></p><%}%><ul class="superior-check-list <%this.className%>"><%for(var i=0;i<this.list.length;i++) {%><li class="<%if(this.list[i].selected) {%>cur<%}%> <%if(!this.list[i].available) {%>disabled<%}%>" data-value="<%this.list[i].code%>" action="change_tags"><%this.list[i].name%></li><%}%></ul></div>',{list:e,title:t,className:i,description:a})},discount:function(e){return Utemplate('<div class="prop-discount"><div class="discount-title">享受优惠：</div><ul class="discount-list"><%for(var i=0;i<this.list.length;i++) {%><li><i class="discount-icon"></i><%this.list[i]%></li><%}%></ul></div>',{list:e})},price:function(e){return Utemplate('<p class="ruling-wrap <%if(this.vipPriceStatus === 2) {%>vip-status<%}%>"><span class="ruling">￥<%this.price || this.price === 0 ? this.price : "---"%></span><span class="vip"></span></p><%if(this.originalPrice && this.price !== this.originalPrice){%><p class="original">原价￥<%this.originalPrice%></p><%}%>',e)}};this.positionDetail=function(t){return e.positionDetail(t)},this.positionSync=function(t){return e.positionSync(t)},this.positionRelative=function(){return'<div class="prop-position-relative J_position_relative"><div class="position-relative-label">相关职位</div><ul class="position-relative-list J_job_list"></ul><a href="javascript:;" class="position-relative-open J_job_open" action="open_job"><i class="iboss-down"></i></a></div>'},this.positionRelativeList=function(t){return e.positionRelative(t)},this.getFilterCard=function(){var e='<div class="prop-filter-card J_tab_wrap">';return e+='<nav class="prop-filter-tab">',e+='<a href="javascript:;" class="tab-cell cur" action="tab_change" data-index="0">基础选项</a>',e+='<a href="javascript:;" class="tab-cell" action="tab_change" data-index="1">高级选项</a>',e+="</nav>",e+='<div class="prop-filter-content">',e+='<div class="tab-cell J_filter_basic" style="display:block;"></div>',e+='<div class="tab-cell J_filter_superior"></div>',e+="</div>",e+="</div>"},this.getFilterCardBasic=function(t){var i="";return t.inviteTypeList&&t.inviteTypeList.length&&(i+=e.inviteType(t.inviteTypeList)),t.inviteCountList&&t.inviteCountList.length&&(i+=e.inviteCount(t.inviteCountList)),i},this.getFilterCardSuperior=function(t){var i="";return(t.schoolTags&&t.schoolTags.length||t.comTags&&t.comTags.length)&&(i+='<div class="superior-check-wrap">',t.schoolTags&&t.schoolTags.length&&(i+=e.heightFilterCell(t.schoolTags,"牛人毕业院校","J_school")),t.comTags&&t.comTags.length&&(i+=e.heightFilterCell(t.comTags,"名企优先","J_company","根据牛人对企业的搜索热度排序")),i+="</div>"),t.ageTags&&t.ageTags.length&&(i+='<div class="superior-check-wrap">',i+=e.heightFilterCell(t.ageTags,"年龄区间","J_age"),i+="</div>"),t.distanceTags&&t.distanceTags.length&&(i+='<div class="superior-check-wrap">',i+=e.heightFilterCell(t.distanceTags,"距离范围","J_distance"),i+="</div>"),i},this.getDiscount=function(t){return e.discount(t)},this.getPriceDom=function(t){return e.price(t)},this.getDialogSubject=function(t){var i={title:"buy"===t?"购买牛人炸弹":"使用牛人炸弹"},a={bottonText:"批量沟通"},n='<section class="business-prop-body">';return n+=e.header(i),n+='<div class="prop-position-selecter">',n+='<label class="position-selecter-label">选择职位<span class="position-tips J_position_title"></span></label>',n+='<div class="position-selecter">',n+=e.position(),n+="</div>",n+="</div>",n+='<div class="J_switch_wrap"></div>',n+="</section>",n+=e.footer(a)}},t=function(t,i){var a=this;e.call(this),this.action=t,this.option=i,this.dialogInstance=null,this.dialogConfirmStatus=!1,this.wrap=null,this.J_switch_wrap=null,this.J_position_relative=null,this.J_job_list=null,this.J_job_open=null,this.J_tab_wrap=null,this.J_filter_basic=null,this.J_filter_superior=null,this.J_invite_type=null,this.J_invite_count=null,this.J_school=null,this.J_company=null,this.J_age=null,this.J_distance=null,this.J_discount=null,this.J_price_box=null,this.J_submit=null,this.switchJob=function(e){var t="";t+=this.positionDetail(e.jobInfo),e.jobInfo.expandDegreeDesc&&(t+=this.positionSync(e.jobInfo)),e.bombPositionList&&e.bombPositionList.length>0&&(t+=this.positionRelative()),t+=this.getFilterCard(),t+='<p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" action="charRobot">在线咨询</a>或<a href="javascript:;" action="charSell">请销售顾问联系我</a></p>',this.J_switch_wrap.innerHTML=t,e.jobInfo.expandDegreeDesc||e.jobInfo.expandWorkYearDesc?this.wrap.querySelector(".J_position_title").innerText="匹配牛人较少，扩展相关职位":this.wrap.querySelector(".J_position_title").innerText="",this.J_position_relative=this.wrap.querySelector(".J_position_relative"),this.J_job_list=this.wrap.querySelector(".J_job_list"),this.J_job_open=this.wrap.querySelector(".J_job_open"),this.J_tab_wrap=this.wrap.querySelector(".J_tab_wrap"),this.J_filter_basic=this.wrap.querySelector(".J_filter_basic"),this.J_filter_superior=this.wrap.querySelector(".J_filter_superior"),this.renderCheckbox(e)},this.renderCheckbox=function(e){if(e.bombPositionList&&e.bombPositionList.length>0&&(this.J_job_list.innerHTML=this.positionRelativeList(e.bombPositionList)),this.J_position_relative){this.J_job_list.offsetHeight>this.J_position_relative.offsetHeight&&(this.J_job_open.style.display="block")}this.J_filter_basic.innerHTML=this.getFilterCardBasic(e),this.J_filter_superior.innerHTML=this.getFilterCardSuperior(e),this.J_invite_type=this.wrap.querySelector(".J_invite_type"),this.J_invite_count=this.wrap.querySelector(".J_invite_count"),this.J_school=this.wrap.querySelector(".J_school"),this.J_company=this.wrap.querySelector(".J_company"),this.J_age=this.wrap.querySelector(".J_age"),this.J_distance=this.wrap.querySelector(".J_distance")},this.renderFooter=function(e){var t=e.discountList;t&&t.length>0&&(this.J_discount.innerHTML=this.getDiscount(t)),this.J_price_box.innerHTML=this.getPriceDom(e),this.J_submit.classList.remove("disabled")},this.render=function(e){var t=this.getDialogSubject(this.action);this.dialogInstance=$.dialog({bind:!0,title:"",closeLayer:!1,content:t,wrapClass:"business-prop-wrap",cancelText:"",confirmText:"",onOpen:function(t){a.wrap=t,a.J_switch_wrap=t.querySelector(".J_switch_wrap"),a.J_discount=t.querySelector(".J_discount"),a.J_price_box=t.querySelector(".J_price_box"),a.J_submit=t.querySelector(".J_submit"),$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(e)),$(".J_showUnable").on("click",function(){$(this).parents("ul").toggleClass("unfolded")}),DropDown.init($(t)),a.option.onOpen&&"function"==typeof a.option.onOpen&&a.option.onOpen(t)},onClose:function(){!a.dialogConfirmStatus&&a.option.onClose&&"function"==typeof a.option.onClose&&a.option.onClose()}})}};t.prototype=new e;var i=function(e,t){var i=this;this.action=e,this.option=t,this.vipPriceStatus=null;var a={encryptId:null,id:null,inviteType:null,inviteCount:null,bombPositions:null,school:null,company:null,age:null,distance:null,source:null};this.setParams=function(e,t){if("encryptId"===e)for(var i in a)"source"!==i&&a.hasOwnProperty(i)&&(a[i]=null);a[e]=t},this.getParams=function(){return this.deepCopy(a)},this.deepCopy=function(e){var t=Array.isArray(e)?[]:{};for(var a in e)e.hasOwnProperty(a)&&("object"==typeof e[a]&&null!==e[a]?t[a]=i.deepCopy(e[a]):t[a]=e[a]);return t},this.getJobList=function(){var e=$.Deferred();return $.get("/wapi/zpitem/web/geekBombPro/getJobList.json").success(function(t){0==t.code?e.resolve(t.zpData):$.toast({type:"error",content:t.message})}).error(function(){$.toast({type:"error",content:"加载职位列表失败"})}),e},this.getGeekBombPro=function(e){var t=$.Deferred(),a=this.paramsDetailFormat(e);return $.get("/wapi/zpitem/web/geekBombPro/toConfirm.json",a).success(function(e){if(0==e.code){var a=e.zpData;i.vipPriceStatus=a.vipPriceStatus,t.resolve(a)}else $.toast({type:"error",content:e.message})}).error(function(){$.toast({type:"error",content:"加载道具详情失败"})}),t},this.getSelectionPrice=function(e){
var t=$.Deferred(),i="/wapi/zpitem/web/itemMall/getDiscountInfo/"+this.option.itemId,a=encodeURIComponent(JSON.stringify(this.paramsFormat(e)));return $.post(i,{paramsJson:a},function(e){var i=e.code,a=e.zpData.itemDiscountInfo;0===i?t.resolve(a):$.toast({type:"error",content:e.message})}),t},this.buy=function(e){var t=this.paramsFormat(a),n={description:"购买道具：「牛人炸弹Pro」",data:t,itemId:this.option.itemId},s={success:e,cancel:function(){i.option.payCancel&&"function"==typeof i.option.payCancel&&i.option.payCancel()},fail:function(){i.option.payFail&&"function"==typeof i.option.payFail&&i.option.payFail()}};window.top.Payment.purchase(n,s)},this.updateDegree=function(e){var t=$.Deferred(),i="/wapi/zpitem/geekBombV2/updateDegree/"+a.encryptId+".json";return $.post(i,{degreeCode:e},function(e){0===e.code?t.resolve(e.zpData.status):$.toast({type:"error",content:e.message})}),t},this.paramsDetailFormat=function(e){var t={},i=[];return e.encryptId&&(t.encryptId=e.encryptId),e.inviteType&&(t.inviteType=e.inviteType),e.inviteCount&&(t.inviteCount=e.inviteCount),e.bombPositions&&e.bombPositions.length>0&&(t.bombPositions=e.bombPositions.join(",")),e.source&&(t.source=e.source),e.school&&i.push(e.school),e.company&&i.push(e.company),e.age&&i.push(e.age),e.distance&&i.push(e.distance),i.length>0&&(t.tags=i.join(",")),t},this.paramsFormat=function(e){var t={},i=[];return e.id&&(t.targetId=e.id),e.inviteType&&(t.inviteType=e.inviteType),e.inviteCount&&(t.inviteCount=e.inviteCount),e.bombPositions&&e.bombPositions.length>0&&(t.Positions=e.bombPositions.join(",")),e.source&&(t.source=e.source),e.school&&i.push(e.school),e.company&&i.push(e.company),e.age&&i.push(e.age),e.distance&&i.push(e.distance),i.length>0&&(t.filterTags=i.join(",")),t}},a=function(e,a){var n=new i(e,a),s=new t(e,a);a.source&&n.setParams("source",a.source),$.toast({type:"loading",content:"正在加载"}),n.getJobList().then(function(e){s.render(e.jobList),$(".J_stickPosition").on("dropdown.selected",o);var t=$(".J_stickPosition").find(".dropdown-menu li").not(".disabled");t.length&&t.eq(0).click(),l(),$("#toast").remove()});var o=function(e,t){var i=t||$(".J_stickPosition input[type=hidden]").val();if(!i)return $.toast({type:"error",content:"数据发生错误了"}),!1;$.toast({type:"loading",content:"正在加载"}),n.getGeekBombPro({encryptId:i}).then(function(e){$("#toast").remove(),0===e.status?(n.setParams("encryptId",e.jobInfo.encryptId),n.setParams("id",e.jobInfo.id),e.bombPositionList&&e.bombPositionList.length>0&&e.bombPositionList.forEach(function(e){e.selected=1}),s.switchJob(e),s.wrap.querySelector(".business-prop-body").classList.add("scroll-wrap"),r(),c()):f(e.status)})},r=function(){if(s.J_job_list){var e=[];$(s.J_job_list).children("li").each(function(){$(this).hasClass("cur")&&e.push($(this).data("value"))}),n.setParams("bombPositions",e)}if(s.J_invite_type){var t="";$(s.J_invite_type).children("li").each(function(){if($(this).hasClass("cur"))return t=$(this).data("value"),!1}),n.setParams("inviteType",t)}if(s.J_invite_count){var i="";$(s.J_invite_count).children("li").each(function(){if($(this).hasClass("cur"))return i=$(this).data("value"),!1}),n.setParams("inviteCount",i)}if(s.J_school){var a="";$(s.J_school).children("li").each(function(){if($(this).hasClass("cur"))return a=$(this).data("value"),!1}),n.setParams("school",a)}if(s.J_company){var a="";$(s.J_company).children("li").each(function(){if($(this).hasClass("cur"))return a=$(this).data("value"),!1}),n.setParams("company",a)}if(s.J_age){var a="";$(s.J_age).children("li").each(function(){if($(this).hasClass("cur"))return a=$(this).data("value"),!1}),n.setParams("age",a)}if(s.J_distance){var a="";$(s.J_distance).children("li").each(function(){if($(this).hasClass("cur"))return a=$(this).data("value"),!1}),n.setParams("distance",a)}},c=function(){if(!a.itemId)return!1;var e=n.getParams();n.getSelectionPrice(e).then(function(e){0===e.status?(e.vipPriceStatus=n.vipPriceStatus,s.renderFooter(e)):(s.J_submit.classList.add("disabled"),$.toast({type:"error",content:"获取价格失败了"}))})},l=function(){var e={add:document.addEventListener?function(e,t,i,a){"mousewheel"===t&&void 0!==document.mozFullScreen&&(t="DOMMouseScroll"),e.addEventListener(t,i,!!a)}:function(e,t,i){e.attachEvent("on"+t,i)},remove:document.removeEventListener?function(e,t,i){e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent("on"+t,i)},target:function(e){return e.target?e.target:window.event.srcElement},stop:function(e){e&&e.stopPropagation?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1)},attFather:function(e,t,i){return e&&t&&e.parentNode?(i?null!==e.getAttribute(t):e.getAttribute(t))?{node:e,attr:e.getAttribute(t)}:this.attFather(e.parentNode,t):null}},t=function(e){if(a.payComplete&&"function"==typeof a.payComplete&&a.payComplete(e))return!1;window.top.Payment.success({article:"道具使用成功",text:"您可以在「我的道具」中查看使用效果",confirm:function(){a.success&&"function"==typeof a.success&&a.success()},close:function(){a.success&&"function"==typeof a.success&&a.success()}})},i=function(i){var o=e.target(i),r=e.attFather(o,"action");(e.attFather(o,"stop")&&e.stop(i),r&&"open_job"===r.attr)&&$(s.J_position_relative).toggleClass("open");if(r&&"tab_change"===r.attr){var c=Number(r.node.dataset.index),l=$(r.node);if(l.hasClass("cur"))return;l.addClass("cur").siblings().removeClass("cur"),$(s.J_tab_wrap).find(".prop-filter-content .tab-cell").each(function(e,t){e===c?$(t).show():$(t).hide()})}if(r&&"change_job_relative"===r.attr&&d(r.node),r&&"change_invite_type"===r.attr&&u(r.node,"inviteType"),r&&"change_invite_count"===r.attr&&u(r.node,"inviteCount"),r&&"change_tags"===r.attr&&p(r.node),r&&"submit"===r.attr){var l=$(r.node);if(l.hasClass("disabled"))return;if(a.onConfirm&&"function"==typeof a.onConfirm&&a.onConfirm(n.getParams()))return!1;n.buy(t);var h=s.wrap.querySelector("#positionSync");if(h&&h.checked){var f=h.value;n.updateDegree(f).then(function(e){0!==e&&$.toast({type:"error",content:"同步修改职位中的最低学历失败了"})})}s.dialogConfirmStatus=!0,s.dialogInstance&&s.dialogInstance.close()}if(r&&"charRobot"===r.attr){ChatBot.open();try{Block.action({action:"help-robot-call",p2:3,p3:a.itemId})}catch(i){}}if(r&&"charSell"===r.attr){CallMeDialog();try{Block.action({action:"help-passive-call-click",p2:3,p3:a.itemId})}catch(i){}}};s.wrap&&e.add(s.wrap,"click",i)},d=function(e){var t=$(e);if(!t.hasClass("disabled")){var i=n.getParams();t.hasClass("cur")?i.bombPositions.splice(t.data("index"),1):i.bombPositions.push(t.data("value")),$.toast({type:"loading",content:"正在加载"}),n.getGeekBombPro(i).then(function(e){$("#toast").remove(),0===e.status?(t.toggleClass("cur"),r(),h(e),c()):f(e.status,"因人数限制，请先取消高级筛选")})}},u=function(e,t){var i=$(e);if(!i.hasClass("disabled")&&!i.hasClass("cur")){var a=n.getParams();a[t]=i.data("value"),$.toast({type:"loading",content:"正在加载"}),n.getGeekBombPro(a).then(function(e){$("#toast").remove(),0===e.status?(i.addClass("cur").siblings("li").removeClass("cur"),r(),h(e),c()):f(e.status,"当前牛人数不足，暂时不可点击")})}},p=function(e){var t=$(e);if(!t.hasClass("disabled")){var i=n.getParams(),a=t.parent("ul"),s="";a.hasClass("J_school")&&(s="school"),a.hasClass("J_company")&&(s="company"),a.hasClass("J_age")&&(s="age"),a.hasClass("J_distance")&&(s="distance"),t.hasClass("cur")?i[s]="":i[s]=t.data("value"),$.toast({type:"loading",content:"正在加载"}),n.getGeekBombPro(i).then(function(e){$("#toast").remove(),0===e.status?(t.toggleClass("cur").siblings("li").removeClass("cur"),r(),h(e),c()):f(e.status,"当前牛人数不足，暂时不可点击")})}},h=function(e){var t=n.getParams();e&&(e.bombPositionList&&e.bombPositionList.length>0&&e.bombPositionList.forEach(function(e){t.bombPositions.indexOf(e.position)>-1?e.selected=1:e.selected=0}),e.inviteTypeList&&e.inviteTypeList.length>0&&e.inviteTypeList.forEach(function(e){t.inviteType===e.code?e.selected=1:e.selected=0}),e.inviteCountList&&e.inviteCountList.length>0&&e.inviteCountList.forEach(function(e){t.inviteCount===e.code?e.selected=1:e.selected=0}),e.schoolTags&&e.schoolTags.length>0&&e.schoolTags.forEach(function(e){t.school===e.code?e.selected=1:e.selected=0}),e.comTags&&e.comTags.length>0&&e.comTags.forEach(function(e){t.company===e.code?e.selected=1:e.selected=0}),e.ageTags&&e.ageTags.length>0&&e.ageTags.forEach(function(e){t.age===e.code?e.selected=1:e.selected=0}),e.distanceTags&&e.distanceTags.length>0&&e.distanceTags.forEach(function(e){t.distance===e.code?e.selected=1:e.selected=0}),s.renderCheckbox(e))},f=function(e,t){0!==e&&(1===e&&$.toast({type:"error",content:"当前职位不可用"}),2!==e&&3!==e||window.top.Menu.sideEl.find(".menu-position").click(),4===e&&$.toast({type:"error",content:t||"筛选条件不可用"}))}};return{factory:function(e,t){return e=e||"buy",t=t||{},t.itemId||t.itemType?t.itemId?void a(e,t):void $.get("/wapi/zpitem/web/item/get?itemType="+t.itemType,function(i){t.itemId=i.zpData[t.itemType],a(e,t)}):($.toast({content:"数据发生了错误！",type:"error"}),!1)}}}(),ResumeDirectCard=function(){var e,t=function(e,t){var i=this;i.get={},i.post={};var a=[],n=[];i.jobId="",i.categoryBase={},i.category=[],i.relatedPositions=[],i.itemDiscountInfo={};var s=function(){$("#toast").addClass("slideUp"),setTimeout(function(){$("#toast").remove()},500)};i.get.job=function(){var t=$.Deferred(),i={buy:"/wapi/zpitem/web/jobTop/jobTopJobList.json",use:"/wapi/zpitem/web/jobTop/useJobTopSelJob.json"};return $.get(i[e]).success(function(e){t.resolve(e.zpData.jobList)}).error(function(){$.toast({type:"error",content:"加载职位列表失败"})}),t},i.get.dateRange=function(){var a=$.Deferred(),n="use"==e?{encryptUserItemId:t.encryptUserItemId}:{},o={buy:"/wapi/zpitem/web/jobTop/jobTopSelDay/"+i.jobId+".json",use:"/wapi/zpitem/web/jobTop/useJobTopSelDay/"+i.jobId+".json"};return $.toast({type:"loading",content:"正在加载"}),$.get(o[e],n).success(function(e){i.timeTypeGray=e.zpData.timeTypeGray,i.timeTypeGray&&e.zpData.dayBeanTypeList?e.zpData.dayBeanTypeList.length>1?i.category=e.zpData.dayBeanTypeList||[]:(i.categoryBase=e.zpData.dayBeanTypeList[0],i.timeTypeGray=0):$.isArray(e.zpData.dayBean)?i.categoryBase=e.zpData.dayBean[0]:i.categoryBase=e.zpData.dayBean,i.relatedPositions=e.zpData.relatedPositions||[],i.dayDiscount=e.zpData.dayDiscount||[],i.jobTopCount=e.zpData.jobTopCount,i.vipPriceStatus=e.zpData.vipPriceStatus,e.zpData.experienceTip?i.experienceTip=e.zpData.experienceTip:i.experienceTip=null,a.resolve(e),s()}).error(function(){s()}),a},i.post.buy=function(i,a,s,o){var r=$.Deferred(),c={buy:"/boss/item/pay/jobtop.json",use:"/boss/item/useJobTopBooking/"+i+".json"},l={source:t.source,encryptTargetId:i,date8:n.join(","),Positions:s||"",jobTopTimeType:a};"use"==e&&(l.endDate=t.endDate);var d=function(t){__conversion("prop_topcard_"+e+"_"+i),r.resolve(t)},u={url:c[e],description:"购买道具：「牛人直通卡」",amount:"use"==e?0:o,data:l,itemId:t.itemId||"89e3b4ba1117aca61XY~",success:d},p={buy:function(){},success:d};return window.top.Payment.purchase(u,p),r},i.post.consume=function(e){var i=$.Deferred(),a={date8:n.join(","),encryptUserItemId:t.encryptUserItemId};return $.ajax({method:"post",url:"/wapi/zpitem/web/jobTop/useJobTopBooking/"+e+".json",data:a,cache:!1,success:function(t){0==t.code?(i.resolve(t),__conversion("prop_topcard_use_"+e)):$.toast({type:"error",content:t.message})},error:function(){$.toast({type:"error",content:"使用失败"})}}),i},i.setRange=function(e){n=e},i.getRange=function(){return n},i.total=function(){var e=0,t=function(e){var t={};return $.each(a,function(i,a){a.date8==e&&(t=a)}),t};return $.each(n,function(i,a){e+=t(a).price}),e},i.freeVipPreorder=function(){var e=$.Deferred();if(!i.experienceTip)return!1;var t={priceId:i.experienceTip.priceId,targetId:i.experienceTip.targetId,targetType:i.experienceTip.targetType,bz:i.experienceTip.bz,sf:i.experienceTip.sf};return $.post("/wapi/zpblock/order/preorder",t,function(t){var i=t.code,a=t.zpData.status;0===i?e.resolve(a):$.toast({type:"error",content:t.message})}),e},i.getSelectionPrice=function(){var e=$.Deferred(),a={encryptTargetId:$(".J_stickPosition input[type=hidden]").val(),date8:n.join(","),jobTopTimeType:$(".J_categorySelected")?$(".J_categorySelected").val():""},s="/wapi/zpitem/web/itemMall/getDiscountInfo/"+t.itemId;return $.post(s,{paramsJson:encodeURIComponent(JSON.stringify(a))},function(t){var a=t.code,n=t.zpData.itemDiscountInfo;0===a?(i.itemDiscountInfo=n,i.itemDiscountInfo.save=n.originalPrice-n.price,e.resolve(n)):$.toast({type:"error",content:t.message})}),e},Modal=function(){return i}},i=function(){var t=this;this.setTotal=function(){},this.consume=function(){},t.formatDate=function(e){return{year:e.substring(0,4),month:e.substring(4,6),day:e.substring(6,8)}},t.message={10:"审核中",15:"即将过期",20:"审核失败",30:"不可用",7:"预定满"},this.formatMonth=function(){var e=new Date,t=e.getFullYear(),i=e.getMonth(),a=e.getDate(),n=0;return 11==i?(t+=1,i=0):i+=1,n=new Date(t,i,0),(n.getDate()-a<7?n.getMonth()+2:n.getMonth()+1)%12},this.addEvent=function(e){$(".prop-consume").on("click",".canbuy,.canapply",t.selectedJob),$(".prop-consume").on("click",".J_duration_list li",t.selectCategory),$(".prop-consume").on("click",".extend-job-list li",t.selectedExtendJob),$(".prop-consume").on("click",".J_robot",function(){ChatBot.open();try{Block.action({action:"help-robot-call",p2:3,p3:e})}catch(e){}}),$(".prop-consume").on("click",".J_call",function(){CallMeDialog();try{Block.action({action:"help-passive-call-click",p2:3,p3:e})}catch(e){}})},this.toggleDisable=function(e){e?$(".prop-consume .btn-sure").addClass("disabled"):$(".prop-consume .btn-sure").removeClass("disabled")},this.close=function(){t.wrap.fadeOut("normal",function(){t.wrap.remove()})},this.select=function(e){$(e).toggleClass("selected");var i=$(".prop-consume .prop-date-list .selected"),a=[];$.each(i,function(e,t){a.push($(t).attr("data-date"))}),t.pick(a,$(e).index()%7)},this.pick=function(i,a){$(".J_dateRange .ipt");e.setSelectionRange(i),e.setFooter(),t.toggleDisable(i.length<1)},this.renderDateRange=function(t){t&&($(".J_dateRange input[type=text]").val(""),$(".prop-consume .prop-date-list").empty().append(PropTemplate.dateRange(t,e.getSelectionRange())))},this.renderCategory=function(e){$(".J_duration_wrap").html(PropTemplate.extend(e))},this.selectCategory=function(){var i=$(this).data("type");if(i!=$(".J_categorySelected").val()){$(this).addClass("selected").siblings("li").removeClass("selected"),$(".J_categorySelected").val(i);var a=e.getDateByCodes(i);e.setSelectionRange([]),t.renderDateRange(a),t.toggleDisable(!0),$(".prop-date-list dd.canbuy").length>0&&0!==e.canSelectDays&&$(".prop-date-list dd.canbuy").eq(0).click()}},this.getWeeks=function(){for(var e=(new Date).getDay()+1,t=["日","一","二","三","四","五","六"],i=[],a=0;a<7;a++)i.push(t[(e+a)%7]);return i},this.renderExtendJob=function(e){e&&e.length>0?$(".prop-consume .J_extend_job").html(PropTemplate.extendJob(e)):$(".prop-consume .J_extend_job").empty()},this.selectedExtendJob=function(){$(this).toggleClass("selected"),e.getExtendJob()}},a=function(t){var a={};return a.buy=function(){i.call(this,arguments);var t=this;this.render=function(i){ConsumeConfirm({title:"购买牛人直通卡",wrapClass:"prop-stick-buy",content:PropTemplate.stick({action:"buy",weeks:t.getWeeks(),month:t.formatMonth()}),confirmText:"购买并预定",open:function(e){t.wrap=e,$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(i,t.message)),DropDown.init(e)},confirm:function(i){$(".prop-consume .btn-sure").hasClass("disabled")||e.buy(),t.toggleDisable(!1),$(i).remove()}})},this.selectedJob=function(){if(e.canSelectDays>=0&&e.getSelectionRange().length>=e.canSelectDays&&!$(this).hasClass("selected"))return $.toast({type:"error",content:"为保证置顶效果，当前职位最多可预约"+e.totalDays+"天"}),!1;t.select($(this))},this.setTotal=function(t,i){var a=t.save,n=2===i,s=e.counter(),o=a>0?" multi-row":"";o+=n?" prop-total-vip":"",$(".prop-consume .btns .prop-total").remove();var r='<p class="prop-total'+o+'">￥<em>'+t.price+'</em><i class="vip-discount-sign"></i>';a>0&&(r+="<br><span>原价"+t.originalPrice+"</span>"),r+="</p>",t.price>0&&$(".prop-consume .btns").prepend(r),s.dateDiscount?$(".prop-date-article .discount-tip").show().text("额外立减"+s.dateDiscount+"%"):$(".prop-date-article .discount-tip").hide().text(""),this.setDiscount(t)},this.setDiscount=function(e){var t=e.discountList,i=$(".J_discount_wrap");t&&t.length>0?i.html(PropTemplate.discount(t)):i.empty()}},a.use=function(){var t=this;i.call(this,arguments),this.render=function(i,a){ConsumeConfirm({title:"使用牛人直通卡",wrapClass:"prop-stick-buy",content:PropTemplate.stick({action:"use",weeks:t.getWeeks(),month:t.formatMonth()}),confirmText:"使用",open:function(e){t.wrap=e,$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(i,t.message)),DropDown.init(e)},confirm:function(){$(".prop-consume .btn-sure").hasClass("disabled")||e.consume(),$(".prop-consume .btn-sure").addClass("disabled")}}),t.fromListEl=a},this.selectedJob=function(){var i=parseInt($(".J_dateRangeSelected").attr("data-max"))||1,a=$(".J_dateRange .prop-date-list dd.selected");if(e.canSelectDays>=0&&a.length>=e.canSelectDays&&!$(this).hasClass("selected"))return $.toast({type:"error",content:"为保证置顶效果，当前职位最多可预约"+e.totalDays+"天"}),!1;(a.length<i||$(this).hasClass("selected"))&&t.select($(this)),$(".J_dateRange .prop-date-list dd.selected").length>=i?$(".J_dateRange .prop-date-list dd").not(".selected").addClass("disabled"):$(".J_dateRange .prop-date-list dd.disabled").removeClass("disabled")},this.consume=function(e){}},new a[t]},n=function(e,i,n){var s=this,o=new t(e,i),r=new a(e);s.action=e,s.totalDays=-1,s.canSelectDays=-1,s.buy=function(){var t=$(".J_stickPosition input[type=hidden]").val(),a=$(".J_categorySelected")?$(".J_categorySelected").val():"",n=$(".J_extend_job_selected").val(),s="use"!=e?getVipSaveText(o.itemDiscountInfo.vipSave):"";o.post.buy(t,a,n,o.itemDiscountInfo.price).then(function(){r.close(),"use"==e&&r.consume(o.getRange().length),setTimeout(function(){window.top.Payment.success({article:"预定成功",text:"您可以在「我的道具」中查看使用效果"+s,close:function(){i.success&&i.success()}})},50)}),window.top.__conversion("topcard_pay_"+t+"_"+o.itemDiscountInfo.price+"_"+o.itemDiscountInfo.save)},s.consume=function(){r.toggleDisable(!0);var e=$(".J_stickPosition input[type=hidden]").val();o.post.consume(e).then(function(){r.close(),r.consume(o.getRange().length),setTimeout(function(){window.top.Payment.success({article:"预定成功",text:"您可以在「我的道具」中查看使用效果",close:function(){i.success&&i.success()}})},50)}),window.top.__conversion("topcard_pay_"+e+"_"+$(".prop-date-range .selected").length)},s.getDateByCodes=function(e){var t=null;return(e||0==e)&&o.category.forEach(function(i){if(i.type==e)return t=i.data,null!==i.totalDays&&void 0!==i.totalDays?(s.totalDays=i.totalDays,s.canSelectDays=i.totalDays-i.bookingDays):(s.totalDays=-1,s.canSelectDays=-1),!1}),t},s.counter=function(){if("use"==e)return{total:$(".J_dateRange dd.selected").length,discount:0,pay:$(".J_dateRange dd.selected").length,save:0};var t=o.getRange();return{dateDiscount:100*function(e,t){return t<1?0:e[Math.min(e.length-1,t-1)]}(o.dayDiscount,t.length)}},s.getSelectionRange=function(){return o.getRange()},s.setSelectionRange=function(e){o.setRange(e)},s.getExtendJob=function(){var e=$(".prop-stick-buy .extend-job-list li"),t=$(".prop-stick-buy .J_extend_job_discount"),i=$(".prop-stick-buy .J_extend_job_selected"),a=[],n=0;e&&e.length>0&&(e.each(function(e,t){$(t).hasClass("selected")&&(a.push($(t).data("position")),n+=Number($(t).data("percent")))}),n>0?t.text("邀请范围提升"+n+"%"):t.text(""),a.length>0?i.val(a.join(",")):i.val(""))},s.setFooter=function(){if("use"===s.action)return!1;o.getSelectionPrice().then(function(e){0===e.status&&r.setTotal(o.itemDiscountInfo,o.vipPriceStatus)})},o.get.job().then(function(t){r.render(t,n),r.addEvent(i.itemId),$(".stick-flexible-panel").hide(),$(".J_stickPosition").on("dropdown.selected",function(){$(".dropdown-wrap").addClass("dropdown-disabled");var t=$(".J_stickPosition input[type=hidden]").val();o.jobId=t,o.get.dateRange().then(function(){$(".dropdown-wrap").removeClass("dropdown-disabled"),o.setRange([]),r.toggleDisable(!0),o.timeTypeGray&&"buy"===e?r.renderCategory(o.category):$(".J_duration_wrap").empty();var t=null;if(o.timeTypeGray?t=s.getDateByCodes($(".J_categorySelected").val()):(t=o.categoryBase.data,null!==o.categoryBase.totalDays&&void 0!==o.categoryBase.totalDays?(s.totalDays=o.categoryBase.totalDays,s.canSelectDays=o.categoryBase.totalDays-o.categoryBase.bookingDays):(s.totalDays=-1,s.canSelectDays=-1)),r.renderDateRange(t),r.renderExtendJob(o.relatedPositions),s.getExtendJob(),$(".J_dateRangeSelected").attr("data-max",o.jobTopCount),$(".stick-flexible-panel").show(),$(".prop-date-list dd.canbuy").length>0&&0!==s.canSelectDays&&$(".prop-date-list dd.canbuy").eq(0).click(),o.experienceTip){var i=$('<div class="experience-tip J_experience"><span class="experience-text J_text">'+o.experienceTip.desc+'</span><a href="javascript:;" class="experience-btn J_experience_buy">'+o.experienceTip.buttonText+"</a></div>");$(".dialog-title .title").find(".J_experience").off("click","**").remove(),$(".dialog-title .title").append(i),i.on("click",".J_experience_buy",function(){o.freeVipPreorder().then(function(e){1===e?($.toast({type:"success",content:"恭喜您，领取成功！"}),i.find(".J_text").text("已领取 VIP3天体验，抓紧享受道具折扣吧"),i.find(".J_experience_buy").remove(),setTimeout(function(){$(".J_stickPosition").find(".dropdown-menu li.cur").eq(0).trigger("dropdown.selected")},1e3)):$.toast({type:"error",content:"领取失败，请稍后再试！"})})})}$(".prop-stick-buy").find(".dialog-container").addClass("scroll-wrap")}),window.top.__conversion("topcard_job_"+t)});var a=$(".J_stickPosition").find(".dropdown-menu li").not(".disabled");a.length&&a.eq(0).click()})};return{factory:function(t,i){i.itemId?e=new n(t,i):$.get("/wapi/zpitem/web/item/get?itemType="+i.itemType,function(a){i.itemId=a.zpData[i.itemType],e=new n(t,i)})}}}(),ResumeRiseBag=function(){var e=function(){},t=function(e,t){var i=this,a=[];i.get={},i.post={},i.position={},i.selected=function(e){$.each(a,function(t,a){a.encryptId==e&&(i.position=a)})},i.get.job=function(){var e=$.Deferred(),t=function(t){a=t.zpData.jobList,e.resolve(a)};return $.get("/wapi/zpitem/web/resumeDirect/jobList.json").success(t).error(function(){$.toast({type:"error",content:"加载职位列表失败"})}),e},i.get.selCount=function(e){var t=$.Deferred();return $.get("/wapi/zpitem/web/resumeDirect/toConfirm",{encryptJobId:e}).success(function(e){e.zpData.experienceTip?i.experienceTip=e.zpData.experienceTip:i.experienceTip=null,t.resolve(e.zpData)}),t},i.freeVipPreorder=function(){var e=$.Deferred();if(!i.experienceTip)return!1;var t={priceId:i.experienceTip.priceId,targetId:i.experienceTip.targetId,targetType:i.experienceTip.targetType,bz:i.experienceTip.bz,sf:i.experienceTip.sf};return $.post("/wapi/zpblock/order/preorder",t,function(t){var i=t.code,a=t.zpData.status;0===i?e.resolve(a):$.toast({type:"error",content:t.message})}),e}},i=function(){var t=this;t.message={10:"审核中",15:"即将过期",30:"不可用",35:"不可用"},t.scale=function(e){var i=t.position.priceLevel||[],a=i.filter(function(e){return 1!=e.status&&e.count<101}),n=a.length-1;return a.length>0?a[n].count:50},t.setTotal=function(){e.getSelectionPrice().then(function(e){if(0!==e.status)return!1;var i=e.originalPrice-e.price,a=2===t.position.vipPriceStatus,n=i>0?" multi-row":"";n+=a?" prop-total-vip":"";var s="<em>"+e.price+'</em><i class="vip-discount-sign"></i>';i>0&&(s+='<br><span class="gray">原价'+e.originalPrice+"</span>"),$(".prop-consume .btns .prop-total").remove(),$(".prop-consume .btns").prepend('<p class="prop-total'+n+'">￥'+s+"</p>");var o=e.discountList,r=$(".J_discount_wrap");o&&o.length>0?r.html(PropTemplate.discount(o)):r.empty()})},t.select=function(e){t.setTotal()},t.enable=function(e){for(var i=$(".prop-resume-count .scale-wrap li"),a=t.position.priceLevel||[],n=0;n<a.length;n++)1!=a[n].status&&i.filter("[data-count="+a[n].count+"]").addClass("enable")},t.init=function(e){var i=t.scale(e);$(".prop-consume .prop-resume-count li[data-count="+i+"]").addClass("selected"),t.enable(),t.select()},t.toggleDisable=function(e){e?$(".prop-consume .btn-sure").addClass("disabled"):$(".prop-consume .btn-sure").removeClass("disabled")},t.close=function(){t.wrap.fadeOut("normal",function(){t.wrap.remove()})},t.html=function(e){$(".prop-resume-box").html(PropTemplate.selCount(e)),t.position=e,t.init(e.inviteCount),t.addEvent()},t.addEvent=function(){$(".prop-resume-box").on("click",".scale-wrap .enable",function(){if($(this).hasClass("selected"))return!1;$(".prop-resume-count .scale-wrap .selected").removeClass("selected"),$(this).addClass("selected"),t.select($(this).attr("data-count"));var e=$(".J_stickPosition input[type=hidden]").val();window.top.__conversion("resumedirect_invite_"+e+"_"+$(this).attr("data-count"))}),$(".prop-resume-box .icon-resume-mark").hover(function(){$(".prop-resume-box .prop-resume-tip").show()},function(){$(".prop-resume-box .prop-resume-tip").hide()}),$(".prop-consume").on("click",".J_robot",function(){ChatBot.open();try{Block.action({action:"help-robot-call",p2:3,p3:t.position.encryptItemId})}catch(e){}}),$(".prop-consume").on("click",".J_call",function(){CallMeDialog();try{Block.action({action:"help-passive-call-click",p2:3,p3:t.position.encryptItemId})}catch(e){}})}},a=function(t){var a={};return a.buy=function(){var t=this;i.call(this,arguments);var a=function(e,i){t.wrap=e,$(".J_stickPosition .dropdown-menu ul").append(PropTemplate.position(i,t.message)),DropDown.init(e),t.toggleDisable(!0)};this.render=function(i){ConsumeConfirm({title:"购买简历加油包",content:PropTemplate.resume(),confirmText:"购买并使用",wrapClass:"prop-bombshell",open:function(e){a(e,i)},confirm:function(i){if(!$(".prop-consume .btn-sure").hasClass("disabled")){var a=$(".prop-consume .scale-wrap .selected"),n=t.position.priceLevel||[],s=n.filter(function(e){return e.count==a.attr("data-count")}),o=s[0];e.consume(a.attr("data-count"),o)}$(".prop-consume .btn-sure").addClass("disabled"),$(i).remove()}})}},a.use=function(){},new a[t]},n=function(e,i,n){var s=this,o=new t(e,i),r=new a(e),c=function(){var e=$(".J_stickPosition input[type=hidden]").val();o.selected(e),o.get.selCount(e).then(function(e){if(s.positionItem=e,r.html(e),r.toggleDisable(!1),o.experienceTip){var t=$('<div class="experience-tip J_experience"><span class="experience-text J_text">'+o.experienceTip.desc+'</span><a href="javascript:;" class="experience-btn J_experience_buy">'+o.experienceTip.buttonText+"</a></div>");$(".dialog-title .title").find(".J_experience").off("click","**").remove(),$(".dialog-title .title").append(t),t.on("click",".J_experience_buy",function(){o.freeVipPreorder().then(function(e){1===e?($.toast({type:"success",content:"恭喜您，领取成功！"}),t.find(".J_text").text("已领取 VIP3天体验，抓紧享受道具折扣吧"),t.find(".J_experience_buy").remove(),setTimeout(function(){$(".J_stickPosition").find(".dropdown-menu li.cur").eq(0).trigger("dropdown.selected")},1e3)):$.toast({type:"error",content:"领取失败，请稍后再试！"})})})}}),window.top.__conversion("resumedirect_job_"+e)};s.consume=function(e,t){r.toggleDisable(!0);var a=getVipSaveText(t.oprice-t.price),n=function(e){r.close(),setTimeout(function(){window.top.Payment.success({article:"使用成功",text:"您可以在「我的道具」中查看使用效果"+a,close:function(){window.location.reload()}})},50),__conversion("prop_resumeDirect_buy_"+o.position.encryptId)},c=s.positionItem.expand||{},l={url:"/boss/item/pay/resumedirect.json",amount:t.price,description:"购买道具：「简历加油包」",data:{source:i.source,encryptTargetId:o.position.encryptId,inviteCount:e,Degree:c.degree,WorkYear:c.workYear},itemId:i.itemId,success:n},d={buy:function(){},success:n};window.top.Payment.purchase(l,d),window.top.__conversion("resumedirect_pay_"+o.position.encryptId+"_"+e)},s.getSelectionPrice=function(){var e=$.Deferred(),t=s.positionItem.expand||{},a={encryptTargetId:o.position.encryptId,inviteCount:$(".prop-consume .scale-wrap .selected").attr("data-count"),Degree:t.degree,WorkYear:t.workYear},n="/wapi/zpitem/web/itemMall/getDiscountInfo/"+i.itemId;return $.post(n,{paramsJson:encodeURIComponent(JSON.stringify(a))},function(t){var i=t.code,a=t.zpData.itemDiscountInfo;0===i?e.resolve(a):$.toast({type:"error",content:t.message})}),e},o.get.job().then(function(e){r.render(e,n),$(".J_stickPosition").on("dropdown.selected",c);var t=$(".J_stickPosition").find(".dropdown-menu li").not(".disabled");t.length&&t.eq(0).click()}),__conversion("prop_resumeDirect_"+e)};return{status:"fulfilled",factory:function(t,i){i.itemId&&"buy"!==t?e=new n(t,i):$.get("/wapi/zpitem/web/item/get?itemType="+i.itemType,function(a){i.itemId=a.zpData[i.itemType],e=new n(t,i)})}}}(),PositionShop=function(){var e={hot:function(t){var i,a=!t.bzbList||t.bzbList.length<2?"":" item-combo",n=e.header(t),s=e.discount(t);return i=t.bzbList?t.bzbList.map(function(t){return e.superCard(t)}):[e.aloneCard(t)],n+'<div class="item-list clearfix'+a+'">'+i.join("")+"</div>"+s},singleCard:function(e){return Utemplate('<div class="item-card"><p class="item-name"><%this.name%></p><%for(var i=0;i<this.privilegeList.length;i++){%><p class="item-rights"><i class="dot"></i><span class="item-rights-title"><%this.privilegeList[i].name%></span></p><%}%><div class="item-desc"><p><span class="amount fr"><%this.priceList[0].unitDesc%></p>权益总价值</div></div>',e)},aloneCard:function(e){return Utemplate('<div class="item-card"><p class="item-name"><%this.priceTitle%><i class="discount">限时折扣</i></p><%for(var i=0;i<this.descList.length;i++){%><p class="item-rights"><i class="dot"></i><span class="item-rights-title"><%this.descList[i]%></span></p><%}%><div class="item-desc"><p><span class="amount fr"><%this.currentPriceDesc%></p>权益总价值</div></div>',e)},card:function(t){if(1===t.priceList.length)return e.singleCard(t);return Utemplate('<div class="item-card"><p class="item-name"><%this.name%></p><%for(var i=0;i<this.privilegeList.length;i++){%><p class="item-rights"><span class="item-rights-title"><%this.privilegeList[i].name%></span></p><%}%><ul><%for(var j=0;j<this.priceList.length;j++){%><li <%if(this.priceList[j].select){%>class="selected"<%}%> ><%if(this.priceList[j].promoteDesc){%><p class="offer-select"><%this.priceList[j].promoteDesc%></p><%}%><span class="item-date"><%this.priceList[j].expireName%><%if(this.priceList[j].discountDesc){%><i class="discount"><%this.priceList[j].discountDesc%></i><%}%></span><span class="item-price"><%this.priceList[j].unitDesc%></span><span class="item-check"><i class="iboss-checked-solid"></i></span></li><%}%></ul></div>',t)},superCard:function(t){if(1===t.priceList.length)return e.singleCard(t);return Utemplate('<div class="item-card"><p class="item-name"><%this.name%></p><%for(var i=0;i<this.privilegeList.length;i++){%><p class="item-rights"><i class="dot"></i><span class="item-rights-title"><%this.privilegeList[i].name%></span></p><%}%><ul><%for(var j=0;j<this.priceList.length;j++){%><li <%if(this.priceList[j].select){%>class="selected"<%}%> ><%if(this.priceList[j].promoteDesc){%><p class="offer-select"><%this.priceList[j].promoteDesc%></p><%}%><span class="item-date"><%this.priceList[j].expireName%><%if(this.priceList[j].discountDesc){%><i class="discount"><%this.priceList[j].discountDesc%></i><%}%></span><span class="item-price"><%this.priceList[j].unitDesc%></span><span class="item-check"><i class="iboss-checked-solid"></i></span></li><%}%></ul></div>',t)},free:function(){},header:function(e){return Utemplate('<div class="position-top"><div class="article"><h4><%this.shortDesc.name%></h4><%this.hlShortDesc.name%></div><div class="notice-box"><div class="notice-inner"><%if(this.dynamicBar){%><%for(var i=0;i<this.dynamicBar.length;i++){%><p class="notice"><%this.dynamicBar[i]%></p><%}%><%}%></div></div></div>',e)},discount:function(e){
return Utemplate('<%if(this.discountList && this.discountList.length){%><div class="item-discount-list"><p>优惠</p><ul><%for(var i=0;i<this.discountList.length;i++){%><li><i><%this.discountList[i].discountTag%></i><%this.discountList[i].discount.name%></li><%}%></ul></div><%}%><%if(this.bottomTipList){%><%for(var j=0;j<this.bottomTipList.length;j++){%><p class="item-bottom-desc"><%this.bottomTipList[j].name%></p><%}%><%}%>',e)},super:function(t){var i,a=e.header(t);return i=t.bzbList?t.bzbList.map(function(t){return e.superCard(t)}):[e.aloneCard(t)],a+'<div class="item-list clearfix">'+i.join("")+"</div>"+e.discount(t)},upgradeCard:function(e){return Utemplate('<div class="item-card"><p class="item-name"><%this.priceTitle%><i class="discount">限时折扣</i></p><%for(var i=0;i<this.descList.length;i++){%><p class="item-rights"><i class="dot"></i><span class="item-rights-title"><%this.descList[i]%></span></p><%}%><div class="item-desc"><p><span class="amount fr"><%this.currentPriceDesc%></p>升级所需价格<p class="item-bottom-desc"><%this.upgradeDesc%></p></div></div>',e)},upgrade:function(t){return e.header(t)+'<div class="item-list clearfix">'+e.upgradeCard(t)+"</div>"+e.discount(t)}},t=function(e,t,i){var a,n=e.buttonList,s=0,o=function(e){$.get("/wapi/zpblock/order/bzbquery",{bzbParam:e.bzbParam}).success(function(e){if(0===e.code&&6===e.zpData.auditStatus){var i=util.get(e,"zpData.dialog.title",""),a=util.get(e,"zpData.dialog.content","").split(/[\s\n\↵]/),n='<p class="status">当前职位已付费</p><p class="article"><span class="clock-timing">'+i+'</span></p><ul class="desc-list">'+a.map(function(e){return"<li>"+e+"</li>"}).join("")+"</ul>";$.dialog({bind:!0,title:"",closeLayer:!1,closeText:!1,content:n,wrapClass:"flex-dialog-wrap position-shop-confirm",cancelText:"",confirmText:"确定",onConfirm:function(){t.confirm&&t.confirm(),this.close()},onClose:function(){t.close&&t.close()}})}else 0==e.code&&Payment.success({article:e.zpData.dialog.title,text:e.zpData.dialog.content,confirm:function(){t.confirm&&t.confirm()},close:function(){t.close&&t.close()}})})},r=function(t){if(console.log(e),!e.bzbList)return e;var i=$(t).find("li.selected"),a=i.parents(".item-card"),n=e.bzbList[a.index()];return i.length?n.priceList[i.index()]:e.bzbList[0].priceList[0]},c=function(t){if(!e.bzbList)return e;var i=$(t).find("li.selected"),a=i.parents(".item-card");return e.bzbList[a.index()]};$.dialog({bind:!0,title:"",closeLayer:!1,content:i,wrapClass:"flex-dialog-wrap position-shop-wrap",cancelText:n.length>1&&n[0].text,confirmText:n.length>1?n[1].text:n[0].text,onOpen:function(t){$(t).on("click",".item-card li",function(){$(t).find(".selected").removeClass("selected"),$(this).addClass("selected")}),!$(t).find(".item-list li.selected").length&&$(t).find(".item-list li").length&&$(t).find(".item-list li").eq("0").addClass("selected"),a=setInterval(function(){s=(s+1)%e.dynamicBar.length,$(t).find(".notice-inner").animate({marginTop:-37*s})},3e3)},onConfirm:function(i){var a=r(i),s=(c(i),n[n.length-1]),l=decodeURIComponent(s.url),d=getQueryParams(l),u=JSON.parse(d.params),p=t.encryptTargetId||t.targetId;d.ba&&Block.action(Block.formatBA(d.ba));var h={data:{jobId:t.jobId,priceId:a.encryptPriceId,targetId:e.encryptTargetId?e.encryptTargetId:p,targetType:t.targetType?t.targetType:u.targetType,payMode:t.payMode,business:e.business},amount:a.beanCount},f={success:o};Payment.purchase(h,f),this.close()},onCancel:function(e){var i=decodeURIComponent(n[0].url),a=i.split("=")[1],s=JSON.parse(a),r={data:{jobId:t.jobId,priceId:s.priceId,targetId:t.targetId,targetType:t.targetType,payMode:t.payMode,business:t.business},amount:s.beanCount},c={success:o};Payment.purchase(r,c),$(e).remove(),this.close()},onClose:function(){s=[0],clearInterval(a)}})},i=function(i,a){t(i,a,e.hot(i))},a=function(i,a){t(i,a,e.super(i))},n=function(i,a){t(i,a,e.upgrade(i))};return{hot:i,super:a,upgrade:n,include:function(e,t){return e.upgrade?(n(e,t),!0):[21,23].indexOf(e.templateId)>-1?(i(e,t),!0):[22,24].indexOf(e.templateId)>-1&&(a(e,t),!0)}}}(),PositionDirector=function(){var e=function(e,t){var i=function(){var t=$.Deferred();return $.get("/bossweb/job/prolongprice.json?jobId="+e).success(function(e){t.resolve(e)}),t};!function(){i(e).then(function(i){var a={targetType:i.targetType||"",targetId:i.targetId?i.targetId:e,configId:i.configId||"",payMode:i.payMode,jobId:e,action:"延长",success:function(){t.success&&t.success()},confirm:function(){t.success&&t.success()}};if(i.blockPageData&&"object"==typeof i.blockPageData){var n=i.blockPageData.template||i.blockPageData.templateId;3===n||11===n?function(){var a={jobId:e,success:function(){t.success&&t.success()}};window.top.BlockSence.include(i.blockPageData,a)}():12===n||14===n||25===n?function(){var t={parameter:{jobId:e,hotJobType:1},success:function(){a.success&&a.success(a.type)}};window.top.BlockSence.include(i.blockPageData,t)||window.top.Commercial.block(i.blockPageData,function(t,i){var n=$.extend({isPurchase:!0,jobId:e,business:t.business||"",encryptTargetId:t.encryptTargetId},i);window.top.Purchase.commercial({jobId:n.jobId,priceId:n.encryptPriceId,hotJobType:1,targetId:n.encryptTargetId?n.encryptTargetId:a.targetId,business:n.business||"",targetType:void 0!=i.targetType?n.targetType:a.targetType},{item:n,success:function(){a.success&&a.success(a.type)}})})}():function(){var a={jobId:e,success:function(){t.success&&t.success()}};window.top.BlockSence.include(i.blockPageData,a)}()}else Block.confirm({title:i.blockDialogData.title,description:i.blockDialogData.content})})}()};return{open:function(e,t){var i=t||{},a=i.url?i.url:"/bossweb/jobonline.json?jobId="+e,n=function(){return i.success()};$.get(a,function(i){if(1==i.rescode)n();else{if(i.blockPageData||i.blockCode)return BlockSence.include(i.blockPageData,{jobId:e,success:n,encryptTargetId:t.encryptTargetId,targetId:t.targetId,targetType:t.targetType}),!0;window.top.Block.confirm({title:i.blockTitle,description:i.resmsg,ka:"block_openjob_"+i.blockCode})}})},prolong:e}}(),NodeMessage=function(){var e={},t={},i={preUse:function(e,t){var i=$.Deferred();return $.get("/wapi/zpitem/web/smsNotice/preUse.json",{geekId:e.infoData.encryptUid,expectId:e.infoData.encryptExpectId,jobId:e.infoData.toPositionId,sourceType:t.sourceType},function(e){i.resolve(e)}),i}},a={send:function(e,t){var i=$.Deferred();return $.post("/wapi/zpitem/web/smsNotice/use.json",{geekId:e.infoData.encryptUid,expectId:e.infoData.encryptExpectId,jobId:e.infoData.toPositionId,smsContent:t},function(e){i.resolve(e)}),i}},n={purchase:function(e){return e.discountList||(e.discountList=[]),Utemplate('<dl class="item-desc"><dd><b>·</b>发送短信极速联系牛人</dd><dd><b>·</b>自主编辑短信内容</dd><dd><b>·</b>提高牛人回复率</dd><dd><b>·</b>激活后90天内有效，到期后剩余权限作废</dd></dl><ul class="item-list"><%for(var i=0;i<this.list.length;i++){%><li><%this.list[i].specAmount%>次<em class="vline"></em><%this.list[i].price%><span class="price-desc">直豆</span></li><%}%></ul><div class="item-active-list"><ul><%for(var i=0;i<this.discountList.length;i++){%><li><i><%this.discountList[i].discountTag%></i><%this.discountList[i].name%></li><%}%></ul></div>',{list:e.itemSellItemList,discountList:e.discountList.map(formatDiscountList)})},consume:function(e){return e.smsContent||(e.smsContent="你好，我对你的简历非常感兴趣。不知可否深入聊聊？"),Utemplate('<div class="sms-dialog"><p class="item-left">您还有<span class="amount">【<%this.leftCount%>次】</span>短信通知可使用</p><div class="message-input"><textarea  maxLength="40" class="sms-content" placeholder="请输入您的短信内容"><%this.smsContent%></textarea><p class="msg-count"></p><p class="error-tip">内容不能为空</p></div><p class="sms-tip"><span class="icon-warn"></span> 温馨提示：深夜短信将于白天8点发送</p></div>',e)}},s=function(t){var i;i=t.needActivate?"激活并使用":"立即发送",$.dialog({bind:!0,title:"输入短信内容",content:n.consume(t),wrapClass:"flex-dialog-wrap prop-note-message",cancelText:"取消",confirmText:i,onOpen:function(e){var t=(new Date).getHours();(t<8||t>=23)&&$(e).find(".sms-tip").show(),$(e).find(".sms-content").on("input",function(){var t=$(e).find(".sms-content").val(),i=$(e).find(".message-input");i.hasClass("error")&&t.length>0?i.removeClass("error"):0!==t.length||i.hasClass("error")||i.addClass("error"),$(e).find(".msg-count").text(t.length+"/40")}),$(e).find(".msg-count").text($(e).find(".sms-content").val().length+"/40")},onCancel:function(){this.close("cancel")},onConfirm:function(t){var i=$(t).find(".sms-content").val().trim();if(""===i)return $(t).find(".message-input").addClass("error"),$(t).find(".sms-dialog .error-tip").text("内容不能为空"),!1;a.send(e,i).then(function(e){0==e.code?$(t).remove():($(t).find(".message-input").addClass("error"),$(t).find(".sms-dialog .error-tip").text(e.message||""))})}})},o=function(e,t){var i=function(){var t=$(".prop-note-message .item-list .selected").index();return e.itemSellUnite.itemSellItemList[t]};$.dialog({bind:!0,title:"购买短信通知",content:n.purchase(e.itemSellUnite),wrapClass:"flex-dialog-wrap prop-note-message",cancelText:"取消",confirmText:"购买",onOpen:function(e){var t=$(e);t.on("click",".item-list li",function(){t.find(".item-list .selected").removeClass("selected"),$(this).addClass("selected")}),t.find(".item-list li:last").trigger("click")},onCancel:function(){this.close("cancel")},onConfirm:function(a){var n=i(),o={url:"/boss/item/buy/othItem/"+n.encryptItemId+".json",amount:n.price,description:"购买道具：「短信通知」- "+n.specAmount+" 个",data:{source:1==t.sourceType?"plus":"tips"},itemId:n.encryptItemId,success:function(){e.itemSellUnite.leftCount=n.specAmount,s(e.itemSellUnite)}},r={success:function(){console.log("confirm")}};Payment.purchase(o,r),this.close("confirm")}})};return{use:function(a,n){e=a,t=n||{},__conversion(1===n.sourceType?"message-send-2":"message-send-1"),i.preUse(e,n).then(function(e){0===e.code?(!e.zpData.hasItem&&o(e.zpData,n),e.zpData.hasItem&&s(e.zpData)):$.dialog({title:"无法使用",content:'<div class="tip-text"></div><p>'+e.message+"</p>",type:"warning",confirmText:"确定",cancelText:"",wrapClass:"dialog-icons-default",lock:!0,onOpen:function(e){},onConfirm:function(e){$(e).remove()}})})},consume:s}}(),QuickTopCard=function(){var e={headerSuccess:function(e){return Utemplate('<header class="quick-header"><%if(this.showTitle){%><p class="status"><i class="status-icon success"></i><%this.title ? this.title : "发布成功"%></p><%}%><%if(this.auditProgressRate || this.auditProgressRate === 0){%><p class="process-wrap J_process">正在审核中<span class="process-num"><%this.auditProgressRate%>%</span><span class="process"><i style="width: <%this.auditProgressRate%>%;"></i></span></p><%}%><%if(this.content && !(this.content.length <= 0)) {%><%if(this.content.length === 1){%><p class="description"><%this.content[0]%></p><%}else{%><ul class="success-list"><%for(var i=0; i<this.content.length; i++){%><li><%this.content[i]%></li><%}%></ul><%}%><%}%><h3 class="title">急聘专享8.8折</h3><div class="quick-expire"><span class="label">距结束还剩</span><div class="time-wrap J_time"><i>-</i><i>-</i><em>:</em><i>-</i><i>-</i><em>:</em><i>-</i><i>-</i></div></div></header>',e)},headerCheck:function(e){return Utemplate('<header class="quick-header"><%if(this.showTitle){%><p class="status"><i class="status-icon check"></i><%this.title ? this.title : "职位审核中"%></p><%}%><%if(this.auditProgressRate || this.auditProgressRate === 0){%><p class="process-wrap J_process">正在审核中<span class="process-num"><%this.auditProgressRate%>%</span><span class="process"><i style="width: <%this.auditProgressRate%>%;"></i></span></p><%}%><%if(this.content && !(this.content.length <= 0)) {%><%if(this.content.length === 1){%><p class="description"><%this.content[0]%></p><%}else{%><ul class="success-list"><%for(var i=0; i<this.content.length; i++){%><li><%this.content[i]%></li><%}%></ul><%}%><%}else{%><p class="description">审核通过前或修改被驳回，您可以继续使用修改前职位招聘，审核通过后可用新的职位信息招聘，请留心系统通知； <br/>工作时间平均审核时长5分钟，非工作时间最迟1天内完成，请您耐心等待。</p><%}%><h3 class="title">预定限时8.8折</h3></header>',e)},cardContent:function(e,t){return Utemplate('<section class="quick-card"><div class="card-content"><h4 class="title">急聘直通卡<span class="title-tips"></span></h4><ul class="description-list"><% if(this.buyQuickTop === 1) { %><li>·职位显示于同类职位首屏，获得大量曝光</li><li>·系统24小时批量邀请活跃牛人投递简历</li><% }else{ %><li>·职位置顶于同类职位之上24小时</li><li>·系统批量邀请匹配度高的牛人投递简历</li><% } %></ul></div><p class="card-description"><span class="label">置顶职类：</span><%this.job.positionCatgroy%><i class="vline"></i><%this.job.locationName%><i class="vline"></i><%this.job.experienceName%></p></section>',{buyQuickTop:e.buyQuickTop,job:t.job})},cardTips:function(){return'<section class="quick-tips"><p>注：置顶和邀请将在职位审核通过后开始，若审核未通过系统将自动进行退款</p></section>'},footer:function(e,t){var i=1===e.buyQuickTop?"限时专享":"预定急聘";return Utemplate('<footer class="quick-footer"><%if(this.result.price === 0) {%><p class="disabled-text">该职位急聘升级名额已经被抢光了，下次记得早点来哦～</p><%}else{%><div class="price-box"><span class="ruling"><%this.result.payAmount%></span><span class="unit">直豆</span><span class="original"><%this.result.price%>直豆</span></div><%}%><a href="javascript:;" class="btn btn-orange <%if(this.result.price === 0){%>btn-disabled<%}%> J_submit"><%this.bottomText%></a></footer>',{bottomText:i,result:t})}},t={price:function(e){return $.get("/wapi/zpitem/web/quickJobTop/buyDetail/"+e)},bzbquery:function(e){return $.get("/wapi/zpblock/order/bzbquery",{bzbParam:e})},auditInfo:function(e){return $.get("/wapi/zpboss/h5/job/audit/info?jobId="+e)}},i=function(e,i,n){var s=$.Deferred(),o=e.auditStatus||n.auditStatus,r={};return 6===o||7===o?t.auditInfo(e.jobId).done(function(t){var n=t.zpData;if(0===t.code&&n.dialog){var o=n.auditProgressRate?n.auditProgressRate:0;6!==n.auditStatus&&7!==n.auditStatus&&(o=100),r={title:n.dialog.title?n.dialog.title:"",content:n.dialog.content?[].concat(n.dialog.content.split(/[\s\n\↵]/)):[],auditProgressRate:o}}s.resolve(a(e,i,r))}).fail(function(){s.resolve(a(e,i,r))}):s.resolve(a(e,i,r)),s},a=function(t,i,a){t.showTitle&&(a.showTitle=!0);var n="";return 2===t.buyQuickTop?(n+=e.headerCheck(a),n+=e.cardContent(t,i),n+=e.cardTips(),n+=e.footer(t,i)):(n+=e.headerSuccess(a),n+=e.cardContent(t,i),n+=e.footer(t,i)),n},n=function(e){return"<i>"+("0"+e).substr(-2,2).split("").join("</i><i>")+"</i>"},s=function(e,t){var i=t.expireTime,a=t.currentTime-(new Date).getTime();__clock=new Clocking(i,1e3,{pair:function(e){return e+a}}),__clock.interval(function(t){var i=n(t.hour)+"<em>:</em>"+n(t.minute)+"<em>:</em>"+n(t.second);$(e).find(".J_time").html(i)})},o=function(e,a,n){var o=function(){Payment.success({article:"购买成功",text:1===e.buyQuickTop?"即刻置顶职位24小时，邀约匹配牛人投递,可在BOSS直聘APP「我的道具」中查看使用效果":"职位将于审核通过后置顶、邀约匹配牛人投递，可在「我的道具」中查看使用效果",confirm:function(){e.success()}})},r=null;i(e,a,n).done(function(i){$.dialog({bind:!0,title:"",wrapClass:"flex-dialog-wrap quick-top-wrap",cancelText:"",confirmText:"",content:i,onOpen:function(i){var c=this,l=e.auditStatus||n.auditStatus;if(6===l||7===l){var d=!1,u=$(i).find(".J_process"),p=u.find(".process-num"),h=u.find(".process i");r=setInterval(function(){d||(d=!0,t.auditInfo(e.jobId).done(function(e){var t=e.zpData;if(0===e.code){if(3===t.auditStatus)return u.empty().html("当前职位已通过审核"),void clearInterval(r);if(2===t.auditStatus)return u.empty().html("当前职位未通过审核"),void clearInterval(r);if(8===t.auditStatus)return u.empty().html("职位未通过审核，请修改后重新提交"),void clearInterval(r);if(t.auditProgressRate>0)return p.html(t.auditProgressRate+"%"),void h.width(t.auditProgressRate+"%")}}).always(function(){d=!1}))},3e3)}1===e.buyQuickTop&&s(i,a),$(i).find(".J_submit").hover(function(){$(this).parent().addClass("show")},function(){$(this).parent().removeClass("show")}).click(function(){if($(this).hasClass("btn-disabled"))return!1;var t={data:{encryptTargetId:e.jobId,Positions:"",userCouponId:"",source:e.source||"recommend_geek"},description:"购买简历直通卡",amount:a.payAmount,itemId:"b6ed128ee1b8d2841HI~"};2===e.buyQuickTop&&(t.data.appointment=1);var i={success:o,cancel:e.close,close:e.close};if(Payment.purchase(t,i),c.close(),2===e.buyQuickTop)try{_T.sendEvent("preorder-job-pop")}catch(e){}})},onClose:function(){r&&clearInterval(r),e.close&&"function"==typeof e.close&&e.close()}})})};return{purchase:function(e){if(!e.jobId||0===e.buyQuickTop)return!1;if(e.showTitle=!!e.showTitle&&e.showTitle,e.success=e.success?e.success:function(){},e.close=e.close?e.close:function(){},e.buyQuickTop=e.buyQuickTop?e.buyQuickTop:1,e.order=e.order||{},e.source){var i={action:"job-upgrade-click",p:e.jobId,p2:e.source};Block.action(i)}e.order&&e.order.bzbParam?$.when(t.price(e.jobId),t.bzbquery(e.order.bzbParam)).done(function(t,i){0===t[0].code?0===i[0].code?o(e,t[0].zpData,i[0].zpData):o(e,t[0].zpData,{}):$.toast({type:"error",content:t[0].message})}).fail(function(){$.toast({type:"error",content:"请求数据错误"})}):t.price(e.jobId).done(function(t){var i=t.zpData;0===t.code?o(e,i,{}):$.toast({type:"error",content:t.message})}).fail(function(){$.toast({type:"error",content:"请求数据错误"})})}}}(),PropStore=function(){var e=function(e){$.get("/boss/item/chatbag/price.json",function(t){if(1==t.rescode){var i={success:function(){e.success&&e.success()}};if(window.top.BlockSence.include(t.blockPageData,i))return;window.top.Commercial.block(t.blockPageData,function(t,i){var a=$.extend({isPurchase:!0,business:t.business,targetType:t.targetType},i);window.top.Purchase.commercial({priceId:a.encryptPriceId,targetId:t.encryptTargetId,business:a.business||"",targetType:a.targetType},{item:a,success:function(){e.success&&e.success()}})})}})},t=function(e){var t=function(t){Payment.success({article:"购买成功",text:"激活道具后30天内有效，到期后剩余沟通权限作废。",confirmText:"确定",confirm:function(t){e.success&&e.success()}})},i=e.itemType;$.get("/wapi/zpitem/web/item/get?itemType="+i,function(a){var n={url:"/boss/item/buy/othItem/"+a.zpData[i]+".json",itemId:a.zpData[i],data:{source:e.source},success:t},s={success:t};Payment.purchase(n,s)})},i=function(i,a){var a=a||{};switch(a.itemType){case 2:GeekBombshell.factory(i,a);break;case 3:ResumeDirectCard.factory(i,a);break;case 13:ResumeRiseBag.factory(i,a);break;case 15:e(a);break;case 19:t(a);break;case 24:e(a);break;case 28:GeekBoomPro.factory(i,a)}};return{buy:function(e){return i("buy",e)},consume:function(e){return i("use",e)}}}(),PropTemplate=function(){var e={},t=function(e){return window.top.Utemplate('<p class="prop-consume-article"><%this.article%></p><div class="prop-consume-box"><div class="dropdown-wrap J_stickPosition"><span class="dropdown-select"><i class="icon-select-arrow"></i><input type="text" placeholder="未选择" class="ipt" readonly><p class="input-mask text-placeholder">未选择</p><input type="hidden" class="" ></span><div class="dropdown-menu"><ul></ul></div></div></div>',e)};return e.extend=function(e){if(e&&0!==e.length){var t="",i={0:{title:"<span>24</span>小时",description:"含批量邀约<span>4</span>小时"},1:{title:"<span>24</span>小时",description:"含批量邀约<span>8</span>小时"},2:{title:"<span>12</span>小时",description:"0-12点置顶 不含邀约"}};e.forEach(function(e){e.selected&&(t=e.type),e.title=i[e.type].title,e.description=i[e.type].description});return window.top.Utemplate('<div class="prop-resume-info"><p class="prop-consume-article prop-cagegory-article">选择置顶时长 <span class="gray">批量邀约：匹配的牛人上线后 自动邀请对方投递简历</span></p></div><div class="prop-consume-box prop-stick-extend"><input type="hidden" class="J_categorySelected" value="<%this.type%>"><div class="prop-category-range"><ul class="duration-list J_duration_list"><%for(var i=0;i<this.list.length;i++){%><li data-type="<%this.list[i].type%>" class="<%if(this.list[i].selected){%>selected<%}%>"><h4 class=duration><%this.list[i].title%></h4><p class="description"><%this.list[i].description%></p><%if(this.list[i].discountTag){%><span class="discount-tips"></span><%}%></li><%}%></ul>',{list:e,type:t})}},e.stick=function(e){var i='<div class="prop-consume-wrap"><div>'+t({article:"选择需要使用的职位"})+'<div class="stick-flexible-panel"><div class="J_duration_wrap"></div><div class="prop-consume-article prop-date-article">选择使用日期<i class="vline"></i><%this.month%>月<p class="gray">未来14日可预订使用，选择多日可享受折扣 <span class="discount-tip"></span></span></p></div><div class="prop-consume-box prop-date-range J_dateRange"><input type="hidden" class="J_dateRangeSelected" ><dl class="prop-date-week"><%for (var i=0;i<this.weeks.length; i++) {%><dd><%this.weeks[i]%></dd><%}%></dl><dl class="prop-date-list"></dl></div><div class="J_extend_job"></div><div class="J_discount_wrap"></div><p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a>或<a href="javascript:;" class="J_call">请销售顾问联系我</a></p></div></div></div>';return window.top.Utemplate(i,e)},e.extendJob=function(e){return window.top.Utemplate('<div class="prop-extend-job "><input type="hidden" class="J_extend_job_selected" ><p class="extend-job-title">提升邀请数量<span class="extend-job-discount J_extend_job_discount"></span></p><ul class="extend-job-list"><%for(var i = 0; i < this.list.length; i ++){%><li class="selected" data-percent="<%this.list[i].percent%>" data-position="<%this.list[i].position%>"><%this.list[i].positionName%></li><%}%></ul></div>',{list:e})},e.bombshell=function(){return'<div class="prop-consume-wrap">'+t({article:"选择需要使用牛人炸弹的职位"})+'<div class="prop-bombshell-box"></div><div class="J_discount_wrap"></div><p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a>或<a href="javascript:;" class="J_call">请销售顾问联系我</a></p></div>'},e.resume=function(){return'<div class="prop-consume-wrap">'+t({article:"选择使用简历加油包的职位"})+'<div class="prop-resume-box"></div></div>'},e.bomPosition=function(e){var t=e.job;t.fill=function(){var e=["该职位可炸牛人较少"];return 0!=t.expandLowSalary&&0!=t.expandHighSalary?"当前职位吸引力低，使用道具后效果可能较差，建议您适当提高职位薪资":0==t.expandDegreeCode&&0==t.expandLowYear&&0==t.expandHighYear?"":(0==t.expandLowYear&&0==t.expandHighYear||e.push("将经验要求扩大至"+t.expandWorkYearDesc),0!=t.expandDegreeCode&&e.push("将学历要求扩大至"+t.expandDegreeDesc),e.join("，")+"以上后可以使用牛炸")}(),0!=t.expandDegreeCode&&(t.degreeName=t.expandDegreeDesc),0==t.expandLowYear&&0==t.expandHighYear||(t.experienceName=t.expandWorkYearDesc);return t.bombPositionList=e.bombPositionList||[],window.top.Utemplate('<%if (this.fill != "") {%><p class="prop-fill-tip"><%this.fill%></p><%}%><%if (this.expandDegreeCode) {%><p class="extension-item"><i class="selected" data-type="degree"></i>同步修改职位信息中的最低学历</p><%}%><%if (this.expandLowSalary) {%><p class="extension-item"><i class="selected" data-type="salary"></i>修改职位薪资范围为：<%this.expandLowSalary%>K-<%this.expandHighSalary%>K</p><%}%><p class="prop-bombshell-article">将给满足以下条件的牛人发送推送</p><table class="prop-bombshell-infomation"><tr><td class="article">期望职位：</td><td class="description"><p><%this.positionCatgroy%></p></td><td class="article">最低学历：</td><td class="description"><p><%this.degreeName%></p></td></tr><tr><td class="article">工作地点：</td><td class="description"><p><%this.locationName%></p></td><td class="article">工作经验：</td><td class="description"><p><%this.experienceName%></p></td></tr></table><%if(this.bombPositionList.length != 0){%><div class="prop-bombshell-recommend"><p class="prop-bombshell-article">同时推荐给更多相似牛人（可选）<span class="gem-green J_recommendImprove">效果提升89%</span></p><dl><%for(var i=0;i<this.bombPositionList.length;i++){%><dd class="selected"><%this.bombPositionList[i].positionName%></dd><%}%></dl><div class="prop-error"><i class="prop-error"></i>当前牛人数量过少，为保证牛人炸弹效果，请选择相似牛人进行推送</div></div><%}%>',t)},e.position=function(e,t){var i=[0,5,8,45],a=e.filter(function(e){return i.indexOf(e.tag)>-1}),n=e.filter(function(e){return i.indexOf(e.tag)<0}),s={7:"预定满",10:"审核中",15:"职位即将到期",20:"职位审核失败",30:"人数过少",35:"职类不可用",40:"道具不足"},o=function(e){return window.top.Utemplate('<%if(this.usable.length == 0){%><li class="disabled">无可用职位</li><%}%><%for(var i=0;i<this.usable.length;i++){%><li data-val="<%this.usable[i].encryptId%>"><%this.usable[i].positionName%><em class="vline"></em><%this.usable[i].salaryDesc%><em class="vline"></em><%this.usable[i].locationName%><em class="vline"></em><%this.usable[i].degreeName%><em class="vline"></em><%this.usable[i].experienceName%></li><%}%><%if(this.unable.length != 0){%><li class="J_showUnable pos-unable-article disabled"><span class="show">显示</span><span class="hide">隐藏</span>不可用职位<i class="icon-select-arrow fr"></i></li><%for(var j=0;j<this.unable.length;j++){%><li class="disabled unable"><p class="fr unable-status"><%this.message[this.unable[j].tag]%></p><p class="unable-position"><%this.unable[j].positionName%><em class="vline"></em><%this.unable[j].salaryDesc%><em class="vline"></em><%this.unable[j].degreeName%><em class="vline"></em><%this.unable[j].experienceName%></p></li><%}%><%}%>',e)}({usable:a,unable:n,message:s});return $(".prop-consume").on("click",".pos-unable-article",function(){$(this).parents("ul").toggleClass("unfolded")}),$(".J_stickPosition").on("dropdown.selected",function(){var e=$(".J_stickPosition .dropdown-menu .cur");$(".J_stickPosition").find(".input-mask").removeClass("text-placeholder").html(e.html())}),o},e.dateRange=function(e,t){return window.top.Utemplate('<%for(var i in this.list){%><dd <%if(!this.list[i].disabled || this.list[i].status == "today"){%>class="<%this.list[i].status+this.list[i].checked%>"<%}%> data-price="<%this.list[i].price%>" data-date="<%i%>"><p><%i.substr(-2, 2)%></p><span><%if(this.list[i].disabled){%><%this.text[this.list[i].status]%><%}else if(this.list[i].price != 0 && this.showPrice){%>￥<%this.list[i].price%><%}%></span></dd><%}%>',{text:{reserve:"已预订",today:"今天",disabled:"",expired:"",locking:""},showPrice:!0,list:function(){for(var i in e){var a=e[i];a.disabled=!("canapply"===a.status||"canbuy"===a.status),a.checked=t.indexOf(i)>-1&&!a.disabled?" selected":""}return e}()})},e.posCategory=function(e){return window.top.Utemplate('<dl><dt><%this.default.name%></dt><%for(var i=0;i<this.list.length;i++){%><dd data-code="<%this.list[i].code%>"><%this.list[i].name%></dd><%}%></dl>',e)},e.selCount=function(e){var t=""!=$.trim(e.expand.workYearDesc),i=""!=$.trim(e.expand.degreeName),a=t||i?"当前可邀请投递牛人较少，":"";t&&(a+="将经验要求扩大至<strong>"+e.expand.workYearDesc+"</strong>",e.job.experienceName=e.expand.workYearDesc),i&&(a+="将学历要求扩大至<strong>"+e.expand.degreeName+"</strong>",e.job.degreeName=e.expand.degreeName),(t||i)&&(a+="后使用简历加油包");var n='<%if (this.fill != "") {%><p class="prop-fill-tip">'+a+'</p><%}%><div class="prop-resume-info"><p class="prop-resume-article">邀请满足以下条件的牛人投递简历<i class="icon-resume-mark"></i></p><div class="prop-resume-tip"><p class="resume-tip-top">使用前请确认各项条件正确无误。</p><p>您可以通过修改职位条件的方式来变 <br />更牛人的匹配条件。<br />使用后24小时将无法修改职位。</p></div><ul><li class="article">期望职位：</li><li class="content"><%this.job.positionCategory%></li><li class="article">最低学历：</li><li class="content"><%this.job.degreeName%></li><li class="article">工作地点：</li><li class="content"><%this.job.locationName%></li><li class="article">工作经验：</li><li class="content"><%this.job.experienceName%></li></ul></div><div class="prop-resume-count"><p class="prop-resume-article">选择邀请牛人数量<%if (50 < this.inviteCount && this.inviteCount < 100) {%><span class="gray">可邀请人数较少，现在使用8折优惠</span><%}%></p><ul class="scale-wrap"><%for(var i=0; i<this.priceLevel.length; i++){%><li data-count="<%this.priceLevel[i].count%>"><%this.priceLevel[i].count%></li><%}%></ul></div><div class="J_discount_wrap"></div><p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a>或<a href="javascript:;" class="J_call">请销售顾问联系我</a></p>';return window.top.Utemplate(n,e)},e.discount=function(e){return window.top.Utemplate('<div class="discount-wrap J_discount_content"><span class="discount-title">享受优惠：</span><div class="discount-content"><%for(var i=0; i<this.data.length; i++){%><span class="cell"><%this.data[i]%></span><%}%></div></div>',{data:e})},e}(),geekResumeDialog=function(){var e=function(e){var t=$.Deferred();return $.get(e).success(function(e,i,a){t.resolve(e)}),t},t=function(e){var t={};return 1==e?(t.confirmText="沟通中",t.wrapClass="inuse"):2==e?t.confirmText="关闭":3==e?(t.confirmText="立即沟通",t.wrapClass="hasused"):4==e&&(t.confirmText="继续沟通",t.wrapClass="hasused"),t},i=function(t,i,a,n){e(a).then(function(e){setTimeout(function(){$("#toast").remove()},500),$.dialog({title:"",content:'<div class="resume-dialog">'+e+"</div>",closeText:!0,confirmText:t,cancelText:!1,wrapClass:["dialog-layer-full","dialog-resume-full",i].join(" "),lock:!0,onOpen:function(e){e.find(".show-item").on("click",function(){$(this).hide(),$(this).parents(".item-container").addClass("item-all")}),e.hasClass("hasused")&&(e.find(".btns").addClass("continueTalk"),e.find(".continueTalk").on("click",function(){$.ajax({type:"POST",url:"/chat/addRelation.json",dataType:"JSON",data:{gid:n.uid,jid:n.jid||0,expectId:n.expectId},success:function(t){t.stateDes?$.toast({type:"error",content:t.stateDes}):(e.remove(),window.top.Chat.toggleUser(n,""))}})}))},onConfirm:function(e){"关闭"==e.find(".btn-sure").text()&&e.remove()}})})},a=function(a){var n="/boss/item/contact/status.json?"+a.split("?")[1];$.toast({content:"正在加载简历...",type:"loading"});var s,o={};e(n).then(function(e){var t=e.data;o={uid:t.geekId,jid:t.jobId,expectId:t.expectId},s=t.status}).then(function(){var e=t(s);i(e.confirmText,e.wrapClass,a,o)})};return function(e){a(e)}}(),Activity={init:function(){},startsProjectInit:function(){sessionStorage.getItem("startsProject")||Activity.startsProjectNeedShowDialog().then(function(e){Activity.startsProjectCallback(e)},function(){$.toast({type:"error",content:"服务器异常"})})},startsProjectNeedShowDialog:function(){var e=$.Deferred();return $.get("/wapi/zpitem/web/userItem/compensateItem2CEO").success(function(t){e.resolve(t)}).error(function(){e.reject()}),e},startsProjectCallback:function(e){0===e.code&&e.zpData?(e.zpData.canShow&&Activity.startsProjectGiftDialog(),sessionStorage.setItem("startsProject","1")):$.toast({type:"error",content:"服务器异常"})},startsProjectGiftDialog:function(){$.dialog({title:"",content:Activity.startsProjectGiftDialogHtml(),closeText:!1,confirmText:"",cancelText:"",wrapClass:"dialog-stars-project-gift",lock:!0,onOpen:function(e){e.find(".btn-receive").on("click",function(){Activity.startsProjectDialogReceive().then(function(){Activity.startsProjectDetailDialog()},function(){})})}})},startsProjectDetailDialog:function(){$.dialog({title:'免费道具已送至<span class="stress">道具商城-我的道具</span>',content:Activity.startsProjectDetailDialogHtml(),confirmText:"",cancelText:"",wrapClass:"dialog-stars-project-detail",lock:!0})},startsProjectDialogReceive:function(){var e=$.Deferred();return $.post("/wapi/zpitem/web/userItem/deliveryItem2CEO").success(function(t){0==t.code?e.resolve():e.reject(t)}).error(function(){e.reject()}),e},startsProjectGiftDialogHtml:function(){return'<div class="title">新注册CEO专属</div>\n<p class="desc">千元道具礼包<br/>精准触达400+优质牛人</p>\n<div class="icon">\n    <img src="https://img.bosszhipin.com/beijin/app/android/job_top-f09bc8eaed0f448231bd905d85e06bfc.png"/>\n    <img src="https://img.bosszhipin.com/beijin/app/android/669485943-cebcc1c6b03f49b47eec0924082bc302.jpg"/>\n</div>\n<button class="btn btn-receive">领取礼包</button>'},startsProjectDetailDialogHtml:function(){
return'<div class="sub-title">\n    <div>精准触达400+优质人才</div>\n</div>\n<div class="card-box">\n    <div class="item-card">\n        <img src="https://img.bosszhipin.com/beijin/app/android/job_top-f09bc8eaed0f448231bd905d85e06bfc.png"/>\n        <div class="item-name">牛人直通卡</div>\n        <div class="item-desc">职位置顶 多倍曝光</div>\n        <div class="item-price">价值<span class="stress">865</span>元</div>\n        <a href="/chat/im?mu=%2Fvue%2Findex%2F%23%2Fdashboard%2Fprop%2Fmine" class="btn btn-use">查看道具</a>\n    </div>\n    <div class="item-card">\n        <img src="https://img.bosszhipin.com/beijin/app/android/669485943-cebcc1c6b03f49b47eec0924082bc302.jpg"/>\n        <div class="item-name">牛人炸弹</div>\n        <div class="item-desc">自动获取百人意向</div>\n        <div class="item-price">价值<span class="stress">198</span>元</div>\n        <a href="/chat/im?mu=%2Fvue%2Findex%2F%23%2Fdashboard%2Fprop%2Fmine" class="btn btn-use">查看道具</a>\n    </div>\n</div>\n<p class="activity-desc">\n    * 本活动适用于注册时间在1个月内，并通过认证的CEO及相同类型职位的BOSS<br/>\n    * 道具有效期1年，不支持退换<br/>\n    * 如BOSS身份造假或产生违规行为，权益将会被收回<br/>\n    * BOSS直聘享有活动解释权，有相关问题欢迎咨询客服<br/>\n</p>\n<div class="logo-title">新注册CEO立享千元道具礼包</div>\n<div class="service-tips"><a href="https://www.sobot.com/chat/pc/index.html?sysNum=0ae4336e735c44f7801438a4dbc27c52&amp;color=18c3b1&amp;remark=6460082&amp;powered=false&amp;satDegree_A=false" target="_blank">CEO专属咨询/客服通道</a><span>微信号：serveboss</span></div>'}},$jscomp=$jscomp||{};$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var e=0;return function(t){return $jscomp.SYMBOL_PREFIX+(t||"")+e++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),e={next:e},e[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))};var FmsWebSupport=function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:a})},t.r=function(e){$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!=typeof Symbol&&Symbol.toStringTag&&($jscomp.initSymbol(),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i||4&i&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(a,n,function(t){return e[t]}.bind(null,n));return a},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){i.r(t),e=i(1),i=i(2),t.default={Logger:e.default,BrowserCheck:i.default}},function(e,t,i){i.r(t);var a=function(){var e="",t=function(e){console.log.apply(console,$jscomp.arrayFromIterable(e))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(e){var t=e;e>a.NONE?t=a.NONE:e<a.DEBUG&&(t=a.DEBUG),a.logLevel=t},setOutputFunction:function(e){t=e},setLogPrefix:function(t){e=t},log:function(i,n){for(var s=[],o=1;o<arguments.length;++o)s[o-1]=arguments[o];if(o=e,!(i<a.logLevel))if(i===a.DEBUG?o+="DEBUG":i===a.TRACE?o+="TRACE":i===a.INFO?o+="INFO":i===a.WARNING?o+="WARNING":i===a.ERROR&&(o+="ERROR"),s=[o+": "].concat(s),void 0!==a.panel){o="";for(var r=0;r<s.length;r+=1)o+=s[r];a.panel.value=a.panel.value+"\n"+o}else t.apply(a,[s])},debug:function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];a.log.apply(a,[a.DEBUG].concat($jscomp.arrayFromIterable(t)))},trace:function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];a.log.apply(a,[a.TRACE].concat($jscomp.arrayFromIterable(t)))},info:function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];a.log.apply(a,[a.INFO].concat($jscomp.arrayFromIterable(t)))},warning:function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];a.log.apply(a,[a.WARNING].concat($jscomp.arrayFromIterable(t)))},error:function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];a.log.apply(a,[a.ERROR].concat($jscomp.arrayFromIterable(t)))}}}();t.default=a},function(e,t,i){i.r(t),t.default=function(){return{isSupportWebrtc:function(e){return!!e&&(!(-1<e.indexOf("MSIE")||-1<e.indexOf("Trident")||-1<e.indexOf("Presto")||-1<e.indexOf("Maxthon")||-1<e.indexOf("Edge"))&&(-1<e.indexOf("AppleWebKit")?!(-1<e.indexOf("LBBROWSER")&&-1==e.indexOf("LBBROWSER/10"))&&(!(-1<e.indexOf("Chrome/"))||!(55>=1*e.split("Chrome/")[1].split(".")[0])):-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML")))}}}}]).default,mediator=mediator||new EventManger,CoopAssist=function(){var e=null;return{move:function(t,i){e=t,Menu.sideEl.find(".menu-colleague a").attr("data-url","/enterprise/colleague/list.html?uid="+e+"&name="+encodeURIComponent(i)).click()},getId:function(){return e},clear:function(){e=null}}}();!function(){var e={get:{remarks:function(e){var t=$.Deferred();return $.get("/wapi/zpboss/h5/enterprise/colleague/remarkList.json",e).success(function(e){0==e.code?(e.data=e.zpData||[],e.total=e.zpData.length,t.resolve({code:e.code,data:e.zpData})):(alert(e.resmsg),t.reject(e))}).error(function(){t.reject()}),t},colleague:function(e){var t=$.Deferred();return $.get("/boss/share/geek/matelist.json",e).success(function(e){if(e.data=e.data||{page:0,hasMore:!1,mateList:[],resume:""},1==e.rescode){var i={page:e.data.page,hasMore:e.data.hasMore,mateList:e.data.mateList,resume:e.resume,history:e.history||{portrait:"/v2/web/boss/images/figure.png",name:""},records:e.records||!0,canShareMsg:e.canShareMsg};t.resolve(i)}else t.reject(e),alert(e.resmsg)}).error(function(){t.reject()}),t},email:function(){var e=$.Deferred();return $.get("/wapi/zpboss/h5/share/recentEmails").success(function(t){0===t.code&&t.zpData?e.resolve(t.zpData):e.reject(t)}).error(function(){e.reject()}),e},bossAndMateRemarkList:function(e){var t=$.Deferred();return $.get("/wapi/zpboss/h5/inner/remark/getRemarkList",e).success(function(e){0==e.code&&e.zpData?t.resolve(e):t.reject(e)}).error(function(){t.reject()}),t}},post:{remarks:function(e){var t=$.Deferred();return $.post("/enterprise/remark/publish.json",e).success(function(e){1==e.rescode?t.resolve(e.data):(alert(e.resmsg),t.reject(e.data))}).error(function(e){t.reject()}),t},remove:function(e){var t=$.Deferred();return $.post("/enterprise/remark/delete.json",e).success(function(e){1==e.rescode?t.resolve(e.resmsg):alert(e.resmsg)}),t},forward:function(e,t,i){var a="/chat/shareGeek.json",n=$.extend({},t),s=$.Deferred();return"interview"===e.type&&(a="/wapi/zprelation/interview/wap/inner/share",n={mateId:i.id,interviewId:e.interviewId,shareMessage:t.shareNote,shareChat:t.canShareMsg}),["forward_geek","batch_forward_geek"].indexOf(e.type)>-1?(a="/wapi/zpboss/h5/batch/mate/share",n={encryptToId:t.toId,shareNote:t.shareNote,shareMessage:t.canShareMsg,mateShareGeekBatchList:e.geekList},$.ajax({type:"POST",url:a,dataType:"JSON",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(e){0===e.code?s.resolve(e.resmsg):alert(e.resmsg)}}),s):($.post(a,n).success(function(e){0===e.code?s.resolve(e.message):alert(e.message)}),s)},forwardEmail:function(e,t){var i=$.Deferred(),a={toEmail:t.toEmail,shareNote:t.shareNote,emailShareGeekBatchList:e.geekList};return $.ajax({type:"POST",url:"/wapi/zpboss/h5/batch/email/share",dataType:"JSON",contentType:"application/json; charset=utf-8",data:JSON.stringify(a),success:function(e){0===e.code?i.resolve(e.message):i.reject(e)}}),i},saveRemark:function(e){var t=$.Deferred();return $.post("/wapi/zpboss/h5/inner/remark/addRemark",e).success(function(e){0==e.code&&e.zpData?t.resolve(e.data):t.reject(e.data)}).error(function(e){t.reject()}),t}}},t=function(e){for(var t=0;t<e.data.length;t++)e.data[t].title=e.data[t].title.replace(/</g,"&#60;").replace(/>/g,"&#62;");return Utemplate('<h4>该牛人与同事的沟通记录</h4><ul class="record"><%for(var i=0;i<this.data.length;i++) {%><%if(this.data[i].source == 1) {%><li><img src="<%this.data[i].portrait%>"><div><p class="action"><%this.data[i].title%></p><p class="operat"><%this.data[i].addDate%></p></div></li><%}%><%}%></ul>',e)},i=function(e,t){var i=t&&"interview"===t.type?"转发面试安排，您可以":"转发牛人",a=t&&["forward_geek","batch_forward_geek"].indexOf(t.type)>-1?"":"checked",n=t&&["forward_geek","batch_forward_geek"].indexOf(t.type)>-1?'<div class="title-tip">同事至少有一个在线职位且职位发布2小时后才能被搜索到</div>':"";return Utemplate("<h4>"+i+': </h4><span class="sub-title">通过邮箱或站内转发</span>'+n+'<div class="coop-search"><div class="coop-input"><input class="ipt" placeholder="姓名、职位、邮箱" type="text" name=""><i class="coop-icon-search iboss-menu-search"></i><i class="icon-selecter-close iboss-close-solid"></i></div><div class="dl-lists"><dl></dl><div class="dl-loadmore">正在加载</div></div></div><div class="error-tip hide"><i class="iboss-iboss-explain-solid"></i>输入正确的邮箱地址</div><textarea placeholder="请输入转发留言"></textarea><ul class="check-list"><%if(this.records && this.canShareMsg){%><li><label class="checkbox"><input type="checkbox" '+a+' name="coop-chat" value="manual"/><span>连同聊天记录一并转发</span></label></li><%}%><%if(this.resume){%><li><label class="checkbox"><input type="checkbox" checked name="coop-resume" value="manual"/><span>将获得的附件简历一并转发</span></label></li><%}%></ul><div class="btns"><a ka="geek_coop_forward" class="btn btn-forward" href="javascript:;">转发</a></div>',e)},a=function(e){var e={data:e};return Utemplate('<%if(!this.data){%><dt class="gray blank">没有符合条件的同事</dt><dd class="tip"><span>1. 同事的公司全称需与您一致</span><span>2. 同事需发布至少一个在线职位</span><span>3. 确保你输入的搜索信息与该同事的信息一致</span></dd><%}%><%if(this.data){%><%for(var i=0;i<this.data.length;i++){%><dd data-id="<%this.data[i].encryptUserId%>"><%this.data[i].name%><em class="vline"></em><%this.data[i].title%><em class="vline"></em><%this.data[i].mail%><%if(this.data[i].mail ==""){%>-<%}%></dd><%}%><%}%>',e)},n=function(e,t){return Utemplate('<%if((!this.mateList || !this.mateList.length) && (!this.emails || !this.emails.length)){%><dt class="gray blank">没有符合条件的信息，你可以直接转发邮箱</dt><%}%><%if(this.emails && this.emails.length){%><dt class="tip">最近的邮箱转发</dt><%for(var i=0;i<this.emails.length;i++){%><dd data-type="email"><%this.emails[i]%></dd><%}%><%}%><%if(this.mateList && this.mateList.length){%><dt class="tip">站内同事</dt><%for(var i=0;i<this.mateList.length;i++){%><dd data-id="<%this.mateList[i].encryptUserId%>"><%this.mateList[i].name%><em class="vline"></em><%this.mateList[i].title%><em class="vline"></em><%this.mateList[i].mail%><%if(this.mateList[i].mail ==""){%>-<%}%></dd><%}%><%}%>',{mateList:e,emails:t})},s=function(){this.render=function(i,a){e.get.remarks({geek:a.geek}).then(function(e){0==e.code&&i.find(".dialog-con").html(t(e))},function(){})}},o=function(){var t,n,s=!1,o={},r=!1,c=[],l={},d={forward:!1},u=this,p=function(e,t){var i=function(t){var i=t,a=new RegExp(e,"g");return $.each(i,function(t){i[t]=i[t].replace(a,'<u class="h">'+e+"</u>")}),i.join('<em class="vline"></em>')};$.each(t,function(){var e=$(this).html().split('<em class="vline"></em>');e.length>1&&$(this).html(i(e))})},h=function(e){var t=e,i=$(a(t));o.$query&&p(o.$query,i),o.mateList&&o.mateList.length?$(".coop-forward .coop-search dl").append(i):$(".coop-forward .coop-search dl").empty().html(i)},f=function(e){for(var t,i=0;i<c.length;i++)c[i].encryptUserId==e&&(t=c[i]);return t};this.isVisiable=function(e){var t=e.getBoundingClientRect();return t.top>0&&window.innerHeight-t.top>0||t.top<=0&&t.bottom>=0};var m=function(e,t){var i=["正在加载","没有更多了","加载更多"],a=n&&n.find(".coop-forward .coop-search .dl-loadmore");a=a&&a.length?a:$(".coop-forward .coop-search .dl-loadmore"),t?a.hide():a.html(i[e]).show()},g=function(){o.mateList=new Array,o.$query="",u.__isLoading=!1,u.__hasMore=!0,u.__page=1,c=[],$(".coop-forward .coop-search dl").empty()},v=function(){if(u.__hasMore&&!u.__isLoading){m(0,!0),u.__isLoading=!0;var t=$.Deferred(),i={geek:u.geekId,page:u.__page,query:o.$query.toLowerCase()};return e.get.colleague(i).then(function(e){if(t.resolve(e),u.__page=e.page+1,u.__hasMore=e.hasMore,u.__isLoading=!1,r=!1,e.mateList&&e.mateList.length)for(var i=0;i<e.mateList.length;i++)c.push(e.mateList[i]);o=$.extend(o,e)},function(){t.reject(),u.__isLoading=!1}),t}},b=function(){v().then(function(e){h(e.mateList);var t=e.hasMore?2:1;e.mateList?m(t):m(0,!0)})},y=function(i){i.off();var a=i.find(".coop-input input");i.on("focus",".coop-input input",function(){r=!0;var e=$(this).val();g(),o.$query=e,b(),i.find(".coop-search .dl-lists").show(),e.length>0?(i.find(".coop-icon-search").hide(),i.find(".icon-selecter-close").show()):(i.find(".coop-icon-search").show(),i.find(".icon-selecter-close").hide())}),i.on("click",function(){i.find(".coop-search .dl-lists").hide()}),i.on("click",".coop-search",function(e){return e.preventDefault(),!1}),i.on("click",".coop-search dd:not(.tip)",function(e){var t=f($(this).attr("data-id"));return o.history=t,a.val(t.name),i.find(".coop-search .dl-lists").hide(),e.preventDefault(),!1}),i.on("input",".coop-input input",function(){var e=$(this).val().trim();e.length>0?(i.find(".coop-icon-search").hide(),i.find(".icon-selecter-close").show()):(i.find(".coop-icon-search").show(),i.find(".icon-selecter-close").hide()),g(),o.$query=e,b()}),i.on("click",".icon-selecter-close",function(){i.find(".coop-icon-search").show(),i.find(".icon-selecter-close").hide(),a.val(""),g(),b()}),i.on("click",".btn-forward",function(){if(!o.history.encryptUserId)return alert("请选择一位同事"),!1;if(d.forward)return!1;d.forward=!0;var a=$(".coop-forward textarea").val().trim(),n={toId:o.history.encryptUserId,geekId:l.geekId,expectId:l.expectId,shareNote:a,canShareMsg:$("input[name='coop-chat']").is(":checked")?1:0,shareResume:$("input[name='coop-resume']").is(":checked")?1:0};e.post.forward(l,n,o.history).then(function(){1==localStorage.getItem("send_notips")?($.toast({type:"success",content:"转发成功"}),i.remove()):$.dialog({type:"info",title:"转发成功",content:'<div class="tip-text">已直接为你和同事创建了协同群聊会话，可方便进一步沟通协作</div><div><input class="send-notips" type="checkbox">  不再提示</div>',closeText:!0,confirmText:"知道了",cancelText:"",closeLayer:!1,wrapClass:"dialog-icons-default",lock:!0,onConfirm:function(e){e.find(".send-notips:checked").length&&localStorage.setItem("send_notips",1),e.remove()}}),t&&t.close(),d.forward=!1},function(){d.forward=!1})}),i.find(".coop-search .dl-lists").off("scroll").on("scroll",function(){r||(u.timer&&clearTimeout(u.timer),u.timer=setTimeout(function(){var e=$(".coop-forward .coop-search .dl-loadmore").get(0);!u.__isLoading&&u.isVisiable(e)&&u.__hasMore&&b()},200))})};this.render=function(t,a){n=t,l=$.extend({},a),u.geekId=l.geek,u.__isLoading=!1,u.__hasMore=!0,u.__page=1,o.$query="",e.get.colleague({geek:l.geek,page:u.__page}).then(function(e){o=$.extend({},e),c=e.mateList,t.find(".coop-forward").html(i(o,l)),y(t),h(o.mateList);var a=e.hasMore?2:1;e.mateList?m(a):m(0,!0)},function(){t.find(".coop-forward").html("<p style='padding-bottom: 30px;'>加载错误<br></p>")}),s=!0}},r=function(){var t,s,o=!1,r={},c=!1,l=[],d={},u={forward:!1},p=this,h=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,f=!1,m=function(e,t){var i=function(t){var i=t,a=new RegExp(e,"g");return $.each(i,function(t){i[t]=i[t].replace(a,'<u class="h">'+e+"</u>")}),i.join('<em class="vline"></em>')};$.each(t,function(){var e=$(this).html().split('<em class="vline"></em>');e.length>0&&$(this).html(i(e))})},g=function(e){var t=e,i=$(a(t));r.$query&&m(r.$query,i),r.mateList&&r.mateList.length?$(".coop-forward .coop-search dl").append(i):$(".coop-forward .coop-search dl").empty().html(i)},v=function(e,t){var i=e,a=$(n(i,t));r.$query&&m(r.$query,a),r.mateList&&r.mateList.length?$(".coop-forward .coop-search dl").append(a):$(".coop-forward .coop-search dl").empty().html(a)},b=function(e){for(var t,i=0;i<l.length;i++)l[i].encryptUserId==e&&(t=l[i]);return t};this.isVisiable=function(e){var t=e.getBoundingClientRect();return t.top>0&&window.innerHeight-t.top>0||t.top<=0&&t.bottom>=0};var y=function(e,t){var i=["正在加载","没有更多了","加载更多"],a=s&&s.find(".coop-forward .coop-search .dl-loadmore");a=a&&a.length?a:$(".coop-forward .coop-search .dl-loadmore"),t?a.hide():a.html(i[e]).show()},w=function(){r.mateList=new Array,r.$query="",p.__isLoading=!1,p.__hasMore=!0,p.__page=1,l=[],$(".coop-forward .coop-search dl").empty()},C=function(){if(p.__hasMore&&!p.__isLoading){y(0,!0),p.__isLoading=!0;var t=$.Deferred(),i={geek:p.geekId,page:p.__page,query:r.$query.toLowerCase()};return e.get.colleague(i).then(function(e){if(t.resolve(e),p.__page=e.page+1,p.__hasMore=e.hasMore,p.__isLoading=!1,c=!1,e.mateList&&e.mateList.length)for(var i=0;i<e.mateList.length;i++)l.push(e.mateList[i]);r=$.extend(r,e)},function(){t.reject(),p.__isLoading=!1}),t}},x=function(e){C().then(function(t){if("loadmore"===e)g(t.mateList);else if(""===r.$query)v(t.mateList,r.emails.slice(0,2));else{var i=[];$.each(r.emails,function(e,t){t.indexOf(r.$query)>-1&&i.push(t)}),v(t.mateList,i)}var a=t.hasMore?2:1;t.mateList&&t.mateList.length?y(a):y(0,!0)})},k=function(e){e.off();var t=e.find(".coop-input input"),i=e.find("input[name=coop-chat]");e.on("focus",".coop-input input",function(){c=!0;var t=$(this).val();w(),r.$query=t,x(),e.find(".coop-search .dl-lists").show(),t.length>0?(e.find(".coop-icon-search").hide(),e.find(".icon-selecter-close").show()):(e.find(".coop-icon-search").show(),e.find(".icon-selecter-close").hide())}),e.on("click",function(){e.find(".coop-search .dl-lists").hide()}),e.on("click",".coop-search",function(e){return e.preventDefault(),!1}),e.on("click",".coop-search dd:not(.tip)",function(a){if("email"===$(this).attr("data-type"))r.history=$(this).text(),t.val($(this).text()),i.prop("checked",!1).prop("disabled",!0);else{var n=b($(this).attr("data-id"));r.history=n,t.val(n.name),i.prop("disabled",!1)}return e.find(".error-tip").addClass("hide"),e.find(".coop-search .dl-lists").hide(),a.preventDefault(),!1}),e.on("input",".coop-input input",function(){if(f)return!0;T(e,$(this),i)}),e.on("compositionstart",".coop-input input",function(){f=!0}),e.on("compositionend",".coop-input input",function(){f=!1,T(e,$(this),i)}),e.on("click",".icon-selecter-close",function(){e.find(".coop-icon-search").show(),e.find(".icon-selecter-close").hide(),e.find(".error-tip").addClass("hide"),i.prop("disabled",!1),t.val(""),w(),x()}),e.on("click",".btn-forward",function(){e.find(".error-tip").addClass("hide"),t.val().indexOf("@")>-1?I(e):S(e)}),e.find(".coop-search .dl-lists").off("scroll").on("scroll",function(){c||(p.timer&&clearTimeout(p.timer),p.timer=setTimeout(function(){var e=$(".coop-forward .coop-search .dl-loadmore").get(0);!p.__isLoading&&p.isVisiable(e)&&p.__hasMore&&x("loadmore")},200))})},T=function(e,t,i){var a=t.val().trim();a.length>0?(e.find(".coop-icon-search").hide(),e.find(".icon-selecter-close").show()):(e.find(".coop-icon-search").show(),e.find(".icon-selecter-close").hide()),a.indexOf("@")>-1?i.prop("checked",!1).prop("disabled",!0):i.prop("disabled",!1),w(),r.$query=a,e.find(".error-tip").addClass("hide"),x()},I=function(i){var a=i.find(".coop-input input").val();if(!h.test(a))return i.find(".error-tip").removeClass("hide"),!0;var n={toEmail:a,shareNote:$(".coop-forward textarea").val().trim()};e.post.forwardEmail(d,n).then(function(){$.toast({type:"success",content:"转发成功"}),i.remove(),t&&t.close(),u.forward=!1},function(e){$.toast({type:"error",content:e.message||"服务器异常"}),u.forward=!1})},S=function(i){if(!r.history.encryptUserId)return alert("请选择一位同事"),!1;if(u.forward)return!1;u.forward=!0;var a=$(".coop-forward textarea").val().trim(),n={toId:r.history.encryptUserId,geekId:d.geekId,expectId:d.expectId,shareNote:a,canShareMsg:$("input[name='coop-chat']").is(":checked")?1:0,shareResume:$("input[name='coop-resume']").is(":checked")?1:0};e.post.forward(d,n,r.history).then(function(){1==localStorage.getItem("send_notips")?($.toast({type:"success",content:"转发成功"}),i.remove()):$.dialog({type:"info",title:"转发成功",content:'<div class="tip-text">已直接为你和同事创建了协同群聊会话，可方便进一步沟通协作</div><div><input class="send-notips" type="checkbox">  不再提示</div>',closeText:!0,confirmText:"知道了",cancelText:"",closeLayer:!1,wrapClass:"dialog-icons-default",lock:!0,onConfirm:function(e){e.find(".send-notips:checked").length&&localStorage.setItem("send_notips",1),e.remove()}}),t&&t.close(),u.forward=!1},function(){u.forward=!1})};this.render=function(t,a){s=t,d=$.extend({},a),p.geekId=d.geek,p.__isLoading=!1,p.__hasMore=!0,p.__page=1,r.$query="",e.get.colleague({geek:d.geek,page:p.__page}).then(function(a){e.get.email().then(function(e){r=$.extend({},a),r.emails=e.recentEmails||[],l=a.mateList,t.find(".coop-forward").html(i(r,d)),k(t),v(r.mateList,r.emails.slice(0,2));var n=a.hasMore?2:1;a.mateList&&a.mateList.length?y(n):y(0,!0)})},function(){t.find(".coop-forward").html("<p style='padding-bottom: 30px;'>加载错误<br></p>")}),o=!0}},c=function(){var e=function(e){return'<span class="sub-title">微信扫码，附件简历也可以转发了</span><div class="qrcode-wrap"><img src=""/><canvas class="qrcode-bg" width="190" height="190"></canvas></div>'};this.render=function(i,a){var n=i.find(".forward-wechat");n.append(e());var s,o,r=a.geekList&&a.geekList[0];if("forward_geek"===a.type&&r&&(s="/boss/share/geek.json",o={geekId:r.encryptGeekId,expectId:r.expectId,jobId:r.jobId}),"interview"===a.type&&(s="/wapi/zprelation/interview/wap/wechat/share",o={interviewId:a.interviewId}),["batch_forward_geek"].indexOf(a.type)>-1)return s="/wapi/zpboss/h5/batch/share/QRCode",o={wxShareGeekBatchList:a.geekList},$.ajax({url:s,type:"POST",data:JSON.stringify(o),contentType:"application/json; charset=utf-8",dataType:"JSON",timeout:3e4,success:function(e){0==e.code?(n.find("img").attr("src",e.zpData.qrCodeUrl),t(n.find(".qrcode-bg"))):n.append('<span class="text-tip">获取二维码失败，请稍后再试</span>')}}),!0;$.ajax({url:s,type:"GET",data:o,dataType:"JSON",timeout:3e4,success:function(e){if(1==e.rescode||0==e.code)n.find("img").attr("src",e.qrUrl||e.zpData.qrUrl||e.zpData.qrCodeUrl),t(n.find(".qrcode-bg"));else{if(9001===e.rescode)return $(".dialog-wrap.forward-geek-wrap").remove(),$.toast({type:"error",content:e.resmsg}),!1;n.append('<span class="text-tip">获取二维码失败，请稍后再试</span>')}}})};var t=function(e){var t=e[0],a=t.getContext("2d");a.strokeStyle="#CEEFEC",a.fillStyle="#A9E6E0",a.translate(5,5),i(a,0)},i=function(e,t){e.clearRect(-5,-5,190,190),e.beginPath(),e.arc(90,90,90,0,2*Math.PI),e.moveTo(170,90),e.arc(90,90,80,0,2*Math.PI),e.moveTo(160,90),e.arc(90,90,70,0,2*Math.PI),e.stroke(),e.closePath(),t=t>=360?1:t+.2;var a=t*Math.PI/180;e.beginPath(),e.arc(90+90*Math.sin(a),90+90*Math.cos(a),3,0,2*Math.PI),e.moveTo(90+80*Math.sin(2*-a),90+80*Math.cos(2*-a)),e.arc(90+80*Math.sin(2*-a),90+80*Math.cos(2*-a),2,0,2*Math.PI),e.moveTo(90+70*Math.sin(5*a),90+70*Math.cos(5*a)),e.arc(90+70*Math.sin(5*a),90+70*Math.cos(5*a),2,0,2*Math.PI),e.fill(),e.closePath(),requestAnimationFrame(function(){i(e,t)})}},l=function(){var t=["更新了备注","已开聊","已回应","已有联系方式","更换过职位","转发了该牛人","已发面试邀请","面试已完成"];this.renderDialog=function(e,t){var i=this;this.getData(t,function(a){0==a.code&&a.zpData&&(i.preDealDataForDialog(a.zpData),e.find(".dialog-con").html(i.getDialogHtml(a.zpData,t)),i.addEvent(e,t))},function(){$.toast({type:"error",content:"服务器异常"}),setTimeout(function(){e.remove()},500)})},this.getData=function(t,i,a){e.get.bossAndMateRemarkList({geekId:t.geek}).then(function(e){i(e)},function(){a()})},this.getBossCurStep=function(e){if(e.bossRemarkList&&e.bossRemarkList.length){for(var t=0;t<e.bossRemarkList.length;t++){var i=e.bossRemarkList[t];if(0!==i.type&&4!==i.type&&5!==i.type)return i}return e.bossRemarkList[0]}return{}},this.getMateCurStepType=function(e){return e.mateRemarkList&&e.mateRemarkList.length?e.mateRemarkList[e.mateRemarkList.length-1].type:""},this.preDealDataForDialog=function(e){var t=this;e.mateRemarkList&&e.mateRemarkList.length&&$.each(e.mateRemarkList,function(e,i){var a=new Date(i.addTime);i.date=t.dateFormat(a,"yyyy-MM-dd"),i.time=t.dateFormat(a,"hh:mm")}),e.bossRemarkList&&e.bossRemarkList.length&&$.each(e.bossRemarkList,function(e,i){var a=new Date(i.addTime);i.date=t.dateFormat(a,"yyyy-MM-dd"),i.time=t.dateFormat(a,"hh:mm")})},this.dateFormat=function(e,t){var i={Z:"","M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"H+":e.getHours()>12?e.getHours()-12:e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t},this.getDialogHtml=function(e,i){for(var a=this.getMateCurStepType(e),n=this.getBossCurStep(e),s=[0,0,0,0,0,0,0,0],o=0;o<e.bossRemarkList.length;o++)e.bossRemarkList[o].remark=e.bossRemarkList[o].remark.replace(/</g,"&#60;").replace(/>/g,"&#62;");for(var o=0;o<e.mateRemarkList.length;o++)e.mateRemarkList[o].remark=e.mateRemarkList[o].remark.replace(/</g,"&#60;").replace(/>/g,"&#62;"),++s[e.mateRemarkList[o].type];var r='<div class="step-box">\n    <%if(this.bossRemarkList && this.bossRemarkList.length != 0) {%>    \t<div class="boss-step">\n        \t<h5>我与 Ta 的沟通进度</h5>\n        \t<div class="detail">'+t[n.type]+"&nbsp;&nbsp;&nbsp;"+n.date+"&nbsp;&nbsp;"+n.time+'</div>\n    \t</div>\n    \t<%if(this.mateRemarkList && this.mateRemarkList.length != 0) {%>    \t\t<div class="simple-mate-step">\n        \t\t<div class="detail">同事与Ta的进度:&nbsp;&nbsp;&nbsp;&nbsp;打招呼<em>'+s[1]+"</em>次&nbsp;&nbsp;回应<em>"+s[2]+"</em>次&nbsp;&nbsp;交换<em>"+s[3]+"</em>次&nbsp;&nbsp;约面<em>"+s[6]+"</em>次&nbsp;&nbsp;完成<em>"+s[7]+'</em>次</div>\n    \t\t</div>\n    \t<%}%>    <%}else if(this.mateRemarkList && this.mateRemarkList.length != 0){%>    \t<div class="mate-step">\n        \t<h5>同事与Ta 的沟通进度</h5>\n        \t<ul class="detail">\n            \t<li'+(1===a?' class="cur" ':"")+">打招呼 <em>"+s[1]+"</em></li>\n            \t<li"+(2===a?' class="cur" ':"")+">回应 <em>"+s[2]+"</em></li>\n            \t<li"+(3===a?' class="cur" ':"")+">交换 <em>"+s[3]+"</em></li>\n            \t<li"+(6===a?' class="cur" ':"")+">约面 <em>"+s[6]+"</em></li>\n            \t<li"+(7===a?' class="cur" ':"")+">完成 <em>"+s[7]+'</em></li>\n        \t</ul>\n    \t</div>\n    <%}%></div>\n<div class="log-box">\n    <div class="tab-box">\n    \t<%if(this.bossRemarkList && this.bossRemarkList.length != 0) {%>        \t<h5 class="cur" data-type="0">我的进度详情</h5>\n        \t<em class="vline"></em>\n    \t<%}%>    \t<%if(this.mateRemarkList && this.mateRemarkList.length != 0) {%>        <h5 data-type="1">同事进度详情</h5>\n        <em class="vline"></em>\n    \t<%}%>    </div>\n    <div class="log-content">    \t<%if(this.bossRemarkList && this.bossRemarkList.length != 0) {%>    \t<ul class="boss-list cur">\n        \t<%for(var i=0;i<this.bossRemarkList.length;i++) {%>        \t\t<li class="type-<%this.bossRemarkList[i].type%>">\n            \t\t<div class="date-time">\n            \t    \t<div class="date"><%this.bossRemarkList[i].date%></div>\n               \t \t<div class="time"><%this.bossRemarkList[i].time%></div>\n            \t\t</div>\n            \t\t<img src="<%this.bossRemarkList[i].bossTiny%>"/>\n            \t\t<div class="remark">\n                \t\t<div class="title"><%this.bossRemarkList[i].title%></div>\n                \t\t<div class="sub-title"><%this.bossRemarkList[i].remark%></div>\n            \t\t</div>\n        \t\t</li>\n        \t<%}%>    \t</ul>\n       <%}%>    \t<%if(this.mateRemarkList && this.mateRemarkList.length != 0) {%>    \t<ul class="mate-list <%if(!this.bossRemarkList || this.bossRemarkList.length == 0){%>cur<%}%>">\n        \t<%for(var i=0;i<this.mateRemarkList.length;i++) {%>        \t\t<li class="type-<%this.mateRemarkList[i].type%>">\n            \t\t<div class="date-time">\n                \t\t<div class="date"><%this.mateRemarkList[i].date%></div>\n                \t\t<div class="time"><%this.mateRemarkList[i].time%></div>\n            \t\t</div>\n            \t\t<img src="<%this.mateRemarkList[i].bossTiny%>"/>\n            \t\t<div class="remark">\n                \t\t<div class="title"><%this.mateRemarkList[i].title%></div>\n                \t\t<div class="sub-title"><%this.mateRemarkList[i].remark%></div>\n            \t\t</div>\n        \t\t</li>\n        \t<%}%>    \t</ul>\n       <%}%>    </div>\n</div>\n<div class="remark-box">\n    <textarea placeholder="记录你的沟通进度，仅自己及公司同事可见"></textarea>\n    <div class="error-tip hide">最多输入500字</div>\n\t <div class="remark-count hide"><span>0</span>/500</div>\n    <button class="btn btn-sure hide" ka="geek_schedule_add_'+i.geek+'">确定</button>\n</div>';return Utemplate(r,e)},this.addEvent=function(t,i){var a=t.find(".remark-box"),n=a.find(".btn-sure"),s=a.find(".remark-count"),o=s.find("span"),r=a.find(".error-tip"),c=a.find("textarea"),l=this;t.find(".tab-box h5").on("click",function(){$(this).addClass("cur").siblings("h5").removeClass("cur"),t.find(".log-content ul").eq(Number($(this).data("type"))).addClass("cur").siblings().removeClass("cur")}),t.find(".log-content .remark").on("click",function(){$(this).toggleClass("unFolder")}),t.find(".remark-box .btn-sure").on("click",function(){if(c.val().trim().length>500)return r.removeClass("hide"),!1;e.post.saveRemark({geekId:i.geek,remark:filterXss(c.val())}).then(function(e){l.renderDialog(t,i)},function(){$.toast("服务器异常","error")})}),c.on("input",function(){if(c.val().trim()){n.removeClass("hide"),s.removeClass("hide");var e=c.val().trim().length;o.text(e),e>500?o.addClass("red"):(o.removeClass("red"),r.addClass("hide"))}else n.addClass("hide"),s.addClass("hide"),o.removeClass("red")})}},d=new o,u=new c,p=new s,h=new l,f=new r;mediator.subscribe("FORWARD_GEEK",function(e){var t=$.extend({},e);$.dialog({title:"",content:'<div class="forward-wechat"></div><div class="coop-forward coop-wrap"></div>',confirmText:"",cancelText:"",inline:!0,wrapClass:"dialog-prop-default forward-geek-wrap "+("interview"==e.type?" forward-interview":""),onOpen:function(i){u.render(i,t),["forward_geek","batch_forward_geek"].indexOf(e.type)>-1?f.render(i,t):d.render(i,t)}})}),mediator.subscribe("COMMUNICATION_RECORD",function(e){var t=$.extend({},e);$.dialog({title:"",content:"",confirmText:"",cancelText:"",wrapClass:"dialog-prop-default coop-record-wrap",onOpen:function(e){p.render(e,t)}})}),mediator.subscribe("REMARK_LIST_DIALOG",function(e){var t=$.extend({},e);$.dialog({
title:"牛人沟通进度",content:"",confirmText:"",cancelText:"",wrapClass:"dialog-prop-default dialog-remark-list",onOpen:function(e){h.renderDialog(e,t)}});try{_T.sendEvent("geek_schedule_click_"+e.geek)}catch(e){}}),$(document).ready(function(){$(document).on("click",".icon-coop",function(){if("Recommend"in window&&Recommend.visiable&&PreviewPosition.include())return PreviewPosition.review(function(){Recommend.getData(1)});var e=$(this);e.closest("#recommend-list").length&&localStorageInstance("recommend-pos",$("#container").scrollTop()),e.attr("data-uid")&&""!=e.attr("data-uid")&&mediator.publish("COMMUNICATION_RECORD",{geek:e.attr("data-eid")})})})}();var ResumeViewer=function(){var e={},t=function(){var t={suid:e.suid,lid:e.lid,expectId:e.expectId},i={success:function(){e.consume&&e.consume()}},a={success:function(){PropShop.geekPropCall.consume(t,i)}},n=function(e){$.confirm({content:'<div class="prop-cont"><div class="prop-end"><p>购买成功</p>搜索畅聊卡30天内有效，购买后即可生效，到期后剩余权限作废。</div></div>',backgroundDismiss:!1,confirmButton:"立即使用",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/succ.png" alt="牛人" class="title-icon">',confirm:function(){this.close(),Recommend.consumeSearchCard($item,$btn)}})};$.when(function(){var e=$.Deferred();return $.get("/boss/item/isShowAndItemCount.json",t,function(t){var t="string"==typeof t?$.parseJSON(t):t;e.resolve(t)}),e}(),function(){var e=$.Deferred();return $.get("/wapi/zpitem/web/geekInfoRight/getGeekInfoRight.json",function(t){e.resolve(t.zpData)}),e}()).then(function(e,s){if(a.props=s,e.itemCount<1||e.canBuySearchCard&&e.searchChatCount<1){if(SearchChatingCard.include({left:e.itemCount,data:s,success:function(e){"chat"===e.card?n():a.success()}}))return!0;PropShop.geekPropCall.buy(a)}else PropShop.geekPropCall.consume(t,i)})};return{preview:function(i){e=i,$.toast({content:"正在加载简历...",type:"loading",parentWrap:window.top.document.body});var a=function(e){var i={title:"",content:e,closeText:!0,closeLayer:!1,wrapClass:"dialog-layer-full dialog-resume-full",lock:!0,cancelText:!1,confirmText:"联系Ta",onOpen:function(e){e.find(".next-btn").on("click",function(){Search.showNextResume()}),e.find(".prev-btn").on("click",function(){Search.showPrevResume()}),e.on("click",".dialog-footer .btn-getcontact",function(){var t="."+$(this).attr("class").split(" ").join(".");el.find(t).click(),e.remove()}),e.find(".resume-lock").length&&e.find(".dialog-footer").hide(),e.find(".show-item").on("click",function(){$(this).hide(),$(this).parents(".item-container").addClass("item-all")}),e.find(".btns .btn-getvipcontact, .btns .btn-continue").on("click",function(){"0"==$(this).attr("data-isvip")?window.top.Commercial.vip({sf:14},function(){el.find(".btn-getvipcontact").attr("data-isvip","1"),el.trigger("click"),Search.nowResume="",$("#container").hasClass("search-result-model")&&($(".nav-info").html("<span>您已开通VIP账号，匿名牛人已全部解锁</span>").unbind("click"),Search.getData(1),$(".search-query .prop-buy").remove())}):"1"==$(this).attr("data-isvip")&&($(this).hasClass("btn-continue")?SearchGeekModified.continueChat($(this)):SearchGeekModified.greetChat(el,$(this)))}),e.find(".dialog-con").on("click",function(t){$(t.target).parents(".dialog-con").length||e.remove()})},onConfirm:function(e){t()}};i.onCancel=function(e){propInit.init({suid:el.attr("data-suid")||"",lid:el.attr("data-lid")||"",el:el,card:"call"}),e.remove()},$.dialog(i)},n={suid:e.suid,jid:e.jid,lid:e.lid,expectId:e.expectId,ka:"detail_search_lst_"+e.suid};$.get("/boss/search/geek/info",n,function(e,t){console.log(arguments),$("#toast").remove(),a('<div class="resume-dialog">'+e+"</div>")})}}}(),SearchResumeViewer=function(){var e={};return{preview:function(t,i){e=t;var a=t.el,n=t.card,s=t.segs;$.toast({content:"正在加载简历...",type:"loading",parentWrap:window.top.document.body});window.top.$(".list-and-phone .geek-content li");if(i)for(var o=0;o<i.length;o++){var r=i[o];if(r.geekCard.encryptUserId===t.suid){o;break}}var c=function(e){var s={title:"",content:e,closeText:!0,closeLayer:!1,wrapClass:"dialog-layer-full dialog-resume-full search-resume",lock:!0,cancelText:!1,confirmText:"联系Ta",onOpen:function(e){e.find(".next-btn").on("click",function(){Search.showNextResume()}),e.find(".prev-btn").on("click",function(){Search.showPrevResume()}),e.find(".resume-lock").length&&e.find(".dialog-footer").hide(),e.on("click",".show-item",function(){$(this).hide(),$(this).parents(".item-container").addClass("item-all")});var s=t.el.find(".item-operate button");$(".search-resume .btns").html("");for(var o=0;o<s.length;o++){$(".search-resume .btns").append($(s[o]).clone(!0));var r=$($(".search-resume .btns button")[o]);r.unbind("click"),r.on("click",function(t){return function(i){s[t].click(),"call"===n&&e.remove()}}(o))}e.find(".btns .btn-getvipcontact, .btns .btn-continue").on("click",function(){"0"==$(this).attr("data-isvip")?window.top.Commercial.vip({sf:14},function(){a.find(".btn-getvipcontact").attr("data-isvip","1"),a.trigger("click"),Search.nowResume="",$("#container").hasClass("search-result-model")&&($(".nav-info").html("<span>您已开通VIP账号，匿名牛人已全部解锁</span>").unbind("click"),Search.getData(1),$(".search-query .prop-buy").remove())}):"1"==$(this).attr("data-isvip")&&($(this).hasClass("btn-continue")?SearchGeekModified.continueChat($(this)):SearchGeekModified.greetChat(a,$(this)))}),e.find(".dialog-con").on("click",function(t){$(t.target).parents(".dialog-con").length||e.remove()}),d.setNextPreBtn(i)},onConfirm:function(e){}};s.onCancel=function(e){e.remove()},$.dialog(s)},l={suid:e.suid,jid:e.jid,lid:e.lid,expectId:e.expectId,securityId:e.securityId,segs:s,ka:"detail_search_lst_"+e.suid};$.get("/boss/search/geek/info",l,function(e,t){$("#toast").remove(),c('<div class="resume-dialog">'+e+"</div>")});var d={lisDOM:window.top.$(".geeksearch-container iframe").contents().find(".geek-content li"),reCloneResumeBtn:function(e){var t=d.lisDOM.eq(e),i=t.find(".item-operate button");$(".search-resume .btns").html("");for(var a=0;a<i.length;a++){$(".search-resume .btns").append($(i[a]).clone(!0));var s=$($(".search-resume .btns button")[a]);s.unbind("click"),s.on("click",function(e){return function(t){i[e].click(),"call"===n&&wrap.remove()}}(a))}},setBtnParams:function(e,t){if(!t)return null;var i=t[e];if(!i)return null;var a=i.geekCard;return a?{suid:a.encryptUserId,jid:a.jid,lid:a.lid,securityId:a.securityId,segs:s,expectId:a.expectId,ka:"detail_search_lst_"+a.encryptUserId}:null},setNextPreBtn:function(e){$(".search-resume .resume-dialog").before('<div class="prev-btn"></div><div class="next-btn">');var i=0;if(e)for(var a=0;a<e.length;a++){var n=e[a];if(n.geekCard.encryptUserId===t.suid){i=a;break}}$(".search-resume .prev-btn,.search-resume .next-btn").unbind("click"),$(".prev-btn").on("click",function(t){i-=1,d.clickHandle(i,e)}),$(".next-btn").on("click",function(t){i+=1,d.clickHandle(i,e)})},requestResume:function(e){window.top.$("#toast").remove(),window.top.$.toast({content:"正在加载简历...",type:"loading",parentWrap:window.top.document.body});var t={suid:e.suid,jid:e.jid,lid:e.lid,expectId:e.expectId,securityId:e.securityId,segs:s,ka:"detail_search_lst_"+e.suid};$.get("/boss/search/geek/info",t,function(e,t){$("#toast").remove(),$(".resume-dialog").html(e)})},clickHandle:function(e,t,i){var a=d.setBtnParams(e,t,i);if(!a)return void window.top.$.toast({content:"已经是最后一份简历了",type:"info"});d.requestResume(a),d.reCloneResumeBtn(e)}}}}}();window.SearchResumeViewer=SearchResumeViewer;var Counselor=function(){var e={},t=0,i=function(e){var t=new Date(e.time),i=new Date;return t.getDate()==i.getDate()&&t.getMonth()==i.getMonth()},a=function(e,t){switch(t){case"content":return e.substr(0,e.length-2);case"code":return e.substr(-1,1);default:return e.split("如需了解更多权益")[0]}},n={card:function(e){return'<a href="javascript:;" class="counselor-card" target="_blank"><div class="avatar"></div><div class="pannel"><div class="title">招聘助手：<span class="c-close"><i></i></span><div class="c-shield"><i></i><span>30天内不再提示</span></div></div><p class="content">'+a(e.content,"content")+'</p><div class="c-btn">了解更多权益</div></div></a>'}},s={};s.shieldMsg=function(){$.ajax({type:"post",url:"/block/wangcai/notify/close.json",async:!0,success:function(e){1==e.rescode||$.toast({content:e.resmsg,type:"error"})},error:function(e){$.toast({content:"系统异常",type:"error"})}})};return function(){$(document).on("click",".counselor-card",function(i){var a=(new Date).getTime(),n="";Chat.sendReadMessage({userData:{gid:990,friendSource:0},uid:990,mid:t}),$(".counselor-card").remove(),$(i.target).parents(".c-close").length?n="counselor_close_":$(i.target).parents(".c-shield").length?(n="counselor_shield_",s.shieldMsg()):(n="counselor_trigger_",window.top.ChatBot.open());try{_T.sendEvent(""+n+_PAGE.uid+"_"+e.type+"_"+a)}catch(i){}i.preventDefault()})}(),{received:function(s){if(t<s.mid&&i(s)){t=s.mid,e.content=s.body.text,e.type=a(e.content,"code"),$(".counselor-card").remove(),$("body").append(n.card(e));try{_T.sendEvent("counselor_receive_"+_PAGE.uid+"_"+e.type+"_"+s.time)}catch(e){}}}}}(),Payment=function(){function e(e){var e=$.extend({article:"",text:"",cancelText:!1,confirmText:"确定",close:function(){},confirm:function(){}},e);$.dialog({title:"",content:r.notice(e),confirmText:e.confirmText,cancelText:e.cancelText,closeText:!0,wrapClass:"commerical-success-notice pop-payment",lock:!0})}function t(e){var e=$.extend({article:"",text:"",confirmText:"确定",close:function(){},confirm:function(){}},e),t=function(){var t=this.$content,i=this;t.on("click",".success-confirm",function(){i.close(),e.confirm("confirm")}),t.on("click",".success-cancel",function(){i.close(),e.confirm("close")})};$.confirm({backgroundDismiss:!1,content:r.success(e),confirmButton:!1,cancelButton:!1,buttonsReverse:!0,closeIcon:!1,columnClass:"pop-payment",title:!1,onOpen:t,onClose:e.close,ononfirm:e.confirm})}function i(e,t,i){var a,n=!0,s={bzbParam:e.bzbParam};e.query&&(s=$.extend(s,e.query));var t=$.extend({success:function(){},fail:function(){}},t),r=function(i){n&&(a.close(),i.ptype=e.data.payType,t.success(i))},c=function(){$(".pop-payment .PaymentCheck").html('<i class="loader-gray-17"></i>正在查询支付结果，请稍后'),o.get.queryStatus(e,s).then(function(e){if(1!==e.zpData.state){$(".pop-payment .PaymentCheck").html('<span class="gray">未支付成功，请您扫码完成支付。</span><a class="PayCheckBtn" href="javascript:">重新查询</a>')}else 0===e.code&&1==e.zpData.state&&(n=!1,r(e))})},l=function(){o.get.queryStatus(e,s).then(function(e){0===e.code&&1!==e.zpData.state?n&&setTimeout(l,3e3):0===e.code?(n&&r(e),n=!1):$.toast({type:"error",content:e.message})})},d=function(){var e=this.$content;a=this,setTimeout(l,1500),e.on("click",".PayCheckBtn",c)},u=function(){n=!1,t.close&&t.close()},p=function(){};!function(e){$.confirm({content:e,confirmButton:!1,cancelButton:!1,buttonsReverse:!0,closeIcon:!1,columnClass:"pop-payment",title:!1,onOpen:d,onClose:u,confirm:p})}(i)}function a(e,t){var i,a,n={success:function(){},cancel:function(){},fail:function(){}},t=$.extend(n,t),e=$.extend({recharge:!1},e),s=!0,c=function(e,t){$(".pop-payment .qr-code-loading").css("display","inline-block"),o.post.purchase(e,t).then(function(i){var a=!!e.condition&&e.condition(i);return 0!=i.code||1!==i.zpData.status&&3!==i.zpData.status&&!e.recharge?($.toast({type:"error",content:i.message}),!1):a?e.success(i.zpData):4==e.data.payType&&1===i.zpData.status?(t.buy&&t.buy({pay:e.amount,orderId:i.zpData.orderId,orderNo:i.zpData.orderNo,balance:e.balance,payType:e.data.payType}),t.success(i.zpData)):(e.orderId=i.zpData.orderId,e.qrCode=i.zpData.qrUrl,e.orderNo=i.zpData.orderNo,e.data.payType,$(".mb-qr-pannel .qr-code img").attr("src",e.qrCode),setTimeout(d,3e3),t.buy&&t.buy({pay:e.amount,balance:e.balance,payType:e.data.payType,orderNo:i.orderNo}),$(".pop-payment .qr-code-loading").css("display","none"),void $(".prop-order-type p").removeClass("disabled"))},function(){})},l=function(i){a.close(),i.ptype=e.data.payType,t.success({bzbParam:e.bzbParam})},d=function(){i&&clearTimeout(i),o.get.queryStatus(e).then(function(e){0===e.code&&1!==e.zpData.state?s&&(i=setTimeout(d,3e3)):0===e.code?(s&&l(e),s=!1):$.toast({type:"error",content:e.message})})},u=function(i){var n=$(i),s=!1;a=this;var r=navigator.userAgent,l=["Android","iPhone","SymbianOS","Windows Phone","iPod"];$.each(l,function(e,t){r.indexOf(t)>-1&&(s=!0)});var d=s&&!e.recharge;if(d&&(n.addClass("mobile-pay"),n.find(".qr-query").html('请选择付款方式<a href="javascript:;">我已支付</a>')),n.on("click",".prop-order-type .pay-type",function(){if($(this).hasClass("selected")||$(this).hasClass("disabled"))return!1;n.find(".prop-order-type .selected").addClass("disabled").removeClass("selected"),$(this).addClass("selected").addClass("disabled"),e.data.payType=$(this).attr("data-payType");var i={1:"支付宝",2:"微信"};n.find(".qr-query").html("使用"+i[e.data.payType]+(d?"":"扫码")+'支付<a href="javascript:;">我已支付</a>'),c(e,t);var a={action:2==e.data.payType?"click_wechat":"click_alipay",p:e.data.payType,p2:e.description,p3:e.amount/100,p4:e.balance/100,p5:e.cost/100};Block.action(a),d&&window.open("/mpa/html/payment/browser?bzbParam="+e.bzbParam+"&bzbChannel="+e.data.payType)}),n.on("click",".order-back",function(){var t=OrderStore.query(e.storeId);BlockSence.include(t.config.blockPageData,t.config.option),n.remove()}),n.on("click",".qr-query a",function(){n.find(".qr-query").html("正在查询，请稍等"),o.get.queryStatus(e).then(function(e){1!==e.zpData.state&&n.find(".qr-query").html("未支付成功，请您"+(d?"重新选择":"扫码")+'完成支付<a href="javascript:;">重新查询</a>')})}),n.on("click",".btn-block",function(){if($(this).hasClass("disabled"))return!1;e.data.payType=4,$(this).addClass("disabled"),c(e,t),a.close()}),n.on("click",".item-coupon-list span",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):($(".item-coupon-list .selected").removeClass("selected"),$(this).addClass("selected"));var t=$(this).index(),i=e.userCouponList[t],a=$(this).parents("li").find(".discount-desc");$(this).hasClass("selected")?(e.coupon=i.offAmount,e.discountId=i.discountId,a.text(i.discountDesc),n.find(".coupon-selected").text("-"+e.coupon+"直豆").show()):(e.coupon=0,e.discountId="0",a.html("&nbsp;"),n.find(".coupon-selected").text(e.userCouponList.length+"张可用"));var s=e.amount,o=100*e.coupon+e.totalOffAmount,r=e.amount-e.balance-o,c=s>o+e.balance?r:e.amount-o;e.pay=c,e.cost=r,e.cost<=0&&(e.data.payType=4),n.find(".pay-amount").text(e.pay/100+"直豆"),e.cost>0||e.recharge?(n.find(".prop-order-type").show(),n.find(".prop-buttons").hide()):(n.find(".prop-buttons").show(),n.find(".prop-order-type").hide())}),n.on("click",".coupon-left",function(){n.find(".item-coupon").toggleClass("unfold")}),n.on("click",".coupon-selected",function(){n.find(".item-coupon").toggleClass("unfold")}),n.on("click",".bead-close",function(){a.close(),t.cancel&&t.cancel()}),(e.cost>0||e.recharge)&&!s){var u=e.lastBzbChannel||1;$('.pop-payment .pay-type[data-paytype="'+u+'"]').click()}},p=function(){return s=!1,t.fail()},h=function(){},f=function(e){$.dialog({bind:!0,title:"",content:e,closeText:!1,confirmText:"",cancelText:"",closeLayer:!1,inline:!0,wrapClass:"pop-payment flex-dialog-wrap",onOpen:u,onClose:p,confirm:h})};if($(".pop-payment").length)return!1;if(e.recharge)f(r.recharge(e));else{var m=e.prePayUrl||"";o.post.order(e,m,function(i){if(1011===i.code&&(window.location.href="/logout/"),1===i.experience)return void t.success(i);var a={storeId:t.storeId,discountId:i.discountId,itemIcon:i.bizIcon,balance:i.remainAmount,amount:i.amount,totalOffAmount:i.totalOffAmount-i.offAmount,needAmount:i.needAmount+i.offAmount,pay:i.needAmount,cost:i.amount-i.remainAmount-i.totalOffAmount,note:i.bizNote||"",coupon:i.offAmount,bzbParam:i.bzbParam,lastBzbChannel:i.lastBzbChannel,discountList:i.discountList,userCouponList:i.userCouponList,discountParam:i.discountParam,description:i.bizName?i.bizName:e.description,noBack:t.noBack};e=$.extend(e,a),e.cost<1&&(e.data.payType=4),0==e.amount||0==e.needAmount?t.success(e):f(r.purchase(e))})}}function n(e,t){var a={type:"wx",name:"微信支付",pay:e.pay,qrCode:e.qrCode};i(e,t,r.pay(a)),__conversion("payment_wx")}function s(e,t){var a={type:"zfb",name:"支付宝",pay:e.pay,qrCode:e.qrCode};i(e,t,r.pay(a)),__conversion("payment_zfb")}var o={},r={},c="Free";return o.get={},o.post={},o.post.orderInfo=function(e,t){var i=$.Deferred();return $.post("/wapi/zpp/user/bzbOrderInfo",{bzbParam:e},function(e){0==e.code?i.resolve(e):$.toast({type:"error",content:e.message})}),i},o.get.coupon=function(e){var t=$.Deferred();return $.get("/wapi/zpp/user/bzbDiscountList",{bzbParam:e,pageSize:10},function(e){0==e.code?t.resolve(e):$.toast({type:"error",content:e.message})}),t},o.post.order=function(e,t,i){c="pending";var a="/wapi/zpitem/web/itemMall/preOrder/"+e.itemId;!e.data.priceId&&e.itemId||(a="/wapi/zpblock/order/preorder");var n=function(e){c="free",$.when(o.post.orderInfo(e),o.get.coupon(e)).then(function(t,a){t.userCouponList=a.zpData.discountList||[];var n=$.extend({},t.zpData,{bzbParam:e,userCouponList:a.zpData.discountList||[]});i(n)})},s=function(e){if("string"==typeof e&&(e=JSON.parse(e)),1011===e.code)return window.location.href="/user/login";0==e.code&&1==e.zpData.status?1===e.zpData.experience?i(e.zpData):n(e.zpData.bzbParam):$.toast({type:"error",content:e.message})};e.data.priceId?(e.data.bz=e.data.business,e.data.jid=e.data.jobId,$.post(a,e.data,s)):$.post(a,{paramsJson:encodeURIComponent(JSON.stringify(e.data))},s)},o.get.queryStatus=function(e,t){var i=$.Deferred();return $.ajax({method:"post",url:"/wapi/zpp/user/payOrderSync",data:{orderId:e.orderId},cache:!1,success:function(e){i.resolve(e)}}),i},o.post.purchase=function(e,t){var i=$.Deferred(),a="/wapi/zpp/user/bzbOrder",n={discountParam:e.discountParam,bzbParam:e.bzbParam,discountId:e.discountId,bzbChannel:e.data.payType};return e.recharge&&(a="/wapi/zpp/user/rechargeBean",n={amount:100*e.data.beanCount,payChannel:e.data.payType}),$.ajax({method:"post",url:a,data:n,cache:!1,success:function(e){if(0!=e.code)return $.toast({type:"error",content:e.message}),i.reject(e),t.fail();i.resolve(e)},error:function(){return t.fail()}}),i},r.pay=function(e){return Utemplate('<div class="mb-payment"><p class="mb-payment-title"><img src="/v2/web/boss/images/icon-shield.png" />安全支付</p><div class="mb-pay-info"><i class="icon-<%this.type%>"></i><%this.name%><i class="currency">￥</i><i class="amount"><%this.pay / 100%></i></div><div class="qr-code"><img src="<%this.qrCode%>" /></div><div class="mb-payment-result PaymentCheck"><span class="gray">使用<%this.name%>扫码支付</span><a class="PayCheckBtn" href="javascript:">我已支付</a></div></div>',e)},r.purchase=function(e){return Utemplate('<div class="mb-payment"><p class="mb-payment-title <%if(this.storeId && !this.noBack){%>payment-order-back<%}%> "><%if(this.storeId && !this.noBack){%><i class="iboss-right order-back"></i><%}%><img src="/v2/web/boss/images/icon-shield.png" /><%if(this.article){%><%this.article%><%}else{%>确认支付<%}%><i class="bead-close"></i></p><dl class="order-detail"><dt><img src="<%this.itemIcon%>"><div class="item-prop fl"><p ><span class="item-name"><%this.description%></span><%if(this.note){%><br><%this.note%><%}%></p></div><span class="fr"><%this.amount/100%>直豆</span></dt><%if (0 < this.discountList.length) {%><dd class="item-coupon"><p>优惠</p><ul class="pay-active-list"><%for(var j=0;j<this.discountList.length;j++){%><li><i class="tag-desc"><%this.discountList[j].discountTag%></i><%if(this.discountList[j].discountType == 1){%><span class="amount-desc coupon-selected"><%this.discountList[j].discountAmountDesc%></span><%}else{%><span class="amount-desc"><%this.discountList[j].discountAmountDesc%></span><%}%><p class="discount-desc"><%this.discountList[j].discountDesc%></p><%if(this.discountList[j].discountType == 1){%><div class="item-coupon-list"><%for(var i=0;i<this.userCouponList.length;i++){%><span <%if(i==0){%>class="selected"<%}%> data-id="<%this.userCouponList[i].discountId%>" <%if(this.userCouponList[i].selected){%>class="selected"<%}%>>减<%this.userCouponList[i].offAmount%>直豆</span><%}%></div><%}%></li><%}%></ul></dd><%}%><dd>直豆余额<span class="fr"><%this.balance/100%>直豆</span></dd><dd>还需支付<span class="fr pay-amount"><%this.pay/100%>直豆</span></dd></dl><div class="prop-order"><div class="prop-order-type" <%if(this.cost <= 0){%>style="display: none;"<%}%>> <div class="prop-type-article">直豆余额不足，请选择支付方式：</div> <p class="fl pay-type payment-wx" data-type="wx" data-payType="2"><i class="icon-wx"></i>微信支付</p> <p class="fr pay-type payment-zfb" data-type="zfb" data-payType="1"><i class="icon-zfb"></i>支付宝</p> <div class="mb-qr-pannel"><p class="qr-code"><span class="qr-code-loading"><i class="icon-toast-loading"></i></span><img src="//static.zhipin.com/v2/web/boss/images/qrcode-pm.jpg" /></p><p class="qr-query">使用支付宝扫码支付<a href="javascript:;">我已支付</a></p></div></div><div class="prop-buttons" <%if(0 < this.cost){%>style="display: none;"<%}%>><button class="btn btn-block">立即支付</button></div><div class="payment-agreement">付费即表示同意<a href="https://m.zhipin.com/H5/html/protocol/incrementProtocol.html" target="_blank">《Boss直聘增值服务协议》</a></div></div></div>',e)},r.recharge=function(e){return Utemplate('<div class="mb-payment"><p class="mb-payment-title"><img src="/v2/web/boss/images/icon-shield.png" />确认支付<i class="bead-close"></i></p><dl class="order-detail"><dt><img src="/v2/web/boss/images/prop/icon-bean.png" /><span class="item-name"><%this.description%></span><span class="fr"><%this.amount/100%>直豆</span></dt><dd>支付金额<span class="fr pay-amount">￥<%this.pay/100%></span></dd></dl><div class="prop-order"><div class="prop-order-type"> <div class="prop-type-article">请选择支付方式：</div> <p class="fl pay-type payment-wx" data-type="wx" data-payType="2"><i class="icon-wx"></i>微信支付</p> <p class="fr pay-type payment-zfb" data-type="zfb" data-payType="1"><i class="icon-zfb"></i>支付宝</p> <div class="mb-qr-pannel"><p class="qr-code"><span class="qr-code-loading"><i class="icon-toast-loading"></i></span><img src="//static.zhipin.com/v2/web/boss/images/qrcode-pm.jpg" /></p><p class="qr-query">使用支付宝扫码支付<a href="javascript:;">我已支付</a></p></div></div><div class="payment-agreement">付费即表示同意<a href="https://m.zhipin.com/H5/html/protocol/incrementProtocol.html" target="_blank">《Boss直聘增值服务协议》</a></div></div></div>',e)},r.success=function(e){return Utemplate('<div class="mb-payment"><p class="mb-payment-title"><img src="/v2/web/boss/images/icon-shield.png" />安全支付</p><div class="pay-info-text"><img src="/v2/web/boss/images/layer/succ.png" /><p class="article"><%this.article%></p><div class="text gray"><%this.text%></div><p><%if(this.cancelText){%><a href="javascript:" class="success-cancel btn"><%this.cancelText%></a><%}%><a href="javascript:" class="btn-primary success-confirm btn"><%this.confirmText%></a></p></div></div>',e)},r.notice=function(e){return Utemplate('<div class="mb-payment"><p class="mb-payment-title"><img src="/v2/web/boss/images/icon-shield.png" />安全支付</p><div class="pay-info-text"><img src="/v2/web/boss/images/layer/succ.png" /><p class="article"><%this.article%></p><div class="text gray"><%this.text%></div></p></div></div>',e)},{wx:n,zfb:s,notice:e,success:t,purchase:a,balance:o.get.balance}}(),Purchase=function(){function e(e,t,i){Payment.success({article:e||"购买成功",text:t||"",confirm:function(){i.confirm&&i.confirm()},close:function(){i.close&&i.close()}})}function t(t,i,a){"-1"==a.item.view?a.item.view="不限":a.item.view=(a.item.view+"").replace("人","")+"人";var n=a.action?a.action:"发布",s={ordinary:{1:"火爆职位普通版"+n+"成功！可保持职位在线<%this.description%>，期间每日查看牛人上限<%this.view%>，开聊上限<%this.employ%>。",2:"",3:"火爆职位普通版"+a.action+"成功！可保持职位在线<%this.description%>，期间每日查看牛人上限<%this.view%>，开聊上限<%this.employ%>。",4:"已成功升级至火爆职位畅聊版！当前剩余有效期<%this.restDays%>天，期间每日查看牛人<%this.view%>，开聊<%this.employ%>人。"},carefree:{1:"火爆职位畅聊版发布成功！可保持职位在线<%this.description%>，期间每日查看牛人<%this.view%>，开聊牛人<%this.employ%>。",2:"",3:"火爆职位畅聊版"+a.action+"成功！可保持职位在线<%this.description%>，期间每日查看牛人<%this.view%>，开聊牛人<%this.employ%>。",4:"已成功升级至火爆职位畅聊版！当前剩余有效期<%this.restDays%>天，期间每日查看牛人<%this.view%>，开聊<%this.employ%>人。"},experience:{1:"火爆职位普通版发布成功！该职位可免费在线<%this.expiredays%>天，为避免影响招聘，请及时延长招聘时长。",2:"火爆职位普通版发布成功！该职位可免费在线<%this.expiredays%>天，为避免影响招聘，请及时延长招聘时长。",3:"火爆职位普通版发布成功！该职位可免费在线<%this.expiredays%>天，为避免影响招聘，请及时延长招聘时长。",4:"火爆职位普通版发布成功！该职位可免费在线<%this.expiredays%>天，为避免影响招聘，请及时延长招聘时长。",5:"火爆职位普通版发布成功！该职位可免费在线<%this.expiredays%>天，为避免影响招聘，请及时延长招聘时长。"}},o={ordinary:{1:"火爆职位-普通版",2:"",3:"火爆职位-普通版",4:"火爆职位-普通版"},carefree:{1:"火爆职位-畅聊版",2:"",3:"火爆职位-畅聊版",4:"火爆职位-畅聊版"},experience:{1:"火爆职位",2:"",3:"",4:"",5:"火爆职位"}},r={0:{1:"block_sendjob_purchase_hot_",2:"block_extendjob_purchase_hot_",3:"block_openjob_purchase_hot_",4:"block_upgradejob_purchase_hot_"},1:{1:"block_sendjob_purchase_super_",2:"block_extendjob_purchase_super_",3:"block_openjob_purchase_super_",4:"block_upgradejob_purchase_super_"}};try{var c=r[i.hotJobType][i.action]+i.priceId;_T.sendEvent(c)}catch(e){}var n=a.item.type||"ordinary",l=Utemplate(s[n][i.action],a.item),d=o[n][i.action],u=a.action?a.action+"成功":"发布成功";(a.item.combos&&a.item.combos.activityType||a.item.activityType)&&(l+='<ul class="vip-promotion-2018-notice"><li>1.活动截止时间2019年1月1日,超出活动时间范围，购买的商品不再享受活动折扣</li><li>2.本次优惠活动仅针对部分用户,最终解释权归BOSS直聘所有</li><li>3.活动期间购买的商品原则上无法申请退款,如因平台原因导致您无法使用账号的赠送时长请联系客服</li></ul>');var p=function(t){e(u,l,a),"function"==typeof a.success&&a.success(t)},h={url:t,data:i,description:d,amount:a.item.pay,success:p},f={success:function(e){var t={1:"bean",2:"wx",3:"zfb"};i.hotJobType&&i.action&&e.ptype&&window.top.__conversion(r[i.hotJobType][i.action]+t[e.ptype]+"_"+i.priceId),p(e)}};Payment.purchase(h,f)}return{vip:function(e,t){var i=t||{},a=function(){$.toast({type:"success",content:"您已成功购买VIP账号，可在VIP权益页面查看使用明细"}),i.success&&i.success()},n={url:"/boss/item/pay/vipaccount.json",data:e,description:"购买道具：「VIP账号」- 1个月",amount:parseInt(e.amount,10),success:a},s={success:a};Payment.purchase(n,s)},position:t,commercial:function(t,i){var a=11==i.item.business?"普通职位":"火爆职位",n="";i.item&&i.item.categoryList&&i.item.categoryList.filter(function(e){return e.name&&e.name.indexOf("道具购买折扣")>-1}).length&&(n="（VIP道具专享价目前只支持6.12以上版本和网页版使用，暂不支持iOS）");var s={1:"免费试用火爆职位",2:a+"-<%this.priceName%>",3:"升级VIP账号",4:"购买"+i.item.title,5:"升级VIP账号",6:a+"-<%this.priceName%>",7:"",8:"",9:"免费试用火爆职位",10:a+"-<%this.priceName%>",11:"升级VIP账号",12:"购买<%this.title%>",16:"升级VIP账号"},o={1:"火爆职位发布成功！该职位可<%this.title%>，为避免影响招聘，请及时延长招聘时长。",2:a+"<%this.priceName%>发布成功！可保持职位在线一个月，期间可<%this.descList[1].bottomDesc%>牛人<%this.descList[1].count%><%this.descList[1].unitDesc%>，<%this.descList[0].bottomDesc%><%this.descList[0].count%><%this.descList[0].unitDesc%>。",3:"您已成功购买VIP账号，可在VIP权益页面查看使用明细"+n,4:"您已成功购买「<%this.title%>」，<%if(this.business != 16){%><%this.inDate%>内，<%}%>主动沟通人数<%this.chat%>，赠送主动查看人数<%this.view%>。",5:"您已成功购买VIP账号，可在VIP权益页面查看使用明细"+n,6:a+"<%this.priceName%>发布成功！可保持职位在线<%this.expireName%>，期间可<%this.descList[1].bottomDesc%>牛人<%this.descList[1].count%><%this.descList[1].unitDesc%>，<%this.descList[0].bottomDesc%><%this.descList[0].count%><%this.descList[0].unitDesc%>。",7:"",8:"",9:"",10:a+"<%this.priceName%>发布成功！可保持职位在线<%this.expireName%>，期间可<%this.descList[1].bottomDesc%>牛人<%this.descList[1].count%><%this.descList[1].unitDesc%>，<%this.descList[0].bottomDesc%><%this.descList[0].count%><%this.descList[0].unitDesc%>。",11:"您已成功购买VIP账号，可在VIP权益页面查看使用明细"+n,12:"",16:"您已成功购买VIP账号，可在VIP权益页面查看使用明细"+n};4==i.item.cardId&&(i.title=i.item.title,i.item.chat=i.item.chatDescList[0],i.item.inDate=i.item.chatDescList.length>2?i.item.chatDescList[1]:"",i.item.view="+"+2*parseInt(i.item.chat,10)+"次");var r=i.item?i.item:i,c=r.cardId,l=s[c]?Utemplate(s[c],r):"",d=9==c?function(e){return e.categoryList?e.categoryList.map(function(e){return e.bottomDesc+e.count+e.unitDesc}).join("，"):""}(r):o[c]?Utemplate(o[c],r):"",u=function(t){var a=function(){};if(i.success?a=i.success:i.confirm&&(a=i.confirm),1===t.experience)return e("免费试用火爆职位",t.dialog.content,{confirm:a}),!0;if(t.bzbParam)return $.get("/wapi/zpblock/order/bzbquery",{bzbParam:t.bzbParam}).success(function(t){e(t.zpData.dialog.title,t.zpData.dialog.content,{confirm:a})}),!0;var n="";3==c&&r.activityType&&(n='<ul class="vip-promotion-2018-notice"><li>特别注意：</li><li>1. 活动期间，每个用户只能购买一次VIP账号，不可多次购买；</li><li>2. 活动期间购买的商品原则上无法申请退款，如因平台原因导致您无法使用账号的赠送时长请联系客服；</li></ul>'),2==c&&r.activityType&&(n='<ul class="vip-promotion-2018-notice"><li>特别注意：</li><li>1. 活动截止时间1月1日,超出活动时间范围，购买的商品不再享受活动折扣；</li><li>2. 本次优惠活动仅针对部分用户,最终解释权归BOSS直聘所有；</li><li>3. 活动期间购买的商品原则上无法申请退款如因平台原因导致您无法使用账号的赠送时长请联系客服；</li></ul>'),e(l,d+n,{confirm:a})},p={url:"/boss/block/pay.json",data:t,tid:r.p||"",description:l,amount:parseInt(r.beanCount,10),success:u};i.item.article&&(p.article=i.item.article);var h=OrderStore.push({blockPageData:i.blockPageData,option:i}),f={storeId:h.id,buy:function(e){var t={action:"confirm-payment",p:"",p2:r.beanCount,p3:e.balance,p4:e.pay,p5:e.pay};Block.action(t)},success:u};Payment.purchase(p,f)}}}(),Recharge=function(){function e(e){var t={recharge:!0,url:e.url||"/boss/item/rechargebean.json",amount:100*e.amount,pay:100*e.pay,description:"直豆充值："+e.amount+"个",data:{beanCount:e.amount}},i={success:function(t){e.save?Payment.success({article:"直豆充值成功",text:"本次充值为您节省了"+e.save+"元"}):Payment.success({article:"直豆充值成功",text:"你可以在 BOSS直聘 APP「钱包」中查看充值明细"}),"function"==e.callback&&e.callback({pay:e.pay,save:e.save,amount:e.amount})}};Payment.purchase(t,i)}function t(t){var i=function(e){var e=$(".recharge-beans-rebate .selected").length?parseInt($(".recharge-beans-rebate .selected").attr("data-amount"),10):$(".recharge-beans-rebate .ipt").val();if($(".recharge-beans-rebate .order-info").remove(),e>0){$(".recharge-beans-rebate .btn-sure").removeClass("disabled");var t=s(e,a(e)),i='<div class="order-info">支付金额<span class="order-amount">￥'+t.pay+'</span><span class="gray">(已减'+t.save+"元）</span></div>";$(i).insertBefore($(".recharge-beans-rebate .btns"))}else $(".recharge-beans-rebate .btn-sure").addClass("disabled")},a=function(e){var i=0;for(var a in t.discountInfo.rangeDiscount){e>=parseInt(a,10)&&(i=t.discountInfo.rangeDiscount[a])}return i},o=function(e){$(e).on("input",".ipt-amount",function(){var t=$(this).val().replace(/\D+/g,"");t.length&&(t=parseInt($(this).val(),10)),$(this).val(t),$(e).find(".recharge-rebate-panel .selected").removeClass("selected"),i()}),$(e).on("click",".recharge-rebate-panel li",function(){$(e).find(".recharge-rebate-panel .selected").removeClass("selected"),$(this).addClass("selected"),i()}),i()},r=function(i){if($(i).find(".btn-sure").hasClass("disabled"))return!1;var n=$(".recharge-beans-rebate .selected").length?parseInt($(".recharge-beans-rebate .selected").attr("data-amount"),10):$(".recharge-beans-rebate .ipt").val();e($.extend({url:t.url,callback:t.success,confirm:t.success},s(n,a(n)))),$(i).remove()};$.dialog({title:"直豆充值",content:n.rebate(function(){return[100,200,300,500,1e3].map(function(e){return{amount:e,save:s(e,a(e)).save}})}()),confirmText:"确定充值",cancelText:!1,wrapClass:"recharge-beans-rebate",onOpen:o,onConfirm:r})}function i(t){var i=t.discount?.9:1,a=function(e){var t=function(t){var t=parseInt(t,10),a=s(t,i);$(e).find(".order-save").text("-￥"+a.save),$(e).find(".order-pay").text("￥"+a.pay),t?$(e).find(".btn-sure").removeClass("disabled"):$(e).find(".btn-sure").addClass("disabled")};$(e).on("input",".ipt-amount",function(){var e=$(this).val().replace(/\D+/g,"");e.length&&(e=parseInt($(this).val(),10)),$(this).val(e),t(e)}),t(100)},o=function(a){if($(a).find(".btn-sure").hasClass("disabled"))return!1;var n=$(a).find(".ipt-amount").val();e($.extend({callback:t.success,url:t.url},s(n,i))),$(a).remove()};$.dialog({title:"直豆充值",content:n.original(t),confirmText:"确定充值",cancelText:!1,wrapClass:"recharge-beans-original",onOpen:a,onConfirm:o})}var a={get:{}};a.get.discount=function(){var e=$.Deferred();return $.get("/boss/item/recharge/discount/check.json",function(t){
1==t.rescode?e.resolve(t):$.toast({type:"error",content:t.message})}),e};var n={rebate:function(e){return Utemplate('<p class="gray ios-off">ios用户独享充值折扣（仅限网页版）</p><div><p class="pull-left">直豆充值</p><div class="recharge-rebate-panel"><ul><%for(var i=0; i<this.list.length; i++){%><li ka="selected_amount_<%this.list[i].amount%>" <%if(this.list[i].amount==500){%> class="selected"<%}%> data-amount="<%this.list[i].amount%>"><p class="rebate-item"><%this.list[i].amount%>直豆<span class="rebate-off">减<%this.list[i].save%>元</span><span class="interval"></span></p></li><%}%></ul><input class="ipt ipt-amount" maxlength="4" placeholder="输入任意直豆数"></div></div>',{list:e})},original:function(e){return Utemplate('<ul><li><span class="pull-left">充值直豆个数</span><p><input type="text" value="100" maxlength="4" class="ipt-amount"></p></li><%if(this.discount){%><li><span class="pull-left">iOS用户9折优惠</span><p class="order-save"></p></li><%}%><li><span class="pull-left">金额</span><p  class="order-pay"></p></li><li><p class="ios-notice">因iOS政策限制，直豆在iOS端V6.17以上版本仅可用于道具购买。<br>安卓及PC端不受影响。</p></li></ul>',e)}},s=function(e,t){if(!e)return{amount:0,save:0,pay:0};var i=100*e,a=Math.floor(i*t);return{amount:e,save:(i-a)/100,pay:a/100}};return function(e){a.get.discount().then(function(a){var n=$.extend(e||{},a);return a.discountInfo&&a.discountInfo.rangeDiscount&&!isEmpty(a.discountInfo.rangeDiscount)?t(n):i(n)})}}(),__conversion=__conversion||function(e){try{_T.sendEvent(e)}catch(e){}},Prop={getDiscountInfo:function(){var e=$.Deferred();return $.get("/boss/item/recharge/discount/check.json").success(function(t){e.resolve(t)}),e},Url:{positionList:"/boss/data-temp/prop/position.json",topcardPositionList:"/boss/data-temp/prop/position.json",useTopcardPositionList:"/boss/data-temp/prop/position.json",useGeekBomb:"/boss/data-temp/prop/",useGeekPhone:"/boss/data-temp/prop/",buyGeekPhone:"/boss/data-temp/prop/",orderRequest:"/boss/data-temp/prop/orderRequest.json",exchange:"/boss/data-temp/prop/position.json",rechargeBean:"/boss/data-temp/prop/position.json",useTopcardSelectDay:"/boss/data-temp/prop/",topcardSelectDay:"/boss/data-temp/prop/",topcardBuy:"/boss/data-temp/prop/",topcardUse:"/boss/data-temp/prop/"},TRUE_URL:{positionList:"/boss/item/geekBombJobList.json",topcardPositionList:"/boss/item/jobTopJobList.json",useTopcardPositionList:"/boss/item/useJobTopSelJob.json",useGeekBomb:"/boss/item/useGeekBomb/",useGeekPhone:"/boss/useGeekInfoRight/",buyGeekPhone:"/boss/item/buy/othItem/",orderRequest:"/boss/item/orderquery.json",exchange:"/bossweb/redeemCode/exchange.json",rechargeBean:"/boss/item/rechargebean.json",useTopcardSelectDay:"/boss/item/useJobTopSelDay/",topcardSelectDay:"/boss/item/jobTopSelDay/",topcardBuy:"/boss/item/buyJobTop/",topcardUse:"/boss/item/useJobTopBooking/"},getRequestUrl:function(e){var t=!1;return t=!(document.domain.indexOf(".bosszhipin.com")>-1||document.domain.indexOf(".weizhipin.com")>-1)&&"172.16.6.191:8080"==window.location.host,0==t?Prop.TRUE_URL[e]:Prop.Url[e]},Views:{header:{niuren:'<img src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',topcard:'<img src="/v2/web/boss/images/layer/top-card.png" alt="牛人直通卡" class="title-icon">',zhadan:'<img src="/v2/web/boss/images/layer/zhadan.png" alt="牛人炸弹" class="title-icon">',succ:'<img src="/v2/web/boss/images/layer/succ.png" alt="成功" class="title-icon">'},title:{1:'<p class="prop-title">选择职位<span class="use-num"></span></p>',2:'<p class="prop-title">选择文案</p>',3:'<p class="prop-title prop-date-title">选择置顶日期                <span class="been-use pull-right"><i></i>已占用</span>                <span class="been-reserve pull-right"><i></i>已预定</span>                </p>',4:'<div class="pay-title">                    <span class="">使用微信扫码支付</span>                </div>'},button:{1:'<div class="pay-status-area">                    <a href="javascript:" ka="item_mall_nd_wxPay" class="status-btn">我已完成支付</a>                </div>',2:'<div class="pay-btn-area">                    <a href="" class="left-btn">前往</a>                    <a href="" class="right-btn">关闭</a>                </div>',3:'<div class="btn-area">                    <a href="" class="left-btn">取消</a>                    <a href="" class="right-btn">下一步</a>                    <div class="clear"></div>                </div>',4:'<div class="btn-area">                    <a href="" class="define-btn">知道了</a>                </div>'}},Layer:{createHeader:function(e){return Prop.Views.header[e]},createTitle:function(e){return Prop.Views.title[e]},createSuccMessage:function(e,t){return'<div class="succ-container"><p class="succ-title">'+e+"</p>"+(t?'<p class="succ-desc">'+t+"</p>":"")+"</div>"},createSelectList:function(e){var t="",i="";for(var a in e)0==a&&(t="<dt>                    <p><span>"+e[a].jobName.replace(/\</g,"&lt;").replace(/\>/g,">")+"</span><span>"+e[a].locationName+"</span><span>"+e[a].lowSalary+"-"+e[a].highSalary+'k</span></p>                        <span class="on"><i></i></span>                        <input type="hidden" value="'+e[a].encryptId+'"/>                    </dt>'),i+='<li data-val="'+e[a].encryptId+'"><span>'+e[a].jobName.replace(/\</g,"&lt;").replace(/\>/g,">")+"</span><span>"+e[a].locationName+"</span><span>"+e[a].lowSalary+"-"+e[a].highSalary+"k</span></li>";return i="<dd><ul>"+i+"</ul></dd>",'<div class="select-list"><dl>'+t+i+"</dl></div>"},createRadioList:function(e){return'<div class="radio-list">                        <ul>                            <li class="active" data-id="72"><i></i><p>请查看我发布的'+e.replace(/\</g,"&lt;").replace(/\>/g,">")+'岗位说明，如感兴趣，我们再详细沟通。</p></li>                            <li data-id="73"><i></i><p>你好，我们急招'+e.replace(/\</g,"&lt;").replace(/\>/g,">")+'，如有兴趣希望可以深聊。</p></li>                            <li data-id="74"><i></i><p>你好，系统自动匹配了我的招聘信息给你，如果感兴趣，请回复消息。</p></li>                        </ul>                    </div>'},createDateTime:function(e){return Prop.Layer.createTitle(3)+'<div id="prop-select-date" class="prop-select-date"></div>'+("buy"==e?'<p class="topcard-price">牛人直通卡的价格与您选择的日期有关</p>':"")},createBuyZhiBean:function(e){return window.top.Utemplate('<div class="niuren-buy"><ul><li class="first"><span class="pull-left">充值直豆个数</span><div class="pull-right"><input maxlength="4" type="text" value="100" class="count bean-count"/></div></li><%if(this.discount){%><li class="privilege"><span class="pull-left">iOS用户9折优惠</span><span class="pull-right privilege">-￥10.8</span></li><%}%><li class="money-item"><span class="pull-left">金额</span><span class="pull-right money">￥100</span></li></ul></div>',e)},bindRadioSelect:function(e){e.find("li").click(function(){$(this).addClass("active").siblings("li").removeClass("active")})},alertSuccLayer:function(e,t,i,a){i.$title&&i.$title.html(Prop.Layer.createHeader("succ")),"buy"==a&&t?i.$content.find(".prop-layer").html(Prop.Layer.createSuccMessage(e,t)+Prop.Views.button[2]):i.$content.find(".prop-layer").html(Prop.Layer.createSuccMessage(e,t)+Prop.Views.button[4]),i.$btnc.remove(),i.$content.find(".prop-layer .define-btn").click(function(e){e.preventDefault(),i.close()}),i.$content.find(".prop-layer .pay-btn-area .left-btn, .prop-layer .pay-btn-area .right-btn").click(function(e){window.location.reload()})},createQrcode:function(e){return Prop.Layer.createTitle(4)+'<div class="qrcode-area">                        <img src="'+e+'" alt="二维码">                    </div>'+Prop.Views.button[1]},createAlertLayer:function(e){$.confirm({content:'<p class="sys-msg">'+e+"</p>",cancelButton:!1,confirmButton:"知道了",columnClass:"pop-stage prop-pop",title:!1})}},buyZhiBean:function(e,t){var i,a=this,e=$.extend({discount:!1},e);i=$(".frame-container").length&&-1==$(".frame-container").attr("src").indexOf("wordhr.zhipin.com")&&$(".frame-container").contents().find(".prop-list-right").length?$(".frame-container").contents().find(".prop-list-right"):$("#container").find(".prop-list-right"),showConfirm=function(){$.confirm({content:'<div class="prop-layer">'+a.Layer.createBuyZhiBean(e)+"</div>",cancelButton:"取消",confirmButton:"确认充值",buttonsReverse:!0,columnClass:"pop-stage prop-pop",title:a.Layer.createHeader("zhadan"),onOpen:function(){var t=this;this.$content.find(".money"),Number(i.find(".balance").text());this.$content.find(".count").on("input",function(){$(this).val($(this).val().replace(/\D/g,""));var i=Number($(this).val());e.discount?(t.$content.find(".pull-right.privilege").html("- ￥"+(.1*i).toFixed(2)),t.$content.find(".pull-right.money").html("￥"+(i-.1*i).toFixed(2))):t.$content.find(".pull-right.money").html("￥"+i)}).trigger("input")},confirm:function(){var a=this,n=a.$content.find(".count");if(privilege=(.1*n.val()).toFixed(2),""==n.val()||0==n.val())return n.focus(),!1;var s=parseInt(n.val(),10);e.discount&&(s=(s-privilege).toFixed(2));var o={recharge:!0,url:Prop.getRequestUrl("rechargeBean"),amount:parseInt(n.val(),10),pay:s,description:"直豆充值："+parseInt(n.val(),10)+"个",data:{beanCount:parseInt(n.val(),10)}},r={success:function(n){a.close(),e.discount?window.top.Payment.success({article:"直豆充值成功",text:"本次充值为您节省了"+privilege+"元"}):window.top.Payment.success({article:"直豆充值成功",text:"你可以在 BOSS直聘 APP「钱包」中查看充值明细"}),"function"==typeof t&&t(),i.find(".balance").text(n.beanCount)}};window.top.Payment.purchase(o,r)}})}()}},iosRecharge={buyHandle:function(){$.get("/boss/item/recharge/discount/check.json",function(e){Prop.buyZhiBean({discount:e.discount||!1})})},showPop:function(){PageSet.getTipData(function(e){if(e.rescode&&e[13]){if("true"!=sessionStorage.getItem("showPop"+_PAGE.uid)){$.dialog({title:"",content:'<div class="ios-bg"></div>',confirmText:"",cancelText:"",wrapClass:"prop-ios",onOpen:function(e){e.find(".ios-bg").click(function(){window.top.Recharge({}),e.remove()})}});({sendData:function(){$.ajax({type:"post",url:"/setting/notify/set.json",dataType:"JSON",data:{type:13},cache:!1,success:function(e){},error:function(){}})}}).sendData()}sessionStorage.setItem("showPop"+_PAGE.uid,"true")}})}};$(function(){"PageSet"in window&&(iosRecharge.showPop(),$(".top-user .recharge-ios").click(function(){$(".frame-container").length&&-1==$(".frame-container").attr("src").indexOf("wordhr.zhipin.com")&&$(".frame-container").contents().find(".dialog-wrap:visible,.jconfirm:visible").remove(),window.top.Recharge({})}))});var Block=function(){function e(e,t){var i=e,a=$.confirm({content:t,title:!1,closeIcon:!0,cancelButton:!!i.cancelText&&i.cancelText,confirmButton:i.confirmText||"确定",confirmButtonClass:"fr",columnClass:"pop-block "+i.style,onOpen:function(){i.ka&&this.$confirmButton.attr("ka",i.ka),i.vka&&__conversion(i.vka),i.open&&i.open(this)},confirm:function(){if(i.next&&i.next(this.$content),!i.next&&i.confirm&&i.confirm(),0==i.autoClose)return!1},cancel:function(e){i.cancel&&e&&i.cancel()},onClose:function(e){i.close&&i.close()}});return $(document).on("_BEFORE_UNLOAD",function(){a.close()}),a}function t(t){var i=t,a=t.content||s({title:i.title,description:i.description});i.style="pop-block-alert",e(i,a)}function i(t,i){if(i.dpGray&&i.blockPageData)return window.top.BlockSence.include(i.blockPageData,t),!1;var a,n={},o=function(e,t){var a=(i.isEdit,"发布");e.text("付费"+a+"职位：￥"+t)},r=function(){if("vip"==$(".hot-list-tab .checked").attr("data-cls"))return n.vip.type="vip",n.vip;var e=$("input[name=ordinary]").filter(":checked"),t=e.attr("data-type"),i=e.attr("data-index");return selected=n[t][i],selected.type=t,selected.activityType=n.activityType,selected.activityEndDate=n.activityEndDate,selected.ba=n.ba,selected},d=function(e){var t=function(e){return"<i>"+("0"+e).substr(-2,2).split("").join("</i><i>")+"</i>"};if(n.activityType&&n.activityEndDate){var i=n.activityEndDate;a=new Clocking(i,1e3),a.interval(function(i){var a="";a=i.day>0?'<span class="prom-text">距结束</span>'+t(i.day)+"&nbsp;天":'<span class="prom-text">距结束还剩</span>'+t(i.hour)+"："+t(i.minute)+"："+t(i.second),e.find(".hot-promotion").html(a)})}},u={open:function(e){var t=e.$content;if(t.on("change","input[name='ordinary']",function(){var i=$(this).attr("data-type"),a=$(this).attr("data-index"),s=n[i][a];o(e.$confirmButton,s.pay),t.find("."+i+"-view").text(s.view),t.find("."+i+"-employ").text(s.employ)}),t.on("click",".hot-list-tab li",function(){$(".hot-list-tab .checked").removeClass("checked"),$(this).addClass("checked"),t.find(".block-storm").removeClass("combination-ord").removeClass("combination-vip").addClass("combination-"+$(this).attr("data-cls")),"ord"==$(this).attr("data-cls")?(e.$confirmButton.removeClass("btn-vip-rose"),t.find("input[name=ordinary]").filter(":checked").trigger("change")):e.$confirmButton.addClass("btn-vip-rose").text("开通VIP帐号")}),$(".hot-list-tab li.checked").length?$(".hot-list-tab li.checked").trigger("click"):t.find("input[name=ordinary]").filter(":checked").trigger("change"),e.$btnc.on("click",".trial a",function(){var t=n.experience;t.type="experience",i.confirm(t),e.close(),__conversion("block_sendjob_purchase_trial")}),n.experience){e.$btnc.append(Utemplate('<p class="trial">您有一次免费体验机会，可免费试用火爆职位普通版<%this.expiredays%>天，<a href="javascript:">点击免费使用</a></p>',n.experience))}d(t)},next:function(){var e=r();i.confirm&&i.confirm(e)}};i.canBuyVip?function(){$.when(p({sf:i.sf||"",vipPriceId:i.vipPriceId}),h(t)).then(function(t,a){n=a,n.vip={ba:t.detailPage.ba,vipPriceId:i.vipPriceId,pay:t.detailPage.currentPriceDesc.replace(/[^\d.]/g,"")};var o=$.extend(u,i);e(o,s({title:o.title,description:o.description})+l.storm(t.detailPage,a))})}():function(){var a=function(t){n=t;var a=$.extend(u,i);e(a,s({title:a.title,description:a.description})+c.storm(t))};t.combos?a(t.combos):h(t).then(function(e){a(e)})}()}function a(t,i){var a,n=function(t){a=t;var n=i,r=s({title:n.title,description:n.description})+o(t);n.next=function(){var e=$("input[name=super]").filter(":checked").attr("data-index"),t=a.prices[e];n.confirm(t)},n.open=function(e){var n=e.$content,s=function(e,t){var a=(i.isEdit,"发布");e.text("付费"+a+"职位：￥"+t)},o=(i.isEdit,"付费发布职位");if(e.$confirmButton.text(o+"：￥"+t.pay),e.$btnc.on("click",".trial a",function(){var t=a.experience;t.type="experience",i.confirm(t),e.close(),__conversion("block_sendjob_purchase_trial")}),n.on("change","input[name='super']",function(){var t=$(this).attr("data-index"),i=a.prices[t];s(e.$confirmButton,i.pay);var o="可保持职位在线"+i.expiredays+"天，期间每日查看详情"+i.view+"，开聊上限为"+i.employ+"。";n.find(".hot-intro").text(o)}),n.find("input[name=super]").filter(":checked").trigger("change"),a.experience){e.$btnc.append(Utemplate('<p class="trial">你有一次免费体验机会，可以免费试用火爆职位限制版 <%this.expiredays%> 天，<a ka="block_sendjob_purchase_super_trial" href="javascript:">点击免费使用</a></p>',a.experience))}},e(n,r)};t.combos?n(t.combos):u(t).then(function(e){n(e)}),console.log(arguments)}function n(t,i){var a=i,n=a.content||r(t);a.style="pop-block-upgrade",a.open=function(e){e.$confirmButton.text("付费升级职位："+t.currentPriceDesc)},e(a,n)}var s=function(e){return Utemplate(' <div class="block-intro"><img src="/v2/web/boss/images/icon-lock-24.png"><dl><dt><%this.title%></dt><dd class="gray"><%this.description%></dd></dl><div class="clear"></div></div>',e)},o=function(e){return-1==e.view?e.view="无上限":e.view=e.view,Utemplate('<div class="hot-list hot-list"><p class="hot-intro">可保持职位在线<%this.description%>，期间每日查看详情<%this.view%>，开聊上限为<%this.employ%>。</p><ul class="ordinary"><%for(var i=0;i<this.prices.length;i++){%><li><label class="radio"><input data-index="<%i%>" type="radio" <%if(i == 0){%>checked<%}%> name="super" value="<%i%>"><span>普通版，<%this.prices[i].description%><%if(this.prices[i].discount){%><em class="discount"><%this.prices[i].discount%></em><%}%><em class="pay">￥<%this.prices[i].pay%>/职位</em></span></label></li><%}%></ul></div>',e)},r=function(e){return e.hlShortDesc.name=function(){var t=e.hlShortDesc,i=t.name;return t.highlightList&&t.highlightList.length&&$.each(t.highlightList,function(e,t){var a=i.substr(t.startIndex,t.endIndex);i=i.replace(a,"<b>"+a+"</b>")}),i}(),Utemplate('<div class="super-upgrade-panel"><div  class="super-upgrade-description"><span class="icon-lock"></span><div class="description"><h4><%this.title%>普通版，<%this.animationTitle%></h4><p><%this.shortDesc.name%></p><p><%this.hlShortDesc.name%></p></div></div><dl class="super-upgrade-list"><dt>畅聊版<span class="icon-upgrade">升级</span></dt><%for(var i=0;i<this.descList.length;i++){%><dd><%this.descList[i]%><i class="icon-check"></i></dd><%}%><dd><b>升级所需价格：</b><span class="bean-number"><%this.currentPriceDesc%></span><span class="upgrade-discount">限时折扣</span><span class="annotation"><%this.upgradeDesc%></span></dd></dl><p class="notice">*以上价格均为单个职位价格，不同城市不同职类价格有所波动</p></div>',e)},c={vip:function(e){var t={pay:e.currentPriceDesc,list:e.lineList};return Utemplate('<table class="vip-grid"><thead><tr><th>账号权益</th><th style="width: 90px;">认证账号</th><th style="width: 70px;">VIP账号</th></tr></thead><tbody><%for (var i=0;i<this.list.length;i++){%><tr><td><div class="cut-off"><%this.list[i].itemDesc%><i class="gray"><%this.list[i].itemDescHint%></i></div></td><td class="gray"><%this.list[i].curDesc%></td><td class="primrose"><%this.list[i].totalDesc%></td></tr><%}%></tbody></table><div class="vip-counter"><p class="fl">权益总价值<i>限时折扣</i></p><p class="fr primrose">¥<%this.pay%></p></div>',t)},storm:function(e){return Utemplate('<%if(this.activityType){%><div class="hot-promotion"></div><%}%><div class="hot-list"><p class="hot-intro ordinary">火爆职位普通版，每日查看详情<span class="ordinary-view"><%this.ordinary[0].view%></span>，开聊<span class="ordinary-employ"><%this.ordinary[0].employ%></span></p><ul class="ordinary"><%for(var i=0;i<this.ordinary.length;i++){%><li><label class="radio"><input data-index="<%i%>" data-type="ordinary" type="radio" <%if(i == 0){%>checked<%}%> name="ordinary" value="0"><span>普通版，<%this.ordinary[i].description%><%if(this.ordinary[i].discount){%><em class="discount"><%this.ordinary[i].discount%></em><%}%><em class="pay">￥<%this.ordinary[i].pay%>/职位</em></span></label></li><%}%></ul><%if(this.carefree.length){%><p class="hot-intro ordinary" style="padding-top: 9px;">火爆职位畅聊版，每日查看详情<span class="carefree-view"><%this.carefree[0].view%></span>，开聊<span class="carefree-employ"><%this.carefree[0].employ%></span></p><ul class="ordinary"><%for(var j=0;j<this.carefree.length;j++){%><li><label class="radio"><input data-index="<%j%>" type="radio" data-type="carefree" name="ordinary" value="0"><span>畅聊版，<%this.carefree[j].description%><%if(this.carefree[j].discount){%><em class="discount"><%this.carefree[j].discount%></em><%}%><em class="pay">￥<%this.carefree[j].pay%>/职位</em></span></label></li><%}%></ul><%}%>',e)}},l={vip:function(e){return'<div class="vip-ordinary-grid">'+c.vip(e)+"</div>"},storm:function(e,t){return'<div class="block-storm combination-vip"><div class="hot-list-tab"><ul><li data-cls="vip" class="checked">开通VIP</li><li data-cls="ord">单独发布</li></ul></div><div class="vip-wrap">'+c.vip(e)+'</div><div class="ordinary-wrap">'+c.storm(t)+"</div></div>"}},d=function(e){var e=e;return $.isArray(e)?$.each(e,function(t,i){-1==i.view?e[t].view="无上限":e[t].view=i.view+"人",-1==i.employ?e[t].employ="无上限":e[t].employ=i.employ+"人"}):(-1==e.view?e.view="无上限":e.view=e.view+"人",-1==e.employ?e.employ="无上限":e.employ=e.employ+"人"),e},u=function(e){var t=$.Deferred();return $.get("/bossweb/job/superprice.json",e).success(function(e){1==e.rescode&&(e.prices=d(e.prices),e.experience&&(e.experience=d(e.experience)),t.resolve(e))}),t},p=function(e){var t=$.Deferred();return $.get("/bossweb/job/vipaccountprice.json",e).success(function(e){1==e.rescode&&t.resolve(e)}),t},h=function(e){var t=$.Deferred();return e.combos?t.resolve(e.combos):$.get("/bossweb/job/price.json",e).success(function(e){if(1==e.rescode){var i={};i.ordinary=d(e.ordinary),i.carefree=d(e.carefree),e.experience&&(i.experience=d(e.experience)),i.activityType=e.activityType,i.activityEndDate=e.activityEndDate,t.resolve(i)}}),t},f=function(t,i){p(t).then(function(a){var n=i,o=s({title:n.title||"发布普通职位个数已达上限",description:n.description})+l.vip(a.detailPage);n.style="pop-vip",n.cancelText="我再想想",n.confirmText="开通VIP帐号",n.next=function(){i.confirm({ba:a.detailPage.ba,vipPriceId:t.vipPriceId,pay:a.detailPage.currentPriceDesc.replace(/[^\d.]/g,"")})},e(n,o)})},m=function(e){var t=e;return e&&"[object Object]"!==Object.prototype.toString.call(e)&&(t=JSON.parse(decodeURIComponent(e))),t};return{confirm:t,purchase:i,super:a,upgrade:n,vip:f,action:function(e,t){var t=t||{},i=$.extend(e,t);$.ajax({method:"post",url:"/wapi/zpCommon/actionLog/common.json",data:{ba:JSON.stringify(i)},cache:!1,success:function(e){},error:function(){}})},formatBA:m}}(),Upgrade=function(){var e=function(e,t){window.top.Purchase.position("/boss/block/pay.json",{priceId:t.priceId,action:4,hotJobType:0,business:t.business||"",targetId:t.targetId,targetType:t.targetType},{item:t,success:e.success,confirm:function(){}})},t=function(t,i){if(!0===i.dpGray||"true"===i.dpGray)return window.top.BlockSence.include(t,i),!1;var a={cancelText:"我再想想",vka:"block_upgradejob_purchase_hot",cancel:function(){},confirm:function(){i.ba&&Block.action(Block.formatBA(i.ba),{p4:4,p5:i.priceId,action:"user-block-biz-button"}),e({success:function(){}},i)}};window.top.Block.upgrade(t,$.extend(a,i))};return{include:function(e,i){return!!e.upgrade&&(t(e,i),!0)},render:t}}(),DirectAccessCard=function(){var e={},t={prop:function(e){var t=$.Deferred();return $.get("/boss/item/quicktop/selposition.json?jobId="+e).success(function(e){1==e.rescode?t.resolve(e):$.toast({type:"error",content:e.resmsg})}),t}},i={notice:function(e){return Utemplate('<div class="free-notice-panel"><h4 class="subhead">保存成功</h4><p>您使用免费权益发布了一个普通职位，</p><p>该职位价值50元/月，</p><p>剩余可免费在线普通职位数：<%this.unPubCount%>个。</p><i class="bead-close"></i></div>',e)},recommend:function(e,t){return(t.title?i.notice(t):Utemplate('<div class="brief-panel"><p class="icon-brief icon-success"></p><div class="brief-description"><p class="heading">保存成功</p><p class="position gray"><span class="position-name"><%this.positionName%></span><em class="vline"></em><%this.locationName%><em class="vline"></em><%this.lowSalary%>K-<%this.highSalary%>K</p></div><i class="bead-close"></i></div>',e))+Utemplate('<div class="introduce-panel"><img src="/v2/web/boss/images/prop/promotion.png"><p class="slogan">急聘直通卡限时专享</p><p class="intro-text">置顶职位+邀约投递，立即提升职位招聘效率</p><p class="notice">职位发布24小时内限时购买</p><button class="btn">立即体验</button></div>',e)},card:function(e){return Utemplate('<div class="brief-panel"><p class="icon-brief icon-card"></p><div class="brief-description"><p class="heading">急聘直通卡购买</p><p class="position gray">置顶职位+邀约投递，立即提升职位招聘效率</p></div><i class="card-discount"></i></div><div class="card-description"><p class="position gray">使用职位：<span class="position-name"><%this.job.positionName%></span><em class="vline"></em><%this.job.locationName%><em class="vline"></em><%this.job.lowSalary%>K-<%this.job.highSalary%>K</p><p class="direct-notice">购买后即置顶该职位，连续置顶24小时</p><div class="position-category"><div class="position-tip">置顶职类<p class="fr gray">选择更多职类置顶，提升招聘效果，可享额外折扣</p></div><%if(1 < this.positionList.length){%><dl><dt><%this.positionList[0].name%></dt><%for(var i=1; i<this.positionList.length;i++){%><dd><%this.positionList[i].name%></dd><%}%></dl><%}%></div></div>',e)}},a=function(){setTimeout(function(){window.top.location.href="/chat/im?mu=/bossweb/joblist.html"},1e3)},n=function(){var t=$(".direct-card-pop .position-category .selected"),i=t.length>0?t.length:0,a=Math.min(i,e.positionDiscount.length-1),n=e.positionDiscount[a],s=1e3*e.positionList[0].price;t.each(function(t,i){var t=$(this).index();s+=1e3*e.positionList[t].price});var o=Math.floor(s*(1-n)/1e3);return{amount:s/1e3,discount:n,save:t.length>0?Math.ceil(s/1e3-o):0,pay:o}},s=function(){var e=n(),t="选择更多职类置顶，提升招聘效果，可享额外折扣";if(e.discount>0){t="招聘效果提升"+($(".direct-card-pop .position-category .selected").length+1)+"倍 额外立减"+100*e.discount+"% ",$(".direct-card-pop .position-tip .gray").addClass("discount-tip").text(t)}else $(".direct-card-pop .discount-tip").removeClass("discount-tip").text(t);$(".direct-card-pop .dialog-footer  .prop-total").remove();var i='<p class="prop-total">￥<em>'+e.pay;e.save>0&&(i+="</em><span>(已省"+e.save+")</span>"),i+="</p>",$(".direct-card-pop .dialog-footer .btns").append(i)},o=function(e){var t=n(),i=function(){Payment.success({article:"购买成功",text:"即刻置顶职位24小时，邀约匹配牛人投递,可在BOSS直聘APP「我的道具」中查看使用效果",confirm:function(){a()}})},s={url:"/boss/item/pay/quicktop.json",data:e,description:"购买简历直通卡",amount:t.pay,itemId:"b6ed128ee1b8d2841HI~",success:i,close:function(){},cancel:function(){}},o={success:i,cancel:a,close:a};Payment.purchase(s,o)},r=function(t){e=$.extend({},t);$.dialog({bind:!0,title:"",closeLayer:!1,content:i.card(t),wrapClass:"direct-card-pop",confirmText:"购买并使用",cancelText:"取消",onOpen:function(e){$(e).on("click",".position-category dd",function(){$(this).toggleClass("selected"),s()}),s()},onConfirm:function(){var t=[];$(".direct-card-pop .position-category .selected").each(function(i,a,n){var s=$(this).index();t.push(e.positionList[s].code)});var i={jobId:e.job.jobId,positionCode:t.join(","),userCouponId:""};o(i),this.close(),__conversion("ermergency_buy")},onClose:function(e){$(e).off("click")},onCancel:function(){a()}})},c=function(e,n){var n=n||{};$.dialog({bind:!0,title:"",closeLayer:!1,content:i.recommend(e,n),wrapClass:"direct-card-pop",confirmText:!1,cancelText:!1,onOpen:function(i){var n=this;$(i).on("click",".bead-close",function(){n.close(),a()}),$(i).on("click",".introduce-panel .btn",function(){n.close(),t.prop(e.jobId).then(function(e){r(e)}),__conversion("ermergency_edit")}),__conversion("ermergency_card")},onClose:function(e){$(e).off("click")}})};return{show:r,notice:function(e){$.dialog({bind:!0,title:"",closeLayer:!1,content:i.notice(e),wrapClass:"direct-card-pop",confirmText:!1,cancelText:!1,onOpen:function(e){var t=this;$(e).on("click",".bead-close",function(){t.close(),a()})},onClose:function(e){$(e).off("click")}})},recommend:c}}(),Clock=function(){var e=(new Date).getTime(),t=0,i=function(e){return e-t};return{setMistiming:function(i){i.zpData-e>3e3&&(t=i.zpData-e)},pair:i}}(),Clocking=function(e,t,i){if(!this instanceof Clocking)return new Clocking(e,t,i);var a,n=i||{},s=this,o=function(){return n.pair?n.pair((new Date).getTime()):Clock.pair((new Date).getTime())},r=function(){var t=o(),i=Math.ceil((e-t)/1e3),a=Math.floor(i/86400),n=Math.floor(i/3600)-24*a,r=Math.floor(i/60)-24*a*60-60*n,c=Math.ceil(i)-24*a*60*60-60*n*60-60*r;return!(i>0)&&s.destroy(),{timing:i>0,day:Math.max(a,0),hour:n,minute:r,second:c}};this.format=function(e){var t=Math.floor(e/86400),i=Math.floor(e/3600)-24*t,a=Math.floor(e/60)-24*t*60-60*i,n=Math.ceil(e)-24*t*60*60-60*i*60-60*a;return{day:Math.max(t,0),hour:i,minute:a,second:n}},this.interval=function(e){var i=r();a=setInterval(function(){e(r())},t),e(i)},this.destroy=function(){clearInterval(a)}},CommercialGroup=function(){function e(e,t){$.dialog({bind:!0,title:"",content:e.content,confirmText:!1,cancelText:!1,wrapClass:"commercial-combination-wrap",inline:!0,onOpen:function(){s(this,e)},onClose:function(){}})}var t=function(e){if(!$.isArray(e.priceList))return e;var t=e.priceList.reverse(),i=t.find(function(e){return 4==e.showType});return e.priceList.reverse(),i||e.priceList[e.priceList.length-1]},i={top:function(e){return Utemplate('<div class="commercial-combination-top"><h3><%this.title%></h3><p class="gray"><%this.description%></p></div>',e)},footer:function(e){return Utemplate('<div class="commercial-combination-footer"><span class="btn btn-sure fr"><%this.text%></span><%if(this.cancelText){%><span class="btn btn-outline fr"><%this.cancelText%></span><%}%><p class="price"><%if(this.beanCount){%><span class="desc">待支付</span><span class="amount"><%this.beanCount%></span> <span class="unit">直豆</span><%if(this.discountDesc){%><span class="oprice"><%this.discountDesc%></span><%}%><%}else{%><span class="amount">免费</span><%}%></p></div>',{beanCount:t(e).beanCount,discountDesc:e.discountDesc,text:e.button?e.button.text:"立即购买",cancelText:e.cancelText,discountDesc:e.discountDesc})},group:function(e){if(e.cardList.length<2)return"";return Utemplate('<ul class="commercial-combination-group"><%for(var i=0;i<this.list.length;i++){%><li data-card="<%this.list[i].cardId%>" <%if(i==0){%>class="selected"<%}%>><%if(i==0){%><i class="icon-rec-tip"></i><%}%><h5><%this.list[i].title%></h5><p class="desc"><%this.list[i].subTitle%></p><p class="price"><%if(this.list[i].beanCount){%><%this.list[i].price%></p><%}else{%><span class="amount">免费</span><%}%><%if(this.showType == 4){%><i class="combination-priority"></i><%}%></li><%}%></ul>',{list:function(){return e.cardList.map(function(e){var t=e.priceList?e.priceList[0].beanCount+e.priceList[0].unitDesc+"起":e.beanCount+e.unitDesc;return{cardId:e.cardId,title:e.title,showType:e.showType,price:t,beanCount:e.priceList?e.priceList[0].beanCount:e.beanCount,subTitle:(e.subTitle||"").split("\n").join("<br>")}})}()})},trial:function(e){var t='<div class="commercial-panel trial-panel"><p class="subhead"><%this.headerList[0]%></p><table width="100%"><%for(var i=0; i<this.categoryList.length;i++){%><tr><td width="65%"><%this.categoryList[i].bottomDesc%></td><td><%this.categoryList[i].count%><%this.categoryList[i].unitDesc%></td></tr><%}%></table></div><div class="panel-desc-list">'+(e.bottomTipList||[]).map(function(e){return'<p class="panel-description">'+e.name+"</p>"}).join("")+"</div>";return Utemplate(t,e)},vip:function(e){return'<div class="commercial-combination-vip" data-card-id="3"><div class="combination-vip-table">'+i.vipItem(e)+'</div></div><div class="panel-desc-list">'+(e.bottomTipList||[]).map(function(e){return'<p class="panel-description">'+e.name+"</p>"}).join("")+"</div>"},flow:function(e){var t='<div class="commercial-chat-card" data-card-id="4"><ul><%for(var i=0;i<this.list.length; i++){%><li <%if(this.list[i].showType == 4){%>class="selected"<%}%>><%if(this.list[i].inDate){%><p class="item-price"><span class="fl"><span class="amount"><%this.list[i].beanCount%></span>直豆</span><span class="fr"><span class="amount" style="visibility: hidden;">0</span><em class="num"><%this.list[i].inDate%></em></span></p><%}else{%><p style="text-align: center;" class="item-price"><span class="amount"><%this.list[i].beanCount%></span>直豆</p><%}%><div class="item-desc"><p><span class="fl"><%this.list[i].viewDesc%></span><span class="fr"><em class="num"><%this.list[i].view%></em></span></p><p><span class="fl"><%this.list[i].chatDesc%></span><span class="fr"><em class="num"><%this.list[i].chat%></em></span></p></div></li><%}%></ul><div class="panel-desc-list">'+(e.bottomTipList||[]).map(function(e){return'<p class="panel-description">'+e.name+"</p>"}).join("")+"</div></div>",i=e.priceList.length-1,a=function(t){var a=[];return $.each(t,function(t,n){a.push({showType:0,viewDesc:16==e.business?"查看":"每日查看",chatDesc:16==e.business?"沟通":"每日沟通",chat:n.chatDescList[0],view:n.chatDescList[1],inDate:n.chatDescList.length>3?n.chatDescList[2]:"",beanCount:parseInt(n.chatDescList[n.chatDescList.length-1],10)}),4==n.showType&&(i=t)}),a}(e.priceList);return a[i].showType=4,Utemplate(t,{title:e.title,list:a,bottomDesc:e.bottomDesc})},position:function(e){var t=e.priceList.length-1,i=function(e){var i=[];return $.each(e,function(e,a){i.push({showType:a.showType,unitDesc:a.unitDesc,priceName:a.priceName,beanCount:a.beanCount,encryptPriceId:a.encryptPriceId,descList:a.descList.slice(0,2)}),4==a.showType&&(t=e)}),i}(e.priceList);return i[t].showType=4,
Utemplate('<div class="commercial-combination-position" data-card-id="2"><ul><%for(var i=0; i<this.list.length; i++){%><li <%if(this.list[i].showType == 4){%>class="selected"<%}%>><div class="commercial-item"><b class="name"><%this.list[i].priceName%></b><p><span class="amount"><%this.list[i].beanCount%></span><%this.list[i].unitDesc%></p></div><div class="item-desc"><%for (var j=0;j<this.list[i].descList.length; j++){%><p><span class="fr"><b><%this.list[i].descList[j].count%></b><%this.list[i].descList[j].unitDesc%></span><span class="gray"><%this.list[i].descList[j].bottomDesc%></span></p><%}%></div></li><%}%></ul><div class="panel-desc-list"><%for (var k=0;k<this.bottomTipList.length; k++) {%><p class="panel-description"><%this.bottomTipList[k].name%> </p><%}%></div></div>',{list:i,bottomTipList:e.bottomTipList||[],bottomDesc:e.bottomDesc})},positionItem:function(e,t){return e.isMulti=t,Utemplate('<table><tr><%if (this.isMulti) {%><td class="t-title" width="auto">火爆职位-<%this.priceName%></td><%}%><%for (var i=0; i<this.descList.length; i++){ %><td width="160"><%this.descList[i].count%><%this.descList[i].unitDesc%><br><%this.descList[i].bottomDesc%></td><%}%></tr></table>',e)},superPosition:function(e,t){var a='<div class="commercial-panel super-position-panel" data-card-id="6"><p class="subhead"><%this.title%></p><div class="vip-item">'+i.positionItem(e.priceList[0],t)+'</div><ul class="tap-option"><%for (var i=0; i<this.priceList.length; i++) {%><li class="commercial-item <%if(this.priceList[i].discountShowType == 1){%>discounts<%}%><%if(this.priceList[i].showType == 4){%> selected<%}%>"><%this.priceList[i].expireName%><span class="vip-price"><span class="vip-price-amount"><%this.priceList[i].beanCount%></span><%this.priceList[i].unitDesc%></span></li><%}%></ul><p class="panel-description"><%this.bottomDesc%>如企业需批量采购，请联系客服 400-065-5799 </p></div>';return e.title=t?"付费发布职位":e.title,Utemplate(a,e)},vipItem:function(e){return e.headerList||(e.headerList=["权益类型","当前权益","VIP权益"]),Utemplate('<table cellpadding="0" cellspacing="0" style="width:100%;"><thead><tr><td width="35%"><%this.headerList[0]%></td><td width="35%"><%this.headerList[1]%></td><td width="155"><%this.headerList[2]%></td></tr></thead><tbody><%for (var i=0; i<this.categoryList.length; i++) {%><tr><td><%this.categoryList[i].name%></td><td><%this.categoryList[i].currentRight%></td><td><%this.categoryList[i].vipRight%></td></tr><%}%></tbody></table>',e)},superVip:function(e){var t='<div class="commercial-combination-vip" data-card-id="3"><div class="combination-vip-table">'+i.vipItem(e)+'</div></div><div class="commercial-vip-group"><ul><%for(var i=0;i<this.priceList.length;i++){%><li <%if(this.priceList[i].showType == 4){%>class="selected"<%}%>><p class="vip-group-price"><span class="item-price"><em class="amount"><%this.priceList[i].beanCount%></em>直豆</span><span><em class="amount" style="visibility: hidden;width: 1px;overflow: hidden;">.</em><%this.priceList[i].averagePrice%></span></p><p class="vip-group-indate"><%this.priceList[i].expireName%></p></li><%}%></ul></div>'+(e.bottomTipList||[]).map(function(e){return'<p class="panel-description">'+e.name+"</p>"}).join("");return e.priceList.find(function(e){return 4==e.showType})||(e.priceList[e.priceList.length-1].showType=4),Utemplate(t,e)}},a={},n=function(){var e={},t=$(".commercial-combination-wrap"),i=t.find(".commercial-combination-group .selected"),n=i.length?a.cardList[i.index()]:a.cardList[0],s=n.priceList?n.priceList:n.vipCardList;if(s&&s.length){var o=t.find(".commerical-combination-detail .selected").index();e.combo=$.extend({},s[o]),e.combo.cardId=n.cardId,s[o].priceName?e.combo.title="火爆职位-"+s[o].priceName:e.combo.title=n.title}else e.combo=n;return e.combo.targetType=n.targetType,e.card=n,e},s=function(e,i){var s=$(".commercial-combination-wrap"),r=function(e,t){e.beanCount?s.find(".commercial-combination-footer .price").html('<span class="desc">待支付</span><span class="amount">'+e.beanCount+'</span> <span class="unit">直豆</span>'):s.find(".commercial-combination-footer .price").html('<span class="amount">免费</span>'),t&&s.find(".btn-sure").text(t.button.text)},c=function(e,t){var i=t.priceList?t.priceList[0]:t,a=t.priceList?i.beanCount+i.unitDesc+"起":i.beanCount+i.unitDesc;i.beanCount?e.find(".price").html(a):e.find(".price").html('<span class="amount">免费</span>')};s.on("click",".commercial-combination-group li",function(){if(!$(this).hasClass("selected")){var e=s.find(".commercial-combination-group .selected"),i=a.cardList[$(this).index()],n=o(i);c($(this),t(i)),c(e,a.cardList[e.index()]),s.find(".commerical-combination-detail").html(n),e.removeClass("selected"),$(this).addClass("selected"),r(t(i),i)}}),s.on("click",".commercial-vip-group li,.commercial-combination-position li,.commercial-chat-card li",function(){if(!$(this).hasClass("selected")){var e=$(this).closest("ul"),t=s.find(".commercial-combination-group .selected"),i=t.length?a.cardList[t.index()]:a.cardList[0],n=i.priceList[$(this).index()];t.find(".price").html('<span class="amount">'+n.beanCount+'</span><span class="unit">'+n.unitDesc+"</span>"),e.find(".selected").removeClass("selected"),$(this).addClass("selected"),r(n)}}),s.on("click",".btn-sure",function(){var t=n();e.close(),i.confirm(t.card,t.combo)}),s.on("click",".btn-outline",function(){i.cancel(s),e.close()})},o=function(e){var t,n=a.cardList.length>1;return 1==e.cardId||9==e.cardId?t=i.trial(e):2==e.cardId||10==e.cardId?t=i.position(e):3==e.cardId||11==e.cardId?t=i.vip(e):4==e.cardId||12==e.cardId?t=i.flow(e):5==e.cardId||16==e.cardId?t=i.superVip(e):6==e.cardId&&(t=i.superPosition(e,n)),t};return{block:function(t,n,s){a=$.extend({},t);var r=i.top({title:t.shortDesc.name,description:t.hlShortDesc?t.hlShortDesc.name:""}),c='<div class="commerical-combination-content">'+r+i.group(a);c+='<div class="commerical-combination-detail">'+o(t.cardList[0])+"</div></div>",e({content:c+i.footer($.extend(t.cardList[0],{cancelText:s.cancelText})),confirm:function(e,t){if(n&&n(e,t),e.button&&e.button.url){var i=getQueryParams(e.button.url),a=Block.formatBA(i.ba);Block.action(a),t.ba=a}},cancel:function(){s.cancel&&s.cancel()}},t)}}}(),CommercialVip=function(){function e(e,t){$(e).on("click",".commercial-props-group li",function(){if(!$(this).hasClass("selected")){$(e).find(".commercial-props-group .selected").removeClass("selected"),$(this).addClass("selected"),s();var t=o();7==t.cardId?$(e).find(".item-description").html(a.key(t)):$(e).find(".item-description").html(a.vip(t))}}),$(e).find(".commercial-props-group li").eq(0).trigger("click"),$(e).on("click",".btn-sure",function(){var i=o();t.confirm(i,i),$(e).remove()})}function t(t,i){$.dialog({bind:!0,title:"",content:t.content,confirmText:!1,cancelText:!1,wrapClass:"commercial-props-wrap",inline:!1,onOpen:function(i){e(i,t)},onClose:function(){}})}function i(e){return'<div class="commercial-props-content">'+a.group(e)+'<div class="item-description">'+a.key(e[0])+"</div></div>"}var a={top:function(e){return Utemplate('<div class="commercial-group-top"><h3><%this.title%></h3><span class="gray"><%this.description%></span></div>',e)},footer:function(e){return Utemplate('<div class="commercial-footer"><span class="btn btn-sure fr"><%this.text%></span><%if(this.cancelText){%><span class="btn btn-outline fr"><%this.cancelText%></span><%}%><div class="commercial-props-account fr"><p class="price"><span class="amount"><%this.beanCount%></span> <span class="unit"><%this.unitDesc%></span></p><p class="discount-price"><%this.discountDesc%></p></div></div>',{beanCount:$.isArray(e.priceList)?e.priceList[e.priceList.length-1].beanCount:e.beanCount,discountDesc:e.discountDesc,text:"立即购买",cancelText:e.cancelText,unitDesc:e.unitDesc})},group:function(e){return Utemplate('<ul class="commercial-props-group"><%for(var i=0; i<this.list.length;i++){%><li data-card-id="<%this.list[i].cardId%>"><h5><%this.list[i].article%></h5><p class="desc"><%this.list[i].description%></p><p class="price"><%this.list[i].price%></p></li><%}%></ul>',{list:e.map(function(e){return 7==e.cardId?{cardId:e.cardId,article:"沟通钥匙",description:"限沟通1位牛人",price:e.beanCount+"直豆/次"}:8==e.cardId?{cardId:e.cardId,article:"VIP账号",description:"专享每日"+e.title.replace(/[^0-9]/gi,"")+"人沟通权益！",price:e.beanCount+"直豆/月"}:e})})},vip:function(e){return Utemplate('<div class="vip-list"><table cellpadding="0" cellspacing="0"><thead><tr><td width="180">权益类型</td><td width="180">免费账号权益</td><td width="180">VIP专享权益</td></tr></thead><tbody><%for (var i=0; i<this.categoryList.length; i++) {%><tr><td><%this.categoryList[i].name%></td><td><%this.categoryList[i].currentRight%></td><td><%this.categoryList[i].vipRight%></td></tr><%}%></tbody></table></div>',e)},key:function(){return'<div class="props-chat-key"><i class="icon-locked"></i><span>一键解锁心仪牛人，沟通畅聊无阻解锁后，该牛人长期沟通有效</span></div>'}},n={},s=function(){var e=$(".commercial-props-wrap .dialog-container"),t=o(),i=7==t.cardId?"直豆/次":"直豆/月",a='<p class="price"><span class="amount">'+t.beanCount+'</span> <span class="unit">'+i+"</span></p>";e.find(".commercial-props-account").html(a)},o=function(){var e=$(".commercial-props-wrap .dialog-container"),t=e.find(".commercial-props-group .selected").attr("data-card-id");return n.cardList.find(function(e){return e.cardId==t})};return{block:function(e,s,o){if(n=e,e.cardList.length<2){var r=e.cardList[0];return r.article="今日沟通人数已达上限<span>购买沟通钥匙，解锁该牛人</span>",s(r,r),!1}t({content:a.top({title:e.shortDesc?e.shortDesc.name:"今日沟通人数已达上限",description:e.hlShortDesc?e.hlShortDesc.name:"购买沟通钥匙，或升级VIP账号"})+i(e.cardList)+a.footer($.extend(e.cardList[0],{cancelText:o.cancelText})),confirm:function(e,t){if(s&&s(e,t),e.button){var i=getQueryParams(e.button.url),a=Block.formatBA(i.ba);Block.action(a),t.ba=a}},cancel:function(){o.cancel&&o.cancel()}},e)}}}(),Commercial=function(){function e(e,t){var i,a=function(e){var i=t.cardList.filter(function(t){return t.cardId==e})[0];if(!i.priceList)return i;var a=$(".commercial-content:visible").find("input:checked").parents("tr").index();return i.priceList[a]},n=function(e){return e.find(".commercial-tab .selected").length?e.find(".commercial-tab .selected").attr("data-card-id"):t.cardList[0].cardId},s=function(e){var i=n(e),s=t.cardList.filter(function(e){return e.cardId==i})[0],o={discountDesc:a(i).discountDesc,beanCount:a(i).beanCount,confirmText:s.button.text};o.confirmText&&e.find(".commercial-footer .btn-sure").text(o.confirmText);var r="";void 0!=o.beanCount&&(r+='<p class="price">'+o.beanCount+" 直豆</p>"),o.discountDesc&&(r+='<p class="discount-price">'+o.discountDesc+"</p>"),e.find(".commercial-footer .combo-account").html(r)},o=function(e){e.find(".commercial-tab li").off("click").on("click",function(){var t=$(this).index(),i=e.find(".commercial-content").eq(t);e.find(".commercial-tab .selected").removeClass("selected"),$(this).addClass("selected"),e.find(".commercial-content").hide(),i.show(),s(e)}),e.find(".commercial-tab li").eq(0).trigger("click")},r=function(e){e.find(".commercial-content td").off("click").on("click",function(e){var t=$(this).parents("tr").find("label.radio");t.length&&!$.contains(this,e.target)&&t.trigger("click")})},c=function(i){var s=n(i),o=t.cardList.filter(function(e){return e.cardId==s})[0],r=a(s);r.cardId=s,r.title=o.title,r.targetType=card.targetType,e.confirm(o,r)},l=function(e){var a=function(e){return"<i>"+("0"+e).substr(-2,2).split("").join("</i><i>")+"</i>"},n=t.cardList.find(function(e){return e.activityEndDate});if(n){var s=n.activityEndDate;i=new Clocking(s,1e3),i.interval(function(t){var i="";i=t.day>0?'<span class="prom-text">距结束</span>'+a(t.day)+"&nbsp;天":'<span class="prom-text">距结束还剩</span>'+a(t.hour)+"："+a(t.minute)+"："+a(t.second),e.find(".vip-promotion").html(i)})}};$.dialog({bind:!0,title:"",content:e.content,confirmText:!1,cancelText:!1,wrapClass:"commercial-wrap",inline:!0,onOpen:function(t){var i=$(t),a=this;o(i),r(i),i.find(".btn-sure").off("click").on("click",function(){c(i),a.close()}),i.find(".btn-outline").off("click").on("click",function(){e.cancel(i),a.close()}),i.find("input[type=radio]").length&&i.find("input[type=radio]").off("change").on("change",function(){s(i)}),l(i)},onClose:function(){}})}var t={top:function(e){return Utemplate('<div class="commercial-top"><p class="title"><%this.title%></p><%if(this.description != ""){%><p class="description"><%this.description%></p><%}%></div>',e)},footer:function(e){return Utemplate('<div class="commercial-footer"><p class="fl">如企业需要批量采购，请联系客服 <span class="phone">400-065-5799</span></p><span class="btn btn-sure fr"><%this.text%></span><%if(this.cancelText){%><span class="btn btn-outline fr"><%this.cancelText%></span><%}%><div class="combo-account fr"><p class="price"><%this.beanCount%> 直豆</p><p class="discount-price"><%this.discountDesc%></p></div></div>',{beanCount:$.isArray(e.priceList)?e.priceList[e.priceList.length-1].beanCount:e.beanCount,discountDesc:e.discountDesc,text:e.button.text,cancelText:e.cancelText})},tab:function(e){return Utemplate('<ul class="commercial-tab"><%for(var i=0;i<this.list.length;i++){%><li data-card-id="<%this.list[i].cardId%>"><%this.list[i].title%></li><%}%></ul>',{list:e})},trial:function(e){return Utemplate('<div class="commercial-content trial-panel"><ul><%for(var i=0; i<this.categoryList.length; i++){%><li><p class=""><span class="num"><%this.categoryList[i].count%></span><%this.categoryList[i].unitDesc%></p><span class="gray"><%this.categoryList[i].bottomDesc%></span></li><%}%></ul><p class="gray"><%this.bottomDesc%></p></div>',e)},vip:function(e){return Utemplate('<div class="commercial-content vip-panel"><%if(this.activityType){%><div style="margin-bottom: -10px;" class="vip-promotion vip-promotion<%this.activityType%>"></div><%}%><table><thead><tr><td class="title">VIP权益</td><td class="own">当前账号</td><td class="vip">VIP账号</td></tr></thead><tbody><%for (var i=0; i<this.categoryList.length; i++) {%><tr><td class="title"><%this.categoryList[i].name%></td><td class="own"><%this.categoryList[i].currentRight%></td><td class="vip"><%this.categoryList[i].vipRight%></td></tr><%}%></tbody></table><p class="gray"><%this.bottomDesc%></p></div>',e)},flow:function(e){return Utemplate('<div class="commercial-content flow-panel"><table><thead><td>每日沟通总量人数</td><%if(this.inData){%><td class="tc">有效期</td><%}%><td class="tr">价格</td></thead><tbody><%for(var i=0; i<this.list.length; i++){%><tr><td><label class="radio"><input type="radio" name="flowCombo" value="0" checked="checked"><span><%this.list[i].chat%></span><%if(this.list[i].showType == 4){%><i class="icon-rec">荐</i><%}%></label></td><%if(this.list[i].inData){%><td class="tc"><%this.list[i].inData%></td><%}%><td class="tr"><%this.list[i].beanCount%></td></tr><%}%></tbody></table><p class="gray"><%this.bottomDesc%></p></div>',{inData:e.priceList[0].chatDescList.length>2,list:function(e){var t=[];return $.each(e,function(e,i){t.push({showType:i.showType,chat:i.chatDescList[0],inData:i.chatDescList.length>2?i.chatDescList[1]:"",beanCount:i.chatDescList.length>2?i.chatDescList[2]:i.chatDescList[1]})}),t}(e.priceList),bottomDesc:e.bottomDesc})},position:function(e){return Utemplate('<div class="commercial-content hot-panel"><table><tbody><%for(var i=0; i<this.list.length; i++){%><tr><td><label class="radio"><input type="radio" name="hotCombo" value="0" checked="checked"><span><%this.list[i].priceName%></span><%if(i==this.list.length-1){%><i class="icon-rec">荐</i><%}%></label></td><td class="tc"><%this.list[i].chat%></td><td class="tc"><%this.list[i].view%></td><td class="price"><%this.list[i].beanCount%>直豆／月</td></tr><%}%></tbody></table><p class="gray"><%this.bottomDesc%></p></div>',{list:function(e){var t=[];return $.each(e,function(e,i){t.push({priceName:i.priceName,beanCount:i.beanCount,chat:i.descList[0].count+i.descList[0].unitDesc+i.descList[0].bottomDesc,view:i.descList[1].count+i.descList[1].unitDesc+i.descList[1].bottomDesc})}),t}(e.priceList),bottomDesc:e.bottomDesc})}},i={vipPrice:function(e){var t=$.Deferred(),e=e||{sf:10};return $.get("/bossweb/vip2/price.json",e,function(e){1==e.rescode?t.resolve(e.blockPageData):$.toast({type:"error",content:e.resmsg})}),t}},a=function(e){return 1==e.cardId?t.trial(e):2==e.cardId||10==e.cardId?t.position(e):3==e.cardId||11==e.cardId?t.vip(e):4==e.cardId?t.flow(e):void 0},n=function(e){var i=[],n=[];return e.length<2?a(e[0]):($.each(e,function(e,t){i.push({title:t.title,cardId:t.cardId}),n.push(a(t))}),t.tab(i)+'<div class="combo-group">'+n.join("")+"</div>")},s=function(i,a,s){var s=s||{};if(i.cardList.length<1)return!1;var o=i.cardList[0].cardId,r=i.cardList.find(function(e){return 7===e.cardId}),c=[1,2,3,4,5,6,9,10,11,12,16];if(i.cardList.length>1||c.indexOf(o)>-1||r)return r?CommercialVip.block(i,a,s):CommercialGroup.block(i,a,s),!0;e({content:t.top({title:i.shortDesc.name,description:i.hlShortDesc?i.hlShortDesc.name:""})+n(i.cardList)+t.footer($.extend(i.cardList[0],{cancelText:s.cancelText})),confirm:function(e,t){if(a&&a(e,t),e.button){var i=getQueryParams(e.button.url),n=Block.formatBA(i.ba);Block.action(n),t.ba=n}},cancel:function(){s.cancel&&s.cancel()}},i)},o=function(e,t){var a=!1;i.vipPrice(e).then(function(e){var i={success:function(){!a&&t&&"function"==typeof t&&(t(),a=!0),a||t||(window.top.mediator.publish("buyVipSuccess",{success:!0}),a=!0)}};if(window.top.BlockSence.include(e,i))return!1;s(e,function(e,i){var n=$.extend({isPurchase:!0,business:e.business,targetType:e.targetType},i);window.top.Purchase.commercial({priceId:n.encryptPriceId,targetId:e.encryptTargetId,business:n.business||"",targetType:n.targetType},{item:n,success:function(){!a&&t&&"function"==typeof t&&(t(),a=!0),a||t||(window.top.mediator.publish("buyVipSuccess",{success:!0}),a=!0)}})})})},r=function(){function e(e,t){window.top.Purchase.position("/boss/block/pay.json",{action:e.action,jobId:e.jobId,priceId:t.id,action:"experience"==t.type?5:3,hotJobType:0,targetId:e.jobId,targetType:e.targetType,payMode:e.payMode,business:e.business},{item:t,action:e.action?e.action:"开启",success:function(){e.success(t.type)},confirm:function(){e.confirm&&e.confirm(t.type)}})}return function(t){var i={cityCode:t.cityCode,positionCode:t.positionCode,ptype:t.ptype,configId:t.configId,experienceId:t.experienceId,payMode:t.payMode};t.combos&&(i.combos=t.combos);var a=1==t.vipAccount&&t.vipPriceId,n=t.action?t.action:"开启";a&&window.top.__conversion("position_hot_open_block_vip"),window.top.Block.purchase(i,{isEdit:!0,cancelText:"我再想想",title:function(){return a?"该职位为火爆职位":"您需要付费"+n+"火爆职位"}(),description:function(){var e=2==t.vipAccount&&t.limitCount>-2?"您的 VIP 权益可免费发布 "+t.limitCount+" 个火爆职位，目前已达上限，可付费单独"+n+"该职位":"您"+n+"的职位属于火爆职位，因为Boss竞争激烈，所以需要付费才能"+n+"。";return a?"该行业 Boss 竞争激烈，可开通 VIP 账号或单独付费以开启该职位":e}(),vka:"block_openjob_purchase_hot",canBuyVip:a,vipAccount:t.vipAccount,vipPriceId:t.vipPriceId,sf:a?7:"",cancel:function(){},confirm:function(i){if("vip"==i.type){window.top.Purchase.vip({amount:i.pay,priceId:t.vipPriceId},i);var a=window.top.Block.formatBA(i.ba);a&&window.top.Block.action(a),window.top.__conversion("position_hot_open_purchase_vip")}else{var n=window.top.Block.formatBA(t.ba);n&&(n.p4="experience"==i.type?1:2,n.p5=i.id,n.action="user-block-biz-button"),n&&window.top.Block.action(n),e(t,i)}}})}}(),c=function(){function e(e,t){window.top.Purchase.position("/boss/block/pay.json",{action:e.action,jobId:e.jobId,priceId:t.id,action:3,hotJobType:1,targetId:e.targetId,targetType:e.targetType,payMode:e.payMode,business:e.business},{item:t,action:e.action?e.action:"开启",success:function(){e.success&&e.success(t.type)},confirm:function(){}})}return function(t){var i={ptype:t.ptype,configId:t.configId,experienceId:t.experienceId,payMode:t.payMode};t.combos&&(i.combos=t.combos);var a=t.action?t.action:"开启";window.top.Block.super(i,{isEdit:!0,cancelText:"我再想想",title:"您需要付费"+a+"火爆职位",description:"您"+a+"的职位属于火爆职位，因为Boss竞争激烈，所以需要付费才能"+a+"。",vka:"block_openjob_purchase_super",cancel:function(){},confirm:function(i){e(t,i);var a=window.top.Block.formatBA(t.ba);a&&(a.p4="experience"==i.type?1:2,a.p5=i.id,a.action="user-block-biz-button"),a&&window.top.Block.action(a)}})}}();return{vip:o,block:s,hot:r,super:c}}(),SearchChatingCard=function(){function e(){function i(){var e=$(".commercial-props-wrap .dialog-container"),t=e.find(".commercial-props-group .selected").attr("data-card")||"chat",i=c(),a="chat"===t?"buy-chating-card":"buy-geek-call";i.vipSave=parseInt(i.originalPrice)-i.price,i.vipSaveText=i.vipSave>0?'<p class="vip-save-desc"><i class="vip-discount-sign"></i>为您节省<span class="vip-save-amount">¥'+i.vipSave+"</span></p>":"",__conversion(a);var n=function(){o.option.success({card:t,item:i,left:o.option.left,chat:o.option.data.searchChatCard.chatCount})},s={url:"/boss/item/buy/othItem/"+i.id+".json",amount:parseInt(i.price,10),itemId:i.id,data:{source:o.source},success:n};"call"==t&&(s.data.buyCount=i.count);var r={success:n};Payment.purchase(s,r)}function n(e,n){var s=$(e),r={0:"",1:"item-vip-unbought",2:"item-vip-bought"};s.addClass(r[t.option.data.vipPriceStatus]),s.on("click",".commercial-props-group li",function(){s.find(".commercial-props-group .selected").removeClass("selected"),$(this).addClass("selected");var e=o.option.data,t=$(this).attr("data-card"),i="call"==t?e.geekRights:e.searchChatCard;"call"==t?s.find(".item-description").html(a.call(o.option.left,i)):(i.eliteGeekGrayBoss=e.eliteGeekGrayBoss,s.find(".item-description").html(a.chat(i))),l()}),s.on("click",".item-call-list p",function(){s.find(".item-call-list .selected").removeClass("selected"),$(this).addClass("selected"),l()}),s.on("click",".btn-sure",function(){var e=$(".commercial-props-wrap .dialog-container"),t=e.find(".commercial-props-group .selected").attr("data-card");o.option.left>0&&"call"==t?(o.option.success({card:t,left:o.option.left}),__conversion("use-geek-call")):o.option.data.usableSearchItemCount>0?(o.option.success({card:"chat",usableSearchItemCount:o.option.data.usableSearchItemCount}),__conversion("use-geek-chat")):i(),n.close()}),l(),$(e).on("click",".J_robot",function(){ChatBot.open();try{var e=$(".commercial-props-group .selected").data("card"),t="call"===e?8:19;Block.action({action:"help-robot-call",p2:3,p3:t})}catch(e){}}),$(e).on("click",".J_call",function(){CallMeDialog();try{var e=$(".commercial-props-group .selected").data("card"),t="call"===e?8:19;Block.action({action:"help-passive-call-click",p2:3,p3:t})}catch(e){}})}function s(e,t){$.dialog({bind:!0,title:"",content:e.content,confirmText:!1,cancelText:!1,wrapClass:"commercial-props-wrap",inline:!0,onOpen:function(e){n(e,this)},onClose:function(){}})}var o=this,r=function(e,t,i){e.left=o.option.left||0,e.usableSearchItemCount=t,e.geekRights.left=o.option.left||0,e.geekRights.discountList=e.geekRightsDiscountList.map(formatDiscountList),e.searchChatCard.left=t||0,e.searchChatCard.discountList=e.searchChatDiscountList.map(formatDiscountList);var n;n=i||(e.usableSearchItemCount>0||!e.left?"chat":"call");var r="call"===n?e.geekRights:e.searchChatCard;"call"!==n&&r&&e.eliteGeekGrayBoss&&(r.eliteGeekGrayBoss=e.eliteGeekGrayBoss);var c="call"===n?a.call(o.option.left,r):a.chat(r),l=a.group(n,e);s({content:a.top()+'<div class="commercial-props-content">'+l+'<div class="item-description">'+c+'</div><p class="business-meal" style="margin-bottom:20px;margin-top:-10px;">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a >或<a href="javascript:;" class="J_call">请销售顾问联系我</a ></p ></div>'+a.footer(o.option.left,r),confirm:function(e,t){},cancel:function(){option.cancel&&option.cancel()}},e)},c=function(){var e=$(".commercial-props-wrap .dialog-container"),t=e.find(".commercial-props-group .selected").attr("data-card"),i="call"==t?o.option.data.geekRights:o.option.data.searchChatCard;return $.isArray(i)?i[e.find(".item-call-list .selected").length?e.find(".item-call-list .selected").index():i.length-1]:i},l=function(){var e=$(".commercial-props-wrap .dialog-container"),i=e.find(".commercial-props-group .selected").attr("data-card"),a=c();t.option.data.vipPriceStatus,a.economize&&parseInt(a.economize,10),a.price;return"call"==i&&o.option.left>0?(e.find(".btn-sure").text("立即使用"),!1):"call"!=i&&o.option.data.usableSearchItemCount>0?(e.find(".btn-sure").text("激活并使用"),!1):void e.find(".btn-sure").text("立即购买")};o.include=function(e){o.option=e,o.source=e.source;var t=e.data;if(!window.top.searchCardChatABGray)return!!(t.geekRights&&t.searchChatCard&&t.canBuySearchCard)&&(r(t,t.usableSearchItemCount),!0);var i=e.transmit;window.top.CardChatProp&&window.top.CardChatProp.cardOpen({source:"search_connect_geek",onOpen:function(){},transmit:i||{},success:function(e,t){window.top.mediator.publish("searchUsePropSuccess",e,t)},fail:function(e){0!==e.code&&$.toast({type:"error",content:e.message})},buySuccess:e.success})};var d=!1;o.shopping=function(e){if(window.top.searchCardChatABGray)return void(window.top.CardChatProp&&window.top.CardChatProp.buyChat(e));d||(d=!0,$.get("/wapi/zpitem/web/geekInfoRight/getGeekInfoRight.json",function(t){if(d=!1,t.zpData.canBuySearchCard){o.source=e.source,o.option={data:t.zpData,success:e.success||function(){}};var i=e&&e.card;r(t.zpData,0,i)}else PropShop.geekPropCall.buy(e)}),setTimeout(function(){d&&(d=!1)},2e3))},o.confirm=function(e){var t={bind:!0,title:"使用成功",wrapClass:"flex-dialog-wrap dialog-prop-confirm",description:"已为您向牛人发起沟通并索要简历",cancelText:"查看对话",confirmText:"继续搜索",onCancel:function(){this.close("cancel")},onConfirm:function(e){this.close("confirm")},onClose:function(){}},i=e||{},a=$.extend(t,i);a.content='<div class="prop-confirm-content">'+a.description+"</div>",$.dialog(a)},e=function(){return o}}var t=new e,i=function(e,i){var a=t.option.data;return 1==a.vipPriceStatus&&e.vipPrice>0?'<span class="amount">'+e.price+'</span><span class="unit">'+i+'</span><span class="text-gray-price">'+e.vipPrice+i+'</span><i class="vip-discount-sign"></i>':2==a.vipPriceStatus&&e.originalPrice>e.price?'<span class="amount">'+e.price+'</span><span class="unit">'+i+'</span><i class="vip-discount-sign"></i><span class="text-gray-price">'+e.originalPrice+i+"</span>":'<span class="amount">'+e.price+'</span><span class="unit">'+i+"</span>"},a={top:function(e){return Utemplate('<div class="commercial-group-top"><h3>请选择道具</h3></div>',e)},footer:function(e,t){var i=function(){if($.isArray(t)){var i=t.length-1;return t[i].showPrice=e<0,t[i]}return t.showPrice=!0,t}();return Utemplate('<div class="commercial-footer"><span class="btn btn-sure fr"><%this.text%></span><%if(this.cancelText){%><span class="btn btn-outline fr"><%this.cancelText%></span><%}%></div>',{beanCount:i.price,discountDesc:i.economize||"",text:i.button?i.button.text:"立即购买",cancelText:t.cancelText,unitDesc:"直豆",showPrice:i.showPrice})},group:function(e,t){var a=t.geekRights[0],n='<ul class="commercial-props-group"><li <%if(this.card == "call"){%>class="selected"<%}%> data-card="call"><h5>牛人电话</h5><p class="desc">联络1位心仪牛人<br>48小时 不成功退道具</p><%if(0 < this.left){%><p class="left">剩余<%this.left%>个</p><%}else{%><p class="price">'+i(a,"直豆/个")+'<%}%></li><li <%if(this.card != "call"){%>class="selected"<%}%> data-card="chat"><%if(this.eliteGeekGrayBoss){%><h5>搜索畅聊卡</h5><p class="desc">至多沟通<%this.searchChatCard.chatCount%>位牛人<br>一键解锁立即沟通</p><%}else{%><h5>搜索畅聊卡</h5><p class="desc">搜索达人必备<%this.searchChatCard.chatCount%>次沟通权益<br>一键解锁立即沟通</p><%}%><%if(0 < this.usableSearchItemCount){%><p class="left">剩余<%this.usableSearchItemCount%>个</p><%}else{%><p class="price">'+i(t.searchChatCard,"直豆/月")+"</p><%}%></li></ul>";t.card=e;return t.usableSearchItemCount>0&&!t.left||!t.canBuyGeekInfoRight&&!t.left?Utemplate('<div class="search-card-only"><%if(this.usableSearchItemCount){%><p class="left">剩余<%this.usableSearchItemCount%>件</p><%}%><div><p class="card-name">搜索畅聊卡</p><p class="card-desc">搜索达人必备<%this.searchChatCard.chatCount%>次沟通权益，一键解锁立即沟通</p></div></div>',t):Utemplate(n,t)},chat:function(e){var t='<div class="search-desc-list"><%if(this.eliteGeekGrayBoss){%><dl><dd><i class="card-free"></i></dd><dt>30天畅聊</dt><dd>30日内拥有'+e.chatCount+'次畅聊匿名牛人权益，普通牛人消耗1次权益，精英牛人消耗2次权益</dd></dl><dl><%}else{%><dl><dd><i class="card-free"></i></dd><dt>30天畅聊</dt><dd>30日内畅聊'+e.chatCount+'位匿名牛人，搜索/推荐匿名牛人均可使用</dd></dl><dl><%}%><dd><i class="card-resume"></i></dd><dt>快速获取简历</dt><dd>短信通知牛人直接索要简历<br>同意投递自动发送至邮箱</dd></dl><dl><dd><i class="card-chat"></i></dd><dt>立即联络匿名牛人</dt><dd>直接对心仪匿名牛人开始沟通，不消耗每日沟通权益</dd></dl></div><%if(this.left < 1){%><div class="item-active-list"><ul><%for(var i=0;i<this.discountList.length;i++){%><li><i><%this.discountList[i].discountTag%></i><%this.discountList[i].name%></li><%}%></ul></div><%}%>';return Utemplate(t,e)},call:function(e,i){return Utemplate('<div class="search-desc-list "><dl><dd><i class="card-geek"></i></dd><dt>精准搜索大牛</dt><dd>搜索公司/职位/技能，多维度精准定位你的心仪牛人</dd></dl><dl><dd><i class="card-call"></i></dd><dt>快速获取电话、简历</dt><dd>直接向牛人发送投递邀请，投递后电话简历直接发送至邮箱</dd></dl><dl><dd><i class="card-back"></i></dd><dt>不成功退道具</dt><dd>如牛人拒绝投递或48小时内无答复，将退还您的道具</dd></dl></div><%if(this.left == 0 || !this.left){%><div class="item-call-list"><%for(var i=0; i<this.list.length; i++){%><p <%if(i == (this.list.length - 1)){%>class="selected icon-discount"<%}%> ><%this.list[i].count%>个<i class="vline"></i><%this.list[i].price%>直豆<%if (this.bought && 0 < this.list[i].vipPrice){%><i class="vip-discount-sign"></i><%}%></p><%}%></div><div class="item-active-list"><ul><%for(var i=0;i<this.discountList.length;i++){%><li><i><%this.discountList[i].discountTag%></i><%this.discountList[i].name%></li><%}%></ul></div><%}%>',{left:e||0,list:i,discountList:i.discountList,bought:2==t.option.data.vipPriceStatus})}};return t}(),GeekHotProp=function(){var e={},t={},i={combo:function(){var t={title:e.title,single:e.cardList[0],group:e.cardList[1]};return t.group.leftCount>0&&(t.group.itemNote="(1/"+t.group.leftCount+")"),Utemplate('<div class="drop-help-panel"><ul><li><i></i>技术类牛人是指您使用部分技术类职位沟通的牛人</li><li><i></i>目前，您与主动沟通的此类牛人继续沟通时需购买以下商品</li></ul></div><h3 class="title"><%this.title%><i class="icon-help"></i></h3><p class="description gray">使用免费次数与牛人继续沟通</p><div class="geek-hot-group"><ul><li class="item-single <%if(0 < this.single.freeCount){%>item-remain<%}%>"><div class="geek-hot-item"><%if(this.single.showType == 1){%><p class="corner-mark"><span>今日还有<%this.single.freeCount%>次免费</span></p><%}%><p class="item-name"><%this.single.itemNote%></p><span class="item-price"><%this.single.itemName%></span></div></li><li class="item-group <%if(0 < this.group.leftCount){%>item-left<%}%>"><div class="geek-hot-item"><%if(this.group.showType == 1){%><p class="corner-mark"><span>推荐道具</span></p><%}%><p class="item-name"><b><%this.group.itemName%></b></p><p class="item-price"><%this.group.itemNote%></p><p class="item-limit"><%this.group.expireDesc%></p></div></li></ul></div>',t)}},a=function(t,i){var a=t.find(".geek-hot-group .selected").index(),n=i||e.cardList[a],s=n.freeCount>0?"使用免费次数与牛人继续沟通":"使用以下道具与牛人继续沟通";t.find(".btn-sure").text(n.button.text),t.find(".description").text(s)},n=function(){$.dialog({bind:!0,title:"",content:i.combo(),confirmText:"立即购买",cancelText:!1,wrapClass:"prop-hot-geek",onOpen:function(t){$(t).on("click",".geek-hot-group li",function(){$(t).find(".selected").removeClass("selected"),$(this).addClass("selected"),a($(t))}),$(t).on("click",".icon-help",function(){$(t).addClass("geek-help-open")}),$(t).on("click",function(e){$(e.target).hasClass("icon-help")||$(e.target).hasClass("drop-help-panel")||$(e.target).closest("div").hasClass("drop-help-panel")||$(t).removeClass("geek-help-open")});var i=e.cardList[0].freeCount>0?0:1;$(t).find(".geek-hot-group li").eq(i).addClass("selected"),a($(t),e.cardList[i])},onConfirm:function(i){var a=$(i).find(".geek-hot-group .selected").index(),n=e.cardList[a],s=function(){var e="";e=14===n.cardId?"购买单成功：您可以直接在对话中和牛人沟通":"已购买"+n.itemNote+"牛人沟通权益，"+(n.expireDesc?n.expireDesc+"。":"")+"您可以直接在对话中和牛人沟通",Payment.success({article:"购买成功",text:e,confirm:function(){
t.callBack(n)}})};if((n.freeCount>0||n.leftCount>0)&&t.callBack)t.callBack(n);else{var o={prePayUrl:"/block/preOrder",url:"/boss/block/pay.json",amount:n.beanCount,description:15==n.cardId?"购买道具：「极客畅聊卡」":"购买道具：「技术牛人」沟通",data:{priceId:n.priceId,business:n.business,targetType:n.targetType,targetId:n.encryptTargetId},success:s},r={success:s};window.top.Payment.purchase(o,r)}$(i).remove()}})};return{shop:function(i,a){e=i,t=a,n()}}}(),PropShop=function(){function e(){var t=this,i={props:function(e){return e.geekRights.map(function(t){return t.style=10==t.count?"selected hot":"",t.price=parseInt(t.price,10),t.isVip=e.vipPriceStatus>0&&(t.vipPrice>0||t.isVipItem),t.isVip&&(t.style+=1==e.vipPriceStatus?" prop-item-unbought":" prop-item-bought"),t}),Utemplate('<h3 class="prop-call-title">购买牛人电话</h3><div class="prop-cont prop-sells"><ul><%for(var i=0;i<this.geekRights.length; i++){%><li data-id="<%this.geekRights[i].id%>" class="<%this.geekRights[i].style%>" ><%if(this.geekRights[i].isVipItem && this.vipPriceStatus == 2){%><i class="vip-discount-sign"></i><span class="text-orange fr">￥<%this.geekRights[i].price%></span><span class="text-gray-price">￥<%this.geekRights[i].originalPrice%></span><%}else if(0 < this.geekRights[i].vipPrice && this.vipPriceStatus == 1){%><i class="vip-discount-sign"></i><span class="text-gray-price">￥<%this.geekRights[i].vipPrice%></span><span class="text-orange fr">￥<%this.geekRights[i].price%></span><%}else{%><span class="text-orange fr">￥<%this.geekRights[i].price%></span><%}%><p class="fl">购买<%this.geekRights[i].count%>个牛人电话<%if(this.geekRights[i].economize!=0){%><span class="gray">（节省￥<%this.geekRights[i].economize%>）</span><%}%></p></li><%}%></ul><div class="sells-pay"></div></div>',e)},consume:function(e){return Utemplate('<div class="prop-chat"><h3>使用牛人电话道具联系牛人</h3><p class="gray">请选择与牛人沟通的职位</p><div class="dropdown-wrap J_stickPosition"><span class="dropdown-select"><i class="icon-select-arrow"></i><input type="text" placeholder="待沟通的职位" class="ipt sel-active" readonly=""><p class="input-mask"><%this.job.jobName%><i class="vline"></i><%this.job.salaryDesc%></p><input type="hidden" value="<%this.job.encryptId%>"></span><div class="dropdown-menu"><ul><%for(var i=0;i<this.jobs.length;i++){%><li data-id="<%this.jobs[i].encryptId%>"><%this.jobs[i].jobName%><i class="vline"></i><%this.jobs[i].salaryDesc%></li><%}%></ul></div></div></div>',e)}},a={props:function(){var e=$.Deferred();return $.get("/wapi/zpitem/web/geekInfoRight/getGeekInfoRight.json",function(t){e.resolve(t.zpData)}),e},job:function(e){var t=$.Deferred();return $.get("/boss/item/getJobByGeekId.json",e,function(e){t.resolve(e)}),t},jobList:function(){var e=$.Deferred();return $.get("/chat/user/joblist.json",function(t){e.resolve(t.data)}),e},consume:function(e,t){var i=$.Deferred();return $.ajax({method:"post",url:"/wapi/zpitem/web/geekInfoRight/use/"+e,data:t,success:function(e){i.resolve(e)}}),i}};t.consume=function(e,t){$.when(a.jobList(),a.job(e)).then(function(n,s){if(!n||n&&n.length<1)return Block.confirm({title:"您暂时不能与这位牛人开聊！",description:"请至少发布一个开放职位"}),!1;s.jobs=n,$.dialog({bind:!0,title:"",closeText:!1,content:i.consume(s),confirmText:"联系牛人",cancelText:!1,wrapClass:"prop-item-chat",onOpen:function(e){DropDown.init($(e)),$(e).on("click",".dropdown-menu li",function(){$(e).find(".input-mask").html($(this).html()),$(e).find(".J_stickPosition input[type=hidden]").val($(this).attr("data-id"))})},onConfirm:function(i){var n=$(i).find(".J_stickPosition input[type=hidden]").val();$(i).find(".btn-sure").addClass("disabled"),a.consume(n,e).then(function(e){t.success&&t.success(e),$(i).remove()})}})})},t.buy=function(e){var e=e||{},t=function(t){var a=function(){var e=$(".prop-item-call .selected").attr("data-id");return t.geekRights.find(function(t){return t.id==e})};$.dialog({bind:!0,title:"",closeText:!1,content:i.props(t),confirmText:"购买",cancelText:!1,wrapClass:"prop-item-call",onOpen:function(e){var i=function(){var i=a(),n=parseInt(i.price,10),s='<p class="fr">需要支付：<em class="text-orange">¥'+(t.beanCount>n?0:n-t.beanCount)+"</em></p><p><span>金额：¥"+n+"</span><span>余额：¥"+t.beanCount+"</span></p>";$(e).find(".sells-pay").html(s)};$(e).on("click",".prop-sells li",function(){$(e).find(".selected").removeClass("selected"),$(this).addClass("selected"),i()}),i()},onConfirm:function(t){var i=a();i.vipSave=i.originalPrice-i.price,i.vipSaveText=i.vipSave>0?'<p class="vip-save-desc"><i class="vip-discount-sign"></i><span>为您节省</span><span class="vip-save-amount">¥'+i.vipSave+"</span></p>":"";var n=function(t){e.success&&e.success(i)},s={url:"/boss/item/buy/othItem/"+i.id+".json",amount:i.price,description:"购买道具：「牛人电话」- "+i.count+" 个",data:{buyCount:1},itemId:i.id,success:n},o={success:n};this.close(),window.top.Payment.purchase(s,o)}})};e.props?t(e.props):a.props().then(function(e){t(e)})},e=function(){return t}}return{geekPropCall:new e}}(),ChatBot=function(){var e=new EventManger,t=e.subscribe,i=function(e){var t=__type(e),i=__user(t,e);return(maxId>e.mid||0==maxId)&&(maxId=e.mid),{type:t,name:i.name,clientId:e.tempID,avatar:i.avatar+"?x-oss-process=image/resize,w_60,limit_0",isSelf:_PAGE.uid==i.uid,action:_PAGE.uid==i.uid||e.isSelf?"sent":"received",text:Emotion.textCodeToImg(__text(t,e)),originalText:__text(t,e),style:__style(e),image:__image(t,e),company:i.company,position:i.position||"",isAdmin:e.isAdmin,certification:e.certification?e.certification:i.certification,time:e.time,messageId:e.messageId||e.mid,mid:e.mid||e.tempID,fromId:i.uid,toId:e.to?e.to.uid:e.toId,hyperLink:__hyperLink(t,e),interviewShare:__parseJson(t,e),sound:__parseJson(t,e)}},a=function(e){var t;Chat.protobufMessage.createMessage[e.type]&&(msg={tempID:e.clientMid?e.clientMid:(new Date).getTime(),isSelf:!0,from:{uid:Chat.myselfData.uid,name:Chat.myselfData.name,avatar:Chat.myselfData.face},to:{uid:1400400,encryptUid:"02e7ae8b1aacb2281nB629m9EA~~"},time:(new Date).getTime(),body:{type:1,text:e.content||"",action:e.action||null,image:e.image||null},mSource:"server",typeSource:"newSubmit",type:1,taskId:e.taskId||""},t=Chat.protobufMessage.createMessage[e.type](msg)),ChatWebsocket.send(t)},n=function(e){window.top.frames.chatBotDialog&&window.top.frames.chatBotDialog.postMessage({name:"Chat_BOT_RECEIVED",message:e},"*")},s=function(e){$(e).find(".dialog-con").append('<div class="chat-robot-loading"><div class="boss-loading"><span class="component-b"></span><span class="component-o"></span><span class="component-s1"></span><span class="component-s2"></span><p class="gray">正在加载中...</p></div></div>')},o=function(){var e=_PAGE.uid%10,t=[0,1,2,3,4,5,6,7,8,9],i="boss-m.weizhipin.com"===window.location.host;window.location.host,window.location.host;return t.indexOf(e)>-1||i},r=function(){window.top.$(".dialog-chatbot-wrap").find(".dialog-con .chat-robot-loading").hide()},c=function(e){ChatWebsocket.sendReadMessage(e)},l=function(){if(!o()){var t="https://www.sobot.com/chat/pc/index.html?sysNum=0ae4336e735c44f7801438a4dbc27c52&color=18c3b1&remark="+_PAGE.uid+"&powered=false&satDegree_A=false";return void window.open(t)}$(document).on("click",".chatRobot-preview-big-img-wrap .chatRobot-preview-big-img .chatRobot-big-img-close",function(){$(".chatRobot-preview-big-img-wrap").remove()}),$.dialog({title:"",content:"",wrapClass:"dialog-chatbot-wrap",closeText:!1,confirmText:!1,cancelText:!1,lock:!0,inline:!0,closeLayer:!1,onOpen:function(t){e.subscribe("CHAT_BOT_CLOSE",function(){$(t).remove()}),setTimeout(function(){s(t),$(t).find(".dialog-con").append('<iframe name="chatBotDialog" style="border:0" width="100%" height="100%" src="/vue/index/#/dashboard/chat-robot"></iframe>');var e=setInterval(function(){$('.dialog-chatbot-wrap iframe[name="chatBotDialog"]').contents().find("body").css("background","none"),setTimeout(function(){clearInterval(e)},5e3)},0)},10)},onConfirm:function(e){e.remove()}})};return function(){$(document).on("click",".dropdown-help-and-feedback .online-service",function(e){if(!$(this).hasClass("header-pop-feedback")){e.preventDefault(),e.stopPropagation();try{_T.sendEvent("support_feedback_1")}catch(e){}l()}})}(),{send:a,receive:n,formate:i,subscribe:t,publish:e.publish,sendReadMessage:c,open:l,removeLoading:r,isUseNew:o}}();Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var i;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(0===n)return-1;var s=0|t;if(s>=n)return-1;for(i=Math.max(s>=0?s:n-Math.abs(s),0);i<n;){if(i in a&&a[i]===e)return i;i++}return-1}),Array.prototype.isArray||(Array.prototype.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var ChatLabels=function(){var e=[],t=function(t){$.get("/chat/boss/labels.json",function(i){return i.labels&&(e=[].concat(i.labels)),t()})};return{add:function(i){e.length?e.indexOf(i)<0&&e.push(i):t(function(){e.indexOf(i)<0&&e.push(i)})},list:function(i){t(function(){i(e)})}}}(),ChatGeeksFilter=function(){var e={"-1":"全部牛人",5:"新招呼",6:"沟通中",8:"标记不合适",9:"已约面",10:"不符牛人",11:"星标"},t={label:"",conversationType:""},i=function(){return{jobId:$(".top-chat .dropdown-select").attr("data-jobid")||"-1",workflow:e[Chat.getGroupStatus()],label:t.label||"",conversationType:t.conversationType}};return{set:function(e){t=$.extend(e,i)},data:i,isFull:function(){var e=i();return"-1"==e.jobId&&"全部牛人"==e.workflow&&""==e.label&&""==e.conversationType},canConcatGroup:function(){var e=i(),t=["","全部对话","群聊","未读消息"];return"-1"==e.jobId&&"全部牛人"==e.workflow&&""==e.label&&t.indexOf(e.conversationType)>-1}}}(),chatUserModel,chatUserView,chatUserPresenter;!function(){function e(t){var i=this,n=[];i.connect=function(e){Array.isArray(e)&&(n=n.concat(e))},i.add=function(e){n.push(e)},i.filter=function(e,t){var i=a.filter(),n=i.top.length;if(!e)return t({top:i.top,list:i.normal.slice(0,100-n)});var s=[],o=[].concat(e),r=function(e){for(var t=o.length;t--;)o[t]==e&&o.splice(t,1)};return $.each(i,function(e,t){o.indexOf(t.uid)>-1&&(s.push(t),r(t.uid))}),{group:s,exclusive:o}},i.aggregator=new EventManger,e=function(){return i}}function t(e,t){function i(e){Chat.usersInitStatus&&Chat.getFilterUsers({},null,!1)}var s=[],o=$(".chat-container"),r=t;this.toggleStick=function(){var e=$(".user-list .cur"),t=e.parents("ul").hasClass("top-list"),i=t?s.top:s.list,n=i[e.index()];n.isTop=Number(!t),a.setStatus(n.uid,n),r.toggleStick(e,t)},this.filter=function(){},this.flushJob=function(){Chat.filterRadio=!1,Chat.filterGroup=!1,$(".top-chat .dropdown-menu li:first-child").length?$(".top-chat .dropdown-menu li:first-child").trigger("click"):i()},this.batch=function(e,t){$.each(e,function(e,i){Chat.usersData[i].relationType=t,r.batch(i,t)})},this.setStatus=function(e,t,i){var a=void 0==i||i;t&&(Chat.usersData[e].relationType=t,!Chat.usersData[e].isFiltered&&r.transformation(t,e,a))},this.viewed=function(e){r.viewed(e)},this.init=function(e){r.render()};var c=function(){if(($(this).attr("data-status")||$(this).attr("data-origin"))&&!$(this).hasClass("cur")){var e=$(this).attr("data-status");10==e?Chat.containerChat.addClass("vip-filter-container"):Chat.containerChat.removeClass("vip-filter-container"),Chat.curUserData&&Chat.setDraft(Chat.curUserData.uid),o.find(".op-category .cur").removeClass("cur"),$(this).addClass("cur"),i();var e=$(this).attr("data-status");r=-1!=e&&e?5==e?n.factory("news"):n.factory("other"):n.factory("all"),Chat.chatEl.hide(),Chat.welcomeEl.show(),8==e?$(".sec-content").addClass("chat-group-unmatch"):$(".sec-content").removeClass("chat-group-unmatch"),-1==e?$(".sec-content").addClass("chat-group-full"):$(".sec-content").removeClass("chat-group-full")}},l=function(){$(this).parents("dl").find(".cur").removeClass("cur"),$(this).addClass("cur");var e=Chat.containerChat.find(".sel-filter");e.find(".filter-cancel").length||(e.prepend('<span class="filter-cancel" ka="main_filter_cancel">取消标签筛选</span>'),e.find(".dropdown-select").html("&nbsp;")),i()},d=function(){if(o.find(".group-more .dropdown-wrap").removeClass(".dropdown-menu-open"),$(this).attr("data-val")){Chat.curUserData&&Chat.setDraft(Chat.curUserData.uid),r=n.factory("all"),o.find(".group-btns.group-more .btn-filtered").remove();var e='<a href="javascript:;" class="cur btn-filtered" data-origin="'+$(this).attr("data-val")+'">'+$(this).text()+"</a>",t=o.find(".group-btns.group-more");o.find(".op-category .group-btns .cur").removeClass("cur"),$(e).insertBefore(t.find(".dropdown-wrap")),i()}},u=function(){$(".top-chat .dropdown-select").text($(this).text()).attr("data-jobid",$(this).attr("data-jobid")),o.find(".op-category .group-btns .cur").removeClass("cur"),o.find(".op-category .group-btns a").eq(0).addClass("cur"),o.find(".condition-filter .cur").removeClass("cur"),o.find(".filter-cancel").trigger("click"),Chat.groupHistory={},i(),r=n.factory("all")},p=function(){ChatGeeksFilter.set({conversationType:"",label:""}),o.find(".condition-filter .selected").removeClass("selected");var e=Chat.containerChat.find(".sel-filter");e.find(".filter-cancel").remove(),e.find(".dropdown-select").html('筛选 <i class="iboss-down"></i>'),i();try{var t={action:"filter-cancel",bg:1,uid:_PAGE.uid};Block.action(t)}catch(e){}},h=function(e,t){t&&"flush"==t.action&&(Chat.filterRadio=!1,Chat.filterGroup=!1,$(".top-chat .dropdown-menu li:first-child").trigger("click")),setTimeout(function(){Chat.batchHandle.close()},10)},f=function(){try{var e={action:"filter-click",bg:1,uid:_PAGE.uid};Block.action(e)}catch(e){}ChatLabels.list(function(e){if(!e.length)return o.find(".dropdown-filter .condition-filter").html('<p class="labels-empty">暂无可筛选的标签，快去给牛人添加标签吧~</p>'),!1;var t=ChatGeeksFilter.data(),i=["我发起","牛人发起","群聊","同事推荐"].map(function(e){return'<dd class="'+(t.conversationType==e?"selected":"")+'">'+e+"</dd>"}),a=Utemplate('<dl class="chat-filter-labes" data-type="source"><dt>来源</dt><%this.conversations%></dl><dl class="chat-filter-labes" data-type="labels"><dt>标签</dt><%for(var i=0;i<this.lables.length;i++){%><dd <%if(this.label == this.lables[i]){%>class="selected"<%}%>><%this.lables[i]%></dd><%}%></dl><div class="labels-btns"><a class="btn btn-outline" href="javascript:;">取消</a><a class="btn btn-sure" href="javascript:;">确定</a></div>',{lables:e,conversations:i.join(""),label:t.label});o.find(".dropdown-filter .condition-filter").html(a)})};!function(){o.on("click",".op-category .group-btns a",c),o.on("click",".condition-filter dd a",l),o.on("click",".group-more li",d),o.on("click",".filter-cancel",p),o.on("click",".dropdown-filter",f);var e=function(){var e=Chat.containerChat.find(".sel-filter"),t=o.find(".chat-filter-labes dd.selected");!e.find(".filter-cancel").length&&t.length?(e.prepend('<span class="filter-cancel" ka="main_filter_cancel">取消标签筛选</span>'),e.find(".dropdown-select").html("&nbsp;")):t.length||(e.find(".filter-cancel").remove(),e.find(".dropdown-select").html('筛选 <i class="iboss-down"></i>'))};o.on("click",".sel-filter .condition-filter",function(e){e.stopPropagation()}),o.on("click",".sel-filter .btn-sure",function(){var t=Chat.containerChat.find(".sel-filter .chat-filter-labes").eq(0),a=Chat.containerChat.find(".sel-filter .chat-filter-labes").eq(1),n=t.find(".selected").length?t.find(".selected").text():"",s=a.find(".selected").length?a.find(".selected").text():"";ChatGeeksFilter.set({conversationType:n,label:s}),o.find(".dropdown-filter.dropdown-menu-open").removeClass("dropdown-menu-open");try{var r={action:"filter-select",bg:1,uid:_PAGE.uid,p:n,p2:s};Block.action(r)}catch(e){}i(),e()}),o.on("click",".sel-filter .btn-outline",function(){o.find(".dropdown-filter.dropdown-menu-open").removeClass("dropdown-menu-open")}),o.on("click",".chat-filter-labes dd",function(e){e.stopPropagation(),$(this).siblings().removeClass("selected"),$(this).toggleClass("selected")}),$(".top-chat .dropdown-menu li").on("click",u),$(document).on("MENU_ROUTE_CHAT",h)}(),$(".sec-content").addClass("chat-group-full")}function i(){$(".chat-container");this.aggregator=new EventManger,this.toggleStick=function(e,t){var i=Number(t),a=e.clone();e.remove(),$(".user-list ul").eq(i).prepend(a)},this.batch=function(e){},this.viewed=function(e,t){};this.getTemplate=function(e){return""},this.render=function(e){},this.renderUser=function(){}}var a=function(){var e={},t=function(t){var i=!1;return $.each(e,function(e,a){if(a.uid==t)return i=e,!0}),i},i=function(t){if(!Array.isArray(t))return e},a=function(e,t){},n=function(t,i){e={top:t,normal:i}};return{push:a,filter:i,setStatus:function(i,a){var n=t(i),s=$.extend({},e[n],a);e[n]=s},enqueue:n}}(),n=function(){var e={},t={6:'<p class="deal-layer icon-commun"><i></i>沟通中</p>',7:'<p class="deal-layer icon-pass"><i></i>合适</p>',8:'<p class="deal-layer icon-fail"><i></i>不合适</p>',77:'<p class="deal-layer icon-fail icon-delete"><i></i>已删除</p>',99:'<p class="deal-layer icon-read"><i></i>待处理</p>'},a={6:"cur user-communication",7:"cur user-pass",8:"cur user-fail",99:"cur"},n=function(){Chat.userList.find("li").length<1&&(Chat.userList.find(".user-blank").remove(),Chat.userList.find(".loadmore").hide(),Chat.userList.append('<div class="user-blank"><p>暂无牛人</p></div>'))},s=function(e,i,s,o){var r=s?Chat.userList.find("a[data-uid="+s+"]").parent("li"):Chat.userList.find(".cur");r.find(".deal-layer").length||(r.prepend(t[e]),r.attr("class",a[e])),r.addClass("dealSlideRight"),setTimeout(function(){var e=r.next().length?"next":"up";r.slideUp(function(){i&&Chat.curUserData&&Chat.curUserData.uid==s&&(Chat.chatEl.hide(),Chat.welcomeEl.show(),Chat.changeUserView(r,e)),r.remove(),n()})},500)};return e.all=function(){i.call(this,arguments),this.effect={},this.transformation=function(e,t){Chat.usersData[t];if(8==e||77==e)s(e,!0,t);else{Chat.userList.find("a[data-uid="+t+"]").parent("li").attr("class",a[e])}},this.batch=function(e,t){var i=Chat.userList.find("a[data-uid="+e+"]").parents("li");if(8==t)return void i.remove();i.hasClass("cur")?i.attr("class",a[t]):i.attr("class",a[t]).removeClass("cur")}},e.undisposed=function(){i.call(this,arguments),this.effect={}},e.news=function(){i.call(this,arguments),this.effect={},this.transformation=function(e,t){s(e,!0,t),Chat.newGeek.indexOf(t)>-1&&Chat.newGeek.splice(Chat.newGeek.indexOf(t),1),Chat.totalNewGeek(),Chat.groupHistory[5]=void 0},this.batch=function(e,t){var i=Chat.userList.find("a[data-uid="+e+"]").parents("li");i.hasClass("cur")&&(Chat.chatEl.hide(),Chat.welcomeEl.show()),i.remove(),Chat.newGeek.indexOf(e)>-1&&Chat.newGeek.splice(Chat.newGeek.indexOf(e),1),Chat.totalNewGeek(),n()},this.viewed=function(e){var t=Chat.userList.find("a[data-uid="+e+"]").parents("li"),i=Chat.userList.find(".notice-badge:last").closest("li");t.length&&t.hasClass("modify")&&(t.removeClass("modify"),function(){var e=t.prev().index()==i.index();return i.length&&!e}()&&function(e){var t=e.clone().css({height:"0",overflow:"hidden"}),a=i.height();t.insertAfter(i),t.animate({height:a},150),e.animate({height:0,overflow:"hidden"},150,function(){e.remove()})}(t))}},e.appropriate=function(){i.call(this,arguments),this.effect={}},e.inappropriate=function(){i.call(this,arguments),this.effect={}},e.inContact=function(){i.call(this,arguments),this.effect={}},e.other=function(){i.call(this,arguments),this.transformation=function(e,t,i){s(e,i,t)},this.batch=function(e,t){var i=Chat.userList.find("a[data-uid="+e+"]").parents("li");i.hasClass("cur")&&(Chat.chatEl.hide(),Chat.welcomeEl.show()),i.remove()}},{factory:function(t){return new e[t]}}}();chatUserModel=new e,chatUserView=n.factory("all"),chatUserPresenter=new t(chatUserModel,chatUserView),chatUserPresenter.init()}();var ChatGroups=function(){function e(e){return e.filter(function(e){return 1!=e.hiddenStatus&&(1!==e.internal||e.type<1)})}function t(){var t=this,n=[],s=[];t.list=[],t.messages=[],t.between=function(t,i){return i&&t?s.filter(function(e){return t<=e.lastTS&&i>e.lastTS&&1!=e.hiddenStatus&&(1!==e.internal||e.type<1)}):e(s)},t.unread=function(e){return e.filter(function(e){return 1!=e.hiddenStatus&&e.newMsgCount&&(1!==e.internal||e.type<1)})},t.tops=function(){return t.list.filter(function(e){return 1==e.isTop&&1!=e.hiddenStatus&&(1!==e.internal||e.type<1)}).sort(i)},t.add=function(e){t.list.push(e),s.push(e)},t.get=function(e){return t.list.find(function(t){return t.groupId==e||t.encryptGid==e})},t.remove=function(e){var i=t.get(e),a=t.list.indexOf(i);i&&a>-1&&t.list.splice(a,1)},t.getGroupList=function(e){a.list(1).then(function(i){if(i&&i.length){var a=i.filter(function(e){return e.isTop}),o=i.filter(function(e){return!e.isTop});n=a,s=s.concat(o),t.list=i}e(i)})},t.pushMessage=function(e){t.messages.push(e)},t.all=function(){return t.list.filter(function(e){return 1!=e.hiddenStatus&&(1!==e.internal||e.type<1)})}}var i=function(e,t){return t.isTop-e.isTop||t.lastTS-e.lastTS},a={list:function(e){var t=$.Deferred();return $.get("/wapi/zpchat/group/groupInfoList.json?page="+e,function(e){0===e.code&&$.isArray(e.zpData)?t.resolve(e.zpData):t.resolve([])}),t}};return new t}(),GroupMessage=function(){var e=function(e){var t={1:"text",2:"sound",3:"image",18:"jobShare",19:"resumeShare",20:"sticker",12:"hyperLink",23:"interviewShare"};return 12===e.body.type?a("hyperLink",e).url.indexOf("shareId")>-1?"hyperLink":(e.body.text=e.body.hyperLink.text,"system"):t[e.body.type]&&3!==e.body.templated&&3!==e.body.templateId&&3!=e.status?t[e.body.type]:"system"},t=function(e){var t={1:"text",2:"text",3:"image",18:"text",19:"text",20:"image",12:"hyperLink",23:"interviewShare"};return 7===(util.get(e,"body.articles",[]).length?e.body.articles[0]:{}).templateId?"system":3===e.body.templated||3===e.body.templateId||3==e.status?"system":t[e.body.type]},i=function(e,t){var i="",a=util.get(t,"body.articles",[]).length?t.body.articles[0]:{};if("jobShare"===e){var n="string"==typeof t.body.jobShare?JSON.parse(t.body.jobShare):t.body.jobShare;i="[Ta分享了<"+n.position+">职位，具体请在手机查看]"}if("resumeShare"===e){var n="string"==typeof t.body.resumeShare?JSON.parse(t.body.resumeShare):t.body.resumeShare;i="[Ta分享了<"+n.user.name+">的简历，具体请在手机查看]"}return t.body.text&&(i=t.body.text),"image"===e&&(i="[图片]"),"sticker"===e&&(i=0!=t.body.sticker.packId&&t.body.sticker.name?"["+t.body.sticker.name+"]":"[动画表情]"),"interviewShare"===e&&(i=t.from.name+"转发了一个面试日程"),"sound"===e&&(i=t.body.text?t.body.text:"收到一条语音消息，请在APP查看"),3===t.status&&(i=t.from&&t.from.uid!=_PAGE.uid?t.from.name+"撤回了一条消息":"你撤回了一条消息"),7===a.templateId&&(i="收到一条消息，网页端暂不支持，请在app查看"),i.replace(/</g,"&#60;").replace(/>/g,"&#62;").replace(/\n/g,"<br/>").replace(/\\n/g,"<br/>").replace(/&amp;middot;/g,"&#183;").replace(/&amp;lt;/g,"&#60;").replace(/&amp;gt;/g,"&#62;").replace(/&lt;/g,"&#60;").replace(/&gt;/g,"&#62;").replace(/&middot;/g,"")},a=function(e,t){return"hyperLink"===e?"string"==typeof t.body.hyperLink?JSON.parse(t.body.hyperLink):t.body.hyperLink:""},n=function(e,t){return"interviewShare"===e||"sound"===e?"string"==typeof t.body[e]?JSON.parse(t.body[e]):t.body[e]:""},s=function(e,t){if("image"===e)return"string"==typeof t.body.image?JSON.parse(t.body.image):t.body.image;if("sticker"===e){if("string"==typeof t.body.sticker)return JSON.parse(t.body.sticker);if(t.body.sticker&&t.body.sticker.image){var i=t.body.sticker.image;return{origUrl:i.originImage.url,origWidth:i.originImage.width,origHeight:i.originImage.height}}}return{}},o=function(e,t){return t.isSelf||t.from?t.from:{uid:t.fromId,name:t.from?t.from.name:t.name,avatar:t.from?t.from.avatarUrl:t.avatarUrl,position:t.position,company:t.company}};return{formate:function(r){if(!$.isArray(r))return[];var c=0,l=r.map(function(r){var l=e(r),d=o(0,r);return(c>r.mid||0==c)&&(c=r.mid),{type:l,name:d.name,clientId:r.tempID,avatar:d.avatar,isSelf:_PAGE.uid==d.uid,action:_PAGE.uid==d.uid||r.isSelf?"sent":"received",text:Emotion.textCodeToImg(i(l,r)),originalText:i(l,r),style:t(r),image:s(l,r),company:d.company,position:d.position||"",isAdmin:r.isAdmin,certification:r.certification?r.certification:d.certification,time:r.time,messageId:r.messageId||r.mid,mid:r.mid||r.tempID,fromId:d.uid,toId:r.to?r.to.uid:r.toId,hyperLink:a(l,r),interviewShare:n(l,r),sound:n(l,r)}});return Chat.curUserData.maxMsgId=c,l.filter(function(e){return(e.text||"image"==e.type||"hyperLink"==e.type||"interviewShare"==e.type||"sound"==e.type)&&e.type})}}}(),MessageGate=function(){var e=[];return{pull:function(){var t;for(t=0;t<e.length;t++){var i=e[t];switch(ImSocket.publish(i),i.type){case 1:ChatWebsocket.receiveMessage(i);break;case 4:ChatWebsocket.receiveIqMessage(i);break;case 5:ChatWebsocket.receiveSyncMessage(i);break;case 6:ChatWebsocket.receiveStatusMessage(i)}}Chat.addfilterTab(),mediator.subscribe("buyVipSuccess",function(){Chat.addfilterTab()})},push:function(t){e=e.concat(t)}}}();!function(e,t){"function"==typeof define&&define.amd?define([],function(){(e.dcodeIO=e.dcodeIO||{}).Long=t()}):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t():(e.dcodeIO=e.dcodeIO||{}).Long=t()}(this,function(){"use strict";function e(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function t(e){return!0===(e&&e.__isLong__)}function i(e,t){var i,a,s;return t?(e>>>=0,(s=0<=e&&e<256)&&(a=c[e])?a:(i=n(e,(0|e)<0?-1:0,!0),s&&(c[e]=i),i)):(e|=0,(s=-128<=e&&e<128)&&(a=r[e])?a:(i=n(e,e<0?-1:0,!1),s&&(r[e]=i),i))}function a(e,t){if(isNaN(e)||!isFinite(e))return t?m:f;if(t){if(e<0)return m;if(e>=u)return w}else{if(e<=-p)return C;if(e+1>=p)return y}return e<0?a(-e,t).neg():n(e%d|0,e/d|0,t)}function n(t,i,a){return new e(t,i,a)}function s(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return f;if("number"==typeof t?(i=t,t=!1):t=!!t,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return s(e.substring(1),t,i).neg();for(var o=a(l(i,8)),r=f,c=0;c<e.length;c+=8){var d=Math.min(8,e.length-c),u=parseInt(e.substring(c,c+d),i);if(d<8){var p=a(l(i,d));r=r.mul(p).add(a(u))}else r=r.mul(o),r=r.add(a(u))}return r.unsigned=t,r}function o(t){return t instanceof e?t:"number"==typeof t?a(t):"string"==typeof t?s(t):n(t.low,t.high,t.unsigned)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var r={},c={};e.fromInt=i,e.fromNumber=a,e.fromBits=n;var l=Math.pow;e.fromString=s,e.fromValue=o;var d=4294967296,u=d*d,p=u/2,h=i(1<<24),f=i(0);e.ZERO=f;var m=i(0,!0);e.UZERO=m;var g=i(1);e.ONE=g;var v=i(1,!0);e.UONE=v;var b=i(-1);e.NEG_ONE=b;var y=n(-1,2147483647,!1);e.MAX_VALUE=y;var w=n(-1,-1,!0);e.MAX_UNSIGNED_VALUE=w;var C=n(0,-2147483648,!1);e.MIN_VALUE=C;var x=e.prototype;return x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},x.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(C)){var t=a(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=a(l(e,6),this.unsigned),o=this,r="";;){var c=o.div(s),d=o.sub(c.mul(s)).toInt()>>>0,u=d.toString(e);if(o=c,o.isZero())return u+r;for(;u.length<6;)u="0"+u;r=""+u+r}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},x.isZero=function(){return 0===this.high&&0===this.low},x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return 1==(1&this.low)},x.isEven=function(){return 0==(1&this.low)},x.equals=function(e){return t(e)||(e=o(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},x.eq=x.equals,x.notEquals=function(e){return!this.eq(e)},x.neq=x.notEquals,x.lessThan=function(e){return this.comp(e)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(e){return this.comp(e)<=0},x.lte=x.lessThanOrEqual,x.greaterThan=function(e){return this.comp(e)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(e){return this.comp(e)>=0},x.gte=x.greaterThanOrEqual,x.compare=function(e){if(t(e)||(e=o(e)),this.eq(e))return 0;var i=this.isNegative(),a=e.isNegative();return i&&!a?-1:!i&&a?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(g)},x.neg=x.negate,x.add=function(e){t(e)||(e=o(e));var i=this.high>>>16,a=65535&this.high,s=this.low>>>16,r=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,u=65535&e.low,p=0,h=0,f=0,m=0;return m+=r+u,f+=m>>>16,m&=65535,f+=s+d,h+=f>>>16,f&=65535,h+=a+l,p+=h>>>16,h&=65535,p+=i+c,p&=65535,n(f<<16|m,p<<16|h,this.unsigned)},x.subtract=function(e){return t(e)||(e=o(e)),this.add(e.neg())},x.sub=x.subtract,x.multiply=function(e){if(this.isZero())return f;if(t(e)||(e=o(e)),e.isZero())return f;if(this.eq(C))return e.isOdd()?C:f;if(e.eq(C))return this.isOdd()?C:f;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(h)&&e.lt(h))return a(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,s=65535&this.high,r=this.low>>>16,c=65535&this.low,l=e.high>>>16,d=65535&e.high,u=e.low>>>16,p=65535&e.low,m=0,g=0,v=0,b=0;return b+=c*p,v+=b>>>16,b&=65535,v+=r*p,g+=v>>>16,v&=65535,v+=c*u,g+=v>>>16,v&=65535,g+=s*p,m+=g>>>16,g&=65535,g+=r*u,m+=g>>>16,g&=65535,g+=c*d,m+=g>>>16,g&=65535,m+=i*p+s*u+r*d+c*l,m&=65535,n(v<<16|b,m<<16|g,this.unsigned)},x.mul=x.multiply,x.divide=function(e){if(t(e)||(e=o(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?m:f;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return v;s=m}else{if(this.eq(C)){if(e.eq(g)||e.eq(b))return C;if(e.eq(C))return g;return i=this.shr(1).div(e).shl(1),i.eq(f)?e.isNegative()?g:b:(n=this.sub(e.mul(i)),s=i.add(n.div(e)))}if(e.eq(C))return this.unsigned?m:f;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=f}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var r=Math.ceil(Math.log(i)/Math.LN2),c=r<=48?1:l(2,r-48),d=a(i),u=d.mul(e);u.isNegative()||u.gt(n);)i-=c,d=a(i,this.unsigned),u=d.mul(e);d.isZero()&&(d=g),s=s.add(d),n=n.sub(u)}return s},x.div=x.divide,x.modulo=function(e){return t(e)||(e=o(e)),this.sub(this.div(e).mul(e))},x.mod=x.modulo,x.not=function(){return n(~this.low,~this.high,this.unsigned)},x.and=function(e){return t(e)||(e=o(e)),n(this.low&e.low,this.high&e.high,this.unsigned)},x.or=function(e){return t(e)||(e=o(e)),n(this.low|e.low,this.high|e.high,this.unsigned)},x.xor=function(e){return t(e)||(e=o(e)),n(this.low^e.low,this.high^e.high,this.unsigned)},x.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?n(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):n(0,this.low<<e-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?n(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):n(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0===(e&=63))return this;var i=this.high;if(e<32){return n(this.low>>>e|i<<32-e,i>>>e,this.unsigned)}return 32===e?n(i,0,this.unsigned):n(i>>>e-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?n(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:n(this.low,this.high,!0)},x.toBytes=function(e){
return e?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},x.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e}),function(e,t){"function"==typeof define&&define.amd?define(["chat-long.js"],function(){(e.dcodeIO=e.dcodeIO||{}).ByteBuffer=t(e.dcodeIO.Long)}):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=function(){var e;try{e=require("long")}catch(e){}return t(e)}():(e.dcodeIO=e.dcodeIO||{}).ByteBuffer=t(e.dcodeIO.Long)}(this,function(e){"use strict";function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function i(){var e=[],t=[];return function(){if(0===arguments.length)return t.join("")+c.apply(String,e);e.length+arguments.length>1024&&(t.push(c.apply(String,e)),e.length=0),Array.prototype.push.apply(e,arguments)}}function a(e,t,i,a,n){var s,o,r=8*n-a-1,c=(1<<r)-1,l=c>>1,d=-7,u=i?n-1:0,p=i?-1:1,h=e[t+u];for(u+=p,s=h&(1<<-d)-1,h>>=-d,d+=r;d>0;s=256*s+e[t+u],u+=p,d-=8);for(o=s&(1<<-d)-1,s>>=-d,d+=a;d>0;o=256*o+e[t+u],u+=p,d-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,a),s-=l}return(h?-1:1)*o*Math.pow(2,s-a)}function n(e,t,i,a,n,s){var o,r,c,l=8*s-n-1,d=(1<<l)-1,u=d>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,h=a?0:s-1,f=a?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(r=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),t+=o+u>=1?p/c:p*Math.pow(2,1-u),t*c>=2&&(o++,c/=2),o+u>=d?(r=0,o=d):o+u>=1?(r=(t*c-1)*Math.pow(2,n),o+=u):(r=t*Math.pow(2,u-1)*Math.pow(2,n),o=0));n>=8;e[i+h]=255&r,h+=f,r/=256,n-=8);for(o=o<<n|r,l+=n;l>0;e[i+h]=255&o,h+=f,o/=256,l-=8);e[i+h-f]|=128*m}var s=function(e,t,i){if(void 0===e&&(e=s.DEFAULT_CAPACITY),void 0===t&&(t=s.DEFAULT_ENDIAN),void 0===i&&(i=s.DEFAULT_NOASSERT),!i){if((e|=0)<0)throw RangeError("Illegal capacity");t=!!t,i=!!i}this.buffer=0===e?r:new ArrayBuffer(e),this.view=0===e?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian=t,this.noAssert=i};s.VERSION="5.0.1",s.LITTLE_ENDIAN=!0,s.BIG_ENDIAN=!1,s.DEFAULT_CAPACITY=16,s.DEFAULT_ENDIAN=s.BIG_ENDIAN,s.DEFAULT_NOASSERT=!1,s.Long=e||null;var o=s.prototype;o.__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var r=new ArrayBuffer(0),c=String.fromCharCode;s.accessor=function(){return Uint8Array},s.allocate=function(e,t,i){return new s(e,t,i)},s.concat=function(e,t,i,a){"boolean"!=typeof t&&"string"==typeof t||(a=i,i=t,t=void 0);for(var n,o=0,r=0,c=e.length;r<c;++r)s.isByteBuffer(e[r])||(e[r]=s.wrap(e[r],t)),(n=e[r].limit-e[r].offset)>0&&(o+=n);if(0===o)return new s(0,i,a);var l,d=new s(o,i,a);for(r=0;r<c;)l=e[r++],(n=l.limit-l.offset)<=0||(d.view.set(l.view.subarray(l.offset,l.limit),d.offset),d.offset+=n);return d.limit=d.offset,d.offset=0,d},s.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},s.type=function(){return ArrayBuffer},s.wrap=function(e,t,i,a){if("string"!=typeof t&&(a=i,i=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return s.fromBase64(e,i);case"hex":return s.fromHex(e,i);case"binary":return s.fromBinary(e,i);case"utf8":return s.fromUTF8(e,i);case"debug":return s.fromDebug(e,i);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");var n;if(s.isByteBuffer(e))return n=o.clone.call(e),n.markedOffset=-1,n;if(e instanceof Uint8Array)n=new s(0,i,a),e.length>0&&(n.buffer=e.buffer,n.offset=e.byteOffset,n.limit=e.byteOffset+e.byteLength,n.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)n=new s(0,i,a),e.byteLength>0&&(n.buffer=e,n.offset=0,n.limit=e.byteLength,n.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");n=new s(e.length,i,a),n.limit=e.length;for(var r=0;r<e.length;++r)n.view[r]=e[r]}return n},o.writeBitSet=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var a,n=t,s=e.length,o=s>>3,r=0;for(t+=this.writeVarint32(s,t);o--;)a=1&!!e[r++]|(1&!!e[r++])<<1|(1&!!e[r++])<<2|(1&!!e[r++])<<3|(1&!!e[r++])<<4|(1&!!e[r++])<<5|(1&!!e[r++])<<6|(1&!!e[r++])<<7,this.writeByte(a,t++);if(r<s){var c=0;for(a=0;r<s;)a|=(1&!!e[r++])<<c++;this.writeByte(a,t++)}return i?(this.offset=t,this):t-n},o.readBitSet=function(e){var t=void 0===e;t&&(e=this.offset);var i,a=this.readVarint32(e),n=a.value,s=n>>3,o=0,r=[];for(e+=a.length;s--;)i=this.readByte(e++),r[o++]=!!(1&i),r[o++]=!!(2&i),r[o++]=!!(4&i),r[o++]=!!(8&i),r[o++]=!!(16&i),r[o++]=!!(32&i),r[o++]=!!(64&i),r[o++]=!!(128&i);if(o<n){var c=0;for(i=this.readByte(e++);o<n;)r[o++]=!!(i>>c++&1)}return t&&(this.offset=e),r},o.readBytes=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}var a=this.slice(t,t+e);return i&&(this.offset+=e),a},o.writeBytes=o.append,o.writeInt8=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=1,this.view[t]=e,i&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=this.view[e];return 128==(128&i)&&(i=-(255-i+1)),t&&(this.offset+=1),i},o.readByte=o.readInt8,o.writeUint8=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=1,this.view[t]=e,i&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=this.view[e];return t&&(this.offset+=1),i},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),i&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e],i|=this.view[e+1]<<8):(i=this.view[e]<<8,i|=this.view[e+1]),32768==(32768&i)&&(i=-(65535-i+1)),t&&(this.offset+=2),i},o.readShort=o.readInt16,o.writeUint16=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),i&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e],i|=this.view[e+1]<<8):(i=this.view[e]<<8,i|=this.view[e+1]),t&&(this.offset+=2),i},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),i&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e+2]<<16,i|=this.view[e+1]<<8,i|=this.view[e],i+=this.view[e+3]<<24>>>0):(i=this.view[e+1]<<16,i|=this.view[e+2]<<8,i|=this.view[e+3],i+=this.view[e]<<24>>>0),i|=0,t&&(this.offset+=4),i},o.readInt=o.readInt32,o.writeUint32=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),i&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[e+2]<<16,i|=this.view[e+1]<<8,i|=this.view[e],i+=this.view[e+3]<<24>>>0):(i=this.view[e+1]<<16,i|=this.view[e+2]<<8,i|=this.view[e+3],i+=this.view[e]<<24>>>0),t&&(this.offset+=4),i},o.readUInt32=o.readUint32,e&&(o.writeInt64=function(t,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var s=t.low,o=t.high;return this.littleEndian?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o):(this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),a&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var a=0,n=0;this.littleEndian?(a=this.view[t+2]<<16,a|=this.view[t+1]<<8,a|=this.view[t],a+=this.view[t+3]<<24>>>0,t+=4,n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0,t+=4,a=this.view[t+1]<<16,a|=this.view[t+2]<<8,a|=this.view[t+3],a+=this.view[t]<<24>>>0);var s=new e(a,n,!1);return i&&(this.offset+=8),s},o.readLong=o.readInt64,o.writeUint64=function(t,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),i+=8;var n=this.buffer.byteLength;i>n&&this.resize((n*=2)>i?n:i),i-=8;var s=t.low,o=t.high;return this.littleEndian?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=o>>>24&255,this.view[i+2]=o>>>16&255,this.view[i+1]=o>>>8&255,this.view[i]=255&o):(this.view[i]=o>>>24&255,this.view[i+1]=o>>>16&255,this.view[i+2]=o>>>8&255,this.view[i+3]=255&o,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),a&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var a=0,n=0;this.littleEndian?(a=this.view[t+2]<<16,a|=this.view[t+1]<<8,a|=this.view[t],a+=this.view[t+3]<<24>>>0,t+=4,n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0,t+=4,a=this.view[t+1]<<16,a|=this.view[t+2]<<8,a|=this.view[t+3],a+=this.view[t]<<24>>>0);var s=new e(a,n,!0);return i&&(this.offset+=8),s},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=4,n(this.view,e,t,this.littleEndian,23,4),i&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=a(this.view,e,this.littleEndian,23,4);return t&&(this.offset+=4),i},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=8,n(this.view,e,t,this.littleEndian,52,8),i&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var i=a(this.view,e,this.littleEndian,52,8);return t&&(this.offset+=8),i},o.readDouble=o.readFloat64,s.MAX_VARINT32_BYTES=5,s.calculateVarint32=function(e){return e>>>=0,e<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},s.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},s.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},o.writeVarint32=function(e,t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var a,n=s.calculateVarint32(e);t+=n;var o=this.buffer.byteLength;for(t>o&&this.resize((o*=2)>t?o:t),t-=n,e>>>=0;e>=128;)a=127&e|128,this.view[t++]=a,e>>>=7;return this.view[t++]=e,i?(this.offset=t,this):n},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(s.zigZagEncode32(e),t)},o.readVarint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i,a=0,n=0;do{if(!this.noAssert&&e>this.limit){var s=Error("Truncated");throw s.truncated=!0,s}i=this.view[e++],a<5&&(n|=(127&i)<<7*a),++a}while(0!=(128&i));return n|=0,t?(this.offset=e,n):{value:n,length:a}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=s.zigZagDecode32(t.value):t=s.zigZagDecode32(t),t},e&&(s.MAX_VARINT64_BYTES=10,s.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var i=t.toInt()>>>0,a=t.shiftRightUnsigned(28).toInt()>>>0,n=t.shiftRightUnsigned(56).toInt()>>>0;return 0==n?0==a?i<16384?i<128?1:2:i<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:n<128?9:10},s.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},s.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned());var n=s.calculateVarint64(t),o=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,c=t.shiftRightUnsigned(56).toInt()>>>0;i+=n;var l=this.buffer.byteLength;switch(i>l&&this.resize((l*=2)>i?l:i),i-=n,n){case 10:this.view[i+9]=c>>>7&1;case 9:this.view[i+8]=9!==n?128|c:127&c;case 8:this.view[i+7]=8!==n?r>>>21|128:r>>>21&127;case 7:this.view[i+6]=7!==n?r>>>14|128:r>>>14&127;case 6:this.view[i+5]=6!==n?r>>>7|128:r>>>7&127;case 5:this.view[i+4]=5!==n?128|r:127&r;case 4:this.view[i+3]=4!==n?o>>>21|128:o>>>21&127;case 3:this.view[i+2]=3!==n?o>>>14|128:o>>>14&127;case 2:this.view[i+1]=2!==n?o>>>7|128:o>>>7&127;case 1:this.view[i]=1!==n?128|o:127&o}return a?(this.offset+=n,this):n},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(s.zigZagEncode64(e),t)},o.readVarint64=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var a=t,n=0,s=0,o=0,r=0;if(r=this.view[t++],n=127&r,128&r&&(r=this.view[t++],n|=(127&r)<<7,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],n|=(127&r)<<14,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],n|=(127&r)<<21,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],s=127&r,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],s|=(127&r)<<7,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],s|=(127&r)<<14,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],s|=(127&r)<<21,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],o=127&r,(128&r||this.noAssert&&void 0===r)&&(r=this.view[t++],o|=(127&r)<<7,128&r||this.noAssert&&void 0===r))))))))))throw Error("Buffer overrun");var c=e.fromBits(n|s<<28,s>>>4|o<<24,!1);return i?(this.offset=t,c):{value:c,length:t-a}},o.readVarint64ZigZag=function(t){var i=this.readVarint64(t);return i&&i.value instanceof e?i.value=s.zigZagDecode64(i.value):i=s.zigZagDecode64(i),i}),o.writeCString=function(e,i){var a=void 0===i;a&&(i=this.offset);var n,s=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(n=0;n<s;++n)if(0===e.charCodeAt(n))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=d.calculateUTF16asUTF8(t(e))[1],i+=s+1;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=s+1,d.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),this.view[i++]=0,a?(this.offset=i,this):s},o.readCString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var a,n=e,s=-1;return d.decodeUTF8toUTF16(function(){if(0===s)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return s=this.view[e++],0===s?null:s}.bind(this),a=i(),!0),t?(this.offset=e,a()):{string:a(),length:e-n}},o.writeIString=function(e,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,s=i;n=d.calculateUTF16asUTF8(t(e),this.noAssert)[1],i+=4+n;var o=this.buffer.byteLength;if(i>o&&this.resize((o*=2)>i?o:i),i-=4+n,this.littleEndian?(this.view[i+3]=n>>>24&255,this.view[i+2]=n>>>16&255,this.view[i+1]=n>>>8&255,this.view[i]=255&n):(this.view[i]=n>>>24&255,this.view[i+1]=n>>>16&255,this.view[i+2]=n>>>8&255,this.view[i+3]=255&n),i+=4,d.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),i!==s+4+n)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+n));return a?(this.offset=i,this):i-s},o.readIString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var i=e,a=this.readUint32(e),n=this.readUTF8String(a,s.METRICS_BYTES,e+=4);return e+=n.length,t?(this.offset=e,n.string):{string:n.string,length:e-i}},s.METRICS_CHARS="c",s.METRICS_BYTES="b",o.writeUTF8String=function(e,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,s=i;n=d.calculateUTF16asUTF8(t(e))[1],i+=n;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=n,d.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),a?(this.offset=i,this):i-s},o.writeString=o.writeUTF8String,s.calculateUTF8Chars=function(e){return d.calculateUTF16asUTF8(t(e))[0]},s.calculateUTF8Bytes=function(e){return d.calculateUTF16asUTF8(t(e))[1]},s.calculateString=s.calculateUTF8Bytes,o.readUTF8String=function(e,t,a){"number"==typeof t&&(a=t,t=void 0);var n=void 0===a;if(n&&(a=this.offset),void 0===t&&(t=s.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}var o,r=0,c=a;if(t===s.METRICS_CHARS){if(o=i(),d.decodeUTF8(function(){return r<e&&a<this.limit?this.view[a++]:null}.bind(this),function(e){++r,d.UTF8toUTF16(e,o)}),r!==e)throw RangeError("Illegal range: Truncated data, "+r+" == "+e);return n?(this.offset=a,o()):{string:o(),length:a-c}}if(t===s.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+"+e+") <= "+this.buffer.byteLength)}var l=a+e;if(d.decodeUTF8toUTF16(function(){return a<l?this.view[a++]:null}.bind(this),o=i(),this.noAssert),a!==l)throw RangeError("Illegal range: Truncated data, "+a+" == "+l);return n?(this.offset=a,o()):{string:o(),length:a-c}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,i){var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var n,o,r=i;n=d.calculateUTF16asUTF8(t(e),this.noAssert)[1],o=s.calculateVarint32(n),i+=o+n;var c=this.buffer.byteLength;if(i>c&&this.resize((c*=2)>i?c:i),i-=o+n,i+=this.writeVarint32(n,i),d.encodeUTF16toUTF8(t(e),function(e){this.view[i++]=e}.bind(this)),i!==r+n+o)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+n+o));return a?(this.offset=i,this):i-r},o.readVString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var i=e,a=this.readVarint32(e),n=this.readUTF8String(a.value,s.METRICS_BYTES,e+=a.length);return e+=n.length,t?(this.offset=e,n.string):{string:n.string,length:e-i}},o.append=function(e,t,i){"number"!=typeof t&&"string"==typeof t||(i=t,t=void 0);var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}e instanceof s||(e=s.wrap(e,t));var n=e.limit-e.offset;if(n<=0)return this;i+=n;var o=this.buffer.byteLength;return i>o&&this.resize((o*=2)>i?o:i),i-=n,this.view.set(e.view.subarray(e.offset,e.limit),i),e.offset+=n,a&&(this.offset+=n),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new s(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var i=t-e;if(0===i)return this.buffer=r,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var a=new ArrayBuffer(i),n=new Uint8Array(a);return n.set(this.view.subarray(e,t)),this.buffer=a,this.view=n,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=i,this},o.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new s(0,this.littleEndian,this.noAssert);var i=t-e,a=new s(i,this.littleEndian,this.noAssert);return a.offset=0,a.limit=i,a.markedOffset>=0&&(a.markedOffset-=e),this.copyTo(a,0,e,t),a},o.copyTo=function(e,t,i,a){var n,o;if(!this.noAssert&&!s.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=void 0===t)?e.offset:0|t,i=(n=void 0===i)?this.offset:0|i,a=void 0===a?this.limit:0|a,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(i<0||a>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+i+" <= "+this.buffer.byteLength);var r=a-i;return 0===r?e:(e.ensureCapacity(t+r),e.view.set(this.view.subarray(i,a),t),n&&(this.offset+=r),o&&(e.offset+=r),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,i){var a=void 0===t;if(a&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===i&&(i=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,
t<0||t>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t>=i)return this;for(;t<i;)this.view[t++]=e;return a&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian=void 0===e||!!e,this},o.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},o.prepend=function(e,t,i){"number"!=typeof t&&"string"==typeof t||(i=t,t=void 0);var a=void 0===i;if(a&&(i=this.offset),!this.noAssert){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}e instanceof s||(e=s.wrap(e,t));var n=e.limit-e.offset;if(n<=0)return this;var o=n-i;if(o>0){var r=new ArrayBuffer(this.buffer.byteLength+o),c=new Uint8Array(r);c.set(this.view.subarray(i,this.buffer.byteLength),n),this.buffer=r,this.view=c,this.offset+=o,this.markedOffset>=0&&(this.markedOffset+=o),this.limit+=o,i+=o}else{new Uint8Array(this.buffer)}return this.view.set(e.view.subarray(e.offset,e.limit),i-n),e.offset=e.limit,a&&(this.offset-=n),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e),i=new Uint8Array(t);i.set(this.view),this.buffer=t,this.view=i}return this},o.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(this.view.subarray(e,t)),this)},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var i=this.clone();return i.offset=e,i.limit=t,i},o.toBuffer=function(e){var t=this.offset,i=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal limit: Not an integer");if(i>>>=0,t<0||t>i||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(!e&&0===t&&i===this.buffer.byteLength)return this.buffer;if(t===i)return r;var a=new ArrayBuffer(i-t);return new Uint8Array(a).set(new Uint8Array(this.buffer).subarray(t,i),0),a},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,i){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(e="utf8",t=e,i=t),e){case"utf8":return this.toUTF8(t,i);case"base64":return this.toBase64(t,i);case"hex":return this.toHex(t,i);case"binary":return this.toBinary(t,i);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var l=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[],a=0,n=t.length;a<n;++a)i[t[a]]=a;return e.encode=function(e,i){for(var a,n;null!==(a=e());)i(t[a>>2&63]),n=(3&a)<<4,null!==(a=e())?(n|=a>>4&15,i(t[63&(n|a>>4&15)]),n=(15&a)<<2,null!==(a=e())?(i(t[63&(n|a>>6&3)]),i(t[63&a])):(i(t[63&n]),i(61))):(i(t[63&n]),i(61),i(61))},e.decode=function(e,t){function a(e){throw Error("Illegal character code: "+e)}for(var n,s,o;null!==(n=e());)if(s=i[n],void 0===s&&a(n),null!==(n=e())&&(o=i[n],void 0===o&&a(n),t(s<<2>>>0|(48&o)>>4),null!==(n=e()))){if(void 0===(s=i[n])){if(61===n)break;a(n)}if(t((15&o)<<4>>>0|(60&s)>>2),null!==(n=e())){if(void 0===(o=i[n])){if(61===n)break;a(n)}t((3&s)<<6>>>0|o)}}},e.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},e}();o.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),e|=0,t|=0,e<0||t>this.capacity||e>t)throw RangeError("begin, end");var a;return l.encode(function(){return e<t?this.view[e++]:null}.bind(this),a=i()),a()},s.fromBase64=function(e,i){if("string"!=typeof e)throw TypeError("str");var a=new s(e.length/4*3,i),n=0;return l.decode(t(e),function(e){a.view[n++]=e}),a.limit=n,a},s.btoa=function(e){return s.fromBinary(e).toBase64()},s.atob=function(e){return s.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),e|=0,t|=0,e<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var i=[],a=[];e<t;)i.push(this.view[e++]),i.length>=1024&&(a.push(String.fromCharCode.apply(String,i)),i=[]);return a.join("")+String.fromCharCode.apply(String,i)},s.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var i,a=0,n=e.length,o=new s(n,t);a<n;){if((i=e.charCodeAt(a))>255)throw RangeError("illegal char code: "+i);o.view[a++]=i}return o.limit=n,o},o.toDebug=function(e){for(var t,i=-1,a=this.buffer.byteLength,n="",s="",o="";i<a;){if(-1!==i&&(t=this.view[i],n+=t<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(s+=t>32&&t<127?String.fromCharCode(t):".")),++i,e&&i>0&&i%16==0&&i!==a){for(;n.length<51;)n+=" ";o+=n+s+"\n",n=s=""}i===this.offset&&i===this.limit?n+=i===this.markedOffset?"!":"|":i===this.offset?n+=i===this.markedOffset?"[":"<":i===this.limit?n+=i===this.markedOffset?"]":">":n+=i===this.markedOffset?"'":e||0!==i&&i!==a?" ":""}if(e&&" "!==n){for(;n.length<51;)n+=" ";o+=n+s+"\n"}return e?o:n},s.fromDebug=function(e,t,i){for(var a,n,o=e.length,r=new s((o+1)/3|0,t,i),c=0,l=0,d=!1,u=!1,p=!1,h=!1,f=!1;c<o;){switch(a=e.charAt(c++)){case"!":if(!i){if(u||p||h){f=!0;break}u=p=h=!0}r.offset=r.markedOffset=r.limit=l,d=!1;break;case"|":if(!i){if(u||h){f=!0;break}u=h=!0}r.offset=r.limit=l,d=!1;break;case"[":if(!i){if(u||p){f=!0;break}u=p=!0}r.offset=r.markedOffset=l,d=!1;break;case"<":if(!i){if(u){f=!0;break}u=!0}r.offset=l,d=!1;break;case"]":if(!i){if(h||p){f=!0;break}h=p=!0}r.limit=r.markedOffset=l,d=!1;break;case">":if(!i){if(h){f=!0;break}h=!0}r.limit=l,d=!1;break;case"'":if(!i){if(p){f=!0;break}p=!0}r.markedOffset=l,d=!1;break;case" ":d=!1;break;default:if(!i&&d){f=!0;break}if(n=parseInt(a+e.charAt(c++),16),!i&&(isNaN(n)||n<0||n>255))throw TypeError("Illegal str: Not a debug encoded string");r.view[l++]=n,d=!0}if(f)throw TypeError("Illegal str: Invalid symbol at "+c)}if(!i){if(!u||!h)throw TypeError("Illegal str: Missing offset or limit");if(l<r.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+l+" < "+o)}return r},o.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var i,a=new Array(t-e);e<t;)i=this.view[e++],i<16?a.push("0",i.toString(16)):a.push(i.toString(16));return a.join("")},s.fromHex=function(e,t,i){if(!i){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var a,n=e.length,o=new s(n/2|0,t),r=0,c=0;r<n;r+=2){if(a=parseInt(e.substring(r,r+2),16),!i&&(!isFinite(a)||a<0||a>255))throw TypeError("Illegal str: Contains non-hex characters");o.view[c++]=a}return o.limit=c,o};var d=function(){var e={};return e.MAX_CODEPOINT=1114111,e.encodeUTF8=function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)i<128?t(127&i):i<2048?(t(i>>6&31|192),t(63&i|128)):i<65536?(t(i>>12&15|224),t(i>>6&63|128),t(63&i|128)):(t(i>>18&7|240),t(i>>12&63|128),t(i>>6&63|128),t(63&i|128)),i=null},e.decodeUTF8=function(e,t){for(var i,a,n,s,o=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(i=e());)if(0==(128&i))t(i);else if(192==(224&i))null===(a=e())&&o([i,a]),t((31&i)<<6|63&a);else if(224==(240&i))(null===(a=e())||null===(n=e()))&&o([i,a,n]),t((15&i)<<12|(63&a)<<6|63&n);else{if(240!=(248&i))throw RangeError("Illegal starting byte: "+i);(null===(a=e())||null===(n=e())||null===(s=e()))&&o([i,a,n,s]),t((7&i)<<18|(63&a)<<12|(63&n)<<6|63&s)}},e.UTF16toUTF8=function(e,t){for(var i,a=null;;){if(null===(i=null!==a?a:e()))break;i>=55296&&i<=57343&&null!==(a=e())&&a>=56320&&a<=57343?(t(1024*(i-55296)+a-56320+65536),a=null):t(i)}null!==a&&t(a)},e.UTF8toUTF16=function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)i<=65535?t(i):(i-=65536,t(55296+(i>>10)),t(i%1024+56320)),i=null},e.encodeUTF16toUTF8=function(t,i){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,i)})},e.decodeUTF8toUTF16=function(t,i){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,i)})},e.calculateCodePoint=function(e){return e<128?1:e<2048?2:e<65536?3:4},e.calculateUTF8=function(e){for(var t,i=0;null!==(t=e());)i+=t<128?1:t<2048?2:t<65536?3:4;return i},e.calculateUTF16asUTF8=function(t){var i=0,a=0;return e.UTF16toUTF8(t,function(e){++i,a+=e<128?1:e<2048?2:e<65536?3:4}),[i,a]},e}();return o.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var a;try{d.decodeUTF8toUTF16(function(){return e<t?this.view[e++]:null}.bind(this),a=i())}catch(i){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return a()},s.fromUTF8=function(e,i,a){if(!a&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var n=new s(d.calculateUTF16asUTF8(t(e),!0)[1],i,a),o=0;return d.encodeUTF16toUTF8(t(e),function(e){n.view[o++]=e}),n.limit=o,n},s}),function(e,t){"function"==typeof define&&define.amd?define(["chat-bytebuffer.js"],function(){(e.dcodeIO=e.dcodeIO||{}).ProtoBuf=t(e.dcodeIO.ByteBuffer)}):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t(require("bytebuffer"),!0):(e.dcodeIO=e.dcodeIO||{}).ProtoBuf=t(e.dcodeIO.ByteBuffer)}(this,function(e,t){"use strict";var i={};return i.ByteBuffer=e,i.Long=e.Long||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){var e={};return e.IS_NODE=!("object"!=typeof process||process+""!="[object process]"||process.browser),e.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,i=0;i<e.length;i++){try{t=e[i]()}catch(e){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},e.fetch=function(t,i){if(i&&"function"!=typeof i&&(i=null),e.IS_NODE){var a=require("fs");if(i)a.readFile(t,function(e,t){i(e?null:""+t)});else try{return a.readFileSync(t)}catch(e){return null}}else{var n=e.XHR();if(n.open("GET",t,!!i),n.setRequestHeader("Accept","text/plain"),"function"==typeof n.overrideMimeType&&n.overrideMimeType("text/plain"),!i)return n.send(null),200==n.status||0==n.status&&"string"==typeof n.responseText?n.responseText:null;if(n.onreadystatechange=function(){4==n.readyState&&i(200==n.status||0==n.status&&"string"==typeof n.responseText?n.responseText:null)},4==n.readyState)return;n.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){function i(e,i){var a=-1,n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))a=parseInt(e);else if(t.NUMBER_HEX.test(e))a=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(n<0?"-":"")+e);a=parseInt(e.substring(1),8)}if(a=n*a|0,!i&&a<0)throw Error("illegal id value: "+(n<0?"-":"")+e);return a}function a(e){var i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return i*parseInt(e,10);if(t.NUMBER_HEX.test(e))return i*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return i*parseInt(e.substring(1),8);if("inf"===e)return i*(1/0);if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return i*parseFloat(e);throw Error("illegal number value: "+(i<0?"-":"")+e)}function n(e,t,i){void 0===e[t]?e[t]=i:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(i))}var s={},o=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},r=o.prototype;r._readString=function(){var e='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;e.lastIndex=this.index-1;var i=e.exec(this.source);if(!i)throw Error("unterminated string");return this.index=e.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,i[1]},r.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var e,i,a;do{for(e=!1;t.WHITESPACE.test(a=this.source.charAt(this.index));)if("\n"===a&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(a=this.source.charAt(this.index)))return"/";do{if("\n"===a&&++this.line,++this.index===this.source.length)return null;i=a,a=this.source.charAt(this.index)}while("*"!==i||"/"!==a);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;var n=this.index;if(t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(n++)))for(;n<this.source.length&&!t.DELIM.test(this.source.charAt(n));)++n;var s=this.source.substring(this.index,this.index=n);return'"'!==s&&"'"!==s||(this._stringOpen=s),s},r.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},r.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},r.omit=function(e){return this.peek()===e&&(this.next(),!0)},r.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},s.Tokenizer=o;var c=function(e){this.tn=new o(e),this.proto3=!1},l=c.prototype;return l.parse=function(){var e,i,a={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},n=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!n||null!==a.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),a.package=e;break;case"import":if(!n)throw Error("unexpected 'import'");e=this.tn.peek(),("public"===e||(i="weak"===e))&&this.tn.next(),e=this._readString(),this.tn.skip(";"),i||a.imports.push(e);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(a.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(a,null),n=!1;break;case"enum":this._parseEnum(a),n=!1;break;case"option":this._parseOption(a);break;case"service":this._parseService(a);break;case"extend":this._parseExtend(a);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete a.name,a},c.parse=function(e){return new c(e).parse()},l._readString=function(){var e,t,i="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);i+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return i},l._readValue=function(e){var i=this.tn.peek();if('"'===i||"'"===i)return this._readString();if(this.tn.next(),t.NUMBER.test(i))return a(i);if(t.BOOL.test(i))return"true"===i.toLowerCase();if(e&&t.TYPEREF.test(i))return i;throw Error("illegal value: "+i)},l._parseOption=function(e,i){var a=this.tn.next(),n=!1;if("("===a&&(n=!0,a=this.tn.next()),!t.TYPEREF.test(a))throw Error("illegal option name: "+a);var s=a;n&&(this.tn.skip(")"),s="("+s+")",a=this.tn.peek(),t.FQTYPEREF.test(a)&&(s+=a,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,s),i||this.tn.skip(";")},l._parseOptionValue=function(e,i){var a=this.tn.peek();if("{"!==a)n(e.options,i,this._readValue(!0));else for(this.tn.skip("{");"}"!==(a=this.tn.next());){if(!t.NAME.test(a))throw Error("illegal option name: "+i+"."+a);this.tn.omit(":")?n(e.options,i+"."+a,this._readValue(!0)):this._parseOptionValue(e,i+"."+a)}},l._parseService=function(e){var i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal service name at line "+this.tn.line+": "+i);var a=i,n={name:a,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if("option"===i)this._parseOption(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},l._parseServiceRPC=function(e){var i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal rpc service method name: "+i);var a=i,n={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),i=this.tn.next(),"stream"===i.toLowerCase()&&(n.request_stream=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal rpc service request type: "+i);if(n.request=i,this.tn.skip(")"),i=this.tn.next(),"returns"!==i.toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.tn.skip("("),i=this.tn.next(),"stream"===i.toLowerCase()&&(n.response_stream=!0,i=this.tn.next()),n.response=i,this.tn.skip(")"),"{"===(i=this.tn.peek())){for(this.tn.next();"}"!==(i=this.tn.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this._parseOption(n)}this.tn.omit(";")}else this.tn.skip(";");void 0===e.rpc&&(e.rpc={}),e.rpc[a]=n},l._parseMessage=function(e,a){var n=!!a,s=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(s))throw Error("illegal "+(n?"group":"message")+" name: "+s);for(o.name=s,n&&(this.tn.skip("="),a.id=i(this.tn.next()),o.isGroup=!0),s=this.tn.peek(),"["===s&&a&&this._parseFieldOptions(a),this.tn.skip("{");"}"!==(s=this.tn.next());)if(t.RULE.test(s))this._parseMessageField(o,s);else if("oneof"===s)this._parseMessageOneOf(o);else if("enum"===s)this._parseEnum(o);else if("message"===s)this._parseMessage(o);else if("option"===s)this._parseOption(o);else if("service"===s)this._parseService(o);else if("extensions"===s)o.hasOwnProperty("extensions")?o.extensions=o.extensions.concat(this._parseExtensionRanges()):o.extensions=this._parseExtensionRanges();else if("reserved"===s)this._parseIgnored();else if("extend"===s)this._parseExtend(o);else{if(!t.TYPEREF.test(s))throw Error("illegal message token: "+s);if(!this.proto3)throw Error("illegal field rule: "+s);this._parseMessageField(o,"optional",s)}return this.tn.omit(";"),e.messages.push(o),o},l._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},l._parseMessageField=function(e,a,n){if(!t.RULE.test(a))throw Error("illegal message field rule: "+a);var s,o={rule:a,type:"",name:"",options:{},id:0};if("map"===a){if(n)throw Error("illegal type: "+n);if(this.tn.skip("<"),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field type: "+s);if(o.keytype=s,this.tn.skip(","),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field: "+s);if(o.type=s,this.tn.skip(">"),s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=i(this.tn.next()),s=this.tn.peek(),"["===s&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(n=void 0!==n?n:this.tn.next())){var r=this._parseMessage(e,o);if(!/^[A-Z]/.test(r.name))throw Error("illegal group name: "+r.name);o.type=r.name,o.name=r.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(n)&&!t.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(o.type=n,s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=i(this.tn.next()),s=this.tn.peek(),"["===s&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},l._parseMessageOneOf=function(e){var i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal oneof name: "+i);var a,n=i,s=[];for(this.tn.skip("{");"}"!==(i=this.tn.next());)a=this._parseMessageField(e,"optional",i),a.oneof=n,s.push(a.id);this.tn.omit(";"),e.oneofs[n]=s},l._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},l._parseEnum=function(e){var a={name:"",values:[],options:{}},n=this.tn.next();if(!t.NAME.test(n))throw Error("illegal name: "+n);for(a.name=n,this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(a);else{if(!t.NAME.test(n))throw Error("illegal name: "+n);this.tn.skip("=");var s={name:n,id:i(this.tn.next(),!0)};n=this.tn.peek(),"["===n&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),a.values.push(s)}this.tn.omit(";"),e.enums.push(a)},l._parseExtensionRanges=function(){var t,i,n,s=[];do{for(i=[];;){switch(t=this.tn.next()){case"min":n=e.ID_MIN;break;case"max":n=e.ID_MAX;break;default:n=a(t)}if(i.push(n),2===i.length)break;if("to"!==this.tn.peek()){i.push(n);break}this.tn.next()}s.push(i)}while(this.tn.omit(","));return this.tn.skip(";"),s},l._parseExtend=function(e){var i=this.tn.next();if(!t.TYPEREF.test(i))throw Error("illegal extend reference: "+i);var a={ref:i,fields:[]};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(a,i);else{if(!t.TYPEREF.test(i))throw Error("illegal extend token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(a,"optional",i)}return this.tn.omit(";"),e.messages.push(a),a},l.toString=function(){return"Parser at line "+this.tn.line},s.Parser=c,s}(i,i.Lang),i.Reflect=function(t){function i(i){if("string"==typeof i&&(i=t.TYPES[i]),void 0===i.defaultValue)throw Error("default value for type "+i.name+" is not supported");return i==t.TYPES.bytes?new e(0):i.defaultValue}function a(e,i){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new t.Long(e.low,e.high,void 0===i?e.unsigned:i);if("string"==typeof e)return t.Long.fromString(e,i||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,i||!1);throw Error("not convertible to Long")}function n(e,i){var a=i.readVarint32(),s=7&a,o=a>>>3;switch(s){case t.WIRE_TYPES.VARINT:do{a=i.readUint8()}while(128==(128&a));break;case t.WIRE_TYPES.BITS64:i.offset+=8;break;case t.WIRE_TYPES.LDELIM:a=i.readVarint32(),i.offset+=a;break;case t.WIRE_TYPES.STARTGROUP:n(o,i);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+s)}return!0}var s={},o=function(e,t,i){this.builder=e,this.parent=t,this.name=i,this.className},r=o.prototype;r.fqn=function(){for(var e=this.name,t=this;;){if(null==(t=t.parent))break;e=t.name+"."+e}return e},r.toString=function(e){return(e?this.className+" ":"")+this.fqn()},r.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},s.T=o;var c=function(e,t,i,a,n){o.call(this,e,t,i),this.className="Namespace",this.children=[],this.options=a||{},this.syntax=n||"proto2"},l=c.prototype=Object.create(o.prototype);l.getChildren=function(e){if(null==(e=e||null))return this.children.slice();for(var t=[],i=0,a=this.children.length;i<a;++i)this.children[i]instanceof e&&t.push(this.children[i]);return t},l.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof p.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof p.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},l.getChild=function(e){for(var t="number"==typeof e?"id":"name",i=0,a=this.children.length;i<a;++i)if(this.children[i][t]===e)return this.children[i];return null},l.resolve=function(e,t){var i="string"==typeof e?e.split("."):e,a=this,n=0;if(""===i[n]){for(;null!==a.parent;)a=a.parent;n++}var o;do{do{if(!(a instanceof s.Namespace)){a=null;break}if(!(o=a.getChild(i[n]))||!(o instanceof s.T)||t&&!(o instanceof s.Namespace)){a=null;break}a=o,n++}while(n<i.length);if(null!=a)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=a);return a},l.qn=function(e){var t=[],i=e;do{t.unshift(i.name),i=i.parent}while(null!==i);for(var a=1;a<=t.length;a++){var n=t.slice(t.length-a);if(e===this.resolve(n,e instanceof s.Namespace))return n.join(".")}return e.fqn()},l.build=function(){for(var e,t={},i=this.children,a=0,n=i.length;a<n;++a)(e=i[a])instanceof c&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},l.buildOpt=function(){for(var e={},t=Object.keys(this.options),i=0,a=t.length;i<a;++i){var n=t[i],s=this.options[t[i]];e[n]=s}return e},l.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},s.Namespace=c;var d=function(e,i,a,n,s){if(this.type=e,this.resolvedType=i,this.isMapKey=a,this.syntax=n,this.name=s,a&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},u=d.prototype;d.defaultFieldValue=i,u.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},u.verifyValue=function(i){function n(e,t){throw Error("Illegal value for "+s.toString(!0)+" of type "+s.type.name+": "+e+" ("+t+")")}var s=this;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof i||i===i&&i%1!=0)&&n(typeof i,"not an integer"),i>4294967295?0|i:i;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof i||i===i&&i%1!=0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return a(i,!1)}catch(e){n(typeof i,e.message)}else n(typeof i,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return a(i,!0)}catch(e){n(typeof i,e.message)}else n(typeof i,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof i&&n(typeof i,"not a number"),i;case t.TYPES.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case t.TYPES.bytes:return e.isByteBuffer(i)?i:e.wrap(i,"base64");case t.TYPES.enum:var o=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(c=0;c<o.length;c++){if(o[c].name==i)return o[c].id;if(o[c].id==i)return o[c].id}if("proto3"===this.syntax)return("number"!=typeof i||i===i&&i%1!=0)&&n(typeof i,"not an integer"),(i>4294967295||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.resolvedType.clazz)return i;if(i instanceof t.Builder.Message){var r={};for(var c in i)i.hasOwnProperty(c)&&(r[c]=i[c]);i=r}
return new this.resolvedType.clazz(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},u.calculateLength=function(i,a){if(null===a)return 0;var n;switch(this.type){case t.TYPES.int32:return a<0?e.calculateVarint64(a):e.calculateVarint32(a);case t.TYPES.uint32:return e.calculateVarint32(a);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(a));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(a);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(a));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return e.calculateVarint32(a);case t.TYPES.double:return 8;case t.TYPES.string:return n=e.calculateUTF8Bytes(a),e.calculateVarint32(n)+n;case t.TYPES.bytes:if(a.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+a.remaining()+" bytes remaining");return e.calculateVarint32(a.remaining())+a.remaining();case t.TYPES.message:return n=this.resolvedType.calculate(a),e.calculateVarint32(n)+n;case t.TYPES.group:return(n=this.resolvedType.calculate(a))+e.calculateVarint32(i<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+a+" (unknown type)")},u.encodeValue=function(i,a,n){if(null===a)return n;switch(this.type){case t.TYPES.int32:a<0?n.writeVarint64(a):n.writeVarint32(a);break;case t.TYPES.uint32:n.writeVarint32(a);break;case t.TYPES.sint32:n.writeVarint32ZigZag(a);break;case t.TYPES.fixed32:n.writeUint32(a);break;case t.TYPES.sfixed32:n.writeInt32(a);break;case t.TYPES.int64:case t.TYPES.uint64:n.writeVarint64(a);break;case t.TYPES.sint64:n.writeVarint64ZigZag(a);break;case t.TYPES.fixed64:n.writeUint64(a);break;case t.TYPES.sfixed64:n.writeInt64(a);break;case t.TYPES.bool:"string"==typeof a?n.writeVarint32("false"===a.toLowerCase()?0:!!a):n.writeVarint32(a?1:0);break;case t.TYPES.enum:n.writeVarint32(a);break;case t.TYPES.float:n.writeFloat32(a);break;case t.TYPES.double:n.writeFloat64(a);break;case t.TYPES.string:n.writeVString(a);break;case t.TYPES.bytes:if(a.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+a.remaining()+" bytes remaining");var s=a.offset;n.writeVarint32(a.remaining()),n.append(a),a.offset=s;break;case t.TYPES.message:var o=(new e).LE();this.resolvedType.encode(a,o),n.writeVarint32(o.offset),n.append(o.flip());break;case t.TYPES.group:this.resolvedType.encode(a,n),n.writeVarint32(i<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+a+" (unknown type)")}return n},u.decode=function(e,i,a){if(i!=this.type.wireType)throw Error("Unexpected wire type for element");var n,s;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(s=e.readVarint32(),e.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+e.remaining());return n=e.clone(),n.limit=n.offset+s,e.offset+=s,n;case t.TYPES.message:return s=e.readVarint32(),this.resolvedType.decode(e,s);case t.TYPES.group:return this.resolvedType.decode(e,-1,a)}throw Error("[INTERNAL] Illegal decode type")},u.valueFromString=function(i){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(i));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(i);case t.TYPES.bool:return"true"===i;case t.TYPES.string:return this.verifyValue(i);case t.TYPES.bytes:return e.fromBinary(i)}},u.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},s.Element=d;var p=function(e,t,i,a,n,s){c.call(this,e,t,i,a,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!n,this._fields=null,this._fieldsById=null,this._fieldsByName=null},h=p.prototype=Object.create(c.prototype);h.build=function(i){if(this.clazz&&!i)return this.clazz;var a=function(t,i){function a(i,n,s,o){if(null===i||"object"!=typeof i){if(o&&o instanceof t.Reflect.Enum){var r=t.Reflect.Enum.getName(o.object,i);if(null!==r)return r}return i}if(e.isByteBuffer(i))return n?i.toBase64():i.toBuffer();if(t.Long.isLong(i))return s?i.toString():t.Long.fromValue(i);var c;if(Array.isArray(i))return c=[],i.forEach(function(e,t){c[t]=a(e,n,s,o)}),c;if(c={},i instanceof t.Map){for(var l=i.entries(),d=l.next();!d.done;d=l.next())c[i.keyElem.valueToString(d.value[0])]=a(d.value[1],n,s,i.valueElem.resolvedType);return c}var u=i.$type,p=void 0;for(var h in i)i.hasOwnProperty(h)&&(u&&(p=u.getChild(h))?c[h]=a(i[h],n,s,p.resolvedType):c[h]=a(i[h],n,s));return c}var n=i.getChildren(t.Reflect.Message.Field),s=i.getChildren(t.Reflect.Message.OneOf),o=function(a,r){t.Builder.Message.call(this);for(var c=0,l=s.length;c<l;++c)this[s[c].name]=null;for(c=0,l=n.length;c<l;++c){var d=n[c];this[d.name]=d.repeated?[]:d.map?new t.Map(d):null,!d.required&&"proto3"!==i.syntax||null===d.defaultValue||(this[d.name]=d.defaultValue)}if(arguments.length>0){var u;if(1!==arguments.length||null===a||"object"!=typeof a||!("function"!=typeof a.encode||a instanceof o)||Array.isArray(a)||a instanceof t.Map||e.isByteBuffer(a)||a instanceof ArrayBuffer||t.Long&&a instanceof t.Long)for(c=0,l=arguments.length;c<l;++c)void 0!==(u=arguments[c])&&this.$set(n[c].name,u);else this.$set(a)}},r=o.prototype=Object.create(t.Builder.Message.prototype);r.add=function(e,a,n){var s=i._fieldsByName[e];if(!n){if(!s)throw Error(this+"#"+e+" is undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));if(!s.repeated)throw Error(this+"#"+e+" is not a repeated field");a=s.verifyValue(a,!0)}return null===this[e]&&(this[e]=[]),this[e].push(a),this},r.$add=r.add,r.set=function(e,a,n){if(e&&"object"==typeof e){n=a;for(var s in e)e.hasOwnProperty(s)&&void 0!==(a=e[s])&&this.$set(s,a,n);return this}var o=i._fieldsByName[e];if(n)this[e]=a;else{if(!o)throw Error(this+"#"+e+" is not a field: undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));this[o.name]=a=o.verifyValue(a)}if(o&&o.oneof){var r=this[o.oneof.name];null!==a?(null!==r&&r!==o.name&&(this[r]=null),this[o.oneof.name]=o.name):r===e&&(this[o.oneof.name]=null)}return this},r.$set=r.set,r.get=function(e,a){if(a)return this[e];var n=i._fieldsByName[e];if(!(n&&n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},r.$get=r.get;for(var c=0;c<n.length;c++){var l=n[c];l instanceof t.Reflect.Message.ExtensionField||i.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var a=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),n=function(t,i){return this[e.name]=i?t:e.verifyValue(t),this},s=function(){return this[e.name]};null===i.getChild("set"+t)&&(r["set"+t]=n),null===i.getChild("set_"+a)&&(r["set_"+a]=n),null===i.getChild("get"+t)&&(r["get"+t]=s),null===i.getChild("get_"+a)&&(r["get_"+a]=s)}(l)}r.encode=function(t,a){"boolean"==typeof t&&(a=t,t=void 0);var n=!1;t||(t=new e,n=!0);var s=t.littleEndian;try{return i.encode(this,t.LE(),a),(n?t.flip():t).LE(s)}catch(e){throw t.LE(s),e}},o.encode=function(e,t,i){return new o(e).encode(t,i)},r.calculate=function(){return i.calculate(this)},r.encodeDelimited=function(t,a){var n=!1;t||(t=new e,n=!0);var s=(new e).LE();return i.encode(this,s,a).flip(),t.writeVarint32(s.remaining()),t.append(s),n?t.flip():t},r.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},r.toArrayBuffer=r.encodeAB,r.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},r.toBuffer=r.encodeNB,r.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},r.toBase64=r.encode64,r.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},r.toHex=r.encodeHex,r.toRaw=function(e,t){return a(this,!!e,!!t,this.$type)},r.encodeJSON=function(){return JSON.stringify(a(this,!0,!0,this.$type))},o.decode=function(t,a,n){"string"==typeof a&&(n=a,a=-1),"string"==typeof t?t=e.wrap(t,n||"base64"):e.isByteBuffer(t)||(t=e.wrap(t));var s=t.littleEndian;try{var o=i.decode(t.LE(),a);return t.LE(s),o}catch(e){throw t.LE(s),e}},o.decodeDelimited=function(t,a){if("string"==typeof t?t=e.wrap(t,a||"base64"):e.isByteBuffer(t)||(t=e.wrap(t)),t.remaining()<1)return null;var n=t.offset,s=t.readVarint32();if(t.remaining()<s)return t.offset=n,null;try{var o=i.decode(t.slice(t.offset,t.offset+s).LE());return t.offset+=s,o}catch(e){throw t.offset+=s,e}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.decodeJSON=function(e){return new o(JSON.parse(e))},r.toString=function(){return i.toString()};return Object.defineProperty&&(Object.defineProperty(o,"$options",{value:i.buildOpt()}),Object.defineProperty(r,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:i}),Object.defineProperty(r,"$type",{value:i})),o}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var n,s=0,o=this.children.length;s<o;s++)if((n=this.children[s])instanceof b||n instanceof p||n instanceof C){if(a.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");a[n.name]=n.build()}else if(n instanceof p.Field)n.build(),this._fields.push(n),this._fieldsById[n.id]=n,this._fieldsByName[n.name]=n;else if(!(n instanceof p.OneOf||n instanceof w))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=a},h.encode=function(e,t,i){for(var a,n,s=null,o=0,r=this._fields.length;o<r;++o)a=this._fields[o],n=e[a.name],a.required&&null===n?null===s&&(s=a):a.encode(i?n:a.verifyValue(n),t,e);if(null!==s){var c=Error("Missing at least one required field for "+this.toString(!0)+": "+s);throw c.encoded=t,c}return t},h.calculate=function(e){for(var t,i,a=0,n=0,s=this._fields.length;n<s;++n){if(t=this._fields[n],i=e[t.name],t.required&&null===i)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);a+=t.calculate(i,e)}return a},h.decode=function(e,i,a){"number"!=typeof i&&(i=-1);for(var s,o,r,c,l=e.offset,d=new this.clazz;e.offset<l+i||-1===i&&e.remaining()>0;){if(s=e.readVarint32(),o=7&s,r=s>>>3,o===t.WIRE_TYPES.ENDGROUP){if(r!==a)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+r+" ("+(a?a+" expected":"not a group")+")");break}if(c=this._fieldsById[r]){if(c.repeated&&!c.options.packed)d[c.name].push(c.decode(o,e));else if(c.map){var u=c.decode(o,e);d[c.name].set(u[0],u[1])}else if(d[c.name]=c.decode(o,e),c.oneof){var p=d[c.oneof.name];null!==p&&p!==c.name&&(d[p]=null),d[c.oneof.name]=c.name}}else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var h=e.readVarint32();e.offset+=h;break;case t.WIRE_TYPES.STARTGROUP:for(;n(r,e););break;default:throw Error("Illegal wire type for unknown field "+r+" in "+this.toString(!0)+"#decode: "+o)}}for(var f=0,m=this._fields.length;f<m;++f)if(c=this._fields[f],null===d[c.name])if("proto3"===this.syntax)d[c.name]=c.defaultValue;else{if(c.required){var g=Error("Missing at least one required field for "+this.toString(!0)+": "+c.name);throw g.decoded=d,g}t.populateDefaults&&null!==c.defaultValue&&(d[c.name]=c.defaultValue)}return d},s.Message=p;var f=function(e,i,a,n,s,r,c,l,d,u){o.call(this,e,i,r),this.className="Message.Field",this.required="required"===a,this.repeated="repeated"===a,this.map="map"===a,this.keyType=n||null,this.type=s,this.resolvedType=null,this.id=c,this.options=l||{},this.defaultValue=null,this.oneof=d||null,this.syntax=u||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof p.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},m=f.prototype=Object.create(o.prototype);m.build=function(){this.element=new d(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new d(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=d.defaultFieldValue(this.type)},m.verifyValue=function(e,i){function a(e,t){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+e+" ("+t+")")}i=i||!1;var n=this;if(null===e)return this.required&&a(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&a(typeof e,"proto3 field without field presence cannot be null"),null;var s;if(this.repeated&&!i){Array.isArray(e)||(e=[e]);var o=[];for(s=0;s<e.length;s++)o.push(this.element.verifyValue(e[s]));return o}return this.map&&!i?e instanceof t.Map?e:(e instanceof Object||a(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&a(typeof e,"no array expected"),this.element.verifyValue(e))},m.hasWirePresence=function(e,i){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&i[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},m.encode=function(i,a,n){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return a;try{if(this.repeated){var s;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){a.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),a.ensureCapacity(a.offset+=1);var o=a.offset;for(s=0;s<i.length;s++)this.element.encodeValue(this.id,i[s],a);var r=a.offset-o,c=e.calculateVarint32(r);if(c>1){var l=a.slice(o,a.offset);o+=c-1,a.offset=o,a.append(l)}a.writeVarint32(r,o-c)}else for(s=0;s<i.length;s++)a.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i[s],a)}else this.map?i.forEach(function(i,n,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);a.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),a.writeVarint32(o),a.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,n,a),a.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,i,a)},this):this.hasWirePresence(i,n)&&(a.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i,a))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+e+")")}return a},m.calculate=function(i,a){if(i=this.verifyValue(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var n=0;try{if(this.repeated){var s,o;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),o=0,s=0;s<i.length;s++)o+=this.element.calculateLength(this.id,i[s]);n+=e.calculateVarint32(o),n+=o}else for(s=0;s<i.length;s++)n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i[s])}else this.map?i.forEach(function(i,a,s){var o=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,a)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);n+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),n+=e.calculateVarint32(o),n+=o},this):this.hasWirePresence(i,a)&&(n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,i))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+e+")")}return n},m.decode=function(e,i,a){var n,s;if(!(!this.map&&e==this.type.wireType||!a&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!a){s=i.readVarint32(),s=i.offset+s;for(var o=[];i.offset<s;)o.push(this.decode(this.type.wireType,i,!0));return o}if(this.map){var r=d.defaultFieldValue(this.keyType);if(n=d.defaultFieldValue(this.type),s=i.readVarint32(),i.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.remaining());var c=i.clone();for(c.limit=c.offset+s,i.offset+=s;c.remaining()>0;){var l=c.readVarint32();e=7&l;var u=l>>>3;if(1===u)r=this.keyElement.decode(c,e,u);else{if(2!==u)throw Error("Unexpected tag in map field key/value submessage");n=this.element.decode(c,e,u)}}return[r,n]}return this.element.decode(i,e,this.id)},s.Message.Field=f;var g=function(e,t,i,a,n,s,o){f.call(this,e,t,i,null,a,n,s,o),this.extension};g.prototype=Object.create(f.prototype),s.Message.ExtensionField=g;var v=function(e,t,i){o.call(this,e,t,i),this.fields=[]};s.Message.OneOf=v;var b=function(e,t,i,a,n){c.call(this,e,t,i,a,n),this.className="Enum",this.object=null};b.getName=function(e,t){for(var i,a=Object.keys(e),n=0;n<a.length;++n)if(e[i=a[n]]===t)return i;return null},(b.prototype=Object.create(c.prototype)).build=function(e){if(this.object&&!e)return this.object;for(var i=new t.Builder.Enum,a=this.getChildren(b.Value),n=0,s=a.length;n<s;++n)i[a[n].name]=a[n].id;return Object.defineProperty&&Object.defineProperty(i,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=i},s.Enum=b;var y=function(e,t,i,a){o.call(this,e,t,i),this.className="Enum.Value",this.id=a};y.prototype=Object.create(o.prototype),s.Enum.Value=y;var w=function(e,t,i,a){o.call(this,e,t,i),this.field=a};w.prototype=Object.create(o.prototype),s.Extension=w;var C=function(e,t,i,a){c.call(this,e,t,i,a),this.className="Service",this.clazz=null};(C.prototype=Object.create(c.prototype)).build=function(i){return this.clazz&&!i?this.clazz:this.clazz=function(t,i){for(var a=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,i){setTimeout(i.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},n=a.prototype=Object.create(t.Builder.Service.prototype),s=i.getChildren(t.Reflect.Service.RPCMethod),o=0;o<s.length;o++)!function(t){n[t.name]=function(a,n){try{try{a=t.resolvedRequestType.clazz.decode(e.wrap(a))}catch(e){if(!(e instanceof TypeError))throw e}if(null===a||"object"!=typeof a)throw Error("Illegal arguments");a instanceof t.resolvedRequestType.clazz||(a=new t.resolvedRequestType.clazz(a)),this.rpcImpl(t.fqn(),a,function(e,a){if(e)return void n(e);null===a&&(a="");try{a=t.resolvedResponseType.clazz.decode(a)}catch(e){}if(!(a&&a instanceof t.resolvedResponseType.clazz))return void n(Error("Illegal response type received in service method "+i.name+"#"+t.name));n(null,a)})}catch(e){setTimeout(n.bind(this,e),0)}},a[t.name]=function(e,i,n){new a(e)[t.name](i,n)},Object.defineProperty&&(Object.defineProperty(a[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(n[t.name],"$options",{value:a[t.name].$options}))}(s[o]);return Object.defineProperty&&(Object.defineProperty(a,"$options",{value:i.buildOpt()}),Object.defineProperty(n,"$options",{value:a.$options}),Object.defineProperty(a,"$type",{value:i}),Object.defineProperty(n,"$type",{value:i})),a}(t,this)},s.Service=C;var x=function(e,t,i,a){o.call(this,e,t,i),this.className="Service.Method",this.options=a||{}};(x.prototype=Object.create(o.prototype)).buildOpt=l.buildOpt,s.Service.Method=x;var k=function(e,t,i,a,n,s,o,r){x.call(this,e,t,i,r),this.className="Service.RPCMethod",this.requestName=a,this.responseName=n,this.requestStream=s,this.responseStream=o,this.resolvedRequestType=null,this.resolvedResponseType=null};return k.prototype=Object.create(x.prototype),s.Service.RPCMethod=k,s}(i),i.Builder=function(e,t,i){function a(e){e.messages&&e.messages.forEach(function(t){t.syntax=e.syntax,a(t)}),e.enums&&e.enums.forEach(function(t){t.syntax=e.syntax})}var n=function(e){this.ns=new i.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},s=n.prototype;return n.isMessage=function(e){return"string"==typeof e.name&&(void 0===e.values&&void 0===e.rpc)},n.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},n.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},n.isService=function(e){return!("string"!=typeof e.name||"object"!=typeof e.rpc||!e.rpc)},n.isExtend=function(e){return"string"==typeof e.ref},s.reset=function(){return this.ptr=this.ns,this},s.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach(function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new i.Namespace(this,this.ptr,e)),this.ptr=t},this),this},s.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var a=[t];a.length>0;){if(t=a.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var s=t.shift();if(n.isMessage(s)){var o=new i.Message(this,this.ptr,s.name,s.options,s.isGroup,s.syntax),r={};s.oneofs&&Object.keys(s.oneofs).forEach(function(e){o.addChild(r[e]=new i.Message.OneOf(this,o,e))},this),s.fields&&s.fields.forEach(function(e){if(null!==o.getChild(0|e.id))throw Error("duplicate or invalid field id in "+o.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+o.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=r[e.oneof]))throw Error("illegal oneof in "+o.name+"#"+e.name+": "+e.oneof);e=new i.Message.Field(this,o,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,s.syntax),t&&t.fields.push(e),o.addChild(e)},this);var c=[];if(s.enums&&s.enums.forEach(function(e){c.push(e)}),s.messages&&s.messages.forEach(function(e){c.push(e)}),s.services&&s.services.forEach(function(e){c.push(e)}),s.extensions&&("number"==typeof s.extensions[0]?o.extensions=[s.extensions]:o.extensions=s.extensions),this.ptr.addChild(o),c.length>0){a.push(t),t=c,c=null,this.ptr=o,o=null;continue}c=null}else if(n.isEnum(s))o=new i.Enum(this,this.ptr,s.name,s.options,s.syntax),s.values.forEach(function(e){o.addChild(new i.Enum.Value(this,o,e.name,e.id))},this),this.ptr.addChild(o);else if(n.isService(s))o=new i.Service(this,this.ptr,s.name,s.options),Object.keys(s.rpc).forEach(function(e){var t=s.rpc[e];o.addChild(new i.Service.RPCMethod(this,o,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))},this),this.ptr.addChild(o);else{if(!n.isExtend(s))throw Error("not a valid definition: "+JSON.stringify(s));if(o=this.ptr.resolve(s.ref,!0))s.fields.forEach(function(t){if(null!==o.getChild(0|t.id))throw Error("duplicate extended field id in "+o.name+": "+t.id);if(o.extensions){var a=!1;if(o.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(a=!0)}),!a)throw Error("illegal extended field id in "+o.name+": "+t.id+" (not within valid ranges)")}var n=t.name;this.options.convertFieldsToCamelCase&&(n=e.Util.toCamelCase(n));var s=new i.Message.ExtensionField(this,o,t.rule,t.type,this.ptr.fqn()+"."+n,t.id,t.options),r=new i.Extension(this,this.ptr,t.name,s);s.extension=r,this.ptr.addChild(r),o.addChild(s)},this);else if(!/\.?google\.protobuf\./.test(s.ref))throw Error("extended message "+s.ref+" is not defined")}s=null,o=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},s.import=function(t,i){var n="/";if("string"==typeof i){if(e.Util.IS_NODE&&(i=require("path").resolve(i)),!0===this.files[i])return this.reset();this.files[i]=!0}else if("object"==typeof i){var s=i.root;e.Util.IS_NODE&&(s=require("path").resolve(s)),(s.indexOf("\\")>=0||i.file.indexOf("\\")>=0)&&(n="\\");var o=s+n+i.file;if(!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){var r,c=!1;"object"==typeof i?(this.importRoot=i.root,c=!0,r=this.importRoot,i=i.file,(r.indexOf("\\")>=0||i.indexOf("\\")>=0)&&(n="\\")):"string"==typeof i?this.importRoot?r=this.importRoot:i.indexOf("/")>=0?""===(r=i.replace(/\/[^\/]*$/,""))&&(r="/"):i.indexOf("\\")>=0?(r=i.replace(/\\[^\\]*$/,""),n="\\"):r=".":r=null;for(var l=0;l<t.imports.length;l++)if("string"==typeof t.imports[l]){if(!r)throw Error("cannot determine import root");var d=t.imports[l];if("google/protobuf/descriptor.proto"===d)continue;if(d=r+n+d,!0===this.files[d])continue;/\.proto$/i.test(d)&&!e.DotProto&&(d=d.replace(/\.proto$/,".json"));var u=e.Util.fetch(d);if(null===u)throw Error("failed to import '"+d+"' in '"+i+"': file not found");/\.json$/i.test(d)?this.import(JSON.parse(u+""),d):this.import(e.DotProto.Parser.parse(u),d)}else i?/\.(\w+)$/.test(i)?this.import(t.imports[l],i.replace(/^(.+)\.(\w+)$/,function(e,t,i){return t+"_import"+l+"."+i})):this.import(t.imports[l],i+"_import"+l):this.import(t.imports[l]);c&&(this.importRoot=null)}t.package&&this.define(t.package),t.syntax&&a(t);var p=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){p.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=p),t.enums&&(this.create(t.enums),this.ptr=p),t.services&&(this.create(t.services),this.ptr=p),t.extends&&this.create(t.extends),this.reset()},s.resolveAll=function(){var a;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof i.Namespace)this.ptr.children.forEach(function(e){this.ptr=e,this.resolveAll()},this);else if(this.ptr instanceof i.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(a=(this.ptr instanceof i.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=a,a instanceof i.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==a.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(a instanceof i.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=a.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((a=this.ptr.parent.resolve(this.ptr.requestName,!0))&&a instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=a,!((a=this.ptr.parent.resolve(this.ptr.responseName,!0))&&a instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=a}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},s.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,i=this.result,a=0;a<t.length;a++){if(!i[t[a]]){i=null;break}i=i[t[a]]}return i},s.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},s.toString=function(){return"Builder"},n.Message=function(){},n.Enum=function(){},n.Service=function(){},n}(i,i.Lang,i.Reflect),i.Map=function(e,t){function i(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var a=function(e,i){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var a=Object.keys(i),n=0;n<a.length;n++){var s=this.keyElem.valueFromString(a[n]),o=this.valueElem.verifyValue(i[a[n]]);this.map[this.keyElem.valueToString(s)]={key:s,value:o}}},n=a.prototype;return n.clear=function(){this.map={}},n.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),i=t in this.map;return delete this.map[t],i},n.entries=function(){for(var e,t=[],a=Object.keys(this.map),n=0;n<a.length;n++)t.push([(e=this.map[a[n]]).key,e.value]);return i(t)},n.keys=function(){for(var e=[],t=Object.keys(this.map),a=0;a<t.length;a++)e.push(this.map[t[a]].key);return i(e)},n.values=function(){for(var e=[],t=Object.keys(this.map),a=0;a<t.length;a++)e.push(this.map[t[a]].value);return i(e)},n.forEach=function(e,t){for(var i,a=Object.keys(this.map),n=0;n<a.length;n++)e.call(t,(i=this.map[a[n]]).value,i.key,this)},n.set=function(e,t){var i=this.keyElem.verifyValue(e),a=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(i)]={key:i,value:a},this},n.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},n.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},a}(0,i.Reflect),i.loadProto=function(e,t,a){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(a=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,a)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,a){if(t&&"object"==typeof t?(a=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null===n)return void t(Error("Failed to fetch file"));try{t(null,i.loadProto(n,a,e))}catch(e){t(e)}});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e)
;return null===n?null:i.loadProto(n,a,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return e=e||{},void 0===e.convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,a){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(a=t,t=null),t&&"object"==typeof t||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,a),t.resolveAll(),t},i.loadJsonFile=function(e,t,a){if(t&&"object"==typeof t?(a=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(n){if(null===n)return void t(Error("Failed to fetch file"));try{t(null,i.loadJson(JSON.parse(n),a,e))}catch(e){t(e)}});var n=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===n?null:i.loadJson(JSON.parse(n),a,e)},i}),"undefined"==typeof Paho&&(Paho={}),Paho.MQTT=function(e){function t(e,t){var i=t,a=e[t],s=a>>4,o=a&=15;t+=1;var r,d=0,u=1;do{if(t==e.length)return[null,i];r=e[t++],d+=(127&r)*u,u*=128}while(0!=(128&r));var p=t+d;if(p>e.length)return[null,i];var h=new v(s);switch(ChatWebsocket.settings.onlineDebug&&console.log("decodeType:"+s+" "+new Date+" "+(new Date).getTime()),s){case l.CONNACK:1&e[t++]&&(h.sessionPresent=!0),h.returnCode=e[t++];break;case l.PUBLISH:var f=o>>1&3,m=n(e,t);t+=2;var g=c(e,t,m);t+=m,f>0&&(h.messageIdentifier=n(e,t),t+=2);var b=new Paho.MQTT.Message(e.subarray(t,p));1==(1&o)&&(b.retained=!0),8==(8&o)&&(b.duplicate=!0),b.qos=f,b.destinationName=g,h.payloadMessage=b;break;case l.PUBACK:case l.PUBREC:case l.PUBREL:case l.PUBCOMP:case l.UNSUBACK:h.messageIdentifier=n(e,t);break;case l.SUBACK:h.messageIdentifier=n(e,t),t+=2,h.returnCode=e.subarray(t,p)}return[h,p]}function i(e,t,i){return t[i++]=e>>8,t[i++]=e%256,i}function a(e,t,a,n){return n=i(t,a,n),r(e,a,n),n+t}function n(e,t){return 256*e[t]+e[t+1]}function s(e){var t=new Array(1),i=0;do{var a=e%128;e>>=7,e>0&&(a|=128),t[i++]=a}while(e>0&&i<4);return t}function o(e){for(var t=0,i=0;i<e.length;i++){var a=e.charCodeAt(i);a>2047?(55296<=a&&a<=56319&&(i++,t++),t+=3):a>127?t+=2:t++}return t}function r(e,t,i){for(var a=i,n=0;n<e.length;n++){var s=e.charCodeAt(n);if(55296<=s&&s<=56319){var o=e.charCodeAt(++n);if(isNaN(o))throw new Error(f(p.MALFORMED_UNICODE,[s,o]));s=o-56320+(s-55296<<10)+65536}s<=127?t[a++]=s:s<=2047?(t[a++]=s>>6&31|192,t[a++]=63&s|128):s<=65535?(t[a++]=s>>12&15|224,t[a++]=s>>6&63|128,t[a++]=63&s|128):(t[a++]=s>>18&7|240,t[a++]=s>>12&63|128,t[a++]=s>>6&63|128,t[a++]=63&s|128)}return t}function c(e,t,i){for(var a,n="",s=t;s<t+i;){var o=e[s++];if(o<128)a=o;else{var r=e[s++]-128;if(r<0)throw new Error(f(p.MALFORMED_UTF,[o.toString(16),r.toString(16),""]));if(o<224)a=64*(o-192)+r;else{var c=e[s++]-128;if(c<0)throw new Error(f(p.MALFORMED_UTF,[o.toString(16),r.toString(16),c.toString(16)]));if(o<240)a=4096*(o-224)+64*r+c;else{var l=e[s++]-128;if(l<0)throw new Error(f(p.MALFORMED_UTF,[o.toString(16),r.toString(16),c.toString(16),l.toString(16)]));if(!(o<248))throw new Error(f(p.MALFORMED_UTF,[o.toString(16),r.toString(16),c.toString(16),l.toString(16)]));a=262144*(o-240)+4096*r+64*c+l}}}a>65535&&(a-=65536,n+=String.fromCharCode(55296+(a>>10)),a=56320+(1023&a)),n+=String.fromCharCode(a)}return n}var l={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},d=function(e,t){for(var i in e)if(e.hasOwnProperty(i)){if(!t.hasOwnProperty(i)){var a="Unknown property, "+i+". Valid properties are:";for(var i in t)t.hasOwnProperty(i)&&(a=a+" "+i);throw new Error(a)}if(typeof e[i]!==t[i])throw new Error(f(p.INVALID_TYPE,[typeof e[i],i]))}},u=function(e,t){return function(){return e.apply(t,arguments)}},p={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},h={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},f=function(e,t){var i=e.text;if(t)for(var a,n,s=0;s<t.length;s++)if(a="{"+s+"}",(n=i.indexOf(a))>0){var o=i.substring(0,n),r=i.substring(n+a.length);i=o+t[s]+r}return i},m=[0,6,77,81,73,115,100,112,3],g=[0,4,77,81,84,84,4],v=function(e,t){this.type=e;for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])};v.prototype.encode=function(){var e=(15&this.type)<<4,t=0,n=new Array,r=0;switch(void 0!=this.messageIdentifier&&(t+=2),this.type){case l.CONNECT:switch(this.mqttVersion){case 3:t+=m.length+3;break;case 4:t+=g.length+3}if(t+=o(this.clientId)+2,void 0!=this.willMessage){t+=o(this.willMessage.destinationName)+2;var c=this.willMessage.payloadBytes;c instanceof Uint8Array||(c=new Uint8Array(u)),t+=c.byteLength+2}void 0!=this.userName&&(t+=o(this.userName)+2),void 0!=this.password&&(t+=o(this.password)+2);break;case l.SUBSCRIBE:e|=2;for(var d=0;d<this.topics.length;d++)n[d]=o(this.topics[d]),t+=n[d]+2;t+=this.requestedQos.length;break;case l.UNSUBSCRIBE:e|=2;for(var d=0;d<this.topics.length;d++)n[d]=o(this.topics[d]),t+=n[d]+2;break;case l.PUBREL:e|=2;break;case l.PUBLISH:this.payloadMessage.duplicate&&(e|=8),e=e|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(e|=1),r=o(this.payloadMessage.destinationName),t+=r+2;var u=this.payloadMessage.payloadBytes;t+=u.byteLength,u instanceof ArrayBuffer?u=new Uint8Array(u):u instanceof Uint8Array||(u=new Uint8Array(u.buffer));break;case l.DISCONNECT:}var p=s(t),h=p.length+1,f=new ArrayBuffer(t+h),v=new Uint8Array(f);if(v[0]=e,v.set(p,1),this.type==l.PUBLISH)h=a(this.payloadMessage.destinationName,r,v,h);else if(this.type==l.CONNECT){switch(this.mqttVersion){case 3:v.set(m,h),h+=m.length;break;case 4:v.set(g,h),h+=g.length}var b=0;this.cleanSession&&(b=2),void 0!=this.willMessage&&(b|=4,b|=this.willMessage.qos<<3,this.willMessage.retained&&(b|=32)),void 0!=this.userName&&(b|=128),void 0!=this.password&&(b|=64),v[h++]=b,h=i(this.keepAliveInterval,v,h)}switch(void 0!=this.messageIdentifier&&(h=i(this.messageIdentifier,v,h)),this.type){case l.CONNECT:h=a(this.clientId,o(this.clientId),v,h),void 0!=this.willMessage&&(h=a(this.willMessage.destinationName,o(this.willMessage.destinationName),v,h),h=i(c.byteLength,v,h),v.set(c,h),h+=c.byteLength),void 0!=this.userName&&(h=a(this.userName,o(this.userName),v,h)),void 0!=this.password&&(h=a(this.password,o(this.password),v,h));break;case l.PUBLISH:v.set(u,h);break;case l.SUBSCRIBE:for(var d=0;d<this.topics.length;d++)h=a(this.topics[d],n[d],v,h),v[h++]=this.requestedQos[d];break;case l.UNSUBSCRIBE:for(var d=0;d<this.topics.length;d++)h=a(this.topics[d],n[d],v,h)}return f};var b=function(e,t,i){this._client=e,this._window=t,this._keepAliveInterval=1e3*i,this.isReset=!1;var a=new v(l.PINGREQ).encode(),n=function(e){return function(){return s.apply(e)}},s=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(a),this.timeout=this._window.setTimeout(n(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(p.PING_TIMEOUT.code,f(p.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(n(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},y=function(e,t,i,a,n){this._window=t,i||(i=30);this.timeout=setTimeout(function(e,t,i){return function(){return e.apply(t,i)}}(a,e,n),1e3*i),this.cancel=function(){this._window.clearTimeout(this.timeout)}},w=function(t,i,a,n,s){if(!("WebSocket"in e&&null!==e.WebSocket))throw new Error(f(p.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in e&&null!==e.localStorage))throw new Error(f(p.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in e&&null!==e.ArrayBuffer))throw new Error(f(p.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",t,i,a,n,s),this.host=i,this.port=a,this.path=n,this.uri=t,this.clientId=s,this._localKey=i+":"+a+("/mqtt"!=n?":"+n:"")+":"+s+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var o in localStorage)0!=o.indexOf("Sent:"+this._localKey)&&0!=o.indexOf("Received:"+this._localKey)||this.restore(o)};w.prototype.host,w.prototype.port,w.prototype.path,w.prototype.uri,w.prototype.clientId,w.prototype.socket,w.prototype.connected=!1,w.prototype.maxMessageIdentifier=65536,w.prototype.connectOptions,w.prototype.hostIndex,w.prototype.onConnectionLost,w.prototype.onMessageDelivered,w.prototype.onMessageArrived,w.prototype.traceFunction,w.prototype._msg_queue=null,w.prototype._connectTimeout,w.prototype.sendPinger=null,w.prototype.receivePinger=null,w.prototype.receiveBuffer=null,w.prototype._traceBuffer=null,w.prototype._MAX_TRACE_ENTRIES=100,w.prototype.connect=function(e){var t=this._traceMask(e,"password");this._trace("Client.connect",t,this.socket,this.connected),this.connectOptions=e,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},w.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(f(p.INVALID_STATE,["not connected"]));var i=new v(l.SUBSCRIBE);i.topics=[e],void 0!=t.qos?i.requestedQos=[t.qos]:i.requestedQos=[0],t.onSuccess&&(i.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(i.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e})}),t.timeout&&(i.timeOut=new y(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:p.SUBSCRIBE_TIMEOUT.code,errorMessage:f(p.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(i),this._schedule_message(i)},w.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(f(p.INVALID_STATE,["not connected"]));var i=new v(l.UNSUBSCRIBE);i.topics=[e],t.onSuccess&&(i.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(i.timeOut=new y(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:p.UNSUBSCRIBE_TIMEOUT.code,errorMessage:f(p.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(i),this._schedule_message(i)},w.prototype.send=function(e){if(this._trace("Client.send",e),!this.connected)throw new Error(f(p.INVALID_STATE,["not connected"]));wireMessage=new v(l.PUBLISH),wireMessage.payloadMessage=e,e.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage)},w.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw new Error(f(p.INVALID_STATE,["not connecting or connected"]));wireMessage=new v(l.DISCONNECT),this._notify_msg_sent[wireMessage]=u(this._disconnected,this),this._schedule_message(wireMessage)},w.prototype.getTraceLog=function(){if(null!==this._traceBuffer){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var e in this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},w.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@")},w.prototype.stopTrace=function(){delete this._traceBuffer},w.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this.connected=!1,this.connectOptions.mqttVersion,this.socket=new WebSocket(e),this.socket.binaryType="arraybuffer",this.socket.onopen=u(this._on_socket_open,this),this.socket.onmessage=u(this._on_socket_message,this),this.socket.onerror=u(this._on_socket_error,this),this.socket.onclose=u(this._on_socket_close,this),this.sendPinger=new b(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new b(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new y(this,window,this.connectOptions.timeout,this._disconnected,[p.CONNECT_TIMEOUT.code,f(p.CONNECT_TIMEOUT)])},w.prototype._schedule_message=function(e){this._msg_queue.push(e),this.connected&&this._process_queue()},w.prototype.store=function(e,t){var i={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case l.PUBLISH:t.pubRecReceived&&(i.pubRecReceived=!0),i.payloadMessage={};for(var a="",n=t.payloadMessage.payloadBytes,s=0;s<n.length;s++)n[s]<=15?a=a+"0"+n[s].toString(16):a+=n[s].toString(16);i.payloadMessage.payloadHex=a,i.payloadMessage.qos=t.payloadMessage.qos,i.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(i.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(i.payloadMessage.retained=!0),0==e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),i.sequence=t.sequence);break;default:throw Error(f(p.INVALID_STORED_DATA,[key,i]))}localStorage.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(i))},w.prototype.restore=function(e){var t=localStorage.getItem(e),i=JSON.parse(t),a=new v(i.type,i);switch(i.type){case l.PUBLISH:for(var n=i.payloadMessage.payloadHex,s=new ArrayBuffer(n.length/2),o=new Uint8Array(s),r=0;n.length>=2;){var c=parseInt(n.substring(0,2),16);n=n.substring(2,n.length),o[r++]=c}var d=new Paho.MQTT.Message(o);d.qos=i.payloadMessage.qos,d.destinationName=i.payloadMessage.destinationName,i.payloadMessage.duplicate&&(d.duplicate=!0),i.payloadMessage.retained&&(d.retained=!0),a.payloadMessage=d;break;default:throw Error(f(p.INVALID_STORED_DATA,[e,t]))}0==e.indexOf("Sent:"+this._localKey)?(a.payloadMessage.duplicate=!0,this._sentMessages[a.messageIdentifier]=a):0==e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[a.messageIdentifier]=a)},w.prototype._process_queue=function(){for(var e=null,t=this._msg_queue.reverse();e=t.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},w.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===l.PUBLISH&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},w.prototype._on_socket_open=function(){var e=new v(l.CONNECT,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},w.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data),this.receivePinger.reset();for(var t=this._deframeMessages(e.data),i=0;i<t.length;i+=1)this._handleMessage(t[i])},w.prototype._deframeMessages=function(e){var i=new Uint8Array(e);if(this.receiveBuffer){var a=new Uint8Array(this.receiveBuffer.length+i.length);a.set(this.receiveBuffer),a.set(i,this.receiveBuffer.length),i=a,delete this.receiveBuffer}try{for(var n=0,s=[];n<i.length;){var o=t(i,n),r=o[0];if(n=o[1],null===r)break;s.push(r)}n<i.length&&(this.receiveBuffer=i.subarray(n))}catch(e){return void this._disconnected(p.INTERNAL_ERROR.code,f(p.INTERNAL_ERROR,[e.message,e.stack.toString()]))}return s},w.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case l.CONNACK:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var i=this._sentMessages[t];localStorage.removeItem("Sent:"+this._localKey+i.messageIdentifier)}this._sentMessages={};for(var t in this._receivedMessages){var a=this._receivedMessages[t];localStorage.removeItem("Received:"+this._localKey+a.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(p.CONNACK_RETURNCODE.code,f(p.CONNACK_RETURNCODE,[e.returnCode,h[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var n=new Array;for(var s in this._sentMessages)this._sentMessages.hasOwnProperty(s)&&n.push(this._sentMessages[s]);for(var n=n.sort(function(e,t){return e.sequence-t.sequence}),o=0,r=n.length;o<r;o++){var i=n[o];if(i.type==l.PUBLISH&&i.pubRecReceived){var c=new v(l.PUBREL,{messageIdentifier:i.messageIdentifier});this._schedule_message(c)}else this._schedule_message(i)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case l.PUBLISH:this._receivePublish(e);break;case l.PUBACK:var i=this._sentMessages[e.messageIdentifier];i&&(delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(i.payloadMessage));break;case l.PUBREC:var i=this._sentMessages[e.messageIdentifier];if(i){i.pubRecReceived=!0;var c=new v(l.PUBREL,{messageIdentifier:e.messageIdentifier});this.store("Sent:",i),this._schedule_message(c)}break;case l.PUBREL:var a=this._receivedMessages[e.messageIdentifier];localStorage.removeItem("Received:"+this._localKey+e.messageIdentifier),a&&(this._receiveMessage(a),delete this._receivedMessages[e.messageIdentifier]);var d=new v(l.PUBCOMP,{messageIdentifier:e.messageIdentifier});this._schedule_message(d);break;case l.PUBCOMP:var i=this._sentMessages[e.messageIdentifier];delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(i.payloadMessage);break;case l.SUBACK:var i=this._sentMessages[e.messageIdentifier];i&&(i.timeOut&&i.timeOut.cancel(),128===e.returnCode[0]?i.onFailure&&i.onFailure(e.returnCode):i.onSuccess&&i.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case l.UNSUBACK:var i=this._sentMessages[e.messageIdentifier];i&&(i.timeOut&&i.timeOut.cancel(),i.callback&&i.callback(),delete this._sentMessages[e.messageIdentifier]);break;case l.PINGRESP:this.sendPinger.reset();break;case l.DISCONNECT:this._disconnected(p.INVALID_MQTT_MESSAGE_TYPE.code,f(p.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(p.INVALID_MQTT_MESSAGE_TYPE.code,f(p.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(e){return void this._disconnected(p.INTERNAL_ERROR.code,f(p.INTERNAL_ERROR,[e.message,e.stack.toString()]))}},w.prototype._on_socket_error=function(e){this._disconnected(p.SOCKET_ERROR.code,f(p.SOCKET_ERROR,[e.data]))},w.prototype._on_socket_close=function(){this._disconnected(p.SOCKET_CLOSE.code,f(p.SOCKET_CLOSE))},w.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),ChatWebsocket.settings.onlineDebug&&console.log("sendType:"+e.type+" "+new Date+" "+(new Date).getTime()),this.sendPinger.reset()},w.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new v(l.PUBACK,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var i=new v(l.PUBREC,{messageIdentifier:e.messageIdentifier});this._schedule_message(i);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},w.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},w.prototype._disconnected=function(e,t){this._trace("Client._disconnected",e,t),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===e&&(e=p.OK.code,t=f(p.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t})):4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t}))},w.prototype._trace=function(){if(this.traceFunction){for(var e in arguments)void 0!==arguments[e]&&(arguments[e]=JSON.stringify(arguments[e]));var t=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:t})}if(null!==this._traceBuffer)for(var e=0,i=arguments.length;e<i;e++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===e?this._traceBuffer.push(arguments[e]):void 0===arguments[e]?this._traceBuffer.push(arguments[e]):this._traceBuffer.push("  "+JSON.stringify(arguments[e]))},w.prototype._traceMask=function(e,t){var i={};for(var a in e)e.hasOwnProperty(a)&&(i[a]=a==t?"******":e[a]);return i};var C=function(e,t,i,a){var n;if("string"!=typeof e)throw new Error(f(p.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){a=t,n=e;var s=n.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!s)throw new Error(f(p.INVALID_ARGUMENT,[e,"host"]));e=s[4]||s[2],t=parseInt(s[7]),i=s[8]}else{if(3==arguments.length&&(a=i,i="/mqtt"),"number"!=typeof t||t<0)throw new Error(f(p.INVALID_TYPE,[typeof t,"port"]));if("string"!=typeof i)throw new Error(f(p.INVALID_TYPE,[typeof i,"path"]));var o=-1!=e.indexOf(":")&&"["!=e.slice(0,1)&&"]"!=e.slice(-1);n="ws://"+(o?"["+e+"]":e)+":"+t+i}for(var r=0,c=0;c<a.length;c++){var l=a.charCodeAt(c);55296<=l&&l<=56319&&c++,r++}if("string"!=typeof a||r>65535)throw new Error(f(p.INVALID_ARGUMENT,[a,"clientId"]));var u=new w(n,e,t,i,a);this._getHost=function(){return e},this._setHost=function(){throw new Error(f(p.UNSUPPORTED_OPERATION))},this._getPort=function(){return t},this._setPort=function(){throw new Error(f(p.UNSUPPORTED_OPERATION))},this._getPath=function(){return i},this._setPath=function(){throw new Error(f(p.UNSUPPORTED_OPERATION))},this._getURI=function(){return n},this._setURI=function(){throw new Error(f(p.UNSUPPORTED_OPERATION))},this._getClientId=function(){return u.clientId},this._setClientId=function(){throw new Error(f(p.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return u.onConnectionLost},this._setOnConnectionLost=function(e){if("function"!=typeof e)throw new Error(f(p.INVALID_TYPE,[typeof e,"onConnectionLost"]));u.onConnectionLost=e},this._getOnMessageDelivered=function(){return u.onMessageDelivered},this._setOnMessageDelivered=function(e){if("function"!=typeof e)throw new Error(f(p.INVALID_TYPE,[typeof e,"onMessageDelivered"]));u.onMessageDelivered=e},this._getOnMessageArrived=function(){return u.onMessageArrived},this._setOnMessageArrived=function(e){if("function"!=typeof e)throw new Error(f(p.INVALID_TYPE,[typeof e,"onMessageArrived"]));u.onMessageArrived=e},this._getTrace=function(){return u.traceFunction},this._setTrace=function(e){if("function"!=typeof e)throw new Error(f(p.INVALID_TYPE,[typeof e,"onTrace"]));u.traceFunction=e},this.connect=function(e){if(e=e||{},d(e,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(f(p.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0===e.password&&void 0!==e.userName)throw new Error(f(p.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof x))throw new Error(f(p.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload,void 0===e.willMessage.destinationName)throw new Error(f(p.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(void 0===e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(f(p.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(f(p.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,a=0;a<e.hosts.length;a++){if("string"!=typeof e.hosts[a])throw new Error(f(p.INVALID_TYPE,[typeof e.hosts[a],"connectOptions.hosts["+a+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[a])){if(0==a)t=!0;else if(!t)throw new Error(f(p.INVALID_ARGUMENT,[e.hosts[a],"connectOptions.hosts["+a+"]"]))}else if(t)throw new Error(f(p.INVALID_ARGUMENT,[e.hosts[a],"connectOptions.hosts["+a+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(f(p.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(f(p.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!=e.ports.length)throw new Error(f(p.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));e.uris=[];for(var a=0;a<e.hosts.length;a++){if("number"!=typeof e.ports[a]||e.ports[a]<0)throw new Error(f(p.INVALID_TYPE,[typeof e.ports[a],"connectOptions.ports["+a+"]"]));var s=e.hosts[a],o=e.ports[a],r=-1!=s.indexOf(":");n="ws://"+(r?"["+s+"]":s)+":"+o+i,e.uris.push(n)}}}u.connect(e)},this.subscribe=function(e,t){if("string"!=typeof e)throw new Error("Invalid argument:"+e);if(t=t||{},d(t,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(void 0!==t.qos&&0!==t.qos&&1!==t.qos&&2!==t.qos)throw new Error(f(p.INVALID_ARGUMENT,[t.qos,"subscribeOptions.qos"]));u.subscribe(e,t)},this.unsubscribe=function(e,t){if("string"!=typeof e)throw new Error("Invalid argument:"+e);if(t=t||{},d(t,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");u.unsubscribe(e,t)},this.send=function(e,t,i,a){var n;if(0==arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof x)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(n=e,void 0===n.destinationName)throw new Error(f(p.INVALID_ARGUMENT,[n.destinationName,"Message.destinationName"]));u.send(n)}else n=new x(t),n.destinationName=e,arguments.length>=3&&(n.qos=i),arguments.length>=4&&(n.retained=a),u.send(n)},this.disconnect=function(){u.disconnect()},this.getTraceLog=function(){return u.getTraceLog()},this.startTrace=function(){u.startTrace()},this.stopTrace=function(){u.stopTrace()},this.isConnected=function(){return u.connected}};C.prototype={get host(){return this._getHost()},set host(e){this._setHost(e)},get port(){return this._getPort()},set port(e){this._setPort(e)},get path(){return this._getPath()},set path(e){this._setPath(e)},get clientId(){return this._getClientId()},set clientId(e){this._setClientId(e)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(e){this._setOnConnectionLost(e)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(e){this._setOnMessageDelivered(e)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(e){this._setOnMessageArrived(e)},get trace(){return this._getTrace()},set trace(e){this._setTrace(e)}};var x=function(e){var t;if(!("string"==typeof e||e instanceof ArrayBuffer||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array))throw f(p.INVALID_ARGUMENT,[e,"newPayload"]);t=e,this._getPayloadString=function(){return"string"==typeof t?t:c(t,0,t.length)},this._getPayloadBytes=function(){if("string"==typeof t){var e=new ArrayBuffer(o(t)),i=new Uint8Array(e);return r(t,i,0),i}return t};var i=void 0;this._getDestinationName=function(){return i},this._setDestinationName=function(e){if("string"!=typeof e)throw new Error(f(p.INVALID_ARGUMENT,[e,"newDestinationName"]));i=e};var a=0;this._getQos=function(){return a},this._setQos=function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);a=e};var n=!1;this._getRetained=function(){return n},this._setRetained=function(e){if("boolean"!=typeof e)throw new Error(f(p.INVALID_ARGUMENT,[e,"newRetained"]));n=e};var s=!1;this._getDuplicate=function(){return s},this._setDuplicate=function(e){s=e}};return x.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(e){this._setDestinationName(e)},get qos(){return this._getQos()},set qos(e){this._setQos(e)},get retained(){return this._getRetained()},set retained(e){this._setRetained(e)},get duplicate(){return this._getDuplicate()},set duplicate(e){this._setDuplicate(e)}},{Client:C,Message:x}}(window);var Proto=ProtobufMessage.prototype;Proto.init=function(){if("undefined"==typeof dcodeIO||!dcodeIO.ProtoBuf)throw new Error("ProtoBuf.js is not present. Please see www/index.html for manual setup instructions.");var e=dcodeIO.ProtoBuf;Proto.chatProto=e.loadProtoFile(INTERFACE_URLS.chatProtoUrl),Proto.createMessage.init()},Proto.decode=function(e){return Proto.createMessage.build.chatProtocol.decode(e)},Proto.createMessage={init:function(){this.build={chatProtocol:Proto.chatProto.build("TechwolfChatProtocol"),message:Proto.chatProto.build("TechwolfMessage"),messageSync:Proto.chatProto.build("TechwolfMessage"),messageRead:Proto.chatProto.build("TechwolfMessageRead"),presence:Proto.chatProto.build("TechwolfPresence"),user:Proto.chatProto.build("TechwolfUser"),body:Proto.chatProto.build("TechwolfMessageBody"),clientInfo:Proto.chatProto.build("TechwolfClientInfo"),iq:Proto.chatProto.build("TechwolfIq")}},model:{chatProtocol:function(e){var t=new Proto.createMessage.build.chatProtocol;return t.setType(e),t},
message:function(e,t,i,a,n,s){var o=new Proto.createMessage.build.message;return o.setType(e),o.setMid(t,!0),o.setCmid(t,!0),o.setFrom(i),o.setTo(a),o.setBody(n),s&&o.setTaskId(s,!0),o},messageSync:function(e,t){var i=new Proto.createMessage.build.messageSync;return i.setClientMid(e,!0),i.setServerMid(t,!0),i},messageRead:function(e,t,i){var a=new Proto.createMessage.build.messageRead,n=i||0;return a.setUserId(e,!0),a.setUserSource(n,!0),a.setMessageId(t,!0),a.setReadTime((new Date).getTime(),!0),a},presence:function(e){var t=new Proto.createMessage.build.presence,i=new Proto.createMessage.build.clientInfo,a=e.clientInfo;return t.setUid(_PAGE.uid,!0),t.setType(e.type),t.setLastMessageId(e.lastMessageId,!0),i.setVersion(a.version),i.setSystem(a.system),i.setSystemVersion(a.systemVersion),i.setModel(a.model),i.setUniqid(a.uniqid),i.setNetwork(a.network),i.setAppid(a.appid),i.setPlatform(a.platform),i.setChannel(a.channel),i.setSsid(a.ssid),i.setBssid(a.bssid),i.setLongitude(a.longitude),i.setLatitude(a.latitude),t.setClientInfo(i,!0),t},user:function(e,t,i){var a=new Proto.createMessage.build.user,n=i||0;return a.setUid(e||0,!0),a.setSource(n),e&&t&&a.setName(t),a},body:function(e,t){var i=new Proto.createMessage.build.body;return i.setType(e),i.setTemplateId(t),i},iq:function(e){var t=new Proto.createMessage.build.iq;return t.params=e,t.qid=1,t.query="/message/suggest",t}},action:function(e){var t=this.model,i=t.user(e.from.uid,e.from.encryptUid,e.from.source),a=t.user(e.to.uid,e.to.encryptUid,e.to.source),n=t.body(4,1);n.setText(e.body.text),n.setAction(e.body.action);var s=t.message(e.type||1,e.tempID,i,a,n),o=t.chatProtocol(1);return o.setMessages([s]),o},text:function(e){var t=this.model,i=t.user(e.from.uid,e.from.encryptUid,e.from.source),a=t.user(e.to.uid,e.to.encryptUid,e.to.source),n=t.body(1,1);n.setText(e.body.text);var s=t.message(e.type||1,e.tempID,i,a,n,e.taskId),o=t.chatProtocol(1);return o.setMessages([s]),o},graphic:function(e){var t=this.model,i=t.user(e.from.uid,e.from.encryptUid,e.from.source),a=t.user(e.to.uid,e.to.encryptUid,e.to.source),n=t.body(20,1);n.setText(e.body.text),n.setSticker(e.body.sticker);var s=t.message(e.type||1,e.tempID,i,a,n),o=t.chatProtocol(1);return o.setMessages([s]),o},image:function(e){var t=this.model,i=t.user(e.from.uid,e.from.encryptUid,e.from.source),a=t.user(e.to.uid,e.to.encryptUid,e.to.source),n=t.body(3,1);n.setImage(e.body.image);var s=t.message(e.type||1,e.tempID,i,a,n),o=t.chatProtocol(1);return o.setMessages([s]),o},sync:function(e){var t=this.model,i=t.messageSync(e.clientMid,e.serverMid),a=t.chatProtocol(5);return a.setMessageSync([i]),a},read:function(e){var t=this.model,i=t.messageRead(e.uid,e.mid,e.userSource),a=t.chatProtocol(6);return a.setMessageRead([i]),a},presence:function(e){var t=this.model,i=t.presence(e),a=t.chatProtocol(2);return a.setPresence(i),a},iq:function(e){var t=this.model,i=t.chatProtocol(3),a=t.iq(e);return i.iq=a,i}};var Emotion={data:["微笑","撇嘴","色","发呆","得意","流泪","害羞","闭嘴","叹气","睡","尴尬","发怒","调皮","呲牙","惊讶","难过","酷","冷汗","抓狂","吐","偷笑","愉快","白眼","傲慢","饥饿","困","惊恐","流汗","憨笑","悠闲","奋斗","咒骂","疑问","嘘","晕","疯了","衰","骷髅","敲打","再见","擦汗","抠鼻","鼓掌","糗大了","坏笑","左哼哼","右哼哼","哈欠","鄙视","委屈","快哭了","阴险","亲亲","吓","可怜","开心","满意","不高兴","生病","笑哭","皱眉","幽灵","恶魔","高兴","菜刀","西瓜","啤酒","篮球","乒乓","咖啡","饭","面条","猪头","玫瑰","凋谢","嘴唇","爱心","心碎","蛋糕","闪电","炸弹","刀","足球","瓢虫","便便","月亮","太阳","礼物","拥抱","强","弱","握手","胜利","抱拳","勾引","拳头","差劲","爱你","NO","OK"],init:function(){Emotion.getRecebtEmtion();var e,t,i="",a=Publisher.editor.find(".emotion");if(!a.length){for(e=0;e<Emotion.data.length;e++)t=Emotion.data[e],i+='<li><button class="emoj emoj-'+(e+1)+'" data-key="['+t+']" title="'+t+'"></button></li>';var n='<div class="emotion"><div class="emotion-box"><ul class="hide animoji-box"></ul><ul class="loaded">'+i+'</ul><ul class="hide animoji-box"></ul><ul class="hide animoji-box"></ul><ul class="hide animoji-box"></ul><ul class="hide animoji-box"></ul></div><div class="emotion-tab">'+Emotion.getEmotionTabView()+"</div></div>";Publisher.editor.append(n),Emotion.showEmotion();var s=Publisher.editor.find(".emotion .emotion-box");Publisher.editor.find(".emotion .emotion-tab").find(".emotion-sort").on("click",function(){var e=$(this),t=e.index(),i=s.find("ul").eq(t);i.hasClass("loaded")&&0!=t||i.html(Emotion.getEmotionListView(t)).addClass("loaded"),i.removeClass("hide").siblings().addClass("hide"),e.addClass("selected").siblings().removeClass("selected");var a=["recent_emoji","face_emoji","my_emoji","zhizhi_emoji","bird_emoji","zhizhi_emoji2"];try{_T.sendEvent(a[t])}catch(e){}}),$(document).on("click",function(e){$(e.target).hasClass("btn-emotion")||$(e.target).parents(".btn-emotion").length||$(e.target).parents(".emotion").length||Emotion.hideEmotion()}),Publisher.editor.find(".emotion").on("click",".emoj",function(){var e=$(this);Emotion.chooseEmotion(e)}),Publisher.editor.find(".emotion").on("click",".animoji",function(){var e=$(this);Emotion.chooseAnimojiEmotion(e)})}a.show()},emotionTypeData:[{type:"recent",className:"emotion-recent",data:[]},{type:"default",className:"emotion-default"},{packId:0,type:"like",className:"emotion-like",data:[]},{packId:1,type:"zhi",className:"emotion-zhi",data:[]},{packId:2,type:"veteran",className:"emotion-veteran",data:[]},{packId:3,type:"zhi2",className:"emotion-zhi2",data:[]}],getEmotionTabView:function(){var e="",t=Emotion.emotionTypeData;return $.each(t,function(t,i){e+='<div class="emotion-sort '+(1==t?"selected emotion-default":"")+'"><button class="'+i.className+'"></button></div>'}),e},getEmotionListView:function(e){var t="",i=Emotion.emotionTypeData[e].data;if(i.length)for(var a=0;a<i.length;a++){var n="";3!=e&&4!=e&&5!=e||(n="<span>"+i[a].name+"</span>"),t+='<li class="animoji-item"><button data-width="'+i[a].origWidth+'" data-height="'+i[a].origHeight+'" data-url="'+i[a].origUrl+'" data-packId="'+i[a].packId+'" data-sid="'+i[a].itemId+'" class="animoji" title="'+i[a].name+'"><img src="'+i[a].tinyUrl+'"/></button>'+n+"</li>"}return t},showEmotion:function(){Publisher.editor.find(".emotion").show()},hideEmotion:function(){Publisher.editor.find(".emotion").hide()},textCodeToImg:function(e){if(!e)return"";var t,i=e.match(/\[[a-zA-Z\u4e00-\u9fa5]{1,3}\]/g);if(!i)return e;for(t=0;t<i.length;t++){var a,n=i[t].replace(/[\[\]]/g,""),s=Emotion.data.indexOf(n);a=s>-1?'<i class="emoj emoj-'+(s+1)+'" title="'+n+'"></i>':"睡"==n?'<i class="emoj emoj-10" title="'+n+'"></i>':"大哭"==n?'<i class="emoj emoj-6" title="'+n+'"></i>':"不说话"==n?'<i class="emoj emoj-8" title="'+n+'"></i>':"["+n+"]",a&&(e=e.replace(i[t],a))}return e},getRecebtEmtion:function(){var e=[],t=_PAGE.uid+"emotionsBoss";window.localStorage&&window.localStorage.getItem(t)&&(e=JSON.parse(window.localStorage.getItem(t))),Emotion.emotionTypeData[0].data=e},chooseEmotion:function(e){var t=e,i=t.attr("class").split("emoj-")[1],a="https://static.zhipin.com/library/emotions/2x/Expression_"+i+"@2x.png";Publisher.editorInput.find("img:not(.emoj-insert)");Publisher.inserCurosrHtml(a,t.attr("data-key")),Emotion.hideEmotion(),Publisher.submitBtn.removeClass("btn-disabled"),Publisher.editorInput.focus(),Chat.saveDraft();try{_T.sendEvent("send_emoji_face_"+i)}catch(e){}},chooseAnimojiEmotion:function(e){if(!e.hasClass("disabled")){e.addClass("disabled");var t=e.attr("data-packId"),i=e.attr("data-sid"),a=e.attr("title"),n=e.attr("data-url"),s=e.find("img").attr("src"),o=Number(e.attr("data-width")),r=Number(e.attr("data-height")),c={packId:t,sid:i,name:a,image:{originImage:{height:r,width:o,url:n}}};Publisher.sendText(null,"[动画表情]",c),Emotion.hideEmotion(),e.removeClass("disabled");for(var l=Emotion.emotionTypeData[0].data,d={packId:t,itemId:i,name:a,origUrl:n,tinyUrl:s,origWidth:o,origHeight:r},u=0;u<l.length;u++)d.itemId==l[u].itemId&&l.splice(u,1);l.unshift(d),l.length>8&&l.splice(8,10);var p=_PAGE.uid+"emotionsBoss";window.localStorage&&window.localStorage.setItem(p,JSON.stringify(l)),Emotion.emotionTypeData[0].data=l;var h=e.parents("ul").index(),f=["recent","face","my","zhizhi","bird"];try{_T.sendEvent("send_emoji_face_"+f[h])}catch(e){}}},storeEmotion:function(e){if(!e.hasClass("disabled")){e.addClass("disabled");var t=e.attr("data-sid"),i=Publisher.editor.find(".emotion .emotion-box ul").eq(2);$.ajax({type:"get",url:"/sticker/favorite.json",data:{itemId:t},success:function(a){1==a.code?($.toast({content:"添加成功",type:"success"}),i.length&&Emotion.getSticker(i),Chat.chatListCon.find('span.btn-sore[data-sid="'+t+'"]').remove(),Chat.storedEmtions.push({itemId:t}),e.addClass("hidden")):($.toast({content:a.message,type:"error"}),0==a.code&&"用户已经添加该表情"==a.message&&(Chat.chatListCon.find('span.btn-sore[data-sid="'+t+'"]').remove(),Chat.storedEmtions.push({itemId:t})),8e3!=a.code&&e.addClass("hidden")),e.removeClass("disabled")},error:function(){e.removeClass("disabled")}});try{_T.sendEvent("add_emoji")}catch(e){}}},getSticker:function(e){var t=$.Deferred();return $.ajax({type:"get",url:"/wapi/zpchat/sticker/get/sticker",success:function(i){if(0==i.code){var a=i.zpData.packs;$.each(a,function(e,i){var a=i.packId+2;Emotion.emotionTypeData[a]&&(Emotion.emotionTypeData[a].data=i.items),0==i.packId&&t.resolve(i.items)}),e&&e.html(Emotion.getEmotionListView(2)).addClass("loaded")}}}),t}},InterviewTemplate=function(){var e=function(e){return Utemplate('<form class="form-check interview-wrap interview-invitation"><input type="hidden" name="_token" value=""><div class="interview-article">发送面试邀请</div><%if(this.brokenAppointment){%><div class="interview-notice"><i class="icon-unbelievable"></i>该牛人近期有面试爽约的不良记录，请注意！</div><%}else{%><div class="interview-notice"><i class="icon-believable"></i>对方没有面试爽约的不良记录，请放心约面试</div><%}%><table class="data-manage"><tr class="interview-position"><td class="t"><i class="icon-interview icon-position"></i></td><td><div class="dropdown-wrap dropdown-position"><input type="hidden" value="0" name="jobid" class="required" data-blank="必填"><span class="dropdown-select ipt">选择职位</span><div class="dropdown-menu"><ul></ul></div></div></td></tr><tr><td class="t"><i class="icon-interview icon-time"></i></td><td><div class="dropdown-wrap dropdown-hour"><span class="dropdown-select"><input type="text" class="ipt ipt-datetimepicker" name="date" data-type="y-m-d" data-format="yyyy-mm-dd" placeholder="选择面试时间" readonly autocomplete="off"></span></div><div class="dropdown-wrap dropdown-minute" data-fill="false"><span class="dropdown-select"><input type="text" placeholder="请选择" value="9:00" class="ipt" readonly><input type="hidden" value="9" name="hour" class="required" data-blank="必填"><input type="hidden" value="0" name="minute" class="required" data-blank="必填"></span><div class="dropdown-menu"><ul></ul></div></div></td></tr><tr class="interview-address"><td class="t"><i class="icon-interview icon-address"></i></td><td><p class="tip-address">请先选择职位</p></td></tr><tr><td class="t t-top"><i class="icon-interview icon-description"></i></td><td><div class="sub-title">备注事项</div><div class="ipt-wrap"><textarea name="other" class="ipt ipt-area" data-range="0,140" placeholder="选填，最多140字"></textarea><span class="count-num"></span></div></td></tr></table></form><div class=""></div>',e)},t=function(e){return Utemplate('<div class="interview-wrap <%this.style%>"><div class="interview-article"><div class="btn-box"><%if(this.showEdit){%><a href="javascript:;" class="op-edit" data-uid="<%this.interviewInfo.geekId%>"><i class="iboss-edit"></i><div class="tooltip"><p class="gray">编辑</p></div></a><%}%><%if(this.showCancel){%><a href="javascript:;" class="op-cancel" data-uid="<%this.interviewInfo.geekId%>" data-status="<%this.status%>" data-id="<%this.interviewInfo.interviewId%>"><i class="iboss-close-hollow"></i><div class="tooltip"><p class="gray">取消面试</p></div></a><%}%><%if(this.showForward){%><a href="javascript:;" class="op-forward" data-uid="<%this.interviewInfo.geekId%>" data-id="<%this.interviewInfo.interviewId%>"><i class="iboss-zhuanfa"></i><div class="tooltip"><p class="gray">转发</p></div></a><%}%><%if(this.showAbsent){%><a href="javascript:;" class="op-absent" data-uid="<%this.interviewInfo.geekId%>" data-id="<%this.interviewInfo.interviewId%>"><i class="iboss-niurenmeilai"></i><div class="tooltip"><p class="gray">牛人没来</p></div></a><%}%></div><%this.article%></div><table class="data-manage"><tbody><tr><td class="t"><i class="icon-interview icon-position"></i></td><td><%this.interviewInfo.jobName%></td></tr><tr><td class="t"><i class="icon-interview icon-time"></i></td><td><%this.interviewInfo.time%></td></tr><tr class="interview-address"><td class="t"><i class="icon-interview icon-address"></i></td><td><p class="tip-address"><%this.interviewInfo.jobAddress%></p></td></tr><%if(this.interviewInfo.addition != ""){%><tr><td class="t"><i class="icon-interview icon-description"></i></td><td><div class="interview-addition"><%this.interviewInfo.addition%></div></td></tr><%}%></tbody></table><%if(this.showReInterview){%><div><span ka="chat_interview_resend" class="btn btn-block J_reInvite">重新发送面试邀请</span></div><%}%></div>',e)},i=function(e){return Utemplate('<div class="interview-hint"><dl><dt><%this.article%></dt><dd class="gray"><%this.description%></dd></dl></div>',e)};return{invitation:e,condition:t,hint:function(){return'<div class="interview-hint"><p class="article">约面试·诚信协议</p><ul class="gray"><li>面试前6小时，双方可以申请取消 </li><li>如不取消，请按时出席，不要爽约 </li><li>对方爽约，可以在平台内投诉</li><li>爽约一方，平台会打「不良记录」并公示</li></ul><div class="gray">为方便联系，约面试后双方自动交换手机联系方式。</div></div>'},success:function(){return'<div class="interview-success-content"><p class="icon-interview-success"></p><p class="interview-article">面试邀请已发送</p><p class="interview-description">请您等待牛人接受面试邀请</p><p class="interview-transpond">转发面试安排</p></div>'},warning:i}}(),Publisher={init:function(){Publisher.editor=$(".chat-editor"),Publisher.editorControls=Publisher.editor.find(".chat-controls"),Publisher.editorInput=Publisher.editor.find(".chat-message"),Publisher.editorPlaceholder=Publisher.editor.find(".chat-placholder"),Publisher.submitBtn=Publisher.editor.find(".btn-send"),Publisher.menuWrap=$(".chat-container .data-menu"),Publisher.privilege={},Publisher.files={},_PAGE.runChat&&(Publisher.editor.find(".chat-op").removeAttr("ka"),Publisher.editorInput.removeAttr("ka")),Publisher.editorControls.on("mouseover","a",function(e){$(e.target).hasClass("tips")||$(e.target).parents().hasClass("tips")||(Chat.checkUserBlock()&&["link-communication","link-pass","link-fail"].indexOf($(this).attr("class"))>-1?$(this).find("span").text("该牛人不会发送自动回复"):Chat.checkUserBlock()&&$(this).find("span").attr("data-text")?$(this).find("span").text("与牛人进一步沟通需使用道具"):$(this).find("span").attr("data-text")&&$(this).find("span").text($(this).find("span").attr("data-text")),$(this).find('span[class!="no"]').show())}),Publisher.editorControls.on("mouseleave","a",function(){$(this).find('span[class!="no"]').hide()}),Publisher.editorControls.on("click","a",function(e){var t=$(this);if(!$(this).parent().hasClass("links")||$(this).hasClass("btn-interview")){var i=$(this).attr("class");if(Chat.checkUserBlock()&&["btn-position","btn-transmit-resume"].indexOf(i)<0&&!$(this).hasClass("disabled"))return GeekHotProp.shop(Chat.curUserData.infoData.page,{callBack:Chat.ublockBlockGeek});switch(i){case"btn-emotion":t.find("span").hide(),Emotion.init();break;case"btn-dict":t.find("span").hide(),Publisher.showSentence(t);break;case"btn-transmit-resume":t.find("span").hide(),t.find(".tips").hide(),Publisher.showTransmitCode(t);break;case"btn-contact":Publisher.showExchangePhone(t);break;case"btn-weixin":Publisher.showExchangeWeixin(t);break;case"btn-resume":Publisher.showExchangeResume(t);break;case"btn-transmit":$.dialog({title:"",content:'<div class="transmit-con"><div class="transmit-title">把<span class="text-blue"></span>推荐给同事</div><div class="transmit-list"><ul></ul></div><div class="transmit-op"><p><textarea class="ipt ipt-area" name="shareNote">此人文武双全，你一定要看看啊！</textarea></p><p class="tip-text"><label class="checkbox"><input type="checkbox" name="canShareMsg" /><span>连同聊天记录一并转发</span></label></p></div></div>',closeText:!0,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-chat-default dialog-chat-transmit",lock:!0,element:t,onOpen:function(e){var t=e,i=t.find(".transmit-list ul");t.find(".transmit-title .text-blue").text(Chat.curUserData.name),i.html('<li class="loading-tips"><i class="icon-toast-loading"></i><span>加载同事数据中</span></li>'),$.ajax({type:"GET",url:"/chat/brandUserList.json",dataType:"JSON",data:{geek:Chat.curUserData.encryptUid,page:1,pageSize:100},success:function(a){var n,s,a=a,o="";if(1==a.rescode)if(a.canShareMsg||(e.find(".checkbox").hide(),e.find('input[name="canShareMsg"]').attr("checked",!1)),n=a.data,n.length){for(s=0;s<n.length;s++)o+='<li data-uid="'+n[s].encryptUserId+'"><img src="'+n[s].tiny+'" /><span class="name">'+n[s].name+"</span></li>";i.find(".loading-tips").remove(),i.append(o),t.find(".dialog-container").css({"margin-top":-t.find(".dialog-container").outerHeight()/2+"px"}),t.find(".dialog-container").height()>window.innerHeight-40&&(e.css({position:"absolute"}),t.find(".dialog-container").css({top:$(window).scrollTop()+"px","margin-top":"44px"}))}else i.find(".loading-tips").html("暂无同事");else i.find(".loading-tips").html("暂无同事")},error:function(e){$.toast({content:"获取同事数据失败，请稍后再试",type:"error"})}}),i.on("click","li",function(){var e=$(this);e.attr("data-uid");e.hasClass("loading-tips")||(e.parent().find("li").removeClass("checked"),e.find(".fz-check").length||e.append('<i class="fz fz-check"></i>'),e.addClass("checked"))})},onConfirm:function(e){var t=e,i=t.find(".transmit-list li.checked"),a=i.attr("data-uid"),n=t.find('input[name="canShareMsg"]:checked'),s=n.length?1:0,o=t.find('textarea[name="shareNote"]').val(),r=t.find(".btn-sure");return a?""==o?($.toast({content:"请填写推荐评语",type:"warning"}),!1):(r.css("pointer-events","none"),$.ajax({type:"POST",url:"/chat/shareGeek.json",dataType:"JSON",data:{toId:a,geekId:Chat.curUserData.encryptUid,shareNote:o,expectId:Chat.curUserData.infoData.expectId,canShareMsg:s},success:function(e){var e=e;1==e.rescode?$.toast({content:"转发成功",type:"success"}):$.toast({content:"转发失败",type:"error"}),r.css("pointer-events","initial")},error:function(e){$.toast({content:"发送失败",type:"error"}),r.css("pointer-events","initial")}}),void e.remove()):($.toast({content:"请选择同事",type:"warning"}),!1)},onClose:function(e){}});break;case"btn-interview":Publisher.interview(t,"dialog-up-default");break;case"btn-video":$.dialog({title:"",content:"确认向牛人发起视频面试吗？",closeText:!1,wrapClass:"dialog-around-default dialog-up-default dialog-sure-interview-online",element:t,position:"around",opacityLock:!0,onConfirm:function(e){mediator.publish("INTERVIEW_ACTION",{type:"call",kind:"video",geekId:Chat.curUserData.uid,jobId:Chat.curUserData.jobId,expectId:Chat.curUserData.expectId}),e.remove()}});break;case"btn-audio":$.dialog({title:"",content:"确定向牛人发起语音通话吗？",closeText:!1,wrapClass:"dialog-around-default dialog-up-default dialog-sure-interview-online",element:t,position:"around",opacityLock:!0,onConfirm:function(e){mediator.publish("INTERVIEW_ACTION",{type:"call",kind:"audio",geekId:Chat.curUserData.uid,jobId:Chat.curUserData.jobId,expectId:Chat.curUserData.expectId}),e.remove()}});break;case"btn-message":NodeMessage.use(Chat.curUserData,{sourceType:1})}}});var e="按Enter键发送，按Ctrl+Enter键换行";isIE&&(e="按Enter键发送，按shift+Enter键换行",Publisher.editor.find(".chat-op .tip").text(e)),Publisher.editorInput.on("keyup",function(t){var i=Publisher.filterPicture($(this).html()),a=Publisher.htmlConverToMessage(i.html);if(!i.picIds)return""!=a.replace(/[\n\s]/g,"")?void Publisher.submitBtn.removeClass("btn-disabled"):void Publisher.submitBtn.addClass("btn-disabled");Publisher.submitBtn.removeClass("btn-disabled"),a.length>1e3?(Publisher.editor.find(".tip").text("您输入的内容过长，请删减后再发送").addClass("error-tip"),Publisher.submitBtn.addClass("btn-disabled")):(Publisher.editor.find(".tip").text(e).removeClass("error-tip"),Publisher.submitBtn.removeClass("btn-disabled"))});try{document.execCommand("AutoUrlDetect",!1,!1)}catch(e){}Publisher.editorInput.on("paste",function(e){var t=null,i=null;if(window.clipboardData&&clipboardData.setData)t=window.clipboardData.getData("text");else{var a=(e.originalEvent||e).clipboardData,n=a.items;$.each(n,function(e,n){switch(n.kind){case"file":"image/png"===n.type&&(i=n.getAsFile());break;case"string":"text/plain"===n.type&&(t=a.getData("text/plain"));break;default:t=a.getData("text/plain")}})}if(document.body.createTextRange){if(document.selection)textRange=document.selection.createRange();else if(window.getSelection){var s=window.getSelection(),o=s.getRangeAt(0),r=document.createElement("span");r.innerHTML="&#FEFF;",o.deleteContents(),o.insertNode(r),textRange=document.body.createTextRange(),textRange.moveToElementText(r),r.parentNode.removeChild(r)}textRange.text=t,textRange.collapse(!1),textRange.select()}else{if(t){var c=document.createElement("div");c.innerText=t,document.execCommand("insertHTML",!1,c.innerHTML),c=null}if(i){var l=new FileReader;l.onload=function(e){var t="pic_"+Date.now()+"_1",a=new Image;a.src=e.target.result,Publisher.editorInput.append($(a).attr("title","[图片]").attr("pic-id",t).addClass("picture-insert")),Publisher.files[t]={},Publisher.files[t].file=i,Publisher.files[t].base64=e.target.result},l.readAsDataURL(i)}(""!=t||i)&&Publisher.submitBtn.removeClass("btn-disabled")}e.preventDefault()}),Publisher.editorInput.bind("keydown",function(e){13==e.which&&(e.ctrlKey||e.shiftKey?e.ctrlKey&&(/Apple/.test(navigator.vendor)||document.execCommand("insertText",!1,"\n")):(Publisher.sendText(),e.preventDefault())),""!=Publisher.editorInput.html()&&Publisher.editorPlaceholder.hide()});var t=function(){if(Chat.checkUserBlock()&&(Publisher.editorInput.text().length>0||Publisher.editorInput.children().length>0))Publisher.editor.find(".chat-op .tip").text("【技术类牛人】需使用道具与牛人继续沟通");else{var e="按Enter键发送，按Ctrl+Enter键换行";isIE&&(e="按Enter键发送，按shift+Enter键换行"),Publisher.editor.find(".chat-op .tip").text(e)}};Publisher.editorInput.bind("input",function(e){t(),Chat.saveDraft()}),Publisher.editorInput.bind("focus",function(e){Publisher.editorPlaceholder.hide(),t()}),Publisher.editorInput.bind("blur",function(e){""!=Publisher.editorInput.html()&&"<br>"!=Publisher.editorInput.html()||Publisher.editorPlaceholder.show()}),Publisher.editorInput.on("click",function(){if(_PAGE.runChat)try{_T.sendEvent("Geekchat_input_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid)}catch(e){}}),Publisher.editorInput.on("dblclick",".picture-insert",function(){Chat.viewLargeImage($(this))}),Publisher.editorPlaceholder.on("click",function(){Publisher.editorPlaceholder.hide(),Publisher.editorInput.focus()}),Publisher.editorControls.on("click",function(e){$(e.target).closest("a").length||(Publisher.editorPlaceholder.hide(),Publisher.editorInput.focus())}),Publisher.editorControls.find("a").each(function(){if($(this).attr("ka")){var e=$(this).attr("ka"),t=e.split("_")[2];_PAGE.runChat&&$(this).data("optype",t).removeAttr("ka")}}).on("click",function(){var e=$(this).data("optype");if(_PAGE.runChat&&!Chat.curUserData.groupId)try{_T.sendEvent("Geekchat_"+e+"_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid)}catch(e){}else __conversion("group_chat_enmoji")}),Publisher.submitBtn.on("click",function(e){Publisher.sendText()}),$(document).on("click",function(e){$(e.target).hasClass("btn-dict")||$(e.target).parents(".sentence-pannel").length||Publisher.editor.find(".sentence-pannel").remove()}),$(window).on("resize",function(){$(".dialog-around-default").is(":visible")&&$(".dialog-around-default").hide()})},getState:function(e){$.get("/wapi/zpblock/vip/state",function(t){Publisher.privilege=$.extend({},t.zpData);var i=Publisher.privilege.vipFriendFilterState,a=Publisher.privilege.friendFilterSetState,n=Chat.usersID.filter(function(e){return Chat.getGeekById(e.gid,e.friendSource).newMsgCount}),s=Chat.usersID.filter(function(e){return Chat.usersData[e.uid].isFiltered}),o=PageSet.settings("vip-filter-tip"),r=PageSet.settings("vip-filter-not-set");if(2===i&&(!o||(new Date).getTime()-o>864e5)&&n.length>49){$(".sec-content").addClass("vip-filter-tap");var c=$('<div class="vip-filter-bar"><i class="i-vip-close"></i><i class="iboss-left"></i><i class="icon-vip"></i>特权可自动过滤不符合要求的牛人</div>');c.insertAfter($(".chat-search"))}else if(1===i&&s.length>0&&!PageSet.settings("vip-filter-notice")){$(".sec-content").addClass("vip-filter-tap");var c=$('<div class="vip-filter-bar bought"><i class="i-vip-close"></i><span class="notice">您已开启消息过滤，可在"不符牛人"查看</span></div>');c.insertAfter($(".chat-search"))}else if(1===i&&0===a&&(!r||(new Date).getTime()-r>2592e5)&&n.length>49){$(".sec-content").addClass("vip-filter-tap");var c=$('<div class="vip-filter-bar not-set"><i class="i-vip-close"></i><span class="notice">您的VIP特权可自动过滤不想看的消息</span><span class="go-to-not-ok-geek">查看</span></div>');c.insertAfter($(".chat-search"))}return e(Publisher.privilege)})},interviewNotice:function(e,t){$.dialog({title:e.title,content:e.content,confirmText:e.confirmText,cancelText:e.cancelText||"我再想想",wrapClass:"dialog-wrap prop-consume interview-hint-wrap",inline:!0,onOpen:function(){},onConfirm:function(e){return e.remove(),t()},onClose:function(){}})},invitation:function(e,t,i){var a=function(e){for(var e=e||[],t=0;t<e.length;t++){var i=e[t],a=new Date(i.appointTime);i.year=a.getUTCFullYear(),i.month=a.getUTCMonth(),i.day=a.getUTCDate(),i.time=a.getHours()+":"+("0"+a.getMinutes()).substr(-2,2),i.date=i.year+"-"+("0"+(i.month+1)).substr(-2,2)+"-"+("0"+i.day).substr(-2,2)}return e};$.get("/wapi/zprelation/boss/interview/valid/list.json",function(n){var s=a(n.zpData);$.dialog({title:"",content:InterviewTemplate.invitation(i),closeText:!1,confirmText:"发送",cancelText:"取消",preKa:"",wrapClass:"dialog-around-default dialog-chat-default dialog-interview-default "+t,position:"around",inline:!1,lock:!0,element:e,opacityLock:!0,onOpen:function(e){Publisher.invitationOpen(e,i,s);var t=e.find("textarea[name=other]");if(t.length){var a=t,n=a.attr("data-range"),o=PageSet.getLength(a.val()),r=a.closest(".ipt-wrap").find(".count-num");n=n.split(","),r.html("<em"+(o>n[1]?' class="red"':"")+">"+o+"</em>/"+n[1]),t.on("input",function(){o=PageSet.getLength(String(a.val())),r.html("<em"+(o>n[1]?' class="red"':"")+">"+o+"</em>/"+n[1])})}},onConfirm:function(e){if(PageSet.getLength($.trim(e.find("textarea[name=other]").val()))>140)return $.toast({content:"备注事项不要超过140字",type:"error"}),!1;i.interviewInfo&&i.interviewInfo.edit?$.dialog({title:"确认更新面试内容吗？",content:'<div class="tip-text">更新后会取消原有面试，并向牛人重新邀约</div>',confirmText:"确定",cancelText:"取消",wrapClass:"dialog-icons-default",type:"warning",lock:!0,onConfirm:function(t){t.remove(),Publisher.invitationConfirm(e,i,s)}}):Publisher.invitationConfirm(e,i,s)},onClose:function(e){}})})},invitationOpen:function(e,t,i){Chat.jobData={},_self=e;var a=t.interviewInfo,n=function(){var e=new Date,t=$('.interview-invitation input[name="date"]').val(),i=e.getFullYear()+("0"+(e.getMonth()+1)).substr(-2,2)+("0"+e.getDate()).substr(-2,2);return t.replace(/-/g,"")===i},s=function(e,t){var i=e+t;return i%100>=60&&(i+=40),i},o=function(e){if(!n())return!0;var t=new Date,i=("0"+t.getHours()).substr(-2,2)+("0"+t.getMinutes()).substr(-2,2),a=parseInt(i,10),a=s(a,15),i=parseInt(e.replace(":",""),10);return i>a},r=function(e){var t=["8:00","8:30","9:00","9:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30"],i="",a=0;$.each(t,function(t,a){if(o(a)){i+="<li><span>"+a+"</span>";e.filter(function(e){return e.time==a}).length&&(i+="已约面试"),i+="</li>"}}),$(".interview-wrap .dropdown-minute .dropdown-menu ul").empty().html(i);var n=$(".interview-wrap .dropdown-minute .dropdown-menu li"),a=t.indexOf(n.eq(0).text())>2?0:2;n.eq(a).click()};if(e.find(".ipt-datetimepicker").length){var c=new Date,l=parseInt(c.getHours()+""+c.getMinutes()),d=new Date;d.setDate(d.getDate()+27),l>1830&&c.setDate(c.getDate()+1),nowYear=c.getFullYear(),nowMonth=c.getMonth()+1,nowThisDate=c.getDate();var u=null;if(e.find(".ipt-datetimepicker").each(function(){var e=$(this),t=$(this).attr("data-format")||"yyyy-mm-dd";a&&a.appointmentTime&&(!isNaN(a.appointmentTime)&&(a.appointmentTime=Number(a.appointmentTime)),u=new Date(a.appointmentTime),$(this).val(Chat.dateFormat(u,"yyyy-MM-dd"))),e.datetimepicker({format:t,startView:2,minView:2,inDate:i,autoclose:1,startDate:nowYear+"-"+nowMonth+"-"+nowThisDate,endDate:d,initialDate:u,todayBtn:0}).on("changeDate",function(){e.closest(".dropdown-wrap").removeClass("dropdown-menu-open");var t=$('.interview-invitation input[name="date"]').val(),a=i.filter(function(e){return e.date==t});r(a)})}),$(window).one("resize",function(){e.next(".datetimepicker").remove()}),r([]),u){var p=Chat.dateFormat(u,"h:mm");e.find(".dropdown-minute").find("li").filter(function(e,t){return $(t).find("span").text()===p}).addClass("cur").end().end().find("input[name=hour]").val(Chat.dateFormat(u,"h")).end().find("input[name=minute]").val(Chat.dateFormat(u,"mm")).end().find(".ipt").val(Chat.dateFormat(u,"h:mm"))}}$.ajax({type:"GET",url:"/chat/user/joblist.json",dataType:"JSON",data:null,success:function(t){var i,t=t,n="",s=_self.find('input[name="jobid"]');if(1==t.rescode){for(i=0;i<t.data.length;i++){var o=t.data[i].encryptId==Chat.curUserData.infoData.toPositionId;n+="<li "+(o?' class="cur"':"")+' data-val="'+t.data[i].jobId+'"><span class="job-salary">'+t.data[i].salaryDesc+'</span><span class="job-name">'+filterXss(t.data[i].jobName)+"</span></li>",Chat.jobData[t.data[i].jobId]||(Chat.jobData[t.data[i].jobId]={}),Chat.jobData[t.data[i].jobId].jobName=filterXss(t.data[i].jobName),Chat.jobData[t.data[i].jobId].address=filterXss(t.data[i].address),o&&(_self.find(".tip-address").html(filterXss(t.data[i].address)),s.val(t.data[i].jobId),s.parent().find(".dropdown-select").text(Chat.jobData[t.data[i].jobId].jobName))}t.data.length<1&&(n='<li class="disabled">没有在线职位</li>'),s.closest(".dropdown-wrap").find("ul").html(n),s.val(),s.closest(".dropdown-wrap").find("li").on("click",function(){var e=$(this).attr("data-val");_self.find(".tip-address").html(Chat.jobData[e].address),$(this).closest(".dropdown-position").find(".dropdown-select").text($(this).find(".job-name").text()),$(this).parent().find("li").removeClass("cur"),$(this).addClass("cur")}),_self.find('input[name="hour"]').closest(".dropdown-wrap").on("click","li",function(){var e=$(this).find("span").text(),t=e.split(":");$(this).closest(".dropdown-wrap").find('input[name="hour"]').val(t[0]),$(this).closest(".dropdown-wrap").find('input[name="minute"]').val(t[1]),$(this).closest(".dropdown-wrap").find('input[type="text"]').val(e)}),a&&a.jobId&&e.find(".interview-position ul").find("li[data-val="+a.jobId+"]").click()}},error:function(e){}}),DropDown.init(e),_self.find(".data-manage .tip-text .name").text(Chat.curUserData.name),$(e).on("click",".dropdown-position li",function(){$(e).find('input[name="jobid"]').val($(this).attr("data-val"))}),a&&a.addition&&e.find("textarea[name=other]").val(a.addition)},invitationConfirm:function(e,t,i){var a=e,n=a.find('input[name="jobid"]').val(),s=a.find('input[name="date"]').val(),o=a.find('input[name="hour"]').val(),r=a.find('input[name="minute"]').val(),c=a.find('textarea[name="other"]').val(),l=t.interviewInfo&&t.interviewInfo.edit?t.interviewInfo:{},d=l.geekId||Chat.curUserData.uid;if(""==n||"0"==n)return $.toast({content:"请选择职位",type:"warning"}),!1;if(""==s)return $.toast({content:"请选择面试时间",type:"warning"}),!1;if(""==o||""==r)return $.toast({content:"请选择时段",type:"warning"}),!1;if(PageSet.getLength($.trim(c.length))>140)return $.toast({content:"附加说明最多140字",type:"warning"}),!1;var u=function(){$.ajax({type:"POST",
url:"/wapi/zprelation/boss/interview/invite.json",dataType:"JSON",data:{jobname:Chat.jobData[n].jobName,jobid:n,date:s,hour:o,minute:r,address:Chat.jobData[n].address,other:c,uid:d,name:l.geekName||Chat.curUserData.name,sendmsg:0,interviewId:l.interviewId||l.id},success:function(e){var e=e;0==e.code&&$.dialog({title:"",content:InterviewTemplate.success(),confirmText:"",cancelText:"",inline:!0,wrapClass:"dialog-wrap interview-success-wrap",onOpen:function(t){$(t).on("click",".interview-transpond",function(){mediator.publish("FORWARD_GEEK",{type:"interview",interviewId:e.zpData||"",geek:Chat.curUserData.encryptUid,geekId:Chat.curUserData.encryptUid,expectId:Chat.curUserData.infoData.expectId,jobId:Chat.curUserData.jobId}),$(t).remove()})}}),0==e.code?(Chat.usersData[d]&&(Chat.usersData[d].isCloseInterview=!0),a.remove()):3==e.code?(Chat.usersData[d]&&(Chat.usersData[d].isCloseInterview=!0),Chat.showSystemMessage(d,e.resmsg),Publisher.editorControls.find(".btn-interview").addClass("disabled"),a.remove()):$.toast({content:e.message,type:"error"})},error:function(e){$.toast({content:"操作失败，请稍后再试",type:"error"})}})},p=function(){var e=o+":"+r,a=i.filter(function(t){return t.date==s&&t.time==e});if(t.brokenAppointment)Publisher.interviewNotice({title:"",content:InterviewTemplate.warning({article:"注意对方存在不良面试记录",description:"对方近期出现过面试爽约的不良记录，如您要给对方发送 面试要求，建议在面试前与对方再次确认。"}),confirmText:"发送面试邀请"},function(){u()});else if(a.length){var n=a[0];Publisher.interviewNotice({title:"",content:InterviewTemplate.warning({article:"面试时间冲突提醒",description:"你在 "+(n.month+1)+"月 "+n.day+" 日 "+n.time+" 已约 "+n.geekName+" 面试 "+n.jobName+" 职位，建议合理安排面试日程，避免时间冲突。"}),cancelText:"重选时间",confirmText:"继续"},function(){u()})}else u()};return function(){t.interviewCount<1||t.bossBrokenAppointment?Publisher.interviewNotice({title:"",content:InterviewTemplate.hint(),confirmText:"接受"},function(){p()}):p()}(),!1},interviewPublish:function(e,t,i){$.dialog({title:"",content:InterviewTemplate.condition(i),closeText:!1,confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-chat-default dialog-interview-default "+t,position:"around",inline:!1,lock:!0,element:e,opacityLock:!0,onOpen:function(t){t.on("click",".J_reInvite",function(){t.remove();var a=e.hasClass("btn-interview")?"dialog-up-default":"dialog-down-default interview-message-dialog",n=$.extend({},i);n.interviewInfo={},Publisher.invitation(e,a,n)}),t.on("click",".op-forward",function(){mediator.publish("FORWARD_GEEK",{type:"interview",interviewId:i.interviewInfo.interviewId||"",geek:Chat.curUserData.encryptUid,geekId:Chat.curUserData.encryptUid,expectId:Chat.curUserData.infoData.expectId,jobId:Chat.curUserData.jobId}),t.remove()}),t.on("click",".op-edit",function(){t.remove();var a=e.hasClass("btn-interview")?"dialog-up-default":"dialog-down-default interview-message-dialog";i.interviewInfo.edit=!0,Publisher.invitation(e,a,i)}),t.on("click",".op-cancel",function(){t.remove(),Publisher.cancelInterview($(this))}),t.on("click",".op-absent",function(){t.remove(),Publisher.geekAbsentInterview($(this))})},onConfirm:function(){},onClose:function(e){}})},geekAbsentInterview:function(e){var t=e.data("id");$.dialog({title:"牛人确认没来面试吗？",content:'<div class="tip-text">确认牛人没有参加面试后，可以在APP内投诉牛人爽约</div>',confirmText:"确定",cancelText:"取消",wrapClass:"dialog-icons-default",type:"warning",lock:!0,onConfirm:function(e){$.ajax({url:"/wapi/zprelation/boss/interview/feedback.json",type:"post",dataType:"json",data:{interviewId:t,feedback:3},success:function(e){0===e.code?$.toast({content:"反馈成功",type:"success"}):$.toast({content:e.message,type:"success"})},error:function(){$.toast({content:"服务器异常",type:"error"})}}),e.remove(),$(".interview-overlays").remove()}})},cancelInterview:function(e){var t=e.data("status");if([7].indexOf(t)>=0)return $.toast({content:"面试前6小时不可取消面试",type:"error"}),!0;var i=0===t?'<div class="tip-text">对面没有接受面试时，您可以直接取消面试</div>':'<div class="tip-text">请输入取消面试原因，并和对方提前沟通</div>',a=0===t?"":'<div class="ipt-wrap"><textarea class="ipt ipt-area" data-range="0,50" name="reason" placeholder="请输入取消原因"></textarea><span class="count-num"></span></div>',n='<form action="/wapi/zprelation/boss/interview/cancel.json">\t<input type="hidden" name="interviewId" value="'+e.data("id")+'"/>'+i+a+"</form>";$.dialog({title:"确认取消面试",content:n,confirmText:"确定",cancelText:"取消",wrapClass:"dialog-icons-default dialog-cancel-interview",type:"warning",lock:!0,onOpen:function(e){e.find("form").on("submit",function(t){var i=$(this).serialize();$.ajax({url:$(this).attr("action"),type:"post",dataType:"json",data:i,success:function(e){0===e.code?($.toast({content:"取消面试成功",type:"success"}),$(".interview-overlays").remove()):$.toast({content:e.message,type:"error"})},error:function(){$.toast({content:"服务器异常",type:"error"})}}),e.remove(),t.preventDefault()});var t=e.find("textarea[name=reason]");if(t.length){var i=t,a=i.attr("data-range"),n=PageSet.getLength(i.val()),s=i.closest(".ipt-wrap").find(".count-num");a=a.split(","),s.html("<em"+(n>a[1]?' class="red"':"")+">"+n+"</em>/"+a[1]),t.on("input",function(){n=PageSet.getLength(String(i.val())),s.html("<em"+(n>a[1]?' class="red"':"")+">"+n+"</em>/"+a[1])})}},onConfirm:function(e){var t=e.find("textarea[name=reason]");if(t.length>0){if(!String(t.val()).trim())return $.toast({content:"请填写取消原因",type:"error"}),t.focus(),!1;if(PageSet.getLength(String(t.val()))>50)return $.toast({content:"取消原因不能超过50字",type:"error"}),t.focus(),!1}e.find("form").submit()}})},interview:function(e,t,i){i=i||{};var a={"-1":"",0:"interview-warning",1:"interview-success",2:"interview-cancel",3:"interview-cancel",4:"interview-warning",5:"interview-cancel",6:"interview-cancel",7:"interview-success",8:"interview-success",9:"interview-success",10:"interview-success",11:"interview-success",12:"interview-success",13:"interview-success",14:"interview-success",15:"interview-cancel"},n={0:"等待对方接受",1:"待面试",2:"已拒绝",3:"已取消",4:"面试时间到",5:"已超时",6:"已取消",7:"待面试",8:"已完成",9:"已完成",10:"已完成",11:"已完成",12:"已完成",13:"已完成",14:"已完成",15:"牛人没来"},s=function(e){var t=new Date(e);return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日  "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())},o=function(e){try{_T.sendEvent(e)}catch(e){}};(function(){var t=$.Deferred();return $.get("/wapi/zprelation/boss/interview/info.json",{geekId:Chat.curUserData.uid||e.data("uid")}).success(function(e){0==e.code?t.resolve(e.zpData):$.toast({type:"error",content:e.message})}),t})().then(function(r){if(r.showReInterview=[2,3,5,6,8,9,10,11,12,13,14,15].indexOf(r.status)>-1,r.showEdit=[0,1,7].indexOf(r.status)>-1,r.showCancel=[0,1,7].indexOf(r.status)>-1,r.showForward=[0,1,7].indexOf(r.status)>-1,r.showAbsent=[8,9,10,11,12].indexOf(r.status)>-1,"-1"==r.status||i.edit){r.interviewInfo=i,Publisher.invitation(e,t,r);var c=r.brokenAppointment?"green":"red";o("chat_interview_click_"+c)}else r.style=a[r.status],r.article=n[r.status],r.interviewInfo.time=s(r.interviewInfo.appointmentTime),Publisher.interviewPublish(e,t,r),o("chat_interview_click")})},htmlConverToMessage:function(e){if(!e)return"";$("body").find("#boss-editor-sub").length||$("body").append('<div id="boss-editor-sub" style="position:absolute;left:-9999px;"></div>');var t=$("body").find("#boss-editor-sub");return t.html(e),t.find("img").each(function(){$(this).replaceWith($(this).data("key"))}),e=t[0].innerText},filterPicture:function(e,t){var i={},a=e;e="<div>"+e+"</div>";var n=$(e).find(".picture-insert");return n.length?(i.picIds=n.map(function(e,t){return $(t).attr("pic-id")}).get(),i.html=$(e).find(".picture-insert").after(t).remove().end().html(),i):(i.html=a,i)},inserCurosrHtml:function(e,t){var i=Publisher.editorInput.get(0);Publisher.editorInput.text().length;if("getSelection"in window){var a=window.getSelection();if(a&&1===a.rangeCount){i.focus();var n=a.getRangeAt(0),s=new Image;s.src=e,s.setAttribute("data-key",t),s.className="emoj-insert",s.setAttribute("title",t.replace("[","").replace("]","")),n.deleteContents(),n.insertNode(s),n.collapse(!1),a.removeAllRanges(),a.addRange(n)}}else if("selection"in document){i.focus();var n=document.selection.createRange();n.pasteHTML('<img class="emoj-insert" data-key="'+t+'" title="'+t.replace("[","").replace("]","")+'" src="'+e+'">'),i.focus()}},sendText:function(e,t,i){if(Chat.chatEl.find(".msg-item-unlock").length)return Chat.unlockMessages({from:"send"}),!1;var a,t=t,n="",e=e||Chat.curUserData,i=i||null;if(t)n=t;else{if(Publisher.editorInput.hasClass("btn-disabled"))return!1;var s=Publisher.filterPicture(Publisher.editorInput.html());a=s.picIds,n=Publisher.htmlConverToMessage(s.html);try{_T.sendEvent("Geekchat_send_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+e.uid)}catch(e){}if(!(""!=n.replace(/[\n\s]/g,"")||a&&a.length))return Publisher.editorInput.html(""),!1;if(n.length>1e3)return alert("您输入的内容过长，请删减后再发送"),!1}var o=(new Date).getTime();if(n&&Chat.sendTextMessage({tempID:_PAGE.uid+o,isSelf:!0,from:{uid:Chat.myselfData.uid,name:Chat.myselfData.name,avatar:Chat.myselfData.face},to:{source:e.friendSource,uid:e.gid||e.uid||e.groupId,encryptUid:e.encryptUid||(e.encryptGid?e.encryptGid:"")},time:o,body:{type:i?20:1,text:$.trim(n),sticker:i},mSource:"server",typeSource:"newSubmit",type:Chat.curUserData.groupId?2:1}),a&&a.length&&Publisher.sendPicture(a,e),e.relationType&&[6,7,8].indexOf(e.relationType)<0){var r=e.uid;Chat.usersData[r].relationType=6,Chat.userList.length&&Chat.userList.find(".cur").attr("class","user-communication cur")}t||Chat.checkUserBlock()||(Publisher.editorInput.html(""),Publisher.files={},Publisher.submitBtn.addClass("btn-disabled"),Publisher.editorPlaceholder.show())},sendPicture:function(e,t){t=t||Chat.curUserData,$.each(e,function(e,i){var a=Publisher.files[i];if(a){Chat.showPicUploadingMessage({src:a.base64,id:i});var n=new FormData;n.append("source","chat"),n.append("file",a.file),$.ajax({url:"/wapi/zpupload/image/uploadSingle",type:"POST",cache:!1,data:n,dataType:"json",processData:!1,contentType:!1}).done(function(e){function a(){if(n.failed)Chat.chatListCon.find("#"+i).removeClass("status-read status-delivery").addClass("status-error");else if(n.loaded>=2){var e=Date.now();Chat.chatListCon.find("#"+i).remove(),Chat.sendTextMessage({tempID:_PAGE.uid+e,isSelf:!0,from:{uid:Chat.myselfData.uid,name:Chat.myselfData.name,avatar:Chat.myselfData.face},to:{source:t.friendSource,uid:t.gid||t.uid||t.groupId,encryptUid:t.encryptUid||(t.encryptGid?t.encryptGid:"")},time:e,body:{image:{originImage:o,tinyImage:r},type:3,templateId:1,text:"[图片]"},mSource:"server",typeSource:"newSubmit",type:Chat.curUserData.groupId?2:1})}else s>0&&(s-=200,setTimeout(a,200))}if(0===e.code&&e.zpData){var n={loaded:0,failed:!1},s=2e3,o={},r={};Publisher.getImageInfoAsync(o,e.zpData.url,n),Publisher.getImageInfoAsync(r,e.zpData.tinyUrl,n),a()}else Chat.chatListCon.find("#"+i).removeClass("status-read status-delivery").addClass("status-error")}).fail(function(){Chat.chatListCon.find("#"+i).removeClass("status-read status-delivery").addClass("status-error")})}})},getImageInfoAsync:function(e,t,i){var a=new Image;a.onload=function(t){var a=t.path?t.path[0]:t.target;e.height=a.height,e.width=a.width,e.url=a.src,i.loaded+=1},a.onerror=function(){i.failed=!0},a.src=t},showSentence:function(e){var t='<div class="sentence-pannel"><h3 class="title"><a href="javascript:;" class="link-set">设置</a>常用语</h3><div class="sentence-blank">加载中...</div></div>',a=Publisher.editorInput.get(0);$.ajax({url:"/wapi/zpchat/setting/replyWord/list",type:"GET",data:null,dataType:"JSON",timeout:3e4,success:function(e){var n="",s=e.zpData;if(0==e.code){if(s&&s.length){for(i=0;i<s.length;i++)n+="<li>"+filterXss(s[i])+"</li>";t='<div class="sentence-pannel"><h3 class="title"><a href="javascript:;" class="link-set">设置</a>常用语</h3><ul>'+n+"</ul></div>"}else t='<div class="sentence-pannel"><h3 class="title"><a href="javascript:;" class="link-set">设置</a>常用语</h3><div class="sentence-blank"><a href="javascript:;" class="link-add">+添加常用语</a></div></div>';$(t).appendTo(Publisher.editor).show(),Publisher.editor.find(".sentence-pannel li").on("click",function(){Publisher.editorInput.html(Publisher.editorInput.html()+Chat.messageConverToHtml($(this).text())),Publisher.editor.find(".sentence-pannel").hide(),Publisher.submitBtn.removeClass("btn-disabled"),Publisher.setCursorEnd(a)}),Publisher.editor.on("click",".sentence-pannel .link-set, .sentence-pannel .link-add",function(){Menu.sideEl.find(".menu-account a").attr("data-url","/boss/account/management?type=3").click()})}},error:function(e){}})},showTransmitCode:function(e){var t=Chat.curUserData.encryptUid,i=Chat.curUserData.infoData.expectId,a=Chat.curUserData.jobId,n=$(".chat-controls .btn-transmit-resume");try{_T.sendEvent("wx_share")}catch(e){}$.ajax({url:"/boss/share/geek.json",type:"GET",data:{geekId:t,expectId:i,jobId:a},dataType:"JSON",timeout:3e4,success:function(e){if(e.rescode){try{_T.sendEvent("wx_share_qr")}catch(e){}n.find(".transmit-code").remove();var t='<div class="transmit-code"><img src="'+e.qrUrl+'"><sapn>微信扫码  转发同事</span></div>';$(t).appendTo(n).show(),$(document).click(function(e){$(e.target).hasClass("transmit-code")||$(e.target).parents().hasClass("transmit-code")||n.find(".transmit-code").hide()})}else $.toast({content:"获取二维码失败，请稍后再试",type:"error"})}})},showPosition:function(e){if(e.hasClass("btn-position")){var t=Publisher.editorControls.find(".btn-position");"show"==t.attr("link-show")&&$.ajax({url:"/setting/notify/set.json",data:{type:18},type:"post",success:function(e){e.rescode&&(t.find(".tips").hide(),t.attr("link-show","none"))}});(function(){var e=$.Deferred();return $.get("/chat/online/joblist.json",{geekId:Chat.curUserData.gid,securityId:Chat.curUserData.securityId},function(t){1==t.rescode?e.resolve(t):$.toast(t.msg,"error")}),e})().then(function(t){if(t.data.length){for(var i=t.data,a="",n="<p>"+i[0].positionName+" "+i[0].locationName+" "+i[0].salaryDesc+" </p>",s=1;s<i.length;s++)a+='<li data-id="'+i[s].encryptId+'" data-name="'+i[s].positionName+'" data-city="'+i[s].locationName+'">'+i[s].positionName+" "+i[s].locationName+" "+i[s].salaryDesc+" </li>";var o='<div class="chat-position-menu"><div>当前职位'+n+"</div><ul> "+a+"</ul></div>";e.find(".chat-position-menu").remove(),e.append(o),e.find(".chat-position-menu").show(),e.off("click").on("click",".chat-position-menu li",function(e){e.stopPropagation(),Publisher.changePosition($(this))})}}),$(document).on("click",function(t){$(t.target).hasClass("chat-position-menu")||$(t.target).parents().hasClass("chat-position-menu")||e.find(".chat-position-menu").hide()})}},changePosition:function(e){var t=e.attr("data-id"),i=e.attr("data-name"),a=(e.attr("data-city"),{jobId:t,securityId:Chat.curUserData.securityId,geekId:Chat.curUserData.gid}),n=Chat.chatList.find(".chat-info .text .link-job");$.post("/chat/send/jobcard.json",a,function(a){1==a.rescode?(e.parents(".chat-position-menu").hide(),n.attr("data-jobid",t),n.html(i)):$.toast(a.msg,"error")})},showExchangeWeixin:function(e){$.dialog({title:"确认与对方交换微信吗？",content:"",closeText:!1,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-icons-default dialog-alert-default dialog-around-default dialog-up-default dialog-operate-wrap",position:"around",lock:!0,element:e,opacityLock:!0,onOpen:function(e){e.find(".dialog-container").css({"margin-left":"-150px"})},onConfirm:function(e){Chat.exchangeWeixin(2,{from:{uid:Chat.curUserData.uid}}),e.remove()},onClose:function(e){}})},showExchangePhone:function(e){$.dialog({title:"确认与对方交换电话吗？",content:"",closeText:!1,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-icons-default dialog-alert-default dialog-around-default dialog-up-default dialog-operate-wrap",position:"around",lock:!0,element:e,opacityLock:!0,onOpen:function(e){e.find(".dialog-container").css({"margin-left":"-150px"})},onConfirm:function(e){Chat.exchangePhone(2,{from:{uid:Chat.curUserData.uid}}),e.remove()},onClose:function(e){}})},showExchangeResume:function(e){var e=e;e.hasClass("btn-resume"),$.dialog({title:"确定向牛人索取简历吗？",content:"",closeText:!1,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-icons-default dialog-alert-default dialog-around-default dialog-operate-wrap",position:"around",lock:!0,element:e,opacityLock:!0,onOpen:function(t){e.closest(".toggle-type").length?t.find(".dialog-container").css({"margin-left":"-117px","margin-top":"36px"}):(t.addClass("dialog-up-default"),t.find(".dialog-container").css({"margin-left":"-150px"}))},onConfirm:function(e){Chat.exchangeResume(2,{from:{uid:Chat.curUserData.uid}}),e.remove()},onClose:function(e){}})},setCursorEnd:function(e){if(window.getSelection){e.focus();var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()}else if(document.selection){var t=document.selection.createRange();t.moveToElementText(e),t.collapse(!1),t.select()}},getBaseExcludeText:function(e){if(!e.length)return"";var t="将过滤"+e.join("、")+"的牛人消息";return t=t.replace("高于","低于").replace("为","不为").replace("有","没有").replace("是","非")},getDegreeExcludeText:function(e){if(!e.length)return"";var t="将过滤"+e.join("、")+"的牛人消息";return t=t.replace("非","").replace("是","非").replace("有","没有")},vipFilterTpl:function(e){var t=e.workYear.itemName,i="在校生"===t||"应届生"===t?"是"+t:"工作经验为"+t,a={base:[{open:e.degree.open,type:"degreeOpen",disableClick:e.degree.disableClick,style:1===e.degree.open?" selected":"",itemName:"学历高于"+e.degree.itemName},{open:e.workYear.open,type:"workYearOpen",disableClick:e.workYear.disableClick,style:1===e.workYear.open?" selected":"",itemName:i},{open:e.experience.open,type:"experienceOpen",disableClick:e.experience.disableClick,style:1===e.experience.open?" selected":"",itemName:"有"+e.experience.itemName+"工作经历"}],degree:[{open:e.underGraduateOpen,type:"underGraduateOpen",style:1===e.underGraduateOpen?" selected":"",itemName:"非专升本"},{open:e.schoolOpen,type:"schoolOpen",disableClick:e.schoolOpen.disableClick,style:1===e.schoolOpen?" selected":"",itemName:"是985/211院校"},{open:e.studyAbroadOpen,type:"studyAbroadOpen",style:1===e.studyAbroadOpen?" selected":"",itemName:"有留学经历"}]},n=a.base.filter(function(e){return 1===e.open&&1!==e.disableClick}).map(function(e){return e.itemName}),s=a.degree.filter(function(e){return 1===e.open&&1!==e.disableClick}).map(function(e){return"大专升本科"==e.itemName?"专升本":e.itemName});return a.baseExclude=Publisher.getBaseExcludeText(n),a.degreeExclude=Publisher.getDegreeExcludeText(s),a.ageExclude=Publisher.getAgeExclude(e),Utemplate('<dl class="vip-filter-base"><dt>基本条件<span class="gray">（多选）</span></dt><%for (var i=0;i<this.base.length;i++) {%><dd data-type="<%this.base[i].type%>" class="filter-item<%this.base[i].style%> "><%this.base[i].itemName%><i class="radio"></i><i class="iboss-checked-solid <%if(this.base[i].disableClick == 1){%>disabled<%}%> "></i></dd><%}%><dd class="gray"><%this.baseExclude%></dd></dl><dl class="vip-filter-age"><dt>年龄要求</dt><dd><input type="hidden" class="filter-range" /></dd><dd class="gray"><%this.ageExclude%></dd></dl><dl class="vip-filter-degree"><dt>院校资质<span class="gray">（多选）</span></dt><%for (var j=0;j<this.degree.length;j++) {%><dd data-type="<%this.degree[j].type%>" class="filter-item<%this.degree[j].style%>"><%this.degree[j].itemName%><i class="radio"></i><i class="iboss-checked-solid"></i></dd><%}%><dd class="gray"><%this.degreeExclude%></dd></dl>',a)},getAgeExclude:function(e){if(16==e.ageStart&&60==e.ageEnd)return"";if(e.ageStart==e.ageEnd)return"将过滤不为"+e.ageEnd+"岁的牛人消息";var t=[];return e.ageStart>16&&t.push("小于"+e.ageStart+"岁"),e.ageEnd<60&&t.push("大于"+e.ageEnd+"岁"),"将过滤"+t.join("、")+"的牛人消息"},vipFilter:function(){for(var e="",t=[],i=!1,a=16;a<61;a++)t.push(a);var n=function(e){var t=$.Deferred();return $.get("/wapi/zpblock/friend/filter/job?jid="+(e||""),function(e){0===e.code?t.resolve(e):$.toast({type:"error",content:e.message})}),t},s=function(e){var a=0;$(".chat-filter-setting .filter-range").jRange({from:16,to:60,step:1,scale:t,format:function(e){return 60==e||16==e?"不限":e},onstatechange:function(e){var t=e.split(","),n=parseInt(t[0],10),s=parseInt(t[1],10),o=Publisher.getAgeExclude({ageStart:n,ageEnd:s});$(".vip-filter-age dd.gray").text(o),(a+=1)>2&&(i=!0)},snap:!0,width:260,showScale:!1,isRange:!0}).jRange("setValue",e.ageStart+","+e.ageEnd)},o=function(t){n(t).then(function(t){e=t.zpData.jobFilterData.filterId;var i=Publisher.vipFilterTpl(t.zpData.jobFilterData);$(".filter-setting-list").html(i),s(t.zpData.jobFilterData)})},r=function(t){var a=$(t).find(".filter-range").val(),n=$(t).find(".setting-position .selected").text(),s={jid:$(t).find(".setting-position .selected").attr("data-jid"),filterId:e,ageStart:a.split(",")[0],ageEnd:a.split(",")[1]};$(t).find(".filter-item").each(function(e,t){s[$(t).attr("data-type")]=$(t).hasClass("selected")?1:0}),$.post("/wapi/zpblock/friend/filter/job/save",s,function(t){0==t.code?(e=t.zpData,$.toast({type:"success",content:"职位 "+n+" 的设置已保存，新牛人的消息将按照您的设置进行过滤"}),i=!1):$.toast({type:"error",content:t.message})})},c=function(e,t){var t=t||null,a=e,n=$(a).find(".setting-position .selected").text(),s=function(){t?($(".vip-filter-confirm").remove(),t()):($(e).remove(),$(".vip-filter-confirm").remove()),i=!1};i?$.dialog({title:'<i class="icon-dialog-warning"></i>确定保存',content:'<p class="error-tip"><i class="icon-warning"></i>职位 '+n+" 的设置已更改过滤条件，保存更改设置吗？</p>",confirmText:"确认",cancelText:"取消",wrapClass:"vip-filter-confirm flex-dialog-wrap",inline:!0,onConfirm:function(e){t?(r(a),t(),$(".vip-filter-confirm").remove()):(r(a),$(e).remove())},onCancel:s,onClose:s}):$(e).remove()};n().then(function(t){e=t.zpData.filterId;var a=t.zpData.jobList.map(function(e){return'<li data-jid="'+e.jid+'">'+e.jobName+"</li>"}),l="";l=t.zpData.jobFilterData?'<div class="drop-position-list"><ul>'+a.join("")+'</ul></div><div class="fast-filter-setting"><ul><li><span>对全部职位应用基本不符合条件</span><div class="ui-switch ui-switch-checked"><input type="checkbox" class="ui-switch-input"><span class="ui-switch-span"></span></div></li><li class="gray">学历、工作年限不符。且无相关工作经历的 牛人消息将被过滤收起</li></ul></div><p class="article">过滤设置<a href="javascript:;" class="filter-save">保存</a></p><div class="filter-setting-wrap"><div class="fast-setting"><h4>消息过滤设置<i class="i-vip"></i></h4><a href="javascript:;">快速设置</a><p>设置生效后，新牛人的消息将按照您的设置进行过滤</p></div><div class="setting-position"><i class="iboss-down"></i><ul class="position-list">'+a.slice(0,3).join("")+'</ul></div><div class="filter-setting-list">'+Publisher.vipFilterTpl(t.zpData.jobFilterData)+"</div>":'<div class="position-empty"><div><p class="icon-empty"></p><p class="desc">现在还没有在线职位</p><button class="btn btn-outline">去发布</button></div></div>',$.dialog({title:"",content:l,confirmText:!1,cancelText:!1,opacityLock:!0,wrapClass:"chat-filter-setting",inline:!0,closeText:!1,onOpen:function(e){if(i=!1,$(e).on("click",".position-empty .btn",function(){Menu.gotoCategory("postjob",{}),$(e).remove()}),t.zpData.jobFilterData){$(e).find(".setting-position li").eq(0).addClass("selected"),s(t.zpData.jobFilterData);var a=$(e).find(".filter-setting-wrap .position-list li").length,l=$(e).find(".filter-setting-wrap .drop-position-list li").length;$(e).find(".filter-setting-wrap .position-list").height()<30&&a==l&&$(e).find(".setting-position .iboss-down").remove(),$(e).on("click",".setting-position li",function(){var t=this,a=function(e){$(t).siblings().removeClass("selected"),$(t).addClass("selected"),o($(t).attr("data-jid"))};i?c(e,a):a()}),$(e).on("click",".fast-setting a",function(){n().then(function(t){0!==t.zpData.globalOpen?$(e).find(".ui-switch").addClass("ui-switch-checked"):$(e).find(".ui-switch").removeClass("ui-switch-checked"),$(e).find(".fast-filter-setting").show()})}),$(e).on("click",".fast-filter-setting .ui-switch",function(){var i=$(this),a=$(this).hasClass("ui-switch-checked")?0:1;$.post("/wapi/zpblock/friend/filter/save",{flag:a},function(){if(0==t.code){var n=a?"所有职位的基本条件设置已保存，新牛人的消息将按照基本职位要求进行过滤":"快速设置已关闭";if(i.toggleClass("ui-switch-checked"),$.toast({type:"success",content:n,time:3e3}),1==a){$(e).find(".vip-filter-base dd").addClass("selected");var s=[];$(e).find(".vip-filter-base dd").each(function(){$(this).find(".disabled").length||$(this).hasClass("gray")||s.push($(this).text())});var o=Publisher.getBaseExcludeText(s);$(e).find(".vip-filter-base dd.gray").text(o)}else $(e).find(".vip-filter-base dd").each(function(){$(this).find(".disabled").length||$(this).removeClass("selected")}),$(e).find(".vip-filter-base dd.gray").text("")}else $.toast({type:"error",content:t.message});$(e).find(".fast-filter-setting").hide()})}),$(e).on("click",".fast-filter-setting",function(){$(e).find(".fast-filter-setting").hide()}),$(e).on("click",".fast-filter-setting ul",function(e){e.stopPropagation()}),$(e).on("click",".drop-position-list ul",function(e){e.stopPropagation()}),$(e).on("click",".drop-position-list",function(){$(e).find(".drop-position-list").hide(),$(e).find(".setting-position .iboss-down").removeClass("rotate")}),$(e).on("click",".drop-position-list li",function(){var t=this,a=function(){var i=$(t).attr("data-jid"),a=$(e).find('.setting-position li[data-jid="'+i+'"]');$(e).find(".setting-position .selected").removeClass("selected"),$(t).siblings().removeClass("selected"),$(t).addClass("selected"),a.addClass("selected"),a.length?$(e).find(".setting-position ul").prepend(a):($(e).find(".setting-position ul li:last").remove(),$(e).find(".setting-position ul").prepend($(t).clone())),$(e).find(".drop-position-list").hide(),$(e).find(".setting-position .iboss-down").removeClass("rotate"),o(i)};i?c(e,a):a()}),$(e).on("click",".setting-position .iboss-down",function(){var t=$(e).find(".setting-position .selected").attr("data-jid");$(e).find(".drop-position-list .selected").removeClass("selected"),$(e).find('.drop-position-list li[data-jid="'+t+'"]').addClass("selected"),$(this).addClass("rotate"),$(e).find(".drop-position-list").show()}),$(e).on("click",".filter-item",function(){if(!$(this).find(".disabled").length){var e=$(this).parents("dl"),t=[];if($(this).toggleClass("selected"),e.find(".selected").each(function(e,i){if(!$(i).hasClass("gray")){var a="大专升本科"==$(i).text()?"专升本":$(i).text();!$(i).find(".disabled").length&&t.push(a)}}),t.length){var a;e.hasClass("vip-filter-base")?a=Publisher.getBaseExcludeText(t):e.hasClass("vip-filter-degree")&&(a=Publisher.getDegreeExcludeText(t)),e.find("dd.gray").text(a)}else e.find("dd.gray").text("");i=!0}}),$(e).on("click",".filter-save",function(){r(e)})}},onConfirm:function(e){},onClose:c})})}};noticeSwitch={init:function(){var e=this;window.noticeIsClose=!!localStorageInstance("noticeisclose")&&Boolean(localStorageInstance("noticeisclose")),window.noticeAudioIsClose=!!localStorageInstance("noticeaudioisclose")&&Boolean(localStorageInstance("noticeaudioisclose")),this.box=$(".aside_nav_bar .btool"),this.setBox=this.box.find(".setbox"),this.box.find(".btn_settings").bind("click",function(t){e.setBox.is(":hidden")?(e.setBox.show(),bindObjOutsiteClick(e.setBox)):(e.setBox.hide(),unbindObjOutsiteClick(e.setBox)),t.preventDefault()}),window.noticeIsClose&&this.setBox.find(".desk").addClass("off").text("打开桌面通知"),window.noticeAudioIsClose&&this.setBox.find(".audio").addClass("off").text("打开声音提醒"),this.setBox.find(".desk").bind("click",function(e){window.noticeIsClose?(window.noticeIsClose=!1,$(this).removeClass("off").text("关闭桌面通知")):(window.noticeIsClose=!0,$(this).addClass("off").text("打开桌面通知")),localStorageInstance("noticeisclose",window.noticeIsClose),e.preventDefault()}),this.setBox.find(".audio").bind("click",function(e){window.noticeAudioIsClose?(window.noticeAudioIsClose=!1,$(this).removeClass("off").text("关闭声音提醒")):(window.noticeAudioIsClose=!0,$(this).addClass("off").text("打开声音提醒")),localStorageInstance("noticeaudioisclose",window.noticeAudioIsClose),e.preventDefault()})}},$(function(){noticeSwitch.init()}),pageTitleStatus={status:null,ani:null,aniTime:500,set:function(e){var t=this,i="data:image/ico;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAC6wk3/usJN/7rCTf+6wk3/usFN/7nBS/+6wEz/usFL/7rAS/+5wU3/u8JP/7vBTf+6wk3/usJN/7rCTf+6wk3/u8JP/7vCT/+7wk//u8JP/7vDUP+8xFP/u8JR/7zCT/+8wlD/usFM/7e/Rf+8wk7/u8JP/7vCT/+7wk//u8JP/7rCTv+6wk7/u8JQ/7a+Q//S143/9/ju//f57v/6+vX/+fv1//Dy3v/R1Yz/usBK/7rCTv+6wk7/usJO/7rCTv+7w07/u8NO/7zEUf+2v0H/19uZ///////o6sX/3eGl/+Hksv/29+v//////9XZk/+4wEX/vMRQ/7vDTv+7w07/vcRP/73ET/++xVL/uMBD/9bblv//////y9B5/7K7Nv+4vkH/wshf//n68//z9eP/vcRR/73ETv+9xE//vcRP/7zET/+8xE//vcVS/7jAQ//X25b//////9DVhv+7wkr/vsZT/7rARf/t79X//Pz3/7/GVv+7w03/vcRQ/7zET/++xE//vsRP/7/FUv+6wUP/19uX///////P1IL/ucFE/7zDTf/N0nv//////+3w0v+9xE3/vsVQ/77FUP++xE//vsVQ/77FUP+/xlP/usFE/9jcmf//////9PXk/+/x2f/x8t7//P36//T15P/Kz3D/vMNK/7/GUv++xVD/vsVQ/77GUf++xlH/v8dU/7rCRf/Y3Zj///////T25P/v8dj/+Pnu//3+/f/T2Iz/usJE/7/HU/++xlH/vsZR/77GUf+/x1H/v8dR/8DIVP+7xET/2N2Y///////Q1oT/u8NG/8HHVf/s7cr//f79/8jOaf+9xkz/v8hS/7/HUf+/x1H/wMlQ/8DJUP/ByVP/u8VE/9nel///////0deE/77GSf+7w0H/0daE///////Y3Zj/u8VE/8HJU//AyVD/wMlQ/8DIU//AyFP/wclW/7zER//Z3Zf//////9LYhv+/xkr/xMpa/+frwf//////1dqQ/7zFSP/ByVb/wMhT/8DIU//ByVL/wclS/8HKVf+8xUb/3OCf///////8/Pf/+frz//39+///////7vDT/8LKV//AyVH/wclT/8HJUv/ByVL/wclT/8HJU//BylT/v8hN/87Udv/i5a7/4eWr/+Hlr//i5a3/2dyT/8TKVv/ByE//wcpU/8HJU//ByVP/wclT/8HKVP/BylT/wcpT/8LKVP/Ax03/vMVF/73FRf+9xUT/vcVE/7/HR//CyVP/wspU/8HKU//CylT/wcpU/8HKVP/Cy1P/wstT/8LLU//Cy1P/xcpV/8TMV//Fy1f/xMxW/8TLV//Ey1b/wspU/8PLU//Cy1P/wstT/8LLU//Cy1P/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==";if(faviconUrlNew="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAC6wk3/usJN/7rCTf+6wk3/usFN/7nBS/+6wEz/usFL/7rAS/+5wU3/u8JP/7vBTf+6wk3/usJN/7rCTf+6wk3/u8JP/7vCT/+7wk//u8JP/7vDUP+8xFP/u8JR/7zCT/+8wlD/usFM/7e/Rf+8wk7/u8JP/7vCT/+7wk//u8JP/7rCTv+6wk7/u8JQ/7a+Q//S143/9/ju//f57v/6+vX/+fv1//Dy3v/R1Yz/usBK/7rCTv+6wk7/usJO/7rCTv+7w07/u8NO/7zEUf+2v0H/19uZ///////o6sX/3eGl/+Hksv/29+v//////9XZk/+4wEX/vMRQ/7vDTv+7w07/vcRP/73ET/++xVL/uMBD/9bblv//////y9B5/7K7Nv+4vkH/wshf//n68//z9eP/vcRR/73ETv+9xE//vcRP/7zET/+8xE//vcVS/7jAQ//X25b//////9DVhv+7wkr/vsZT/7rARf/t79X//Pz3/7/GVv+7w03/vcRQ/7zET/++xE//vsRP/7/FUv+6wUP/19uX///////P1IL/ucFE/7zDTf/N0nv//////+3w0v+9xE3/vsVQ/77FUP++xE//vsVQ/77FUP+/xlP/usFE/9jcmf//////9PXk/+/x2f/x8t7//P36//T15P/Kz3D/vMNK/7/GUv++xVD/vsVQ/77GUf++xlH/v8dU/7rCRf/Y3Zj///////T25P/v8dj/+Pnu//3+/f/T2Iz/usJE/7/HU/++xlH/vsZR/77GUf+/x1H/v8dR/8DIVP+7xET/2N2Y///////Q1oT/u8NG/8HHVf/s7cr//f79/8jOaf+9xkz/v8hS/7/HUf+/x1H/wMlQ/8DJUP/ByVP/u8VE/9nel///////0deE/77GSf+7w0H/0daE///////Y3Zj/u8VE/8HJU//AyVD/wMlQ/8DIU//AyFP/wclW/7zER//Z3Zf//////9LYhv+/xkr/xMpa/+frwf//////vMGb/zI3w/8IDOn/MzjG/6mwZv/ByVL/wclS/8HKVf+8xUb/3OCf///////8/Pf/+frz//39+///////7vDT/zQ4x/8AA/D/AAPw/wAD8P8wNcj/wclT/8HJU//BylT/v8hN/87Udv/i5a7/4eWr/+Hlr//i5a3/2dyT/8TKVv8JDOj/AAPw/wAD8P8AA/D/BQjs/8HKVP/BylT/wcpT/8LKVP/Ax03/vMVF/73FRf+9xUT/vcVE/7/HR//CyVP/NDjG/wAD8P8AA/D/AAPw/zA1yf/Cy1P/wstT/8LLU//Cy1P/xcpV/8TMV//Fy1f/xMxW/8TLV//Ey1b/wspU/6yzZf80Ocb/CQzp/zQ5xv+rs2X/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",isIE&&(i=_PAGE.assetUrl+"images/1.5/favicon.ico",faviconUrlNew=_PAGE.assetUrl+"images/1.5/favicon1.ico"),this.favicon||($("#favicon").length?this.favicon=$("#favicon"):this.favicon=$('<link rel="icon" id="favicon" type="image/x-icon">').attr("href",i).appendTo("html>head")),this.text="",e){if(this.text="("+e+")",document.title="BOSS直聘"+this.text,!this.ani){var a=!0;this.ani=setInterval(function(){t.favicon.attr("href",a?i:faviconUrlNew),a=!a},this.aniTime)}}else this.ani&&(clearInterval(this.ani),this.ani=null),t.favicon.attr("href",i),document.title="BOSS直聘"},clear:function(){this.status&&(this.status=null),this.ani&&clearInterval(this.ani)}},chatNotification={data:{},dataArray:[],dataHistory:[],show:function(e,t,i){if(!(_PAGE.debug&&this.num||(this.num=!0,window.noticeIsClose||window.isFocus||i.presence))){
window.isIE||window.noticeAudioIsClose||this.audio||(this.audio=document.createElement("audio"),this.audio.src="https://img.bosszhipin.com/audio/message.mp3",this.audio.preload="auto",this.audio.load(),this.audio.muted=!0);var a=this;if(this.Notification=window.Notification||window.mozNotification||window.webkitNotification,this.Notification)if("granted"==this.Notification.permission)a.handler(e,t,i);else{if(chatNotification.requested)return;chatNotification.requested=!0,this.Notification.requestPermission(function(n){if("granted"!==n)return!1;a.handler(e,t,i)})}}},handler:function(e,t,i){var a=this,n=this.formatMessage(i);if(n){if(!window.noticeAudioIsClose&&this.audio&&this.audio.play)try{this.audio.muted=!1,this.audio.play()}catch(e){}var s=new this.Notification(e,{body:this.formatText(n),icon:t,tag:"replace",renotify:!0});this.data[i.mid]=s,this.dataArray.push(i.mid),s.onclick=function(){if(i.isSelf)var e=i.to.uid;else var e=i.from.uid;"undefined"!=typeof DeskNotice&&DeskNotice.messageCard(),$(".menu-chat").hasClass("cur")||$(".menu-chat a").click();try{_T.sendEvent("notice_window_click_"+e)}catch(e){}s.close(),window.focus()},s.onerror=function(){},s.onshow=function(){"undefined"!=typeof DeskNotice&&DeskNotice.messageNotice(),setTimeout(function(){s.close()},5e3)},s.onclose=function(){delete a.data[i.mid];for(var e=0;e<a.dataArray.length;e++)a.dataArray[e]==i.mid&&a.dataArray.splice(e,1)}}},messageTypes:{text:{types:[1,1,1],result:function(e){return e.isSelf?null:e.body.text}},voice:{types:[1,2],result:function(e){return e.isSelf?null:"[收到语音消息，请登录APP端查收]"}},image:{types:[1,3],result:function(e){return e.isSelf?null:"[收到图片消息，请登录APP端查收]"}},redEnvelope:{types:[3,10],result:function(e){if(!e.isSelf)return"[收到红包消息，请登录APP端查收]"}},getSystemText:{types:[3,1,1],result:function(e){return e.isSelf?null:e.body.text}},getSystemMessage:{types:[3,1],result:function(e){return e.body.text}},interview:{types:[1,7,4],result:function(e){return null}},dialogMessage:{types:[1,7,0],result:function(e){return e.body.dialog.title&&e.body.dialog.title.indexOf("面试邀请")>-1?null:e.isSelf?null:e.body.dialog.text}},dialogWeixin:{types:[1,7,1],result:function(e){return e.isSelf?null:e.body.dialog.text}},dialogResume:{types:[1,7,2],result:function(e){return e.isSelf?null:e.body.dialog.text}},agreeInterview:{types:[3,4,47],result:function(e){return e.from.name+"接受了您的面试邀请。"}},audioInterview:{types:[3,4,85],result:function(){return"[语音通话]"}}},formatMessage:function(e){var t=this;for(var i in this.messageTypes){var a=this.messageTypes[i],n=a.types;if(n[0]==e.type&&n[1]==e.body.type)if(1==n[0]&&7==n[1]){if(n[2]==e.body.dialog.type)return a.result.call(t,e)}else if(3==n[0]&&4==n[1]){if(n[2]==e.body.action.aid)return a.result.call(t,e)}else{if(3!=n.length)return a.result.call(t,e);if(n[2]==e.body.templateId)return a.result.call(t,e)}}return null},formatText:function(e){return e=e.replace(/&nbsp;/gi," ").replace(/\[[a-zA-Z\u4e00-\u9fa5]{1,3}\]/g,"[表情]"),e.match(/./g).length>18&&(e=e.substring(0,18)+"..."),e}};var Chat={init:function(){function e(){Chat.radiosBindEvents(),$(".fail-tips").remove(),$(".chat-container").append(o),$.ajax({url:"/wapi/zprelation/relation/getWebSetting4NotOk.json",type:"get",success:function(e){function t(){$("li[data-reason]").each(function(){var e=$(this).context.dataset.reason;a.optionVOList.forEach(function(t){if(t.code==e&&t.content){var i='li[data-reason="'+e+'"]';$(i).attr("data-text",t.content)}})})}var i=e.zpData.token;$('input[name="token"]').val(i);var a=e.zpData.webSetting4NotOkVO,n=a.sendMsgType,s=a.sendMsgContent?'发送消息"'+a.sendMsgContent+'"':'发送消息"您不太适合我们公司"';$("input[name=sendMsg][value=1] +span").text(s),$(".chat-container .set-item").css("height","auto");var o=$(".radio-list").closest("form");0===n?($("input[name=sendMsg][value=0]").attr("checked",!0),$(".chat-container .set-item").find(".defined-form").removeClass("show-defined-form"),t()):1===n?($("input[name=sendMsg][value=1]").attr("checked",!0),$(".chat-container .set-item").find(".defined-form").removeClass("show-defined-form"),t()):2===n?($("input[name=sendMsg][value=2]").attr("checked",!0),t(),$(".ipt-area").attr("placeholder","输入回复内容，内容为空则不发送").val($(".defined-tab .cur").attr("data-text")),o.find('input[name="reasonType"]').val(o.find(".defined-tab .cur").attr("data-reason")),Chat.countAreaLength(o.find(".ipt-area")),$(".no-good-pop .btn").text("保存“"+o.find(".defined-tab .cur").text()+"“信息")):-1===n&&($("input[name=sendMsg][value=1]").attr("checked",!0),$(".chat-container .set-item").find(".defined-form").removeClass("show-defined-form"),t())},error:function(e){$.toast({content:e.message,type:"error"})}})}Chat.homeUrl="/user/login.html",Chat.containerEl=$("#container"),Chat.containerChat=$(".chat-container"),Chat.userList=Chat.containerChat.find(".user-list").not(".chat-search-list"),Chat.resumeContainer=Chat.containerChat.find(".resume-container"),Chat.attachContainer=Chat.containerChat.find(".attachment-container"),Chat.chatBox=$(".chat-box"),Chat.chatList=$(".chat-list"),Chat.chatListCon=Chat.chatList.find("ul"),Chat.chatEl=Chat.containerChat.find(".chat-wrap"),Chat.welcomeEl=$(".chat-weclcome"),Chat.tabcontentEls=Chat.chatEl.find(".chat-tab-content"),Chat.opTopEls=$(".detail-top .op"),Chat.setTopEl=Chat.opTopEls.find(".op-settop"),Chat.setStarEl=Chat.opTopEls.find(".op-star"),Chat.editorEl=$(".chat-editor"),Chat.toggleTypeEl=$(".toggle-type"),Chat.usersInitStatus=!1,Chat.messageStatusData={},Chat.messageStatusDataTemp={},Chat.unReadMessage={},Chat.receiveMaxId=-1,Chat.mids={},Chat.usersDataDelete={},Chat.usersData={},Chat.newGeek=[],Chat.usersID=[],Chat.filterRadio=!1,Chat.filterGroup=!1,Chat.tops=[],Chat.filterUnreadCount=0,Chat.isInnerHR=!1,Chat.propMessages=[],Chat.notification={1:[],5:[],6:[],7:[],8:[]},Chat.prevUid="",Chat.drafts=[],Chat.groupStatus=-1,Chat.groupHistory={},Chat.groupLastModify={},Chat.xhrs={},Chat.batchHandle=Chat.batchUserHandle(),Chat.websocketConnected=!1,Chat.chatHistoryData={},Chat.usersTempData=[],Chat.userFilterTempData=[],Chat.users=Chat.userList.find("li"),Chat.userlistPageTotal=100,Chat.userListMain=Chat.userList.find(".main-list"),Chat.userListTop=Chat.userList.find(".top-list"),Chat.tipsContainer=$(".chat-container .data-tips"),Chat.detailContainer=$(".chat-container .detail-box"),Chat.offlineMessages=[],Chat.ControlsEl=Chat.chatBox.find(".chat-controls"),Chat.directionEl=$(".chat-sider"),Chat.chatList.prepend('<div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div>'),Chat.hisLoading=Chat.chatList.find(".pre-loading"),Chat.curUserData={},Chat.usersDataForJob={},Chat.unreadCountBox=$(".menu-chat-badge"),Chat.unreadMessageCount=0,Chat.newNumber=0,Chat.propMessages=[],PageSet.hasShowReplyTip=!1,Chat.outputData={30:{count:0},31:{count:0},35:{count:0}},Chat.chatUserCount=0,Chat.userlistMoreEl=Chat.userList.find(".loadmore"),Chat.userlistPage=1,Chat.userlistRenderPage=0,Chat.userlistMore=!1,Chat.getUserList(Chat.userlistPage),Chat.isLoading=!1,Emotion.getSticker().then(function(e){Chat.storedEmtions=e}),Chat.filterParms={page:0,status:"",origin:"",jobid:"",salary:0,experience:0,degree:0},Chat.myselfData={uid:_PAGE.uid,name:_PAGE.name,face:_PAGE.face,email:_PAGE.email},chatNotification.chat=this,Chat.containerChat.find(".sec-operate").addClass("operate-disabed").on("click",function(){if($(this).hasClass("operate-disabed"))return!1}),Chat.containerChat.find(".sec-operate").on("click",".dropdown-select",function(e){if($(this).closest(".sec-operate").hasClass("operate-disabed"))return $(this).parent().removeClass("dropdown-menu-open"),!1}),localStorageInstance("recommend-pos")&&localStorageInstance("recommend-pos",""),Menu.isSuportCalc||($("body").addClass("no-calc"),Chat.containerChat.find(".sec-content").css("height",$(window).height()-132+"px"),Chat.userList.css("height",$(window).height()-176+"px"),Chat.chatList.css("height",$(window).height()-329+"px"),Chat.containerChat.find(".data-tips").css("height",$(window).height()-132+"px"),Chat.containerChat.find(".resume-container").css("height",$(window).height()-236+"px"),Chat.containerChat.find(".attachment-container").css("height",$(window).height()-236+"px")),_PAGE.runChat&&"172.16.0.44"!=window.location.host&&(Chat.protobufMessage=new ProtobufMessage(this),$.get("/wapi/zppassport/get/wt").success(function(e){0==e.code&&""!==util.get(e,"zpData.wt","")?ChatWebsocket.init(util.get(e,"zpData.wt","")):ChatWebsocket.init()}).error(function(){ChatWebsocket.init()})),"undefined"!=typeof DeskNotice&&$(".top-user .link-signout").on("click",function(){DeskNotice.messageLogout()}),setTimeout(function(){var e=window.screen.width,t=window.screen.height,i=window.innerWidth,a=window.innerHeight;Chat.sendTrackEvent("screen_boss_"+e+"_"+t+"_avail_"+i+"_"+a+"_"+_PAGE.uid)},3e3);var t=function(e){uid=e.userId,source=e.userSource,ImFriends.getFriendById(uid,source,function(e){setTimeout(function(){e.newMsgCount&&Chat.clearMessageCount(e,e.newMsgCount)})})},i=function(e){if("read"===e.type&&e.message.messageRead&&e.message.messageRead.length)for(var i=e.message.messageRead,a=0;a<i.length;a++){var n=i[a];t(n)}};ImSocket.onSend(i),Chat.checkIsInner(Chat.handleInnerInit);var a=Chat.userlistMoreEl.get(0);Chat.userList.on("scroll",function(){$(".right-click-panel").off("click").remove(),Chat.userFilterTempData&&(Chat.userlistTimer&&clearTimeout(Chat.userlistTimer),Chat.userlistTimer=setTimeout(function(){!Chat.isLoading&&isVisiable(a)&&!Chat.userlistMoreEl.hasClass("disabled")&&Chat.userlistMoreEl.is(":visible")&&(Chat.userlistRenderPage++,Chat.renderUserList(Chat.userFilterTempData,Chat.userlistRenderPage))},200))}),Chat.chatList.on("click",".item-article-btn",function(){var e=$(this).data("url");switch(getQueryString("type",e)){case"bossInviteInterview":Publisher.interview(Chat.ControlsEl.find(".btn-interview"),"dialog-up-default",{appointmentTime:getQueryString("appointmentTime",e),jobId:getQueryString("jobId",e)})}}),Chat.userlistMoreEl.on("click",function(){$(this).hasClass("disabled")||(Chat.userlistRenderPage++,Chat.renderUserList(Chat.userFilterTempData,Chat.userlistRenderPage))}),Chat.containerChat.find(".op-category .group-more").on("click","li",function(){$(this).hasClass("item-help")&&Chat.showOperateHelp($(this))});var n=function(){Publisher.getState(function(e){1===e.vipFriendFilterState?Publisher.vipFilter():0!=e.vipFriendFilterState&&Commercial.vip({sf:34},function(){Chat.containerChat.find(".vip-filter-bar").remove(),Chat.containerChat.find(".vip-filter-tap").removeClass("vip-filter-tap"),Chat.addfilterTab(),Publisher.vipFilter()})})};Chat.containerChat.on("click",".vip-filter-setting",function(){n()}),Chat.userList.on("click",".user-blank-not .setting",function(){n()}),$("#unrecognized-tip").length?(setTimeout(function(){Chat.sendKaEvent("go_certi_block")},2e3),$.dialog({title:"",content:$("#unrecognized-tip").prop("outerHTML"),confirmText:"",cancelText:"",closeText:!1,closeLayer:!1,element:$("#unrecognized-tip"),wrapClass:"dialog-unrecognized",lock:!0,onOpen:function(e){var t=e.find(".img-wrap");t.html('<img src="'+t.attr("data-url")+'">')},onConfirm:function(e){},onClose:function(e){}})):$("#approveBag").length;var s=function(){Chat.chatEl.find(".chat-list").css("visibility","hidden"),Chat.chatEl.find(".chat-wrap-mask").remove(),Chat.chatEl.append($('<div class="chat-wrap-mask"></div>')),Chat.tabcontentEls.find(".suspend-bar").remove()};Chat.userList.on("click","li a",function(e){e.preventDefault();var t=$(this),i=Chat.getGroupStatus();if(i){var a=Chat.groupHistory[i],n=$(this).attr("data-uid"),o=Chat.usersData[n]?Chat.usersData[n]:ChatGroups.get(n);if(!o)return;!Chat.groupLastModify[i]||Chat.groupLastModify[i]==n||-1!=i&&5!=i||(chatUserPresenter.setStatus(Chat.groupLastModify[i],6,!1),Chat.groupLastModify[i]=void 0,Chat.usersData[n].relationType=6),o.newMsgCount&&5==i&&$(this).parent("li").addClass("modify"),chatUserPresenter.viewed(a,n)}Chat.renderTimer&&clearTimeout(Chat.renderTimer),Chat.renderTimer=setTimeout(function(){s(),1==t.attr("data-group")?(Chat.renderGroupBox(t),Chat.chatEl.addClass("chat-group-wrap"),Chat.detailContainer.addClass("group-detail-box"),__conversion("group_chat_"+t.attr("data-uid"))):(Chat.detailContainer.removeClass("group-detail-box"),Chat.chatEl.removeClass("chat-group-wrap"),Chat.renderBox(t.attr("data-uid"),t.attr("data-eid"),t,null,e),"_T"in window&&_T.setFriendSource(o.friendSource)),Chat.chatEl.toggleClass("chat-geek-other",1==o.friendSource)},50),Chat.chatList.find(".ceiling-card").remove(),Chat.prevUid=Chat.curUserData&&(Chat.curUserData.uid?Chat.curUserData.uid:Chat.curUserData.groupId)}),Chat.detailContainer.on("click","a._systemEvent",function(){var e=$(this);ChatRecord.initChatRecords(e).then(function(e){ChatRecord.renderChatRecordsPopup(e.htmlList)})}),Chat.detailContainer[0].ondrop=function(e){e.preventDefault();var t=e.dataTransfer.files;$.each(t,function(e,t){var i="pic_"+Date.now()+"_"+e,a=new FileReader;a.onload=function(e){var a=new Image;a.src=e.target.result,Publisher.editorInput.append($(a).attr("title","[图片]").attr("pic-id",i).addClass("picture-insert")),Publisher.files[i]={},Publisher.files[i].file=t,Publisher.files[i].base64=e.target.result,Publisher.submitBtn.removeClass("btn-disabled")},a.readAsDataURL(t)})},Chat.detailContainer[0].ondragover=function(e){e.stopPropagation(),e.preventDefault()},document.ondragover=function(e){e.stopPropagation(),e.preventDefault()},document.ondrop=function(e){e.stopPropagation(),e.preventDefault()},Chat.chatList.on("click",".message-note-entry",function(){NodeMessage.use(Chat.curUserData,{})}),Chat.tabcontentEls.on("click",".suspend-bar .btn-unlock-geek",function(){Chat.checkUserBlock()&&GeekHotProp.shop(Chat.curUserData.infoData.page,{callBack:Chat.ublockBlockGeek})}),Chat.chatEl.on("click",".msg-item-unlock",function(){Chat.unlockMessages({from:"received"})}),Chat.userList.on("mouseover","li",function(e){var t=$(this),i=t.find(".title"),a=i.find(".user-operation div"),n=t.offset().left+t.outerWidth(),s=t.offset().top;i.addClass("opacitas"),a.css({left:n,top:s})}),Chat.userList.on("mouseout","li",function(e){$(this).find(".title").removeClass("opacitas")}),Chat.userList.on("mouseover","li .reason-brief",function(e){var t=$(this).offset(),i=$(this).parents("a").attr("data-uid"),a=Chat.usersData[i].filterReasonList||[];if($(".filter-reason-tooltip").remove(),!(a.length<2)){var n=$('<div class="filter-reason-tooltip"><div class="tooltip-inner">该牛人的不符项还有：<p>'+a.join("、")+"</p></div></div>");n.css({left:t.left+$(this).width()+15,top:t.top-27}),$("body").append(n)}}),Chat.userList.on("mouseout","li .reason-brief",function(e){$(".filter-reason-tooltip").remove()}),Chat.containerChat.on("click",".vip-filter-bar",function(){$(this).hasClass("bought")||$(this).hasClass("not-set")||$.get("/wapi/zpblock/friend/filter/guide?from=34",function(e){if(2===e.zpData.flag){$.dialog({title:"过滤不符牛人",content:'<div><p class="desc">自动过滤不符牛人，急速提升工作效率</p><p class="vip-filter-banner"></p><a href="javascript:;" class="vip-but">开通VIP立享该特权   </a></div>',confirmText:!1,cancelText:!1,wrapClass:"vip-filter-tip flex-dialog-wrap",inline:!0,onOpen:function(e){$(e).on("click",".vip-but",function(){$(e).remove(),Commercial.vip({sf:34},function(){Chat.containerChat.find(".vip-filter-bar").remove(),Chat.containerChat.find(".vip-filter-tap").removeClass("vip-filter-tap"),Chat.addfilterTab(),Publisher.vipFilter()})})},onConfirm:function(e){}})}else Chat.containerChat.find(".vip-filter-bar").remove(),Chat.containerChat.find(".vip-filter-tap").removeClass("vip-filter-tap")})}),Chat.containerChat.on("click",".not-set .go-to-not-ok-geek",function(){Chat.containerChat.find(".group-vip-filter a").eq(0).click()}),Chat.containerChat.on("click",".vip-filter-bar .i-vip-close",function(e){$(".sec-content").removeClass("vip-filter-tap"),$(".vip-filter-bar").remove(),$(this).parents(".vip-filter-bar").hasClass("bought")?PageSet.settings("vip-filter-notice",(new Date).getTime()):$(this).parents(".vip-filter-bar").hasClass("not-set")?PageSet.settings("vip-filter-not-set",(new Date).getTime()):PageSet.settings("vip-filter-tip",(new Date).getTime()),e.stopPropagation()}),Chat.userList.on("click",".user-operation .user-operation-item",function(e){var t=$(this),i=t.attr("data-uid"),a=t.attr("data-type");"delete"==a?(Chat.deleteLinkman(t),e.stopPropagation()):"report"==t.attr("data-type")||("settop"==a?(Chat.changeTop(t),e.stopPropagation()):"access"==a&&(e.stopPropagation(),e.preventDefault(),$.post("/wapi/zprelation/friend/bossRemoveFilter",{encryptFriendId:Chat.usersData[i].encryptUid},function(){var e=t.parents("li");e.prepend('<p class="deal-layer icon-commun"><i></i>设为符合</p>'),e.attr("class","user-communication"),e.addClass("dealSlideRight"),setTimeout(function(){e.slideUp(function(){e.remove()})},500),Chat.usersData[i].isFiltered=!1,Chat.setFilterCount()}))),e.preventDefault()}),Chat.canShowStickerMessage=!1,document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState?Chat.canShowStickerMessage=!0:"visible"==document.visibilityState&&(Chat.canShowStickerMessage=!1,Chat.Sticker.clear())}),$(document).on("click",".fail-tips .close",function(){$(".fail-tips").remove()}),$(document).on("click",".no-good-pop .close",function(){$(".no-good-pop-mask").remove()});var o='<div class="no-good-pop-mask"><div class="set-item no-good-pop"><div class="close"></div><h3 class="title">当您点击［不合适］按钮时</h3><dl><dt>您是否期望向牛人自动发送一条信息？</dt><dd><form action="/setting/notify/msg.json" method="post"><input type="hidden" name="type" value="4"><input type="hidden" name="token" value=""><input type="hidden" name="reasonType" value=""><div class="radio-list"><label class="radio"><input type="radio" ka="setting-notsuitable-msg0" name="sendMsg" value="0"><span>不发送信息</span></label><label class="radio"><input type="radio" ka="setting-notsuitable-msg1" name="sendMsg" value="1"><span>发送消息"您不太适合我们公司"</span><em class="vline"></em><a href="javascript:;" ka="setting-notsuitable-eidtmsg" class="link-modify">修改</a></label><label class="radio"><input type="radio" ka="setting-notsuitable-msg2" name="sendMsg" value="2"><span>根据不合适原因发送不同的消息</span></label></div><div class="defined-form show-defined-form show-defined-tab"><p class="tip-text">请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！</p><div class="defined-tab"><ul><li data-reason="13" data-text="" class="cur">牛人简历不真实</li><li data-reason="2" data-text="">工作年限不符</li><li data-reason="3" data-text="">学历不符</li><li data-reason="4" data-text="">薪资不符</li><li data-reason="10" data-text="">过往经验不符</li><li data-reason="14" data-text="">年龄不符</li><li data-reason="11" data-text="">该求职者已找到工作</li><li data-reason="12" data-text="">距离太远</li><li data-reason="5" data-text="">其他原因</li></ul></div><textarea class="ipt ipt-area" name="msgContent" data-range="1,200" placeholder="输入消息..." data-text=""></textarea><span class="count-num"><em>0</em>/200</span></div></form></dd></dl><button type="button" ka="setting-notsuitable-save" class="btn">保存</button></div></div>';if($(document).on("input",".no-good-pop .ipt",function(e){$(".defined-tab .cur").attr("data-text",e.target.value)}),$(document).on("click",".no-good-pop .radio",function(e){setTimeout(function(){$(".no-good-pop input[name=reasonType]").val()?$(".no-good-pop .btn").text("保存“"+$(".no-good-pop").find(".defined-tab .cur").text()+"“信息"):$(".no-good-pop .btn").text("保存")},0)}),$(document).on("click",".fail-tips .set",function(){e()}),$(document).on("click",".chat-controls .no-reply-text",function(){e()}),$(document).on("click",".defined-tab li",function(){var e=$(this).closest("form");$(this).parent().find(".cur");$(this).parent().find("li").removeClass("cur"),$(this).addClass("cur"),e.find('input[name="reasonType"]').val($(this).attr("data-reason")),e.find(".ipt-area").val($(this).attr("data-text")),Chat.countAreaLength(e.find(".ipt-area")),$(".no-good-pop .btn").text("保存“"+e.find(".defined-tab .cur").text()+"“信息")}),$(document).on("click",".no-good-pop .btn",function(){if($("dl").find(".defined-form .count-num .red").length)return $(".defined-form .tip-text").text("内容不能超过200个字"),$("dl").find(".defined-form .ipt-area").focus(),!1;var e=$(".radio-list input[type=radio]:checked").val(),t=2==e?"radioChange":"";Chat.saveNoGoodReason(t)}),$(document).on("click",".radio-list .link-modify",function(){$(this).closest(".radio").find('input[type="radio"]').prop("checked","checked"),$(this).closest("dl").find(".defined-form").addClass("show-defined-form").removeClass("show-defined-tab"),$(this).closest("form").find('input[type="reasonType"]').val(""),$(this).closest("form").find(".ipt-area").text($(this).closest("form").find(".ipt-area").attr("data-text")),$(this).closest("dl").find(".defined-form .tip-text").text("请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！");var e=$("input[name=sendMsg][value=1] +span").text(),t=e.substring(5,e.length-1);$(".ipt-area").val(t),$(this).closest("dl").find(".count-num").length&&Chat.countAreaLength($(this).closest("dl").find(".ipt-area")),setTimeout(function(){$(".no-good-pop .btn").text("保存")},0)}),$(document).on("input",".defined-form .ipt-area",function(){Chat.countAreaLength($(this))}),Chat.toggleTypeEl.on("click","span",function(e){var t=$(this),i=t.index();if(t.hasClass("unboss-geek-notice"))return void Chat.showDZNotice();if(!t.parent().hasClass("dropdown-wrap")){if(2==i&&t.hasClass("gray"))return void t.parent().find(".dropdown-wrap").show();t.parent().children().removeClass("cur"),t.addClass("cur"),Chat.containerChat.find(".sel-type").removeClass("dropdown-open"),Chat.tabcontentEls.removeClass("show-box"),Chat.tabcontentEls.eq(i).addClass("show-box"),Chat.chatEl.find(".chat-list").css("visibility","visible"),Chat.chatEl.find(".chat-wrap-mask").remove(),"chat-box"==t.attr("data-target")&&Publisher.editorInput.focus(),0!=i||e.isTrigger||Chat.sendKaEvent("Geekshow_tab_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid),i>0?Chat.chatEl.find(".detail-bottom").show():Chat.chatEl.find(".detail-bottom").hide(),1==i&&(s(),Resume.loadDetail(Chat.userList.find(".cur a").attr("href"),Chat.resumeContainer,e.isTrigger)),2==i&&(s(),Resume.loadAttachment("/wapi/zpgeek/resume/preview4boss/check.json?geekId="+Chat.userList.find(".cur a").attr("data-eid"),Chat.attachContainer,e.isTrigger))}}),Chat.toggleTypeEl.on("click",'li[data-type="resume"]',function(){Publisher.showExchangeResume($(this).closest(".dropdown-wrap").find(".dropdown-label"))}),Chat.opTopEls.on("click",".op-btn",function(){Chat.doTopCommonOp($(this))}),Chat.containerChat.on("click",".detail-bottom .btn, .detail-bottom .btns a, .chat-controls .links a",function(e){if($(this).hasClass("btn-interview"))return!0;if($(this).hasClass("link-chat")&&Chat.toggleTypeEl.find("span[data-target=chat-box]").trigger("click"),!$(this).hasClass("cur")){if($(this).hasClass("link-fail")){if("no-reply-text"==$(e.target).attr("class"))return;return void Chat.isSendNotOkMessage($(this))}if($(this).hasClass("link-cancel-fail")){var t={url:"/wapi/zprelation/relation/delUnSuitable.json",data:{encryptFriendId:Chat.curUserData.encryptUid}};Chat.setWorkflow(Chat.curUserData,$(this),"",null,!1,!1,!1,t)}Chat.workflowTip($(this))}}),$(document).on("click",function(e){0==$(e.target).parents(".dropdown-open").length&&$(".dropdown-open").removeClass("dropdown-open")}),Chat.chatListCon.on("click",".interview-card",function(){Chat.getInterviewDetail($(this).attr("data-id"))}),Chat.chatListCon.on("click",".img-tiny",function(){if($(this).attr("data-large")){var e=$(this).closest("ul").find(".img-tiny").filter(function(){return $(this).attr("data-large")}),t=e.index($(this)),i=e.length>1&&0!==t,a=e.length>1&&t!==e.length-1;Chat.viewLargeImage($(this),{hasPrev:i,hasNext:a,prevCallback:function(i){var a=t-1;i.find(".img-viewer-next-btn").removeClass("hide"),a<=0&&(a=0,i.find(".img-viewer-prev-btn").addClass("hide"));var n=e.eq(a);i.find(".img-viewer img").attr("src",n.attr("data-large"))[0].onload=function(){Chat.changeImgViewerCss(i,n.attr("large-y"))},t=a},nextCallback:function(i){var a=t+1;i.find(".img-viewer-prev-btn").removeClass("hide"),a>=e.length-1&&(a=e.length-1,i.find(".img-viewer-next-btn").addClass("hide"));var n=e.eq(a);i.find(".img-viewer img").attr("src",n.attr("data-large"))[0].onload=function(){Chat.changeImgViewerCss(i,n.attr("large-y"))},t=a}})}}),Chat.chatListCon.on("click",".btn-store",function(){var e=$(this);Emotion.storeEmotion(e)}),Chat.chatListCon.on("click",".item-file .text",function(){Chat.viewFullResume($(this).find("p").attr("data-origin"))}),Chat.chatEl.on("click",".link-job",function(){var e=$(this),t=e.attr("data-jobid"),i="/bossweb/job/"+t+".html";$.toast({content:"正在加载职位详情...",type:"loading"});var a=function(t){window.top.$.dialog({title:"",content:t,closeText:!0,confirmText:"确定",cancelText:!1,wrapClass:"dialog-layer-full dialog-resume-full pop-position-detail",lock:!0,onOpen:function(t){t.find(".dialog-footer .btns").prepend(e.closest("li").find(".icon-coop").clone()),t.find(".dialog-con").on("click",function(e){$(e.target).parents(".dialog-con").length||t.remove()})},onConfirm:function(e){e.remove()}})};$.get(i).success(function(e,t,i){var n;n="error"==t?'<div class="data-tips"><div class="data-blank"><i class="tip-errordata"></i><b>数据加载出错</b></div></div>':e,setTimeout(function(){$("#toast").remove(),n='<div class="resume-dialog">'+n+"</div>",a(n)},500)})}),Chat.chatEl.on("click",".btn-position",function(){Publisher.showPosition($(this))}),Chat.chatEl.on("mouseover",".btn-position .iboss-editor-exchange",function(){$(this).closest(".btn-position").find("span").show()}),Chat.chatEl.on("mouseleave",".btn-position .iboss-editor-exchange",function(){$(this).closest(".btn-position").find("span").hide()}),Chat.directionEl.on("click","a",function(){Chat.changeUserView($(this))}),Chat.resumeContainer.on("click",".link-getphone",function(){var e=$(this);e.hasClass("disabled")||$.confirm({content:"确认与对方交换电话吗？",title:"温馨提示",closeIcon:!0,columnClass:"",onOpen:function(){},confirm:function(){Chat.exchangePhone(2,{from:{uid:Chat.curUserData.uid}}),e.text("已发出请求").addClass("disabled")},error:function(e){}})}),Chat.chatEl.on("click",".item-base img, .item-friend .figure img",function(){if(Chat.curUserData.groupId&&Chat.curUserData.type<1)return!1;var e=!!Chat.curUserData.groupId,t=e?Chat.curUserData.groupId:Chat.curUserData.uid,i=Chat.usersData[t]?Chat.usersData[t].infoData.largeAvatar:$(this).attr("src").replace("_s",""),a=Chat.usersData[t]?Chat.usersData[t].infoData.name:$(this).parents("li").find(".item-name").text();i||(i=$(this).attr("src"));var n='<div class="figure-preview"><div class="figure-mask">'+a+'</div><img src="'+i+'" /></div>';$.dialog({title:"",content:n,confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-figure-preview",lock:!0,opacityLock:!0,onOpen:function(e){},onConfirm:function(e){},onClose:function(e){}})}),window.localStorage)for(var r=0;r<localStorage.length;r++)localStorage.key(r).indexOf("/chatws:ws-")>-1&&localStorage.removeItem(localStorage.key(r));Chat.initSearchBar(),Chat.initRemark(),Chat.socketBeat(),Chat.initGroupChat(),Chat.chatEl.on("click",".show-item",function(){$(this).hide(),$(this).parents(".item-container").addClass("item-all")}),PageSet.getTipData(function(e){e.rescode&&e[18]&&(Chat.chatEl.find(".btn-position").attr("link-show","show"),Chat.chatEl.find(".btn-position .tips").show())}),Chat.chatEl.find(".btn-position .tips em").on("click",function(e){try{_T.sendEvent("pop_position_sure")}catch(e){}e.stopPropagation();var t=$(this);$.ajax({url:"/setting/notify/set.json",data:{type:18},type:"post",success:function(e){e.rescode&&t.parents(".tips").hide()}})}),Chat.chatEl.find(".btn-message .note-message-tip").on("click",function(e){e.stopPropagation(),"i"==e.target.tagName.toLowerCase()&&(PageSet.settings("note-message-tip",1),Chat.chatEl.find(".btn-message .note-message-tip").remove(),Chat.chatEl.find(".btn-message span").hide())}),Chat.chatBox.on("click",".nlp-sug-container span",function(e){var t=$(this).data("type");Chat.handleNLP(t,$(this)),$(this).closest(".nlp-sug-container").fadeOut(function(){$(this).remove()});var i=[{key:"action",value:"accept"},{key:"form_id",value:String(_PAGE.uid)},{key:"to_id",value:String(Chat.curUserData.uid)},{key:"type",value:String(t)},{key:"chat_type",value:String(1)},{key:"msg_id",value:String(Chat.curUserData.lastMsgId)}];ChatWebsocket.sendIqMessage(i);try{var a={action:"chat-nlp-remind-click",bg:1,uid:_PAGE.uid,p:Chat.curUserData.uid,p2:$(this).text(),p3:t};Block.action(a)}catch(e){}}),Chat.chatBox.on("click",".nlp-sug-container .close",function(e){var t=$(this).closest("span").data("type");$(this).closest(".nlp-sug-container").remove();var i=[{key:"action",value:"delete"},{key:"form_id",value:String(_PAGE.uid)},{key:"to_id",value:String(Chat.curUserData.uid)},{key:"type",value:String(t)},{key:"chat_type",value:String(1)},{key:"msg_id",value:String(Chat.curUserData.lastMsgId)}];ChatWebsocket.sendIqMessage(i),e.stopPropagation(),e.preventDefault();try{var a={action:"chat-nlp-remind-close",bg:1,uid:_PAGE.uid,p:Chat.curUserData.uid,p3:t};Block.action(a)}catch(e){}}),sessionStorage.getItem("satisfactionNPS")||(sessionStorage.setItem("satisfactionNPS","1"),Chat.satisfactionNPS()),Chat.chatBox.on("click",".chat-map-box",function(){var e=$(this).find("img").attr("src").match(/:([^&]+)/g),t=e[1].replace(":",""),i=$(this).find(".address").text(),a=['<div id="job-location-container">','<div class="job-location"><i class="iboss-dizhi"></i>'+i+"</div>",'<div id="job-map-container" data-long-lat="'+t+'"></div>',"</div>"];$.dialog({content:a.join(""),title:"",closeText:!0,cancelText:"",confirmText:"",wrapClass:"map-pop",onOpen:function(e){var a=t.split(","),n=new AMap.Map("job-map-container",{resizeEnable:!0,scrollWheel:!0,center:[a[0],a[1]],zoom:16}),s=(n.on("click",function(){}),n.on("mouseout",function(){}),new AMap.Marker({map:n,position:[a[0],a[1]],icon:new AMap.Icon({size:new AMap.Size(42,50),image:"https://static.zhipin.com/zhipin/v40/web/geek/images/icon-poi.png",imageOffset:new AMap.Pixel(0,-60)})}));AMap.event.addListener(s,"click",function(){infoWindow.open(n,s.getPosition())}),AMap.plugin(["AMap.ToolBar","AMap.Scale"],function(){var e=new AMap.ToolBar,t=new AMap.Scale;n.addControl(e),n.addControl(t)}),infoWindow=new AMap.InfoWindow({content:i,offset:new AMap.Pixel(5,-25)}),infoWindow.open(n,n.getCenter()),e.find(".dialog-container").css({margin:"-250px 0 0 -330px"})}})})},handleNLP:function(e,t){var i=t.closest(".nlp-sug-container");switch(e){case 3:Chat.exchangePhone(2,{from:{uid:Chat.curUserData.uid}},i),Chat.sendKaEvent("Geekchat_mobile_nlp_chatview_"+Chat.curUserData.uid);break;case 4:Chat.exchangeWeixin(2,{from:{uid:Chat.curUserData.uid}},i),Chat.sendKaEvent("Geekchat_weixin_nlp_chatview_"+Chat.curUserData.uid);break;case 5:Chat.exchangeResume(2,{from:{uid:Chat.curUserData.uid}},i),Chat.sendKaEvent("Geekchat_resume_nlp_chatview_"+Chat.curUserData.uid);break;case 7:var a=Number(t.data("value"));Publisher.interview(Publisher.editorControls.find("a.btn-interview"),"dialog-up-default",{appointmentTime:a}),Chat.sendKaEvent("Geekchat_interview_nlp_chatview_"+Chat.curUserData.uid);break;case 8:Chat.sendPositionMap(Chat.curUserData.uid,Chat.curUserData.jobId||Chat.curUserData.infoData&&Chat.curUserData.infoData.jobId),Chat.sendKaEvent("Geekchat_interview_nlp_chatview_"+Chat.curUserData.uid)}},showDZNotice:function(){$.dialog({title:"此牛人来自店长直聘",cancelText:!1,content:'<div><p class="gray">您可以与来自店长直聘的牛人直接沟通。</p><dl><dt>暂不支持如下功能：</dt><dd>·暂不支持访问牛人的个人主页；</dd><dd>·暂不支持收藏、转发、交换电话/微信/简历等操作；</dd><dd>·暂不支持发起语音通话、视频面试等；</dd><dd>·您的互动记录中不会显示该牛人；</dd></dl><p class="gray" style="padding-top:10px; font-size:13px;">*Boss直聘与店长直聘均为看准科技集团旗下求职、招聘服务平台</p></div>',wrapClass:"chat-zdgeek-notice flex-dialog-wrap"})},addfilterTab:function(){Publisher.getState(function(e){var t=Chat.usersID.filter(function(e){return Chat.usersData[e.uid]&&Chat.usersData[e.uid].isFiltered})
;if((1===e.vipFriendFilterState||t.length)&&!Chat.containerEl.find(".op-category .group-vip-filter").length){var i='<div class="group-btns group-vip-filter"><i class="icon-vip"></i><div class="filter-tooltip"><p>这里是根据你的消息过滤设置过滤掉的牛人消息，点击查看这些消息</p></div><a ka="chat-relationtype10" href="javascript:;" data-status="10" class="">不符牛人（'+t.length+'）</a><a ka="chat-vip-filter" href="javascript:;" class="vip-filter-setting"><i class="iboss-guolvshezhi"></i></a></div>';Chat.containerEl.find(".op-category").append(i)}})},getGeekById:function(e,t){var e=parseInt(e,10),t=t?parseInt(t,10):0,i=1==t?e+1e8:e;return Chat.usersData[i]},setFilterCount:function(){var e=Chat.usersID.filter(function(e){return Chat.usersData[e.uid]&&Chat.usersData[e.uid].isFiltered});Chat.containerChat.find(".group-vip-filter a").eq(0).text("不符牛人（"+e.length+"）")},radiosBindEvents:function(){$(document).on("change",'input[type="radio"]',function(){var e=$(this).closest("form");e.find(".defined-tab").length&&2==$(this).val()?(e.find('input[name="reasonType"]').val(e.find(".defined-tab .cur").attr("data-reason")),e.find(".defined-form").addClass("show-defined-form show-defined-tab"),e.find(".ipt-area").attr("placeholder","输入回复内容，内容为空则不发送").val(e.find(".defined-tab .cur").attr("data-text")),Chat.countAreaLength(e.find(".ipt-area")),$(".defined-form .tip-text").text("请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！")):0==$(this).val()?($(this).closest("form").find(".defined-form").removeClass("show-defined-form"),e.find('input[name="reasonType"]').val("")):1==$(this).val()&&(e.find(".defined-tab").length&&(e.find('input[name="reasonType"]').val(""),e.find(".defined-form").removeClass("show-defined-form"),e.find(".ipt-area").attr("placeholder","输入消息...").val(e.find(".ipt-area").attr("data-text"))),$(".defined-form .tip-text").text("请不要填写手机、QQ、微信等联系方式或广告信息，否则系统将封禁您的账号！"))})},countAreaLength:function(e){var e=e,t=e.attr("data-range"),i=Chat.calculateStringLength(e.val()),a=e.closest(".defined-form").find(".count-num");a&&a.length&&(t=t.split(","),a.html("<em"+(i>t[1]?' class="red"':"")+">"+i+"</em>/"+t[1]))},calculateStringLength:function(e){for(var t=0,e=e,i=e.length,a=-1,n=0;n<i;n++)a=e.charCodeAt(n),t+=a>=0&&a<=128||a>=65248&&a<=65373||12288==a||12289==a||12290==a?.5:1;return Math.round(t)},saveNoGoodReason:function(e){var t=$(".radio-list").closest("form"),i=t.attr("action"),a=t.serialize();$(".show-defined-form").length;$.ajax({url:i,type:"POST",data:a,dataType:"JSON",timeout:3e4,success:function(e){e.rescode?($.toast({content:"保存成功",type:"success"}),$(".no-good-pop-mask").remove()):$.toast({content:e.resmsg,type:"error"})},error:function(e){$.toast({content:"保存失败，请检查网络后重试",type:"error"})}})},isSendNotOkMessage:function(e){$.ajax({url:"/wapi/zprelation/relation/getWebSetting4NotOk.json",type:"get",success:function(t){var i=t.zpData.webSetting4NotOkVO,a=i.sendMsgType;0===a||1===a||-1===a?Chat.workflowTip(e):2===a&&Chat.mismatching(e)},error:function(e){$.toast({content:e.message,type:"error"})}})},socketBeat:function(){function e(e){var a={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};e=e||window.event,(i=e.type in a?a[e.type]:!this[t])&&"ChatWebsocket"in window&&ChatWebsocket.client&&!ChatWebsocket.client.isConnected()&&ChatWebsocket.reConnection()}var t="hidden",i=!0;t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e},XssText:function(e){return(""+e).replace(/</g,"&#60;").replace(/>/g,"&#62;").replace(/\n/g,"<br/>").replace(/\\n/g,"<br/>").replace(/&amp;middot;/g,"&#183;").replace(/&amp;lt;/g,"&#60;").replace(/&amp;gt;/g,"&#62;").replace(/&lt;/g,"&#60;").replace(/&gt;/g,"&#62;").replace(/&middot;/g,"")},mismatching:function(e){var t=function(e){for(var t=[],i=0;i<e.length;i++)13==e[i].code&&(t[0]=e[i]),2==e[i].code&&(t[1]=e[i]),3==e[i].code&&(t[2]=e[i]),4==e[i].code&&(t[3]=e[i]),10==e[i].code&&(t[4]=e[i]),14==e[i].code&&(t[5]=e[i]),11==e[i].code&&(t[6]=e[i]),12==e[i].code&&(t[7]=e[i]),5==e[i].code&&(t[8]=e[i]);return Utemplate('<div class="subhead"><p class="gray">根据不合适原因，向牛人发送消息</p></div><ul><%for(var i=0;i<this.list.length;i++){%><li data-reason="<%this.list[i].code%>"><%this.list[i].optionName%><%if(this.list[i].sendMsg != 0 && this.list[i].content){%><i class="icon-config"></i><%}%><%else{%><div class="no-message">不发消息</div><%}%><%if(this.list[i].sendMsg != 0 && this.list[i].content){%><div class="config-text"><%this.list[i].content%></div><%}%></li><%}%></ul>',{name:Chat.curUserData.name,list:t})};e.addClass("unfold"),function(){var e=$.Deferred();return $.get("/wapi/zprelation/relation/getWebSetting4NotOk.json",function(t){e.resolve(t.zpData.webSetting4NotOkVO.optionVOList)}),e}().then(function(i){$.dialog({title:"",content:t(i),closeText:!1,confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-up-default dialog-link-fail",position:"around",lock:!0,element:e,opacityLock:!0,onOpen:function(t){t.find("li").on("click",function(){e.attr("data-reason",$(this).attr("data-reason")),Chat.workflowTip(e,null,$(this).attr("data-reason")),t.remove(),e.removeClass("unfold")})},onClose:function(){e.removeClass("unfold")}})})},getGroupStatus:function(){return Chat.containerChat.find(".op-category .cur").attr("data-status")},getQueryParams:function(){var e=$(".top-chat .dropdown-select"),t=Chat.containerChat.find(".op-category .cur"),i=$(".condition-filter dl");return{status:t.attr("data-status")||"-1",origin:t.attr("data-origin")||"-1",jobid:e.attr("data-jobid")||"-1",salary:i.eq(0).find(".cur").attr("data-salary"),experience:i.eq(1).find(".cur").attr("data-experience"),degree:i.eq(2).find(".cur").attr("data-degree")}},getDraft:function(e){Chat.drafts=function(){var e=sessionStorage.getItem("__Chat__Drafts");return""==e||null==e||void 0==e?[]:$.parseJSON(e)}();var t=Chat.drafts.filter(function(t){return t.uid==e});return t.length?t[0]:{}},deleteDraft:function(e){if(e){var t=Chat.drafts.find(function(t){return t.uid==e});if(t){var i=Chat.drafts.indexOf(t);Chat.drafts.splice(i,1)}sessionStorage.setItem("__Chat__Drafts",__stringify(Chat.drafts))}},saveDraft:function(){var e=Chat.curUserData.uid,t=Publisher.editorInput.html(),i=Publisher.filterPicture(t),a=Publisher.htmlConverToMessage(i.html).replace(/</g,"&#60;").replace(/>/g,"&#62;"),n=Chat.getDraft(e);if(n.uid){var s=Chat.drafts.indexOf(n);Chat.drafts.splice(s,1)}e&&a&&""!=$.trim(a)&&Chat.drafts.push({uid:e,text:a,content:i.html}),sessionStorage.setItem("__Chat__Drafts",__stringify(Chat.drafts))},setDraft:function(e){var e=e||Chat.prevUid,t=Publisher.editorInput.html(),i=Publisher.htmlConverToMessage(t).replace(/</g,"&#60;").replace(/>/g,"&#62;");if(e){if(e&&i&&""!=$.trim(i)){var a=Chat.userList.find('a[data-uid="'+e+'"]').find(".title .draft");a.length||(a=$('<p class="draft"></p>'),Chat.userList.find('a[data-uid="'+e+'"]').find(".title").append(a)),a.html('<i class="status status-draft">[草稿]</i>'+i)}!e||i&&""!=i||Chat.userList.find('a[data-uid="'+e+'"]').find(".title .draft").remove()}},addTip:function(){var e=Chat.containerChat.find(".op-category .cur"),t=e.attr("data-status")?e.attr("data-status"):101,i=(e.attr("data-status")?e.attr("data-status"):e.attr("data-origin"),{"-1":"在「<span>全部</span>」中，可以找到近30天的联系人",1:"首次给你发消息的牛人可以方便的在「<span>新牛人</span>」中统一处理",5:"「<span>新招呼</span>」中包含所有你未回复的牛人",6:"和你聊过的牛人，将会自动归档在「<span>沟通中</span>」方便你继续沟通哦～",7:"聊得来的牛人很可贵，把他们标记为「<span>合适</span>」吧",8:"被标记为「<span>不合适</span>」的牛人，你将不会再收到Ta的新消息提示",9:"发送了面试邀请的牛人会在「<span>已约面</span>」   中显示",10:"被标记为「<span>不符牛人</span>」的牛人，你将不会再收到Ta的新消息提示",101:'来自同事推荐等功能全部收集在「<span><i class="icon-category-vdot"></i></span>」里面，进去看看吧',11:"添加过星标的牛人，将在「<span>星标</span>」中显示"}),a="<p><b>Tips：</b>"+i[t]+"</p>";Chat.detailContainer.find(".welcome-tips").empty().append(a)},scrollToByUser:function(e){var t=Chat.userList.find("a[data-uid="+e+"]"),i=Chat.containerChat.find(".op-category .cur").attr("data-status");if(!t.length&&1!=i){var a=Chat.renderUser(Chat.usersData[e]);Chat.userListMain.append(a),t=Chat.userList.find("a[data-uid="+e+"]")}t.trigger("click"),t.closest(".main-list").length&&Chat.userList.find(".top-list li").length?Chat.userList.scrollTop(t.parent().height()*(t.parent().index()+Chat.userList.find(".top-list li").length)):Chat.userList.scrollTop(t.parent().height()*t.parent().index())},toggleGroupList:function(e,t){var i=0,a=[],n=[];if(t.length)for(i=0;i<t.length;i++){var s=t[i];s>1e3&&!Chat.usersdata[s]?a.push(s):s>1e3&&n.indexOf(s)<0&&n.push()}if(result.data.length){var i,t=result.data;for(i=0;i<t.length;i++)t[i]>1e3&&!Chat.usersData[t[i]]?ids.push(t[i]):t[i]>1e3&&!existObj[t[i]]&&(existIds.push(t[i]),existObj[t[i]]=Chat.usersData[t[i]],existArr.push(Chat.usersData[t[i]]));Chat.getAddUsers(ids,existIds,existArr,toggle),Chat.tipsContainer.html("").hide(),Chat.userList.show(),Chat.containerChat.find(".chat-search").show(),$(".chat-container .scroll-wrapper").show(),Chat.detailContainer.show(),Chat.userList.find(".user-blank").remove();var e=Chat.containerChat.find(".op-category .cur").attr("data-status");if(e&&Chat.groupHistory[e]){var s=Chat.groupHistory[e];Chat.userList.find("a[data-uid="+s+"]");Chat.scrollToByUser(s)}}else{Chat.userList.find("ul").empty();var o={5:"暂无新牛人",6:"暂无沟通中的牛人",8:"暂无不合适的牛人",10:"暂无已约面的牛人"},r=Chat.getGroupStatus(),c=ChatGeeksFilter.data();c.conversationType?Chat.containerChat.find(".user-bar-checked").text():o[r],Chat.tabEmpty()}Chat.addTip(),Chat.chatEl.hide(),Chat.welcomeEl.show(),setTimeout(function(){Chat.containerChat.find(".loading-category-refresh").removeClass("loading-category-refresh")},300)},tabEmpty:function(){var e={5:"新招呼",6:"沟通中",8:"不合适",9:"已约面",10:"不符"},t=Chat.getGroupStatus(),i=e[t]||"";Chat.userList.find(".user-blank").remove();var a;10==t?Publisher.privilege&&(1===Publisher.privilege.friendFilterSetState?a='<div class="user-blank user-blank-not"><div class="empty-icon"></div><p class="no-setting-text">已设置过滤条件，还没有不符消息收入</p><p class="setting">前往更改设置</p></div>':0===Publisher.privilege.friendFilterSetState&&(a='<div class="user-blank user-blank-not"><div class="empty-icon"></div><p class="no-setting-text">还未设置过滤条件</p><p class="setting">前往设置</p></div>')):a='<div class="user-blank"><p class="common-no-data">暂无'+i+"牛人</p></div>",Chat.userList.append(a),Chat.userList.find(".loadmore").hide()},getUsersId:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].uid);return t},getFilterUsers:function(e,t){var i=ChatGeeksFilter.data();Chat.curUserData={};var a=(INTERFACE_URLS.chatFilterUsersUrl,[]),n=[],s={},o=[],r=function(e){var r=(e.data,e.data);if(r.length||ChatGroups.all().length&&"群聊"===i.conversationType){if(e.isGroup)return Chat.addTip(),Chat.userList.find(".user-blank").remove(),Chat.chatEl.hide(),Chat.welcomeEl.show(),Chat.renderGroupList(),!0;var c;for(c=0;c<r.length;c++)if(r[c]>1e3&&!Chat.usersData[r[c]])a.push(r[c]);else if(r[c]>1e3&&!s[r[c]]){var l,d=r[c];if(e.workdata){var u=e.workdata.filter(function(e){return e.geek==d});l=$.extend(Chat.usersData[d],u[0])}else l=Chat.usersData[d];n.push(d),s[d]=l,o.push(l)}Chat.usersInitStatus&&Chat.getAddUsers(a,n,o,t),Chat.tipsContainer.html("").hide(),Chat.userList.show(),Chat.containerChat.find(".chat-search").show(),$(".chat-container .scroll-wrapper").show(),Chat.detailContainer.show(),Chat.userList.find(".user-blank").remove(),Chat.containerChat.find(".sel-batch").removeClass("disabled")}else Chat.userList.find(".loadmore").hide(),Chat.containerChat.find(".sel-batch").addClass("disabled"),Chat.renderUserList([],0);Chat.addTip(),Chat.chatEl.hide(),Chat.welcomeEl.show(),setTimeout(function(){Chat.containerChat.find(".loading-category-refresh").removeClass("loading-category-refresh")},300)};if("群聊"==i.conversationType)return Chat.userlistMoreEl.text("没有更多了").addClass("disabled").show(),r({isGroup:!0,data:ChatGroups.all().sort(function(e,t){return t.isTop-e.isTop||t.lastTS-e.lastTS})}),!0;if($(".user-bar-filter input").is(":checked")&&ChatGeeksFilter.isFull()){var c=Chat.usersID.filter(function(e){var t=Chat.getGeekById(e.gid,e.friendSource),a={};if(t)return a=t.infoData,(t.newMsgCount||a.newMsgCount)&&("-1"==i.jobId||t.jobId==i.jobId)});r({data:Chat.getUsersId(c)})}else Chat.xhrs.userList&&Chat.xhrs.userList.abort(),Chat.xhrs.userList=$.ajax({type:"GET",url:"/wapi/zprelation/friend/filterV2.json",dataType:"JSON",cache:!1,data:i,success:function(e){if(0==e.code){var t=e.zpData.dzFriendIdList.map(function(e){return e+1e8}),i=e.zpData.zpFriendIdList.concat(t);if($(".user-bar-filter input").is(":checked")){var a=i.filter(function(e){var t=Chat.usersData[e],i={};if(t)return i=t.infoData,t.newMsgCount||i.newMsgCount});e.data=[].concat(a)}else e.data=[].concat(i);r(e)}},error:function(e){Chat.userList.find("ul").empty(),Chat.userList.find(".user-blank").remove(),Chat.userList.append('<div class="user-blank"><p>加载出错，请稍后再试</p></div>'),Chat.userList.find(".loadmore").hide()}})},removeToast:function(e){$("#toast").addClass("slideUp"),setTimeout(function(){$("#toast").remove()},e)},batchUserStatus:function(e,t,i){var a=$.Deferred();(new Date).getTime();return $.ajax({url:"/wapi/zprelation/relation/groupset.json",type:"POST",data:{geekId:i.join(","),relationType:e},dataType:"JSON",timeout:5e3,success:function(e){(new Date).getTime();0==e.code&&e.zpData?a.resolve():$.toast({content:e.message,type:"error"})},error:function(){$.toast({content:"批量操作失败",type:"error"})}}),a},batchReadMessage:function(e){Chat.containerChat.find(".op-category .cur").attr("data-status");$.each(e,function(e,t){var i=Chat.usersData[t];i.maxMessageId&&(ChatWebsocket.sendReadMessage({userData:i,uid:t,mid:i.maxMessageId}),Chat.clearMessageCount(i,i.newMsgCount))});var t=-1==Chat.getGroupStatus()?800:1200;setTimeout(function(){Chat.batchHandle.close()},t)},batchUserHandle:function(){var e=function(){return'<div class="batch-operate"><div class="batch-title-box"><div class="batch-title"><em class="batch-cancel">取消</em></div></div><div class="batch-operate-wrap"><div class="batch-operate-box"><img src="/v2/web/boss/images/icon-batch-default.png"><p class="batch-number">已选择<span>0</span>位牛人</p><ul><li class="batch-action batch-unlike" data-action="8"><i></i>不合适</li><li class="batch-action batch-read"><i></i>已读</li><li class="batch-action batch-forward"><i class="iboss-zhuanfa"></i>转发</li></ul></div></div></div>'},t={6:'<p class="deal-layer icon-commun"><i></i>沟通中</p>',7:'<p class="deal-layer icon-pass"><i></i>合适</p>',8:'<p class="deal-layer icon-fail"><i></i>不合适</p>'},i={6:"user-communication",7:"user-pass",8:"user-fail"},a=function(e,a){var n=e,s=i[a]||"";n.attr("class",s),n.find(".deal-layer").length||n.prepend(t[a]),n.addClass("dealSlideRight"),setTimeout(function(){n.slideUp(function(){n.remove(),Chat.userList.find("li").length<1&&Chat.tabEmpty()})},500)},n=function(e,t){var n=i[t]||"",s=Chat.containerChat.find(".op-category .cur").attr("data-status"),o=!1;return-1!=s&&void 0!=s||8==t||!Chat.containerChat.find(".batch-wrap").is(":visible")?($.each(e,function(e,i){a($(i),t)}),o=!0):$(e).attr("class",n),o},s=function(){var e=Chat.containerChat.find(".batch-wrap");$(document).off("keydown",r),Chat.containerChat.find(".op-category").animate({marginTop:0,opacity:1},300),e.find(".batch-title").animate({marginTop:42,opacity:0},300),Chat.containerChat.find(".batch-wrap").remove(),$(".batch-layer").remove()},o=function(){var e=$(".batch-list").find("li.selected").length;$(".batch-wrap").find(".batch-number span").text(e)},r=function(e){var t=Chat.containerChat.find(".batch-wrap .user-list"),i=Chat.userList.filter(":last").scrollTop(),a=(Chat.userList.height(),i>0?Math.ceil(i/76):0),n=Math.floor(Chat.userList.height()/76)-1;t.find(".selected").removeClass("selected"),t.find("li").eq(a).addClass("selected"),t.find("li").filter(":gt("+a+")").filter(":lt("+n+")").addClass("selected"),t.find(".unboss-geek").removeClass("selected").addClass("disabled"),Chat.containerChat.find(".batch-list .user-list").scrollTop(i),o()},c=function(e){if(e.length>10)return $.toast({type:"error",content:"批量转发不能超过10人"}),!1;var t=[];$.each(e,function(e,i){var a=Chat.usersData[i];t.push({encryptGeekId:a.encryptUid,expectId:a.expectId||a.infoData.expectId||0,jobId:a.jobId})}),mediator.publish("FORWARD_GEEK",{type:"batch_forward_geek",geekList:t})},l=function(){if($(this).hasClass("disabled"))return!1;var e=$(".batch-wrap"),t=$(this).attr("data-action"),i=$(this).clone(),a=i.find("span").remove().end().text(),s=e.find(".batch-list .selected"),o=[],r=[],l=800;if(s.length){if($.each(s,function(e,t){var i=$(t).find("a:first-child");o.push(i.attr("data-uid")),r.push(i.attr("data-eid"))}),t&&Chat.batchUserStatus(t,o,r).then(function(){$.each(o,function(e,t){Chat.usersData[t].newMsgCount>0&&Chat.subtractPoint(Chat.usersData[t])}),chatUserPresenter.batch(o,t);var e=n(s,t);l=e?1200:800,$.each(o,function(e,t){Chat.newGeek.indexOf(t)>-1&&(Chat.newGeek.splice(Chat.newGeek.indexOf(t),1),Chat.totalNewGeek())}),$.toast({content:"已置为"+a.replace("置为",""),type:"success"})}),$(this).hasClass("batch-forward"))return c(o),!0;Chat.batchReadMessage(o);var d=["nread","ntochat","npass","nfail"],u=t?t-5:0;Chat.sendKaEvent("Geekdeal_"+d[u]+"_"+s.length+"_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view)}},d=function(){if(!$(this).hasClass("disabled")){var t=$('<div class="batch-wrap"></div>'),i=$('<div class="batch-list"><div class="batch-title-box"><div class="batch-title"><i class="icon-operate"></i>批量处理</div></div><div class="batch-user-wrap scrollbar-macosx"><div class="user-list"><ul></ul></div></div></div>'),a=e();$("body").append('<div class="batch-layer"></div>'),i.find("ul").append(Chat.userListTop.children().not(".group-item").clone()).append(Chat.userListMain.children().not(".group-item").clone()),i.prepend(Chat.containerChat.find(".chat-search").clone()),i.find(".cur").removeClass("cur"),t.append(i).append(a),t.find(".user-bar-batch").text("取消"),t.on("click",".user-list li a",function(e){($(".batch-list").find("li.selected").length>1||!$(this).parents("li").hasClass("selected"))&&($(this).parents("li").toggleClass("selected"),o()),e.preventDefault()}),t.on("click",".user-bar-batch",s),t.on("click",".batch-action",l),Chat.containerChat.find(".sec-content").append(t),Menu.isSuportCalc?Chat.containerChat.find(".batch-list .user-list").scrollbar():(Chat.containerChat.find(".batch-user-wrap").css("height",$(window).height()-132+"px"),Chat.containerChat.find(".batch-list .user-list").css("height",$(window).height()-176+"px"));var n=$(".batch-operate-wrap .batch-action[data-action="+Chat.groupStatus+"]");n&&n.addClass("disabled"),Chat.sendKaEvent("Chat_batch_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view),r(),u(t)}},u=function(e){var t=e.find(".batch-action"),i=parseInt(localStorage.getItem("guide_batch_forward_state"));if(!(1&i)&&t.length){var a=t.offset(),n=" left: "+(a.left+120)+"px; top: "+(a.top+54)+"px;",s=$('<div id="guide-batch-forward">\t<div class="guide-layer"></div>\t<div class="guide-container" style="'+n+'">\t\t选中你想要的牛人，一键就能转发给站内或者微信好友 \t\t<span>试一试</span>\t</div></div>');$("body").append(s),s.on("click",function(){s.remove(),localStorage.setItem("guide_batch_forward_state",1|i)})}};return Chat.containerChat.find(".user-bar-batch").on("click",d),{close:s,render:d}},initLableInut:function(){var e=function(){if(!Chat.chatEl.find(".chat-labels-panel").hasClass("active")){var e=Chat.chatEl.find(".chat-labels-input").offset(),t=Chat.chatEl.find(".chat-recommend-labels"),i=e.left,a="";Chat.chatEl.offset().left+Chat.chatEl.width()-i<t.width()&&(a="skewing-right",i=i-t.width()+Chat.chatEl.find(".chat-labels-input").width()),t.removeClass("cls").addClass(a).css({left:i,top:e.top+25}),$("body").append(t),Chat.chatEl.find(".chat-labels-input").addClass("active")}},t=function(){$(".chat-recommend-labels").hasClass("active")||(Chat.chatEl.find(".chat-labels-input").removeClass("active"),Chat.chatEl.find(".chat-labels-panel").append($(".chat-recommend-labels")))};Chat.chatEl.find(".chat-labels-input").hoverDelay({hoverDuring:200,hoverEvent:e,outEvent:t})},layerCeilingInfo:function(e){(void 0!==e?e:function(){return Chat.chatList.scrollTop()<=100||Chat.curUserData.groupId}())?Chat.chatList.find(".ceiling-card").hide():(Chat.chatList.find(".ceiling-card").show(),Chat.chatList.css({paddingTop:0}),Chat.chatList.find(".chat-info").removeClass("ceiling-info"))},initRemark:function(){var e=[],t=function(t,i){if(!t)return i([]);e.length?i(e.filter(function(e){return e.indexOf(t)>-1})):$.get("/chat/all/geek/labels.json",function(a){e=[].concat(a.labels||[]),i(e.filter(function(e){return e.indexOf(t)>-1}))})},i=function(e){var t="",i=Chat.chatEl.find(".chat-labels-input .ipt").val().trim();$.each(e,function(e,a){t+="<li>"+Chat.lightKeyword(i,a)+"</li>"}),Chat.chatEl.find(".chat-labels-suggest").html(t)},a=function(e,t){var i=$.extend({encryptFriendId:Chat.curUserData.encryptUid,securityId:Chat.curUserData.securityId},e);$.post("/wapi/zprelation/noteandlabel/save.json",i,function(e){0!=e.code&&$.toast({type:"error",content:e.resmsg}),t(e)})},n=function(e,t){var i=s(e);a({labels:i.join(",")},function(e){if(0==e.code){$(".chat-recommend-labels").hide(),Chat.curUserData.infoData.labels=[].concat(i);var a=i.map(function(e){return"<span>"+e+'<i class="icon-close"></i></span>'});Chat.chatEl.find(".chat-geek-tag>span").remove(),$(a.join("")).insertBefore(Chat.chatEl.find(".chat-labels-panel"));var n=Chat.getLabelTpl(Chat.curUserData.infoData.labels,Chat.curUserData.infoData.note);$(".chat-labels-panel").remove(),Chat.chatEl.find(".chat-geek-tag").append(n),Chat.initLableInut(),t&&t.toggleClass("selected")}t&&t.attr("data-loading","")}),Chat.chatEl.find(".chat-labels-suggest").empty().hide()},s=function(e){var t=[].concat(Chat.curUserData.infoData.labels),i=t.indexOf(e);return i>-1?t.splice(i,1):t.push(e),t};Chat.chatEl.on("click",".chat-geek-remarks .remark-edit",function(){$(this).css("display","none"),Chat.chatEl.find(".chat-geek-remarks p").addClass("in-edit").attr("contenteditable",!0).focus()});var o=function(e){var t=Chat.XssText(e);Chat.chatEl.find(".chat-geek-remarks .remark-edit").css("display","inline-block"),Chat.chatEl.find(".chat-geek-remarks p").removeClass("in-edit").removeClass("error").attr("contenteditable",!1),a({note:t},function(e){if(0==e.code){var i=Chat.getLabelTpl(Chat.curUserData.infoData.labels,t);if(Chat.curUserData.infoData.note=t,$(".chat-labels-panel").remove(),$(".chat-recommend-labels").remove(),Chat.chatEl.find(".chat-geek-tag").append(i),Chat.initLableInut(),Chat.chatEl.find(".chat-geek-remarks").length&&""==t)Chat.chatEl.find(".chat-geek-remarks").remove();else if(Chat.chatEl.find(".chat-geek-remarks").length)Chat.chatEl.find(".chat-geek-remarks p").html(t+'<span class="remark-edit"></span>');else if(""!=t){var a='<div class="chat-geek-remarks"><div class="fl">备注:</div><p class="expand-p">'+t+'<span class="remark-edit"></span></p></div>';Chat.chatEl.find(".chat-info .chat-card-info").append(a)}}})};Chat.chatEl.on("blur",".chat-geek-remarks p",function(){var e=$(this).text().trim();e.length>120?($(this).addClass("error"),$.toast({type:"error",content:"备注最多输入120个字"})):o(e)}),Chat.chatEl.on("keydown",".chat-geek-remarks p",function(e){var t=$(this).text().trim();13==e.which&&(t.length>119?($(this).addClass("error"),$.toast({type:"error",content:"备注最多输入120个字"})):o(t),e.preventDefault())}),Chat.chatEl.on("focus",".chat-labels-input .ipt",function(){$(this).attr("placeholder","输入标签"),Chat.chatEl.find(".chat-labels-panel").addClass("active"),Chat.chatEl.find(".chat-labels-suggest").show(),Chat.chatEl.find(".chat-labels-panel").append($(".chat-recommend-labels"))}),Chat.chatEl.on("blur",".chat-labels-input .ipt",function(){var t=$(this),i=t.val().trim();""!=i&&Chat.curUserData.infoData.labels.indexOf(i)<0&&(n(i),e.indexOf(i)<0&&e.push(i)),Chat.chatEl.find(".chat-labels-panel").removeClass("active"),t.val("")}),Chat.chatEl.on("mousedown",".chat-labels-suggest li",function(){var e=$(this).text();""!=e&&Chat.curUserData.infoData.labels.indexOf(e)<0&&n(e),Chat.chatEl.find(".chat-labels-input .ipt").val(""),i([])}),Chat.chatEl.on("keydown",".chat-labels-input .ipt",function(t){var i=$(this).val().trim();13==t.which&&(""!=i&&Chat.curUserData.infoData.labels.indexOf(i)<0&&(n(i),e.indexOf(i)<0&&e.push(i),Chat.chatEl.find(".chat-labels-panel").removeClass("active")),$(this).val("").trigger("input"))}),Chat.chatEl.on("input",".chat-labels-input .ipt",function(e){var a=$(this).val().trim();13!==e.which&&t(a,i)}),Chat.chatEl.on("click",".chat-geek-tag .icon-close",function(){var e=$(this).parent().text();n(e);var t=Chat.curUserData.infoData.labels.indexOf(e);Chat.curUserData.infoData.labels.splice(t,1)}),Chat.chatEl.on("click",".ceiling-card",function(){Chat.layerCeilingInfo(!0),Chat.chatList.css({paddingTop:Chat.chatList.find(".chat-info").height()+5}),Chat.chatList.find(".chat-info").addClass("ceiling-info"),__conversion("chat_geek_card_fold_true")}),Chat.chatEl.on("click",".card-unfold",function(e){Chat.layerCeilingInfo(!1),Chat.chatList.find(".chat-info").removeClass("ceiling-info"),Chat.chatList.css({paddingTop:0}),__conversion("chat_geek_card_fold_false")}),$(document).on("click",".chat-recommend-labels dd",function(){var e=$(this),t=e.text();1!=e.attr("data-loading")&&(e.attr("data-loading",1),n(t,e))}),$(document).on("click",".chat-recommend-labels .btn",function(){var e=$(".chat-recommend-labels textarea").val().trim();o(e)}),$(document).on("mouseenter",".chat-recommend-labels",function(){$(this).addClass("active")}),$(document).on("mouseleave",".chat-recommend-labels",function(e){0!=e.screenX&&($(this).removeClass("active"),Chat.chatEl.find(".chat-labels-input").removeClass("active"),Chat.chatEl.find(".chat-labels-panel").append($(this)),Chat.chatEl.find(".chat-labels-input").removeClass("active"))}),$(document).on("input",".chat-recommend-labels textarea",function(){$(".chat-recommend-labels .remark-count span").text($(this).val().trim().length)}),$(document).on("click",".chat-recommend-labels .remark-edit",function(){var e=Chat.curUserData.infoData.note;$(".chat-recommend-labels textarea").val(e),$(".chat-recommend-labels .remark-count span").text(e.length),$(".chat-recommend-labels .chat-geek-note").hide(),$(".chat-recommend-labels .chat-note-update").show(),$(".chat-recommend-labels .chat-remark-input").show()}),$(document).on("mouseover",".chat-editor .chat-controls .link-fail",function(){$(this).find('span[class="no-reply-text"]').show(),$(this).find(".no-good-mask").show()}),$(document).on("mouseleave",".chat-editor .chat-controls .link-fail",function(){$(this).find('span[class="no-reply-text"]').hide(),$(this).find(".no-good-mask").hide()}),$(document).on("mouseover",".chat-editor .chat-controls .link-fail .no-good-mask",function(){$(this).find('span[class="no-reply-text"]').show()}),$(document).on("mouseleave",".chat-editor .chat-controls .link-fail .no-good-mask",function(){$(this).find('span[class="no-reply-text"]').hide()})},setFilterItem:function(){},initSearchBar:function(){var e,t="",i=Chat.containerChat.find(".chat-search"),a=Chat.containerChat.find(".chat-search .ipt"),n=Chat.containerChat.find(".chat-search-list"),s=Chat.containerChat.find(".chat-search .chat-search-input"),o=function(){if(i.removeClass("fold").addClass("unfold"),s.css({width:"100%"}),""==$.trim(a.val())){var e=ChatGroups.all().length?"搜索联系人、群聊":"搜索联系人";Chat.containerChat.find(".chat-search .chat-search-list").empty().html('<p class="chat-search-empty">'+e+"</p>"),Menu.isSuportCalc||Chat.containerChat.find(".chat-search .chat-search-list").css("height",$(window).height()-176+"px")}},r=function(){a.val(""),i.removeClass("unfold").addClass("fold"),s.css({width:"42px"}),i.find(".user-bar-filter").removeClass("open")},c=function(e){var t=Utemplate('<%if(this.list.length == 0){%><p class="chat-search-empty">没有搜索结果</p><%}%><ul><%for(var i=0; i < this.list.length; i++){%><li <%if(this.list[i].isGroup){%>class="group-item"<%}%> ><a href="javascript:;" data-uid="<%this.list[i].uid%>"><div class="figure"><img src="<%this.list[i].avatar%>" alt=""></div> <div class="text"> <div class="title"><span class="name"><%this.list[i].name%></span></div><p class="gray"><%this.list[i].lastMsg%></p> </div> </a></li><%}%></ul>',{list:e});Chat.containerChat.find(".chat-search-list").empty().html(t),__conversion("chat_search_"+encodeURIComponent(a.val()))},l=function(e){return chatUserPresenter.flushJob(),Chat.groupHistory[-1]=$(this).find("a").attr("data-uid"),r(),!1},d=function(){var i=$(this).val().trim();clearTimeout(e),e=setTimeout(function(){i!=t&&""!=i||(i.length>0?c(Chat.searchUserByName(i)):n.empty().html('<p class="chat-search-empty">搜索联系人、群聊</p>').show())},300),t=i},u=function(){$(document).on("click",r),i.on("input",".ipt",d),i.on("focus",".ipt",o),i.on("click",".chat-search-list li",l),i.on("change",".user-bar-filter input",function(){Chat.usersInitStatus&&Chat.getFilterUsers({},null,!1)}),i.on("click",".user-bar-filter p",function(){i.find(".user-bar-filter").toggleClass("open")}),i.on("click",".chat-search-input",function(){i.find(".ipt").focus()}),s.on("click",".icon-chat-search-clear",function(e){e.stopPropagation(),r()}),i.on("click",".user-bar-filter li",function(){var e=$(this).text();Chat.filterRadio="未读消息"===e,Chat.filterGroup="群聊"===e,e!=i.find(".user-bar-checked").text()&&(i.find(".user-bar-checked").text(e),Chat.getFilterUsers({},null,!1)),"全部对话"==e?i.find(".user-bar-checked").removeClass("cur"):i.find(".user-bar-checked").addClass("cur"),i.find(".user-bar-filter").removeClass("open")}),i.on("mouseover mouseout",".chat-search-input",function(e){i.hasClass("unfold")||("mouseover"==e.type?s.css({width:"75px"}):s.css({width:"42px"}))}),i.on("click",".chat-search-article",function(e){e.stopPropagation()})};!function(){i=Chat.containerChat.find(".chat-search"),a=Chat.containerChat.find(".chat-search .ipt"),n=Chat.containerChat.find(".chat-search .chat-search-list"),s=Chat.containerChat.find(".chat-search .chat-search-input"),u()}()},lightKeyword:function(e,t){var i=""+t,a=(t+"").toLowerCase(),n=(e+"").toLowerCase(),s=a.indexOf(n),o=n.length,a=i.substr(0,s)+'<u class="h">'+i.substr(s,o)+"</u>"+i.substr(s+o);return a},searchUserByName:function(e){var t=function(){var t=$.trim((e+"").toLowerCase()),i=Chat.usersID.filter(function(e){var i=$.trim((e.name+"").toLowerCase()),a=Chat.usersData[e.uid];return i.indexOf(t)>-1&&8!==a.relationType&&!a.isFiltered}),a=ChatGroups.all().filter(function(e){return $.trim((e.name+"").toLowerCase()).indexOf(t)>-1});return i.concat(a)};return function(){var i=[].concat(t()),a=[];return $.each(i,function(t,i){var n=Chat.usersData[i.uid]?Chat.usersData[i.uid]:i;a.push({avatar:i.avatar||i.avatarUrl,lastMsg:n.lastMsg,name:Chat.lightKeyword(e,i.name),uid:i.uid||i.groupId,isGroup:void 0!=i.groupId})}),a}()},getAddUsers:function(e,t,i,a){var n=[],e=e;if(!e.length)return void Chat.filterUserListData(n,i,a);$.ajax({type:"GET",url:INTERFACE_URLS.chatAddUsersUrl,dataType:"JSON",cache:!1,data:"friendIds="+e,success:function(e){if(e.status&&e.data.length){var t,s=e.data;for(t=0;t<s.length;t++)Chat.usersData[s[t].uid]||(s[t].fromSource="list",Chat.usersData[s[t].uid]=s[t],Chat.usersData[s[t].uid].fromSource="list",Chat.usersData[s[t].uid].newMsgCount=0,Chat.usersData[s[t].uid].infoData={},Chat.usersData[s[t].uid].lastMsg=s[t].lastMsg),Chat.usersTempData.length||(Chat.usersTempData[0]=[]),Chat.usersTempData[0].unshift(s[t]),n.push(s[t])}Chat.filterUserListData(n,i,a)},error:function(e){}})},concatGroup:function(e,t,i){var a=ChatGeeksFilter.data(),e=$.isArray(e)?e:[],n=function(e,t){return t.lastTS-e.lastTS},s=[];if(!ChatGeeksFilter.canConcatGroup())return e||[]
;if("群聊"===a.conversationType)return ChatGroups.all().sort(n);if(!$.isArray(e)&&i&&0==t)return ChatGroups.all().sort(n);if(!$.isArray(e))return e;if(e.length){0!=t&&1!=t||(s=ChatGroups.tops()),e.sort(n);var o=0==t?(new Date).getTime():e[0].lastTS,r=e.length>1&&!i?e[e.length-1].lastTS:0;s=s.concat(ChatGroups.between(r,o)),$(".user-bar-filter input").is(":checked")&&(s=ChatGroups.unread(s)),e=s.concat(e)}return e.sort(n)},filterUserListData:function(e,t,i){var e=e||[],a=[],t=t;if(a=e.length>0?e.concat(t):t,a.sort(function(e,t){return t.isTop-e.isTop||t.lastTS-e.lastTS}),a.length){var n,s=0,o=[];for(n=0;n<a.length;n++)n>0&&n%Chat.userlistPageTotal==0&&s++,void 0===o[s]&&(o[s]=[]),o[s].push(a[n]);var r=Chat.groupHistory[-1],c=Chat.usersData[r];Chat.containerChat.find(".chat-search .unread-check").hasClass("selected");"-1"==Chat.getGroupStatus()&&c&&r&&o.length&&o[0].indexOf(r)<0&&o[0].push(c),Chat.userlistRenderPage=0,Chat.userListMain.html(""),Chat.userListTop.html(""),Chat.renderUserList(o,0),Chat.userFilterTempData=o,i&&(Chat.resetRules(i),Chat.renderBox(i.uid,i.eid,null,{back:!0}))}},resetRules:function(e,t){var i=Chat.containerChat.find(".data-tab"),a=Chat.containerChat.find(".menu-status"),n=Chat.containerChat.find(".sel-type"),s=Chat.containerChat.find(".sel-filter"),o=Chat.containerChat.find(".sec-filter");i.find("a").removeClass("cur").eq(0).addClass("cur"),a.find("p").eq(0).addClass("show").siblings().removeClass("show"),a.find("p").eq(0).find("a").removeClass("cur").eq(0).addClass("cur"),n.removeClass("dropdown-open"),t?(n.find("a").removeClass("cur"),n.find(".label-text b").addClass("red").text(n.find('a[data-jobid="'+t+'"]').addClass("cur").text())):(n.find(".label-text b").removeClass("red").text("全部职位"),n.find("a").removeClass("cur").eq(0).addClass("cur")),Chat.containerChat.removeClass("show-chat-filter"),s.removeClass("filter-open"),s.find(".label-text b").removeClass("red").text("筛选"),o.find("a").removeClass("cur"),o.find("dl").each(function(){$(this).find("a").eq(0).addClass("cur")}),setTimeout(function(){Chat.containerChat.find(".sel-filter .label-text").attr("ka","main_filter")},10)},setUserTempData:function(e,t){var e=e||[],t=t;if(tempArr=[],e.length>0?tempArr=e.concat(t):tempArr=t,tempArr.length){var i,a=0,n=[];for(i=0;i<tempArr.length;i++)i>0&&i%Chat.userlistPageTotal==0&&a++,void 0===n[a]&&(n[a]=[]),n[a].push(tempArr[i])}return Chat.userFilterTempData=tempArr,tempArr},fetchUserList:function(e){var t=$.Deferred();return $.ajax({type:"GET",url:INTERFACE_URLS.userlistUrl,dataType:"JSON",timeout:6e4,data:"page="+e+"&slm=0",success:function(e){e.zpData=($.isArray(e.zpData)?e.zpData:[]).map(function(e){return e.gid=e.uid,1===e.friendSource&&(e.uid=e.uid+1e8),e}),t.resolve(e)},error:function(e){Chat.isLoading=!1,$.toast({content:"联系人加载失败，请刷新页面再试",type:"error"}),Chat.sendKaEvent("friend_load_error")}}),t},getUserList:function(e){var e=e;Chat.isLoading=!0;var t=function(){Chat.usersTempData.length&&(Chat.userFilterTempData[0]=Chat.userFilterTempData[0].concat(Chat.tops),ChatGroups.getGroupList(function(e){Chat.renderChatBox(),Chat.checkUnreadMessage(),!e||!e.length>0?Chat.containerChat.find(".group-check").hide():Chat.containerChat.find(".group-check").show(),Chat.usersInitStatus=!0,MessageGate.pull()})),Chat.totalNewGeek()};Chat.fetchUserList(e).then(function(i){if(0==i.code&&i.zpData&&i.zpData.length){var a,n=i.zpData,s=[],o={};for(a=0;a<n.length;a++)n[a].uid>1e3&&!Chat.usersData[n[a].uid]||Chat.usersData[n[a].uid]&&!Chat.usersData[n[a].uid].infoData?(o[a]=n[a],o[a].fromSource="list",o[a].infoData={},1!=n[a].newGeek&&5!=n[a].relationType||o[a].newMsgCount&&Chat.notification[5].push(n[a].uid),Chat.usersData[n[a].uid]||(Chat.usersData[n[a].uid]=n[a]),$.extend(Chat.usersData[n[a].uid],o[a]),Chat.addToUserList(n[a].uid),n[a].isTop?Chat.tops.push(n[a]):s.push(n[a])):n[a].uid>1e3&&Chat.usersData[n[a].uid]&&!Chat.usersData[n[a].uid].encryptUid&&$.extend(Chat.usersData[n[a].uid],o[a]),void 0===Chat.usersData[n[a].uid].newMsgCount&&(Chat.usersData[n[a].uid].newMsgCount=0);s=s.filter(function(e){return!e.isFiltered}),o={},Chat.usersTempData.push(s.sort(function(e,t){return t.isTop-e.isTop||t.lastTS-e.lastTS})),Chat.userFilterTempData=Chat.usersTempData,e++,Chat.getUserList(e)}else 1==e?ChatGroups.getGroupList(function(e){e&&e.length?(Chat.renderChatBox(),Chat.checkUnreadMessage(),Chat.containerChat.find(".group-check").show()):(ImFriends.setFriendList(Chat.userFilterTempData),Chat.tipsContainer.html('<div class="data-blank"><i class="tip-nodata"></i><b>没有相关数据</b>'+(VersionStatus.isHunter?"":'<p><a href="/chat/im?mu=recommend" class="btn link-topage">前往推荐牛人</a></p>')+"</div>").show(),Chat.userList.parent(".scroll-wrapper").hide(),Chat.detailContainer.hide(),Chat.containerChat.find(".sec-operate").removeClass("operate-disabed"),Chat.containerChat.find(".group-check").hide()),Chat.usersInitStatus=!0,MessageGate.pull()}):t();Chat.isLoading=!1})},renderChatBox:function(){Chat.tipsContainer.html("").hide(),Chat.userList.show(),Chat.containerChat.find(".chat-search").show(),Chat.userList.parent(".scroll-wrapper").show(),Chat.detailContainer.show(),ImFriends.setFriendList(Chat.userFilterTempData),Chat.renderUserList(Chat.userFilterTempData,0),Chat.userList.find("li").length&&Chat.userlistMoreEl.show(),Menu.isSuportCalc&&Chat.userList.scrollbar(),Chat.containerChat.find(".sec-operate").removeClass("operate-disabed")},isGroupChat:function(e){return e.groupId},getGroupItem:function(e){if(Chat.userList.find("a[data-uid="+e.groupId+"]").length&&!Chat.filterGroup)return"";e.isSilent;e.name=Chat.XssText(e.name),e.lastMsg=e.lastMsg?Chat.XssText(e.lastMsg):"",e.newMsgCount=e.newMsgCount>0?e.newMsgCount:"";var t=e.userId!=e.groupId&&e.userId!=_PAGE.uid&&e.userName?e.userName+"：":"";e.groupId!=Chat.curUserData.groupId&&1==e.isSilent&&e.newMsgCount&&(t='<span class="silent-number">[<span>'+e.newMsgCount+"条</span>]</span>"+t);var i='<p class="gray">'+t+"<%this.lastMsg%></p>",a=e.newMsgCount?'<span class="notice-badge">'+e.newMsgCount+"</span>":"";e.lastMsg||(i='<p class="gray"></p>');var n=e.type>0?'<em class="icon-group-inner">BOSS直聘产品中心</em>':"",s='<li class="group-item"><a data-uid="<%this.groupId%>" data-group="1" href="javascript:;"><div class="figure">'+a+'<img src="<%this.avatarUrl%>?x-oss-process=image/resize,w_60,limit_0"></div><div class="text"><div class="title"><span class="time"><%this.lastTime%></span>'+n+'<span class="name"><%this.name%></span>'+i+'</div><span class="silent-badge"></span>'+function(){var t=Chat.getDraft(e.groupId);return t.text&&""!=t.text?'<p class="draft"><i class="status status-draft">[草稿]</i>'+t.text+"</p>":""}()+"</div></a> </li>";return Utemplate(s,e)},renderUser:function(e){if(Chat.isGroupChat(e))return Chat.getGroupItem(e);if(1400400===e.uid)return"";if(!e||!e.uid)return Chat.sendTrackEvent("chat_renderuser_"+_PAGE.uid+(new Date).getTime()),"";var t=function(t){var i=e.uid,a=Chat.getGeekById(i,e.source),n=a.infoData||{};return"encryptUid"!=t||a.infoData?a[t]?a[t]:n[t]:a.uid},i=e.infoData&&e.infoData.uid?e.infoData:Chat.usersData[e.uid],a=(Chat.getGroupStatus(),1===i.friendSource?"unboss-geek":""),n=function(){var t="",i="",a="",n=0,s=Chat.usersData[e.uid],o=util.get(s,"lastMsgInfo.showText","");return s.lastMsgInfo&&s.lastMsgInfo.status&&(n=e.lastMsgInfo.status),n&&o&&util.get(s,"lastMsgInfo.fromId","")==_PAGE.uid&&(1==n?(t="status-delivery",a="送达"):2==n&&(t="status-read",a="已读"),i='<span class="status '+t+'">['+a+"]</span>"),i};e.gid=e.gid||e.uid,e.securityId=e.securityId||"",e.friendSource=e.friendSource||0;var s='<li class="'+a+'"><a href="'+function(){return"/chat/geek/chatinfo?"+(void 0===t("encryptUid")?"gid="+t("uid"):"uid="+t("encryptUid"))}()+'"data-source="'+e.friendSource+'" data-uid="'+e.uid+'" data-eid="'+t("encryptUid")+'" data-url="/wapi/zpboss/h5/chat/geek.json?uid='+e.gid+"&geekSource="+(e.friendSource||0)+"&securityId="+(e.securityId||"")+'"><div class="figure">'+function(){return t("newMsgCount")?'<span class="notice-badge">'+t("newMsgCount")+"</span>":""}()+'<img src="'+t("avatar")+'?x-oss-process=image/resize,w_60,limit_0" /></div><div class="text"><div class="title">'+function(){var t=0==e.isTop?"置顶":"取消置顶",i=0==e.isTop?1:0;return'<div class="user-operation"><span class="dots">...</span><div><span class="user-operation-item user-operation-settop" data-type="settop" data-friendId="'+e.uid+'" data-isTop ="'+i+'">'+t+'</span><span class="user-operation-item user-operation-access" data-type="access" data-uid="'+e.uid+'" >设为符合</span><span class="user-operation-item user-operation-del" data-type="delete" data-uid="'+e.uid+'" >删除</span><span class="user-operation-item icon-report" data-type="report" data-eid="'+e.encryptUid+'" data-source="'+e.friendSource+'" data-securityId="'+e.securityId+'" ka="chat_report_'+e.gid+'">举报</span></div></div>'}()+function(){return'<span class="time">'+e.lastTime+"</span>"}()+function(){return t("sourceTitle")?'<span class="source-title">'+t("sourceTitle")+"</span>":""}()+function(){return 10!=Chat.getGroupStatus()?"":'<div class="user-filter-reason"><p class="reason-brief">'+(e.filterReasonList.length?e.filterReasonList[0]:"")+"</p></div>"}()+'<span class="name">'+(t("name")?Chat.XssText(t("name")):"&nbsp;")+"</span>"+function(){var t=Chat.usersData[e.uid],a=util.get(t,"lastMsgInfo.showText","");return!_PAGE.canInterviewOnline&&["[语音通话]","[视频通话]"].indexOf(a)>-1&&(a="对方发起了语音通话，请在新版App中查看"),a.indexOf("发来一张图片")>-1&&(a="[图片]"),""==a?'<p class="gray">您正在与牛人'+i.name+"沟通</p>":'<p class="gray">'+n()+a.replace(/\<\/?[a-zA-Z]+\>/g,"").replace(/<\/?phone>/g,"").replace(/<\/?copy>/g,"").replace(/&lt;phone&gt;/g,"").replace(/&lt;\/phone&gt;/g,"").replace(/&lt;copy&gt;/g,"").replace(/&lt;\/copy&gt;/g,"")+"</p>"}()+function(){return 11===e.relationType?'<i class="iboss-xingbiao-mian"></i>':'<i class="iboss-xingbiao-mian hide"></i>'}()+function(){var e=Chat.getDraft(i.uid);return e.text&&""!=e.text?'<p class="draft"><i class="status status-draft">[草稿]</i>'+e.text+"</p>":""}();return e.encryptUid||(e.encryptUid=t("encryptUid")),Chat.userList.find("a[data-uid="+i.uid+"]").length>0&&(s=""),s},stat:function(){var e=(Chat.containerChat.find(".op-category .cur").text(),Chat.userList.find(".notice-badge")),t=0;$.each(e,function(e,i){t+=parseInt($(i).text(),10)}),Chat.sendKaEvent("Chat_User_group_"+Chat.getConGroup()+"_red_"+e.length+"_msg_"+t)},renderGroupList:function(){var e=ChatGroups.all(),t="",i="";if(Chat.userListTop.empty(),Chat.userListMain.empty(),!ChatGeeksFilter.canConcatGroup())return Chat.userlistMoreEl.hide(),Chat.userList.append('<div class="user-blank"><p>暂无群聊</p></div>'),!0;for(var a=0;a<e.length;a++)e[a].isTop?t+=Chat.getGroupItem(e[a]):i+=Chat.getGroupItem(e[a]);Chat.userListTop.empty().append(t),Chat.userListMain.empty().append(i)},renderUserList:function(e,t){function i(e){var t=[];if(e)for(var i=0;i<e.length;i++)t.indexOf(e[i])<0&&t.push(e[i]);return t}var a=function(e){var t=8==Chat.getGroupStatus();return e.filter(function(e){return e&&(8==e.relationType===t||e.isFiltered&&10==Chat.getGroupStatus())})},n=function(e){var t=e.filter(function(e){return e.newMsgCount}),i=e.filter(function(e){return e.newMsgCount<1});return t.concat(i)},s=function(e,t){var s,e=e,o=Chat.concatGroup(e[t],t,e.length<=t+1),t=t,r="",c="";if(o=a(i(o)),0===t&&(Chat.userListTop.empty(),Chat.userListMain.empty()),!o||!o.length)return 0==t&&(Chat.tabEmpty(),Chat.userlistMoreEl.hide()),void(Chat.userList.find("li").length&&Chat.userlistMoreEl.text("没有更多了").addClass("disabled").show());for("群聊"!=ChatGeeksFilter.data().conversationType&&Chat.userlistMoreEl.text("加载更多").removeClass("disabled").show(),5==Chat.getGroupStatus()?(o=n(o),Chat.userList.addClass("user-list-new")):Chat.userList.removeClass("user-list-new"),s=0;s<o.length;s++)o[s].isTop&&8!=Chat.getGroupStatus()?c+=Chat.renderUser(o[s]):r+=Chat.renderUser(o[s]);if(Chat.userListTop.append(c),Chat.userListMain.append(r),0==t){Chat.userList.find("li:first a");o.length,Chat.userlistPageTotal,Chat.userList.scrollTop()>0&&Chat.userList.scrollTop(0)}Chat.stat();var l=Chat.getGroupStatus();if(l&&Chat.groupHistory[l]){var d=Chat.groupHistory[l],u=Chat.userList.find("a[data-uid="+d+"]"),p=Chat.usersData[d]?Chat.usersData[d]:ChatGroups.get(d);!u.length||l!=p.relationType&&-1!=l||(Chat.scrollToByUser(d),Chat.groupHistory[l]=null)}},o=function(e,t){var i=$.Deferred();return $.post("/wapi/zpchat/boss/userLastMsg",{friendIds:e.join(","),src:t},function(e){var a=0,n=e.zpData?e.zpData.length:0;for($.isArray(e.zpData)||i.resolve([]);a<n;a++){var s=e.zpData[a],o=s.uid,r=Chat.getGeekById(o,t),c={uid:r.uid,lastTS:r.lastTS,lastTime:r.lastTime};(!r.lastTS||!r.lastMsg||r.lastTS<=s.lastTS)&&(r=$.extend(r,s,c)),r.lastMsgInfo||(r.lastMsgInfo={})}i.resolve(e.zpData)}),i},r=function(e,t){var i=[],a=[];i=e.filter(function(e){return 1!=Chat.usersData[e].friendSource}),a=e.filter(function(e){return 1==Chat.usersData[e].friendSource}).map(function(e){return Chat.usersData[e].gid}),a.length?$.when(o(i,0),o(a,1)).then(t):o(i,0).then(t)};e[t]&&e[t].length?function(e,t){var i=e;"object"==typeof e[t]&&(i=e[t].map(function(e){return e.uid})),r(i,function(){s(e,t)})}(e,t):s(e,t)},countGroupMessage:function(e){var t=e.to?e.to.uid:e.toId,i=e.from?e.from.uid:e.fromId,a=ChatGroups.get(t),n=[];n.push(e);var s=GroupMessage.formate(n),o=function(){if(a||(a=ChatGroups.get(t)),(!a.maxMessageId||a.maxMessageId<e.mid)&&(a.maxMessageId=e.mid),a.newMsgCount=void 0==a.newMsgCount?0:a.newMsgCount,t!=Chat.curUserData.groupId&&_PAGE.uid!=i){Chat.curUserData.maxMsgId||(Chat.curUserData.cache=[],Chat.curUserData.cache.push(e)),a.newMsgCount++;var n=Chat.userList.find("a[data-uid="+t+"]");n.find(".notice-badge").length?n.find(".notice-badge").text(a.newMsgCount):n.find(".figure").prepend('<span class="notice-badge">'+a.newMsgCount+"</span>"),a.isSilent}else a.maxMessageId&&ChatWebsocket.sendReadMessage({uid:a.groupId,mid:a.maxMessageId}),a.maxMessageId=null;Chat.addGroupMessage(e)};if(4==e.body.type&&76==util.get(e.body,"action.aid",0))a&&(a.hiddenStatus=1,Chat.userList.find('a[data-uid="'+i+'"]').remove(),Chat.curUserData.groupId==i&&(Chat.addTip(),Chat.chatEl.hide(),Chat.welcomeEl.show(),Chat.chatEl.find(".chat-list ul").empty(),Chat.curUserData={}));else if(a){if(!Chat.userList.find('a[data-uid="'+t+'"]').length){var r=Chat.getGroupItem(a);s.length&&!Chat.filterRadio&&"-1"==Chat.getGroupStatus()&&r&&Chat.userListMain.prepend(r)}s.length&&o()}else Chat.containerChat.find(".group-check").show(),$.get("/group/chat/getGroupInfo.json?groupId="+t,function(i){if(1!=i.resCode||!i.groupId)return!1;if(s.length&&(i.userName=e.from?e.from.name:"",i.lastMsg=s[0].originalText),ChatGroups.get(t))o();else{ChatGroups.add(i);var a=Chat.getGroupItem(i);!Chat.filterRadio&&"-1"==Chat.getGroupStatus()&&a&&Chat.userListMain.prepend(a),o()}})},addGroupMessage:function(e){var t=e.to?e.to.uid:e.toId,i=Chat.userList.find("a[data-uid="+t+"]"),a=ChatGroups.get(t),n=a.lastTS,s=[];s.push(e);var o=GroupMessage.formate(s);if(o.length){var r=o[0].isSelf||!o[0].name||"system"==o[0].type?"":o[0].name+"：";if(t!=Chat.curUserData.groupId&&1==a.isSilent&&a.newMsgCount&&(r='<span class="silent-number">[<span>'+a.newMsgCount+"条</span>]</span>"+r),o[0].time>=n&&(a.lastMsg=o[0].originalText,a.lastTS=o[0].time,a.lastTime=Chat.getLastTime(o[0].time),a.userName=o[0].name||"",a.userId=o[0].fromId,i.find(".text .gray").html(r+o[0].originalText),i.find(".text .time").text(a.lastTime),o[0].clientId||(a.lastMsgId=Math.max(e.mid,a.lastMsgId||0))),t==Chat.curUserData.groupId){var c=Chat.chatList.innerHeight()+Chat.chatList.scrollTop()>=Chat.chatList.get(0).scrollHeight;o[0].time-n>3e4&&Chat.chatEl.find(".chat-list ul").append(Chat.getGroupMsgItem({type:"time",style:"time",time:o[0].time,text:Chat.dateFormat(new Date(o[0].time),"Z hh:mm")})),Chat.chatEl.find(".chat-list ul").append(Chat.getGroupMsgItem(o[0])),c&&Chat.scrollToBottom()}else o[0].time>n&&i.parents("ul").prepend(i.parents("li"))}},initGroupChat:function(){var e=function(e){var t=$.Deferred();return $.post("/group/chat/updateGroupSetting.json",e,function(e){1==e.resCode?t.resolve():$.toast({type:"error",content:e.resmsg})}),t};Chat.chatEl.on("click",".chat-group-operate .op-settop",function(){var t=$(this),i=Chat.userList.find(".cur"),a=$(this).hasClass("selected")?0:1,n=a?"已置顶，点击取消":"置顶该群",s=a?"已置顶":"已取消置顶",o=a?Chat.userListTop:Chat.userListMain;e({groupId:Chat.curUserData.groupId,watch:a,silent:Chat.curUserData.isSilent}).then(function(){Chat.curUserData.isTop=a;var e=Chat.dateFormat(new Date,"hh:mm");t.toggleClass("selected"),t.find(".tooltip p").text(n),i.find(".time").text(e),i.prependTo(o),$.toast({type:"success",content:s})}),__conversion("group_operate_silent_"+a)}),Chat.chatEl.on("click",".chat-group-operate .op-silent",function(){var t=$(this),i=Chat.userList.find(".cur"),a=$(this).hasClass("selected")?0:1,n=a?"关闭消息免打扰":"开启消息免打扰",s=a?"已开启消息免打扰":"已关闭消息免打扰";e({groupId:Chat.curUserData.groupId,watch:Chat.curUserData.isTop,silent:a}).then(function(){Chat.curUserData.isSilent=a,t.toggleClass("selected"),i.toggleClass("item-silent"),t.find(".tooltip p").text(n),i.find(".notice-badge").length||i.find(".text").append('<span class="notice-badge"></span>'),$.toast({type:"success",content:s})}),__conversion("group_operate_silent_"+a)});var t=function(e){return Utemplate('<div class="group-member-list"><ul><%for(var i=0; i<this.list.length; i++){%><li data-uid="<%this.list[i].userId%>"><img src="<%this.list[i].avatarUrl%>?x-oss-process=image/resize,w_60,limit_0"><p><%this.list[i].name%></p></li><%}%></ul></div><div class="shadow"></div>',{list:e})},i=function(e,t){var i="",a="";1===t.gender?i='<i class="icon-man"></i>':0===t.gender&&(i='<i class="icon-lady"></i>'),3==t.certification&&(a='<i class="icon-approve"></i>');var n=(_PAGE.uid,[]);t.company&&n.push("<span>"+t.company+"</span>"),t.position&&n.push(t.position);var s=n.length>1?"multi-row":"";return'<p class="card-item-avatar"><img src="'+t.avatarUrl+'?x-oss-process=image/resize,w_220,limit_0" alt=""></p><div class="card-item-panel"><p class="card-info"><span class="name">'+t.nickName+"</span>"+a+i+'</p><p class="card-position '+s+'">'+n.join('<i class="vline"></i>')+'</p><p class="card-description">'+Chat.XssText(t.signature)+"</p></div>"},a=function(e){var t=$.Deferred();return Chat.xhrs.groupMemberChat&&Chat.xhrs.groupMemberChat.abort(),Chat.xhrs.groupMemberChat=$.get("/group/chat/groupUserCard.json",{userId:+e,groupId:Chat.curUserData.groupId},function(e){1==e.resCode?t.resolve(e.data):$.toast({type:"error",content:e.msg})}),t},n=function(e){var t=Chat.chatEl.find(".chat-group-operate");e.on("click",".group-member-list li img",function(){if(!(Chat.curUserData.type>0)){e.find(".member-item-card").length||e.find(".dialog-container").append('<div class="member-item-card"></div>');var n=$(this).parents("li").attr("data-uid"),s=$(this),o=e.find(".member-item-card");a(n).then(function(e){o.html(i(n,e));var a=s.position(),r={left:a.left+35,top:a.top+35};a.left+260>=t.width()&&(r.left=r.left-o.width()),$("body").height()<s.offset().top+175+o.find(".card-item-panel").height()&&(r.top=r.top-170-o.find(".card-item-panel").height()),o.css(r).fadeIn()}),__conversion("group_list_member_detail")}}),e.on("click",".member-item-card .btn",function(t){$.post("/group/chat/privateGroup.json",{fromGroupId:Chat.curUserData.groupId,userId:$(this).attr("data-uid")},function(t){if(1==t.resCode){e.remove();var i=$.extend({count:2,lastTS:(new Date).getTime(),lastTime:Chat.getLastTime((new Date).getTime())},t.data);Chat.addNewGroup(i)}else $.toast({type:"error",content:t.msg})}),__conversion("group_member_card_greet")}),e.on("click",".group-member-list",function(t){$(t.target).is("img")||e.find(".member-item-card").hide()}),e.find(".group-member-list").on("scroll",function(){e.find(".member-item-card").hide()})},s=function(e,i){Chat.curUserData.count=i.length,Chat.chatEl.find(".chat-group-operate .item-group-name").text(Chat.curUserData.name+"（"+Chat.curUserData.count+"）"),$.dialog({bind:!0,title:"",content:t(i),closeText:!1,confirmText:!1,cancelText:!1,wrapClass:"group-members-around",opacityLock:!0,onOpen:function(e){var t=Chat.chatEl.find(".chat-group-operate");t&&(t.addClass("unfold"),$(e).find(".dialog-container").css({left:t.offset().left,top:t.offset().top+t.height()+1,width:t.innerWidth()}),n($(e)))},onResize:function(e){var t=Chat.chatEl.find(".chat-group-operate");$(e).find(".dialog-container").css({left:t.offset().left,top:t.offset().top+t.height()+1,width:t.innerWidth()})},onClose:function(){Chat.chatEl.find(".chat-group-operate").removeClass("unfold")}})};Chat.chatEl.on("click",".chat-group-operate .item-group-name",function(){$(this);$.get("/wapi/zpchat/group/membersInfo?groupId="+Chat.curUserData.groupId,function(e){s(0,e.zpData.result)})}),Chat.chatEl.on("click",".item-friend .figure img",function(){var e=$(this),t=e.attr("data-uid");t&&(Chat.curUserData.type>0||a(t).then(function(a){var s='<div class="member-item-card">'+i(t,a)+"</div>";$.dialog({bind:!0,title:"",content:s,closeText:!1,confirmText:!1,cancelText:!1,lock:!0,wrapClass:"members-card-wrap",opacityLock:!0,onOpen:function(t){var i=e.offset().top;$(t).find(".card-item-panel").height()+190+e.offset().top>$("body").height()&&(i=i-$(t).find(".card-item-panel").height()-150),$(t).find(".dialog-container").css({left:e.offset().left+e.width()+15,top:i}),n($(t))},onResize:function(t){var i=e.offset().top;$(t).find(".card-item-panel").height()+190+e.offset().top>$("body").height()&&(i=i-$(t).find(".card-item-panel").height()-150),$(t).find(".dialog-container").css({left:e.offset().left+e.width()+15,top:i})}}),__conversion("group_record_member_detail")}))}),$("body").on("click",".job-competitive",function(){var e={jobId:$(this).data("jobId")||Chat.curUserData.infoData.jobId,geekId:$(this).data("geekId")||Chat.curUserData.infoData.encryptUid,expectId:$(this).data("expectId")||Chat.curUserData.infoData.encryptExpectId,from:1};Chat.handleJobCompetitive(e)})},handleJobCompetitive:function(e){return void JobCompetitive.show(e)},showJobCompetitive:function(e){function t(e,t,i){return i?'<polygon class="label-bg" points="'+(e-4)+","+(t-12)+" "+(e+24)+","+(t-12)+" "+(e+22)+","+(t-14)+" "+(e+20)+","+(t-12)+" "+(e+49)+","+(t-12)+" "+(e+49)+","+(t+4)+" "+(e-4)+","+(t+4)+' "></polygon>':'<polygon class="label-bg" points="'+(e-4)+","+(t-12)+" "+(e+49)+","+(t-12)+" "+(e+49)+","+(t+4)+" "+(e+24)+","+(t+4)+" "+(e+22)+","+(t+6)+" "+(e+20)+","+(t+4)+" "+(e-4)+","+(t+4)+' "></polygon>'}var i="";if(e.vip){var a={geekPrefer:"",axisTxt:"",diagramTxt:"",polyLineData:"",dot:"",label:"",labelBg:""},n={axisTxt:"",diagramTxt:"",chatDegree:"",label:"",labelBg:"",isNoStep:!0};$.each(e.salaryList,function(e,i){var n=63*e,s=130-130*i.percent/100;if(i.geek&&i.boss){var o=s,r=!1;i.percent<=85?o=s-17:(o=s+44,r=!0),a.labelBg+=t(n,o,r),a.label+='<text class="label" x="'+n+'" y="'+o+'">您在这里</text>',a.labelBg+=t(n,s),a.label+='<text class="label" x="'+n+'" y="'+s+'">牛人偏好</text>',a.geekPrefer=i.low+"K-"+i.high+"K"}else i.geek?(a.labelBg+=t(n,s),a.label+='<text class="label" x="'+n+'" y="'+s+'">牛人偏好</text>',a.geekPrefer=i.low+"K-"+i.high+"K"):i.boss&&(a.labelBg+=t(n,s),a.label+='<text class="label" x="'+n+'" y="'+s+'">您在这里</text>');a.axisTxt+=0==i.low&&0==i.high?'<text class="axis-txt" x="'+(n+7)+'" y="155">面议</text>':'<text class="axis-txt" x="'+n+'" y="155">'+i.low+"K-"+i.high+"K</text>",a.diagramTxt+='<text class="axis-txt" x="'+n+'" y="'+s+'">'+i.percent+"%</text>",a.polyLineData+=n+","+s+" ",a.dot+='<circle class="salary-dot" r="3" cx="'+n+'" cy="'+s+'"></circle>'}),$.each(e.communicateList,function(e,i){var a=58*e,s=135-135*i.percent/100;n.axisTxt+=3==i.stage.length?'<text class="axis-txt" x="'+(a+6)+'" y="155">'+i.stage+"</text>":'<text class="axis-txt" x="'+a+'" y="155">'+i.stage+"</text>",n.diagramTxt+='<text class="axis-txt" x="'+a+'" y="'+s+'">'+i.percent+"%</text>",n.chatDegree+='<rect class="chat-degree" x="'+a+'" y="'+s+'" width="4" height="'+(135-s)+'"></rect>',i.boss&&(n.labelBg+=t(a,s,!1),n.label+='<text class="label" x="'+a+'" y="'+s+'">您在这里</text>',n.isNoStep=!1)}),i='<span class="sub-title">您的竞争力分析</span>'+(e.salaryList&&e.salaryList.length||e.communicateList&&e.communicateList.length?'<span class="sub-title-tip">实时更新，根据近期Boss与牛人的沟通情况分析</span>':'<span class="sub-title-tip no-data-text">该用户为新牛人或近期暂无偏好，获取更多数据后为您展示</span>')+'    <div class="pic-wrap">\n        <div class="pic-box">\n            <span class="desc">薪资竞争力:&nbsp;超过<span class="detail-data">'+e.salaryRank+'%</span>的竞争者<span class="competitor-explain"><i class="iboss-wenhao"></i><div class="competitor-explain-panel">与当前牛人沟通过的其他招聘者</div></span></span>\n            <span class="desc">牛人薪资偏好:&nbsp;<span class="detail-data">'+a.geekPrefer+'</span></span>\n            <svg xmlns="http://www.w3.org/2000/svg" class="svg-pic" width="315">\n                <defs>\n                    <linearGradient id="salary-rect-bg" x1="0%" y1="0%" x2="0%" y2="100%">\n                        <stop offset="0%" style="stop-color: #F3FDFC ; stop-opacity:1"></stop>\n                        <stop offset="100%" style="stop-color: #9FF1E1; stop-opacity:1"></stop>\n                    </linearGradient>\n                </defs>\n                <g transform="translate(0,35)">\n                    <rect class="salary-rect" width="63" height="155" x="0" y="0"></rect>\n                    <rect class="salary-rect" width="63" height="155" x="63" y="0"></rect>\n                    <rect class="salary-rect" width="63" height="155" x="126" y="0"></rect>\n                    <rect class="salary-rect" width="63" height="155" x="189" y="0"></rect>\n                    <rect class="salary-rect" width="63" height="155" x="252" y="0"></rect>\n                </g>\n                <g transform="translate(0,35)">\n                    <line class="salary-rect-line" x1="0" y1="0" x2="0" y2="155"></line>\n                    <line class="salary-rect-line" x1="63" y1="0" x2="63" y2="155"></line>\n                    <line class="salary-rect-line" x1="126" y1="0" x2="126" y2="155"></line>\n                    <line class="salary-rect-line" x1="189" y1="0" x2="189" y2="155"></line>\n                    <line class="salary-rect-line" x1="252" y1="0" x2="252" y2="155"></line>\n                    <line class="salary-rect-line" x1="315" y1="0" x2="315" y2="155"></line>\n                </g>\n                <g transform="translate(12,30)">\n'+a.axisTxt+'</g>\n                <g transform="translate(30,37)">\n                    <polyline class="salary-line" points="'+a.polyLineData+'"></polyline>\n                </g>\n                <g transform="translate(30,37)">\n'+a.dot+'</g>\n                <g transform="translate(20,30)">\n'+a.diagramTxt+'</g>\n                <g transform="translate(8,13)">\n'+a.labelBg+a.label+'</g>\n            </svg>\n        </div>\n        <div class="pic-box">\n            <span class="desc">沟通进度竞争力:&nbsp;'+(n.isNoStep?'您与该牛人<span class="detail-data">暂未产生沟通</span>\n':'超过<span class="detail-data">'+e.contactRank+"%</span>的竞争者</span>\n")+'            <span class="desc">牛人受欢迎程度:&nbsp;已被<span class="detail-data">'+e.geekChated+'</span>位Boss开聊</span>\n            <svg xmlns="http://www.w3.org/2000/svg" class="svg-pic" width="284">\n                <defs>\n                    <linearGradient id="chat-rect-bg" x1="0%" y1="0%" x2="0%" y2="100%">\n                        <stop offset="0%" style="stop-color: #5EEACD ; stop-opacity:1"></stop>\n                        <stop offset="100%" style="stop-color: #53CAC3; stop-opacity:1"></stop>\n                    </linearGradient>\n                </defs>\n                <defs>\n                    <filter id="txt-bg">\n                        <feFlood flood-color="#FF7F45"></feFlood>\n                        <feBlend in="SourceGraphic" mode="screen"></feBlend>\n                    </filter>\n                </defs>\n                <g transform="translate(23,35)">\n                    <rect class="chat-column-rect" width="4" height="135" x="0" y="0"></rect>\n                    <rect class="chat-column-rect" width="4" height="135" x="58" y="0"></rect>\n                    <rect class="chat-column-rect" width="4" height="135" x="116" y="0"></rect>\n                    <rect class="chat-column-rect" width="4" height="135" x="174" y="0"></rect>\n                    <rect class="chat-column-rect" width="4" height="135" x="232" y="0"></rect>\n                </g>\n                <g transform="translate(23,35)">\n'+n.chatDegree+'</g>\n                <g transform="translate(0,30)">\n'+n.axisTxt+'</g>\n                <g transform="translate(16,30)">\n'+n.diagramTxt+'</g>\n                <g transform="translate(3,13)">\n'+n.labelBg+n.label+'</g>\n            </svg>\n        </div>\n    </div>\n    <span class="sub-title">牛人偏好分析</span>'+(e.geekPreference&&!$.isEmptyObject(e.geekPreference)?'<span class="sub-title-tip">实时更新，根据牛人主动沟通/关注/面试等职位分析</span>':'<span class="sub-title-tip no-data-text">该用户为新牛人或近期暂无偏好，获取更多数据后为您展示</span>')+'    <div class="preference-wrap">\n        <div class="preference">\n            <span>公司规模偏好</span>\n            <span class="gray">'+(e.geekPreference&&e.geekPreference.comScale?e.geekPreference.comScale:"——")+'</span>\n        </div>\n        <div class="preference">\n            <span>融资情况偏好</span>\n            <span class="gray">'+(e.geekPreference&&e.geekPreference.comStage?e.geekPreference.comStage:"——")+'</span>\n        </div>\n        <div class="preference">\n            <span>行业偏好</span>\n            <span class="gray">'+(e.geekPreference&&e.geekPreference.industry?e.geekPreference.industry:"——")+'</span>\n        </div>\n        <div class="preference">\n            <span>办公区域偏好</span>\n            <span class="gray">'+(e.geekPreference&&e.geekPreference.workAddr?e.geekPreference.workAddr:"——")+'</span>\n        </div>\n        <div class="preference">\n            <span>沟通时间偏好</span>\n            <span class="gray">'+(e.geekPreference&&e.geekPreference.communicateTime?e.geekPreference.communicateTime:"——")+"</span>\n        </div>\n    </div>",$.dialog({title:"招聘当前牛人:&nbsp;&nbsp;"+e.geekInfo.geekName,content:i,closeText:!0,confirmText:!1,cancelText:!1,inline:!0,wrapClass:"dialog-prop-default job-competitive-wrap",onOpen:function(e){}})
}else i='<span class="sub-title-tip">一键洞悉职位竞争力，辅助招聘决策</span>\n    <div class="content-wrap">\n        <div class="pic-box">\n            <span class="sub-title">招聘当前牛人:&nbsp;'+e.geekInfo.geekName+'</span>\n            <span class="desc">薪资竞争力:&nbsp;超过<span class="blur-data-s"></span><span class="percent">%</span>的竞争者</span>\n            <span class="desc">牛人薪资偏好:&nbsp;<span class="blur-data-m"></span></span>\n            <div class="blur-pic"></div>\n        </div>\n        <div class="text-box">\n            <span class="sub-title">您的竞争力&牛人偏好分析</span>\n            <div class="preference">\n                <span>沟通进度竞争力</span>\n                <span class="gray">超过<span class="blur-data-s"></span><span class="percent">%</span>的竞争者</span>\n            </div>\n            <div class="preference">\n                <span>牛人受欢迎程度</span>\n                <span class="gray">已被<span class="blur-data-s"></span>位Boss开聊</span>\n            </div>\n            <div class="preference">\n                <span>牛人公司规模偏好</span>\n                <span class="gray"><span class="blur-data-s"></span>人以上的公司</span>\n            </div>\n            <div class="preference">\n                <span>牛人沟通时间偏好</span>\n                <span class="gray"><span class="blur-data-s"></span>&nbsp;-&nbsp;<span class="blur-data-s"></span>点</span>\n            </div>\n            <div class="preference">\n                <span>牛人融资规模偏好</span>\n                <span class="gray"><span class="blur-data-s"></span>轮公司</span>\n            </div>\n            <div class="preference">\n                <span>办公区域偏好</span>\n                <span class="gray"><span class="blur-data-s"></span>区</span>\n            </div>\n        </div>\n    </div>\n    <div class="footer-btns">\n    \t<a href="javascript:;" class="btn vip-detail">开通VIP 解锁该权益</a>    </div>',$.dialog({title:"职位竞争力",content:i,closeText:!0,confirmText:!1,cancelText:!1,inline:!0,wrapClass:"dialog-prop-default job-competitive-blur-wrap",onOpen:function(e){e.find(".vip-detail").on("click",function(){$(".dialog-wrap").remove(),Menu.items.removeClass("cur"),Menu.gotoFramePage("/boss/item/vipprivilege.html","/boss/item/vipprivilege.html",$(this).attr("data-op")),e.remove()})}})},_getQueryStringArgs:function(e){e=null==e?window.location.href:e;for(var t=e.substring(e.lastIndexOf("?")+1),i={},a=t.length>0?t.split("&"):[],n=null,s=null,o=null,r=0;r<a.length;r++)n=a[r].split("="),s=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]),s.length&&(i[s]=o);return i},getInterviewCard:function(e){return msgText="",msgText+='<div class="interview-card"  data-id= "'+e.interviewId+'">',msgText+='<div class= "title">'+e.title+"  </div>",msgText+='<div class = "interview-body">',msgText+='<div class="interview-userinfo">',msgText+='<img  class="avator" src="'+e.user.avatar+'" >',msgText+="<p>"+e.user.name+"</p>",msgText+="</div>",msgText+='<p class="interview-time">'+e.interviewTime+"</p>",msgText+='<a class="interview-btn" href="javascript:; ">'+e.bottomText+"</a>",msgText+="</div>",msgText+="</div>",msgText+="</div>",msgText},getGroupMsgItem:function(e){var t=this,i=function(e){var i=Chat.curUserData;if("text"===e.style){var a="";return"received"===e.action&&i.type<1&&(a+="<p>",(e.isAdmin||e.fromId==Chat.curUserData.adminId)&&(a+='<span class="item-identity">群主</span>'),a+='<span class="item-name">'+e.name+'</span><span class="item-position gray">'+(e.company||"")+e.position+"</span></p>"),"sound"===e.type&&(e.text=e.text?e.text:"收到一条语音消息，请在APP查看"),'<div class="group-text">'+a+'<div class="text">'+e.text+"</div></div>"}if("image"===e.type){var n=e.image.tinyImage.width,s=e.image.tinyImage.height,o=e.image.originImage||{};return e.image.tinyImage.width>300&&(s/=Math.floor(n/300),s=Math.floor(s)),'<div class="text bgf"><img class="img-tiny" data-large="'+o.url+'" large-x="'+o.width+'" large-y="'+o.height+'" src="'+e.image.tinyImage.url+'" height="'+s+'"></div>'}if("sticker"===e.type)return'<div class="text bgf"><img class="img-tiny" width="'+e.image.origWidth/2+'" " src="'+e.image.origUrl+'" height="'+e.image.origHeight/2+'"></div>';if("interviewShare"===e.type){var a="";return"received"===e.action&&(a+="<p>",(e.isAdmin||e.fromId==Chat.curUserData.adminId)&&i.type<1&&(a+='<span class="item-identity">群主</span>'),a+='<span class="item-name">'+e.name+'</span><span class="item-position gray">'+(e.company||"")+e.position+"</span></p>"),'<div class="group-text">'+a+'<div class="text bgf">'+t.getInterviewCard(e.interviewShare)+"</div></div>"}return""};return function(e){var t=i(e);if("hyperLink"===e.type){var a=e.hyperLink,n=a.extra_json?a.extra_json:JSON.parse(a.extraJson),s=a.text,o=n.highlightStart,r=n.highlightLength,c=Chat._getQueryStringArgs(a.url).shareId;return'<li class="item-system"><div class="text">'+s.substring(0,o+1)+'<a  ka="groupChatRecord" href="javascript:;"        class="_systemEvent" data-url="/boss/share/geek/detail.json?id='+c+'" >'+s.substr(o+1,r)+"</a></li>"}if("received"===e.action&&"system"!==e.style){var l=3==e.certification?'<i class="icon-certification"></i>':"";return'<li  data-type="'+e.type+'" data-time="'+e.time+'" id="temp-'+e.mid+'" class="item-friend "><div class="figure">'+l+'<img data-uid="'+e.fromId+'" src="'+e.avatar+'" alt=""></div>'+t+"</li>"}return"sent"===e.action&&"system"!==e.style?'<li data-type="'+e.type+'" data-time="'+e.time+'" id="temp-'+e.mid+'" class="item-myself">'+t+"</li>":"system"===e.style?'<li class="item-system"><div class="text">'+e.text+"</div></li>":"time"===e.type?'<li class="item-time"><span class="time">'+e.text+"</span></li>":""}(e)},fillGroupHistoryMessage:function(e){var e=Chat.curUserData.page||1,t=Chat.curUserData.groupId,i=function(e){var t=e[0],i=[];return $.each(e,function(e,a){var n,s=new Date(a.time);n=(new Date).getTime()-a.time>864e5?"MM-dd hh:mm":"Z hh:mm",(a.time-t.time>3e5||0===e)&&i.push({type:"time",style:"time",time:a.time,text:Chat.dateFormat(s,n)}),t=a,i.push(a)}),i};Chat.chatList.off("scroll"),$.get("/group/chat/groupHistoryMessages.json",{groupId:t,maxMsgId:1==e?0:Chat.curUserData.maxMsgId||0,count:20,page:e}).success(function(a){if(Chat.curUserData.groupId!=t)return!1;Chat.chatEl.find(".chat-list").css("visibility","visible"),Chat.chatEl.find(".chat-wrap-mask").remove();var n=Chat.chatListCon.find("li:first"),a=JSON.parse(a);if(Chat.curUserData.adminId=a.adminId,a.messages&&a.messages.length){1==e&&(!Chat.curUserData.maxMessageId||a.messages[0].mid>Chat.curUserData.maxMessageId)&&(Chat.curUserData.maxMessageId=a.messages[0].mid);var s,o=GroupMessage.formate(a.messages),r="";for(o=i(o),s=0;s<o.length;s++)r+=Chat.getGroupMsgItem(o[s]);Chat.chatEl.find(".chat-list ul").prepend(r),1==e&&o.length?Chat.scrollToBottom():n.length&&Chat.chatList.scrollTop(n.offset().top-Chat.chatList.height()),Chat.curUserData.canLoadingData=a.messages.length>19,Chat.messageBarScroll(),Chat.curUserData.newMsgCount=0,(Chat.curUserData.maxMessageId||Chat.curUserData.maxMsgId)&&(ChatWebsocket.sendReadMessage({uid:Chat.curUserData.groupId,mid:Chat.curUserData.maxMessageId||Chat.curUserData.maxMsgId}),Chat.curUserData.maxMessageId=null,Chat.setUnReadMessageCount(-1*Chat.curUserData.newMsgCount))}else Chat.curUserData.canLoadingData=!1})},addNewGroup:function(e){setTimeout(function(){if(!ChatGroups.get(e.groupId)&&!Chat.userList.find("a[data-uid="+e.groupId+"]").length){ChatGroups.add(e);var t=$(Chat.renderUser(e));Chat.userListMain.prepend(t),Chat.userList.find("a[data-uid="+e.groupId+"]").click(),Chat.containerChat.find(".group-check").show()}Chat.scrollToByUser(e.groupId)},200)},renderGroupBar:function(e){Chat.chatEl.find(".detail-top .chat-group-operate").length&&Chat.chatEl.find(".detail-top .chat-group-operate").remove(),Chat.chatEl.find(".detail-top").append(function(){var t=1==e.isTop?" selected":"",i=(e.isSilent,'<p><a class="item-group-name" ka="group_chat_members" href="javascript:;">'+e.name+"（"+e.count+"）</a></p>");return e.type>0&&(i='<p class="chat-inner-group"><span>'+e.name+'</span>Boss直聘产品中心<i class="vline"></i>'+e.position+"</p>",i+='<div class="inner-notice"><i class="iboss-bell-solid"></i>'+e.notice+"</div>"),'<div class="chat-group-cover chat-group-operate"><div class="fr"><span class="op-icon op-settop'+t+'"><div class="op-btn"><i class="iboss-zhiding"></i></div><div class="tooltip"><p class="gray">'+(1==e.isTop?"已置顶，点击取消":"置顶")+"</p></div></span></div>"+i+"</div>"}()),Chat.chatEl.find(".btn-message .note-message-tip").hide()},wipeGroupMessages:function(e){var t=ChatGroups.get(e),i=Chat.userList.find('a[data-uid="'+e+'"]');i.length&&(i.find(".notice-badge").remove(),t.maxMessageId=null,t.newMsgCount=0)},renderGroupBox:function(e){var t=e.attr("data-uid"),i=ChatGroups.get(t);Chat.curUserData=i,Chat.chatEl.show(),Chat.welcomeEl.hide(),Chat.userList.find(".cur").removeClass("cur"),e.parent("li").addClass("cur"),Chat.editorEl.removeClass("disabled"),Publisher.editorInput.focus(),Chat.chatList.find(".chat-info").hide(),Chat.chatList.find("ul").empty(),Chat.renderGroupBar(i),Chat.setDraft(),Chat.chatBox.find(".nlp-sug-container").length&&Chat.chatBox.find(".nlp-sug-container").remove();var a=Chat.getDraft(t);t&&a.content?(e.find(".draft").remove(),Publisher.editorInput.html(a.content),Publisher.submitBtn.removeClass("btn-disabled"),Publisher.setCursorEnd(Publisher.editorInput.get(0))):(Publisher.editorInput.html(""),Publisher.submitBtn.addClass("btn-disabled")),Chat.curUserData.page=1,Chat.curUserData.maxMsgId=0,Chat.curUserData.newMsgCount=0,Chat.fillGroupHistoryMessage(),Chat.userList.find(".cur .notice-badge").remove(),Chat.userList.find(".cur .silent-number").remove(),(Chat.curUserData.maxMessageId||Chat.curUserData.maxMsgId)&&(ChatWebsocket.sendReadMessage({uid:Chat.curUserData.groupId,mid:Chat.curUserData.maxMessageId||Chat.curUserData.maxMsgId}),Chat.curUserData.maxMessageId=null,Chat.setUnReadMessageCount(-1*Chat.curUserData.newMsgCount,Chat.curUserData))},messageBarScroll:function(){Chat.chatList.off("scroll").on("scroll",function(e){if($(".right-click-panel").off("click").remove(),Chat.curUserData&&(Chat.curUserData.historyPage||Chat.curUserData.groupId)){var t=$(this);Chat.timerHistory&&clearTimeout(Chat.timerHistory),Chat.timerHistory=setTimeout(function(){t.scrollTop()<100&&Chat.curUserData.canLoadingData&&(Chat.curUserData.groupId?(Chat.curUserData.page++,Chat.fillGroupHistoryMessage()):(Chat.curUserData.historyPage++,Chat.curUserData.historyLastItem=Chat.chatListCon.find("li").eq(0),Chat.getHistoryMessage({source:Chat.curUserData.friendSource,uid:Chat.curUserData.gid,name:Chat.curUserData.name,avatar:Chat.curUserData.avatar},Chat.curUserData.messageMinId,Chat.curUserData.historyPage,e)))},200),Chat.chatEl.find(".chat-labels-panel").append($(".chat-recommend-labels")),Chat.layerCeilingInfo()}})},unlockMessages:function(e){var t=Chat.curUserData,i={jobId:t.infoData.toPositionId,geekId:t.encryptUid,securityId:t.infoData.securityId,expectId:t.infoData.encryptExpectId};$.get("/bossweb/block/unlockchat.json",i,function(a){if(a.chatToast&&$.toast({type:"success",content:a.chatToast}),a.block&&a.blockPageData){var n={parameter:{jobId:i.jobId},success:function(){Chat.unlockMessages(e),"send"==e.from&&Publisher.sendText()}};window.top.BlockSence.include(a.blockPageData,n)||Commercial.block(a.blockPageData,function(t,n){var s=$.extend({isPurchase:!0,jobId:t.jobId||i.jobId,business:t.business,targetType:t.targetType},n);Purchase.commercial({jobId:s.jobId,priceId:s.encryptPriceId,targetId:t.encryptTargetId,business:s.business||"",targetType:void 0!=a.blockPageData.targetType?a.blockPageData.targetType:s.targetType},{item:s,success:function(){Chat.unlockMessages(e),"send"==e.from&&Publisher.sendText()}})})}else a.block||1!==a.rescode?$.toast({type:"error",content:a.resmsg}):Chat.renderBox(t.uid)})},checkUserBlock:function(){return Chat.curUserData&&Chat.curUserData.infoData&&Chat.curUserData.infoData.block},ublockBlockGeek:function(e){var t=Chat.curUserData.uid;$.post("/boss/block/use/geekchatcard.json",{geekId:t,blockBagId:e.encryptBlockBagId||""},function(e){1==e.rescode?(Chat.usersData[t].infoData.block=!1,Chat.tabcontentEls.find(".suspend-bar").text("使用成功，立即和牛人沟通"),setTimeout(function(){Chat.curUserData.uid===t&&Chat.tabcontentEls.find(".suspend-bar").remove()},3e3)):$.toast({type:"error",content:e.resmsg})})},addPropToTalkBar:function(e){var t=e.page.cardList||[],i=t[0],a=t[1],n=i.freeCount<1&&a.leftCount>0?"使用有剩余极客畅聊卡（1/"+a.leftCount+"）":"立即沟通",s='<div class="suspend-bar"><a class="btn-unlock-geek" href="javascript:;">'+n+'</a><p class="suspend-text">'+e.page.title+e.page.subTitle+"</p></div>";Chat.tabcontentEls.append(s)},getLabelTpl:function(e,t){var i=[{selected:e.indexOf("经验不足")>-1,text:"经验不足"},{selected:e.indexOf("待定")>-1,text:"待定"},{selected:e.indexOf("入职")>-1,text:"入职"},{selected:e.indexOf("待回复")>-1,text:"待回复"},{selected:e.indexOf("需要二面")>-1,text:"需要二面"},{selected:e.indexOf("态度好")>-1,text:"态度好"},{selected:e.indexOf("有更好的人选")>-1,text:"有更好的人选"}];return Utemplate('<div style="display: <%this.display%>;" class="chat-labels-panel"><p class="chat-labels-input"><em class="icon-plus"></em><input class="ipt" maxlength="8" placeholder="添加标签备注" /></p><ul class="chat-labels-suggest"></ul><div class="chat-recommend-labels"><div class="chat-recommend-wrap"><dl><dt>快速选择标签给牛人分类，仅自己可见</dt><%for (var i=0; i<this.list.length; i++) {%><dd <%if(this.list[i].selected){%>class="selected"<%}%>><%this.list[i].text%></dd><%}%></dl><div <%if(this.note){%>style="display:none;"<%}%> class="chat-remark-input"><textarea maxlength="120" placeholder="点击添加备注"></textarea><p class="remark-count"><span>0</span>/120</p></div><p <%if(!this.note){%>style="display:none;"<%}%> class="chat-geek-note">备注：<%this.note%><span class="remark-edit"></span></p><p <%if(this.note){%>style="display:none;"<%}%> class="chat-note-update"><button class="btn">确定</button></p></div></div></div>',{list:i,note:t,display:e.length>11?"none":"inline-block"})},renderGeekCard:function(e){var t=Chat.curUserData.infoData,i="",a="",n=1!=_PAGE.jobCompeteStatus&&2!=_PAGE.jobCompeteStatus||1==Chat.curUserData.friendSource?"":'<span class="job-competitive">牛人分析器</span>',s=[],o=[t.city,t.ageDesc,t.year,t.edu,t.school].filter(function(e){return e});t.phone&&s.push('<span class="card-brief-item" title="'+t.phone+'"><i class="iboss-phone"></i>'+t.phone+"</span>"),t.weixin&&s.push('<span class="card-brief-item" title="'+t.weixin+'"><i class="iboss-wechat"></i>'+t.weixin+"</span>");var r='<span class="card-brief-item">'+t.applyStatusDes+"："+filterXss(t.lastCompany?t.lastCompany:t.school)+'</span><em class="vline"></em><span class="card-brief-item">'+filterXss(t.lastPosition?t.lastPosition:t.major)+"</span>",c=Chat.curUserData.infoData.everWorkPositionNameList?'<span class="card-brief-item">曾任：'+(Chat.curUserData.infoData.everWorkPositionNameList||[]).join("、")+"</span>":"",l=1==Chat.curUserData.friendSource?c:r;a+='<div class="chat-geek-card"><h3>'+Chat.XssText(t.name)+'</h3><span class="card-gender-item">'+(1==t.gender?'<i class="iboss-icon_man"></i>':'<i class="iboss-icon_women"></i>')+"</span>"+l+n,a+=s.join(""),a+="</div>";var d=1==Chat.curUserData.friendSource?Chat.curUserData.infoData.everWorkPositionNameList?"曾任："+(Chat.curUserData.infoData.everWorkPositionNameList||[]).join("、"):"":t.applyStatusDes+"："+filterXss(t.lastCompany?t.lastCompany:t.school)+" · "+filterXss(t.lastPosition?t.lastPosition:t.major);i='<div class="chat-geek-card"><h3>'+Chat.XssText(t.name)+'</h3><span class="card-gender-item">'+(1==t.gender?'<i class="iboss-icon_man"></i>':'<i class="iboss-icon_women"></i>')+"</span>"+n+'<span class="card-brief-item geek-info">'+o.join('<em class="vline"></em>')+"</span>"+s.join("")+"</div>",i+='<div  class="chat-card-info">',i+='<div class="text"><span class="fr chat-info-position" style="font-size: 12px;">沟通职位：<span data-jobid="'+t.toPositionId+'" class="text-blue link-job">'+filterXss(t.toPosition)+'</span><a ka="geek_chat_job" href="javascript:;" class="btn-position"><i class="iboss-editor-exchange"></i><span style="display: none;">更换职位</span></a></span><p><span class="last-info">'+d+'</span><em class="vline"></em><span class="card-brief-item expect">期望职位：'+filterXss(t.position)+'</span><span class="salary">'+t.price+"</span></p></div>",i+='<div class="chat-geek-tag">',$.each(t.labels,function(e,t){i+="<span>"+t+'<i class="icon-close"></i></span>'}),i+=Chat.getLabelTpl(t.labels,t.note),i+="</div>",t.note&&(i+='<div class="chat-geek-remarks"><div class="fl">备注:</div><p class="expand-p">'+t.note+'<span class="remark-edit"></span></p></div>'),i+="</div>",i+='<p class="card-unfold"><i class="iboss-up"></i></p>',Chat.chatList.find(".chat-info").html(i),!Chat.chatList.find(".ceiling-card").length&&Chat.chatList.prepend('<div class="ceiling-card">'+a+"</div>"),Chat.layerCeilingInfo(),Chat.initLableInut()},renderBox:function(uid,eid,el,toggle,e){var uid=uid,el=el||Chat.userList.find('a[data-uid="'+uid+'"]'),eid=eid||el.attr("data-eid"),geek=Chat.usersData[uid],toggleTabs=Chat.toggleTypeEl.find("span"),iqArr=[{key:"action",value:"query"},{key:"form_id",value:_PAGE.uid+""},{key:"to_id",value:uid+""},{key:"chat_type",value:"1"},{key:"msg_id",value:""}];ChatWebsocket.sendIqMessage(iqArr),Chat.chatBox.find(".nlp-sug-container").length&&Chat.chatBox.find(".nlp-sug-container").remove(),Chat.chatEl.show(),Chat.welcomeEl.hide(),Chat.chatEl.find(".chat-group-cover").remove(),Chat.chatList.find(".ceiling-card").hide(),PageSet.settings("note-message-tip")?Chat.chatEl.find(".btn-message .note-message-tip").remove():Chat.chatEl.find(".btn-message .note-message-tip").show(),$("#page_key_name").val(VersionStatus.preKa+"bpc_chat");var loadType=e&&"click"==e.type?"list":"listload",redDot=Chat.userList.find('a[data-uid="'+uid+'"]').find(".notice-badge").length?"red":"",view="chatview";1==Chat.containerChat.find(".data-tab .cur").index()&&(view="infoview"),7==Chat.containerChat.find(".menu-status .show .cur").attr("data-origin")&&(view="fileview2"),uid&&Chat.sendKaEvent("Geekshow_"+loadType+redDot+"_"+Chat.getPublicStatis().context+"_"+view+"_"+uid),Chat.toggleTypeEl.attr("title",""),el&&el.length||!uid||!eid||(Chat.addUser(uid,eid),el=Chat.userList.find('a[data-uid="'+uid+'"]')),Chat.userList.find("li").removeClass("cur"),el.parent().addClass("cur"),Chat.setDraft();var history=Chat.getDraft(uid);uid&&history.content?(el.find(".draft").remove(),Publisher.editorInput.html(history.content),Publisher.submitBtn.removeClass("btn-disabled"),Publisher.setCursorEnd(Publisher.editorInput.get(0))):(Publisher.editorInput.html(""),Publisher.submitBtn.addClass("btn-disabled")),Chat.chatList.find(".chat-info").html(""),Chat.chatListCon.html(""),Chat.chatBox.find(".notice-dialog").remove(),Chat.toUserId=uid,Chat.curUserData=Chat.usersData[Chat.toUserId],Chat.chatList.unbind("scroll"),4==Chat.filterParms.origin?(Chat.tabcontentEls.removeClass("show-box"),Chat.attachContainer.addClass("show-box"),toggleTabs.removeClass("cur"),toggleTabs.eq(2).addClass("cur"),Chat.chatEl.find(".detail-bottom").show()):Chat.resumeContainer.hasClass("show-box")||Chat.attachContainer.hasClass("show-box")?(Chat.resumeContainer.removeClass("show-box"),Chat.attachContainer.removeClass("show-box"),toggleTabs.removeClass("cur"),toggleTabs.eq(0).addClass("cur"),Chat.chatBox.addClass("show-box"),Chat.chatEl.find(".detail-bottom").hide()):Chat.chatEl.find(".detail-bottom").hide();var get={detail:function(){Chat.xhrs.detail&&Chat.xhrs.detail.abort();var e=$.Deferred();return Chat.xhrs.detail=$.ajax({type:"GET",url:el.attr("data-url"),dataType:"JSON",data:null,success:function(t){e.resolve(t)}}),e},labels:function(){}},__detail=function(response){"string"==typeof response&&(response=eval("("+response+")"));var result=response.zpData;if(result&&1==result.status){var data=result.data;if(data.labels=data.labels?data.labels:[],data.uid!=Chat.curUserData.gid)return;Chat.curUserData.infoData=data,Chat.curUserData.encryptUid=data.encryptUid,Chat.curUserData.isCloseInterview=data.isCloseInterview,Chat.curUserData.isCloseInterview=data.isCloseInterview,Chat.curUserData.relationType=data.relationType,el.attr("data-eid",data.encryptUid),void 0===data.encryptUid?el.attr("href","/chat/geek/chatinfo?gid="+data.uid+"&securityId="+Chat.curUserData.securityId):el.attr("href","/chat/geek/chatinfo?uid="+data.encryptUid+"&securityId="+Chat.curUserData.securityId),Chat.curUserData.messageMinId=0,Chat.curUserData.historyPage=1,Chat.curUserData.canLoadingData=!0,Chat.curUserData.historyLastItem=null,$.extend(Chat.usersData[uid].infoData,data),data.resumeVisible?(Chat.toggleTypeEl.find('span[data-target="attachment-container"]').removeClass("gray"),Chat.toggleTypeEl.find(".dropdown-wrap").hide()):(Chat.toggleTypeEl.find('span[data-target="attachment-container"]').addClass("gray"),Chat.toggleTypeEl.find(".dropdown-wrap").show(),data.bothTalked?Chat.toggleTypeEl.find(".dropdown-wrap .dropdown-menu").html('<ul><li data-type="resume"><i class="icon-resume"></i>请求附件简历</li></ul>').css("margin-left","-24px"):Chat.toggleTypeEl.find(".dropdown-wrap .dropdown-menu").html('<p class="gray"><i class="icon-resume"></i>暂无附件简历，在牛人回复后可以向他请求</p>').css("margin-left","-116px")),data.mobileVisible?Chat.opTopEls.find(".dropdown-phone").css("display","inline-block").attr("ka","showmobile_"+Chat.curUserData.uid):Chat.opTopEls.find(".dropdown-phone").css("display","none"),data.weixinVisible?Chat.opTopEls.find(".dropdown-weixin").css("display","inline-block").attr("ka","showwechat_"+Chat.curUserData.uid):Chat.opTopEls.find(".dropdown-weixin").css("display","none"),data.interview?Chat.opTopEls.find(".op-interview").css("display","inline-block").attr("ka","showinterview_"+Chat.curUserData.uid):Chat.opTopEls.find(".op-interview").css("display","none"),Chat.getHistoryMessage({source:Chat.curUserData.friendSource,uid:data.uid,name:data.name,avatar:data.avatar},Chat.curUserData.messageMinId,1,e),Chat.renderGeekCard(!0),Chat.setRelationStatus(data),Chat.setFuntionButton(data),data.block&&Chat.addPropToTalkBar(data),setTimeout(function(){Chat.readResumedirect(el)},300),Chat.messageBarScroll()}else-1==result.status?($.toast({content:"已在其他设备删除该联系人",type:"error"}),uid&&Chat.sendKaEvent("friend_deleted_"+uid)):1011==result.code?alert("登录信息失效，请重新登录"):($.toast({content:"数据加载失败，请稍后再试",type:"error"}),uid&&Chat.sendKaEvent("friend_error_"+uid));11===Chat.curUserData.relationType?Chat.setStarEl.addClass("selected").find(".tooltip p").html("取消星标"):Chat.setStarEl.removeClass("selected").find(".tooltip p").html("&emsp;星标&emsp;")};$.when(get.detail()).then(function(e){__detail(e),e.zpData&&e.zpData.data&&$.post("/wapi/zpchat/session/bossEnter",{geekId:e.zpData.data.encryptUid,expectId:e.zpData.data.encryptExpectId,jobId:e.zpData.data.toPositionId},function(){})}),Chat.usersData[uid]||Chat.addUser(uid,eid),Chat.curUserData&&(Chat.curUserData.isTop?(Chat.setTopEl.addClass("selected").attr("ka","geek_toping_cancel_"+Chat.curUserData.uid),Chat.setTopEl.find(".tooltip p").text("已置顶，点击取消")):(Chat.setTopEl.removeClass("selected").attr("ka","geek_toping_set_"+Chat.curUserData.uid),Chat.setTopEl.find(".tooltip p").text("置顶联系人")),"1"!==localStorage.getItem("chat-geek-star-guide")&&"2"!==localStorage.getItem("chat-geek-star-guide")&&(ChatGuid.star(),localStorage.setItem("chat-geek-star-guide","1")),Chat.curUserData.mids=[],Chat.curUserData.lastMessage={},Chat.clearMessageCount(Chat.curUserData,Chat.curUserData.newMsgCount))},Sticker:{time:0,timer:null,title:document.title,show:function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){e.time++,e.show(),e.time%2==0?document.title="BOSS直聘":document.title="有新消息啦！"},500)},clear:function(){var e=this;clearTimeout(e.timer),document.title=e.title}},changeTop:function(e){var t=e.attr("data-friendId"),i=e.attr("data-isTop"),a={},n={},s=Chat.usersData[t],o=Chat.usersData[t],r=Chat.userList.find('a[data-uid="'+t+'"]').parent("li"),c=r.index(),l=(Chat.userList.find(".cur"),Chat.curUserData),d=Chat.setTopEl;a.setTop=function(){return $.ajax({url:"/wapi/zprelation/friend/friendIsTop.json                ",data:{friendId:s.gid,securityId:s.securityId,isTop:i},type:"post",dataType:"JSON",timeout:5e3,success:function(t){0===t.code?1==i?n.setTop(e):n.cancelTop(e):$.toast({content:t.message,type:"warning"}),e.removeClass("disabled")},error:function(t){e.removeClass("disabled")}}),!1},n.setTop=function(e){Chat.usersData[t].isFiltered||8===!Chat.usersData[t].relationType||ImFriends.publishSyncData({type:"setTop",uid:t,source:o.friendSource}),e.attr("data-isTop",0).text("取消置顶"),$.toast({content:"已置顶",type:"success"}),r.find("a").attr("data-settop",1),Chat.usersData[t].isTop=1,r.prependTo(Chat.userListTop).attr("latest-index",c).find(".time").text(Chat.dateFormat(new Date,"hh:mm")),o==l&&d.addClass("selected").find(".tooltip p").text("已置顶，点击取消"),Chat.sendKaEvent("chat_geek_top")},n.cancelTop=function(e){Chat.usersData[t].isFiltered||8===!Chat.usersData[t].relationType||ImFriends.publishSyncData({type:"cancelTop",uid:t,source:o.friendSource}),e.attr("data-isTop",1).text("置顶"),$.toast({content:"已取消置顶",type:"success"}),r.find("a").removeAttr("data-settop"),Chat.usersData[t].isTop=0,r.prependTo(Chat.userListMain).find(".time").text(Chat.dateFormat(new Date,"hh:mm")),o==l&&d.removeClass("selected").find(".tooltip p").text("置顶联系人"),Chat.sendKaEvent("chat_geek_untop")},e.hasClass("disabled")||a.setTop()},deleteLinkman:function(e){var t=(e.parents("a").attr("data-eid"),e.parents("a").attr("data-source")),i=e.parents("li"),a=e.attr("data-uid"),n={},s=Chat.usersData[a],o=function(){count=Chat.usersData[a].newMsgCount,count>0&&(Chat.unreadMessageCount=Chat.unreadMessageCount-count,Chat.unreadCountBox.text(Chat.unreadMessageCount),Chat.unreadMessageCount<=0&&Chat.unreadCountBox.hide())},r=function(){for(var e=0;e<Chat.drafts.length;e++)Chat.drafts[e].uid==a&&Chat.drafts.splice(e,1);sessionStorage.setItem("__Chat__Drafts",__stringify(Chat.drafts))};n.delete=function(){$.ajax({type:"POST",url:"/wapi/zprelation/friend/delete.json",dataType:"JSON",data:{geekId:s.encryptUid,securityId:s.securityId},success:function(e){0===e.code?($.toast({content:"删除成功",type:"success"}),chatUserPresenter.setStatus(a,77),Chat.curUserData&&Chat.curUserData.encryptUid==s.encryptUid&&(Chat.curUserData={},Chat.chatEl.hide(),Chat.welcomeEl.show()),Chat.usersData[a].newMsgCount&&Chat.setUnReadMessageCount(-1*Chat.usersData[a].newMsgCount,Chat.usersData[a]),r(),o(),i.remove(),Chat.sendKaEvent("chat_geek_delete"),ImFriends.publishSyncData({type:"delete",uid:a,source:t}),delete Chat.usersData[a]):$.toast({content:e.resmsg,type:"error"})},error:function(e){$.toast({content:"请求失败",type:"error"})}})},function(){$.dialog({title:"是否删除此联系人？",content:"删除后消息将被清空",confirmText:"确定",cancelText:"取消",closeText:!0,closeLayer:!1,wrapClass:"dialog-delete-linkman",onConfirm:function(e){e.remove(),n.delete()}})}()},setTop:function(e){var e=e,t=e.hasClass("selected")?0:1;if(e.hasClass("disabled"))return!1;e.addClass("disabled"),$.ajax({url:"/wapi/zprelation/friend/friendIsTop.json",data:{friendId:Chat.curUserData.gid,securityId:Chat.curUserData.securityId,isTop:t},type:"post",dataType:"JSON",timeout:5e3,success:function(i){if(0===i.code){var a=Chat.userList.find(".cur"),n=(a.attr("latest-index"),a.index());t?(a.find("a").attr("data-settop",1),e.attr("ka","geek_toping_cancel_"+Chat.curUserData.uid),e.addClass("selected").find(".tooltip p").text("已置顶，点击取消"),Chat.curUserData.isTop=1,Chat.usersData[Chat.curUserData.uid].isTop=1,$.toast({content:"已置顶",type:"success"}),a.find(".user-operation .user-operation-item:first-child").attr("data-isTop",0).text("取消置顶"),a.prependTo(Chat.userListTop).attr("latest-index",n).find(".time").text(Chat.dateFormat(new Date,"hh:mm"))):(a.find("a").removeAttr("data-settop"),e.attr("ka","geek_toping_set_"+Chat.curUserData.uid),e.removeClass("selected").find(".tooltip p").text("置顶联系人"),Chat.curUserData.isTop=0,Chat.usersData[Chat.curUserData.uid].isTop=0,$.toast({content:"已取消置顶",type:"success"}),a.find(".user-operation .user-operation-item:first-child").attr("data-isTop",1).text("置顶"),a.prependTo(Chat.userListMain).find(".time").text(Chat.dateFormat(new Date,"hh:mm")))}else $.toast({content:i.message,type:"warning"});e.removeClass("disabled")},error:function(e){}})},setStar:function(e){var e=e,t=e.hasClass("selected");if(e.hasClass("disabled"))return!1;e.addClass("disabled");try{var i={action:"star-interest-click",bg:1,uid:_PAGE.uid,p2:Chat.curUserData.gid,p3:Number(!t),p4:Chat.curUserData.jobId||Chat.curUserData.infoData&&Chat.curUserData.infoData.jobId};Block.action(i)}catch(e){}var a=t?"/wapi/zprelation/userMark/del":"/wapi/zprelation/userMark/add";$.ajax({url:a,data:{markType:5,encryptMarkId:Chat.curUserData.encryptUid},type:"post",dataType:"JSON",timeout:5e3,success:function(i){if(0===i.code&&i.zpData){var a=Chat.userList.find(".cur");t?(Chat.setStarEl.removeClass("selected").find(".tooltip p").html("&emsp;星标&emsp;"),Chat.curUserData.relationType=-1,Chat.usersData[Chat.curUserData.uid].relationType=-1,a.find(".iboss-xingbiao-mian").addClass("hide"),$.toast({content:"取消星标成功",type:"success"})):(Chat.setStarEl.addClass("selected").find(".tooltip p").html("取消星标"),Chat.curUserData.relationType=11,Chat.usersData[Chat.curUserData.uid].relationType=11,a.find(".iboss-xingbiao-mian").removeClass("hide"),$.toast({content:"星标添加成功",type:"success"}),"2"!==localStorage.getItem("chat-geek-star-guide")&&(ChatGuid.starFilter(),localStorage.setItem("chat-geek-star-guide","2")))}else $.toast({content:i.message||"服务器异常",type:"error"});e.removeClass("disabled")},error:function(){$.toast({content:"服务器异常",type:"error"}),e.removeClass("disabled")}})},cancelDomFilter:function(){ChatGeeksFilter.set({conversationType:"",label:""}),Chat.containerChat.find(".condition-filter .selected").removeClass("selected");var e=Chat.containerChat.find(".sel-filter");e.find(".filter-cancel").remove(),e.find(".dropdown-select").html('筛选 <i class="iboss-down"></i>')},toggleUser:function(data,message){$(".mchat-container").hide();var sideEl=$(".side-menu"),data=data;sideEl.find("dl").removeClass("cur"),sideEl.find(".menu-chat").click().addClass("cur"),$(".page-container").hide(),$(".chat-container").show(),$("body").removeClass("page-iframe"),Menu.setUrl("chat");var setUserChecked=function(){8===Chat.usersData[data.uid].relationType?(Chat.containerChat.find(".op-category a").removeClass("cur"),Chat.containerChat.find(".op-category a[data-status=8]").addClass("cur"),Chat.cancelDomFilter(),Chat.usersInitStatus&&Chat.getFilterUsers({},null,!1),Chat.groupHistory[8]=data.uid):(chatUserPresenter.flushJob(),Chat.groupHistory[-1]=data.uid),Menu.toggleTopMenu("top-chat")};Chat.usersData[data.uid]||void 0===data.jid?setUserChecked():$.ajax({type:"POST",url:"/chat/addRelation.json",dataType:"JSON",data:{gid:data.uid,jid:data.jid,expectId:data.expectId},success:function(result){var result=result;"string"==typeof result&&(result=eval("("+result+")")),result&&1==result.status&&$.ajax({type:"GET",url:"/wapi/zpboss/h5/chat/geek.json?uid="+data.uid,dataType:"JSON",data:null,success:function(response){"string"==typeof response&&(response=eval("("+response+")"));var result=response.zpData;if(1==result.status){var data=result.data,userInfo={avatar:data.avatar,isTop:0,lastTime:data.lastTime,name:data.name,sex:0,newMsgCount:0,uid:data.uid,encryptUid:data.encryptUid,lastTS:(new Date).getTime()};Chat.usersData[data.uid]=userInfo,Chat.usersData[data.uid].infoData=data,setUserChecked()}else $.toast({content:"数据加载失败，请稍后再试",type:"error"})},error:function(e){}})},error:function(e){}}),setTimeout(function(){$("#page_key_name").val(VersionStatus.preKa+"bpc_chat")},10)},getHistoryMessage:function(info,maxId,page,e){page>1&&Chat.hisLoading.show(),1==page&&Chat.editorEl.addClass("disabled"),Chat.xhrs.history&&Chat.xhrs.history.abort(),Chat.xhrs.history=$.ajax({url:"/wapi/zpchat/boss/historyMsg",type:"GET",data:{src:info.source,gid:info.uid,maxMsgId:maxId,c:20,page:page},dataType:"JSON",
timeout:2e4,success:function(res){var result=res.zpData;if("string"==typeof result&&(result=eval("("+result+")")),Chat.chatList.find(".chat-info").fadeIn(),1==result.type&&result.messages){var len=result.messages.length,i,message,timeMessage;if(len>0){if(Chat.curUserData.historyLastItem)for(i=len-1;i>=0;i--)message=result.messages[i],message.mSource="server",message.typeSource="history",4==message.type||4==message.body.type||message.uncount||(timeMessage=message),ChatWebsocket.receiveTextMessage(message);else{for(i=0;i<len;i++)message=result.messages[i],message.mSource="server",message.typeSource="history",timeMessage||4==message.type||4==message.body.type||message.uncount||(timeMessage=message),ChatWebsocket.receiveTextMessage(message),(!Chat.curUserData.maxMessageId||result.messages[i].mid>Chat.curUserData.maxMessageId)&&(Chat.curUserData.maxMessageId=result.messages[i].mid);1==page&&(Chat.editorEl.removeClass("disabled"),1!=Chat.containerChat.find(".data-tab .cur").index()&&Publisher.editorInput.focus())}if(timeMessage&&Chat.showTimeLine(timeMessage,!0,!0),len>19){var $record=Chat.chatEl.find(".chat-list");$record.innerHeight()>=$record.prop("scrollHeight")?(Chat.curUserData.historyPage=page+1,Chat.curUserData.canLoadingData=!1,Chat.getHistoryMessage(info,result.messages[0].mid,Chat.curUserData.historyPage,e)):setTimeout(function(){Chat.curUserData.canLoadingData=!0},300),Chat.chatList.find(".chat-info").addClass("folded")}else Chat.curUserData.canLoadingData=!1;Chat.curUserData.messageMinId=result.messages[0].mid}if(Chat.curUserData.historyLastItem)try{Chat.chatList.scrollTop(Chat.curUserData.historyLastItem.offset().top-Chat.chatList.height())}catch(e){}}else Chat.curUserData.canLoadingData=!1,Chat.chatList.find(".chat-info").fadeIn();1==page&&Chat.curUserData.maxMessageId&&(Chat.websocketConnected?Chat.sendReadMessage({userData:Chat.curUserData,uid:Chat.curUserData.uid,mid:Chat.curUserData.maxMessageId}):(Chat.interConnect&&clearInterval(Chat.interConnect),Chat.interConnect=setInterval(function(){Chat.websocketConnected&&(Chat.sendReadMessage({userData:Chat.curUserData,uid:Chat.curUserData.uid,mid:Chat.curUserData.maxMessageId}),clearInterval(Chat.interConnect))},1e3))),Chat.editorEl.removeClass("disabled"),Chat.hisLoading.hide()},error:function(e){Chat.curUserData.canLoadingData=!0,Chat.hisLoading.hide(),Chat.editorEl.removeClass("disabled"),Publisher.editorInput.focus()}}),$.when(Chat.xhrs.history).then(function(){var e=Chat.chatEl.find(".toggle-type span[data-target=attachment-container]"),t=Chat.containerChat.find(".op-category .cur").attr("data-origin");Chat.chatEl.find(".toggle-type span[data-target=resume-container]"),Chat.containerChat.find(".op-category .cur").attr("data-status");!e.hasClass("gray")&&4==t&&page<2?e.trigger("click"):(Chat.chatEl.find(".chat-list").css("visibility","visible"),setTimeout(function(){"chat-box"==Chat.toggleTypeEl.find(".cur").attr("data-target")&&Chat.chatEl.find(".chat-wrap-mask").remove()},10))}),Chat.curUserData.canLoadingData=!1},getUserInfo:function(uid,source,callback){$.ajax({url:"/wapi/zpboss/h5/chat/geek.json",data:{uid:uid,geekSource:source},dataType:"JSON",timeout:5e3,success:function(e){"string"==typeof e&&(e=eval("("+e+")")),callback(e.zpData)},error:function(e){callback({status:0,msg:"系统错误"})}})},isNewGeek:function(e){var t=Chat.usersData[e];return 1==(t.infoData?t.infoData.newGeek:t.newGeek)},totalNewGeek:function(){var e=Chat.containerChat.find(".op-category a[data-status=5]");Chat.notification[5].length>0?e.find("span").html("(<em>"+Chat.notification[5].length+"</em>)"):e.find("span").text("")},addNewGeekUser:function(e){Chat.newGeek.indexOf(e)<0&&Chat.newGeek.push(e),Chat.totalNewGeek()},addToUserList:function(e){var t=Chat.usersData[e];Chat.usersID.filter(function(t){return t.uid==e}).length||Chat.usersID.push({gid:t.gid,uid:t.uid,name:t.name,avatar:t.avatar,lastMsg:t.lastMsg,friendSource:t.friendSource})},addUser:function(e,t,i){var a={},n=[-1,1,5],s=Chat.containerChat.find(".op-category .cur"),o=function(){var e=Chat.renderUser(a),t=a,i=Chat.getGroupStatus(),n=t.newGeek?t.newGeek:t.infoData.newGeek;("-1"==i&&8!=t.relationType&&!t.isFiltered||i==t.relationType||10==i&&t.isFiltered)&&($(e).prependTo(Chat.userListMain),Chat.userList.find(".user-blank").remove()),1==n&&Chat.addNewGeekUser(a.uid),Chat.setGroupPoint(a.uid),Chat.addToUserList(a.uid)};if(!(e&&e<1001||i&&i.to&&i.to.uid<1001)){if(e&&Chat.usersData[e])a=Chat.usersData[e];else if(i){var r=i.from.uid==Chat.myselfData.uid?i.to:i.from;a={avatar:r.avatar,fromSource:i.mSource,isTop:0,friendSource:r.source,lastTime:i.time,name:r.name,sex:0,gid:r.uid,newMsgCount:0,uid:1===r.source?r.uid+1e8:r.uid,encryptUid:t,lastTS:i.time};var c="",l=a.lastTime,d=new Date,u=new Date(d.getFullYear(),d.getMonth(),d.getDate()),p=u-l;if(c=d.getFullYear()!=new Date(l).getFullYear()&&d.getFullYear()-new Date(l).getFullYear()>1?d.getFullYear()-new Date(l).getFullYear()+"年前":p>864e5?Chat.dateFormat(new Date(l),"MM月dd日"):p>0?"昨天":Chat.dateFormat(new Date(l),"hh:mm"),a.lastTime=c,i.offline)return Chat.usersData[a.uid]=a,Chat.showMessage(i);Chat.getUserInfo(a.gid,a.friendSource,function(t){if(t&&1==t.status){var n=t.data,s=!1;n.lastTS=i.time,Chat.usersData[a.uid]=a,a.securityId=n.securityId,Chat.usersData[a.uid].infoData=n,Chat.usersData[a.uid].isFiltered=n.isFiltered,Chat.usersData[a.uid].filterReasonList=n.filterReasonList,Chat.usersData[a.uid].relationType=n.relationType||0,Chat.usersData[a.uid].sourceTitle=n.sourceTitle||"",Chat.usersTempData.length||(Chat.usersTempData[0]=[],s=!0),Chat.usersTempData[0].unshift(n),a.encryptUid=n.encryptUid;var r=Chat.getGroupStatus(),c=!n.isFiltered||10==r;a.gid!=Chat.myselfData.uid&&c&&(o(t.newGeek),s&&(Chat.containerChat.find(".data-tips").hide(),Chat.containerChat.find(".user-list").show(),Chat.containerChat.find(".chat-search").show(),Chat.detailContainer.show(),Chat.welcomeEl.show())),Chat.addToUserList(a.uid),Chat.setFilterCount(),Chat.showMessage(i)}else-1==t.status&&(Chat.usersData[e]=null,e&&Chat.sendKaEvent("friend_deleted_add_"+e))})}a.orderNum=Chat.chatUserCount,Chat.chatUserCount++,a.encryptUid&&a.uid!=Chat.myselfData.uid&&(n.indexOf(Chat.groupStatus)>-1||1==s.attr("data-val"))&&o()}},addUserMsgBox:function(e,t){},showMessage:function(message){if(_PAGE.runChat&&message){12==message.body.type&&message.body.hyperLink&&1==message.body.hyperLink.hyperLinkType&&(message.body.text=message.body.hyperLink.text),20==message.body.type&&(0!=message.body.sticker.packId&&message.body.sticker.name?message.body.text="["+message.body.sticker.name+"]":message.body.text="[动画表情]"),1===message.body.type&&5===message.body.templateId&&message.to.uid===Chat.myselfData.uid&&(message.body.text=(message.body.text||"").replace(/\<\/?[a-zA-Z]+\>/g,"").replace(/<\/?phone>/g,"").replace(/<\/?copy>/g,"").replace(/&lt;phone&gt;/g,"").replace(/&lt;\/phone&gt;/g,"").replace(/&lt;copy&gt;/g,"").replace(/&lt;\/copy&gt;/g,""));var base=Chat.showMessageBase(message),messageHtml="";switch(message.body.type){case 1:message.style="text",3===message.status?messageHtml=this.showSystemMessage(message):3==message.body.templateId||6==message.body.templateId?(messageHtml=this.showSystemMessage(message),"请先填写接收附件简历邮箱"==message.body.text&&Chat.showSetEmail(function(){Chat.exchangeResume(1,{from:{uid:Chat.curUserData.uid}})})):5==message.body.templateId&&message.to.uid==Chat.myselfData.uid?(messageHtml=Chat.showSystemMessage(message),message.body.text.indexOf("微信号")>-1?(Chat.opTopEls.find(".dropdown-weixin").css("display","inline-block"),PageSet.markerInfo[12]&&Chat.flashTip(Chat.opTopEls.find(".dropdown-weixin"),"在这里查看已经交换的微信",12)):message.body.text.indexOf("手机号")>-1&&(Chat.opTopEls.find(".dropdown-phone").css("display","inline-block"),PageSet.markerInfo[9]&&Chat.flashTip(Chat.opTopEls.find(".dropdown-phone"),"在这里查看已经交换的电话",9))):messageHtml=this.showTextMessage(message);break;case 2:if(message.style="sound",3===message.status){var __from=message.from.uid==_PAGE.uid?"你":message.from.name;message.body.text=__from+"撤回了一条消息",messageHtml=this.showSystemMessage(message)}else message.body.text=message.body.text?message.body.text:"收到语音消息，请登录APP端查收",messageHtml=this.showTextMessage(message);break;case 3:if(message.style="image",3===message.status){var __from=message.from.uid==_PAGE.uid?"你":message.from.name;message.body.text=__from+"撤回了一条消息",messageHtml=this.showSystemMessage(message)}else if(1==message.body.templateId){if(message.body.image){var tinyData=message.body.image.tinyImage,originData=message.body.image.originImage,width=tinyData.width,height=tinyData.height;width>300&&(height/=Math.floor(width/300),height=Math.floor(height)),message.body.text='<img src="'+tinyData.url+'" class="img-tiny" width="" height="'+height+'" data-large="'+originData.url+'" large-x="'+originData.width+'" large-y="'+originData.height+'" />'}messageHtml=this.showTextMessage(message)}break;case 4:message.style="action";var __action=message.body.action||{};if(20==__action.aid){var extend=eval("("+message.body.action.extend+")");Chat.setDialogMessageDomStatus(extend.msg_id)}else if(27==__action.aid)message.body.text="请求交换联系方式已发送",messageHtml=this.showSystemMessage(message);else if(32==__action.aid)message.body.text="请求交换微信已发送",messageHtml=this.showSystemMessage(message);else if(37==__action.aid){var email=_PAGE.email;if(message.body.action.extend&&message.body.action.extend.indexOf("{")>-1){var extend=eval("("+message.body.action.extend+")");email=extend.resumeEmail}message.body.text="简历请求已发送。如果牛人同意，TA的简历将发送到{"+email+"}!",messageHtml=this.showSystemMessage(message)}else 75==__action.aid&&__action.extend&&Revocation.sync(message);break;case 7:if(message.style="exchange",message.isSelf)0==message.body.dialog.type||4==message.body.dialog.type&&(base.userData.isCloseInterview=!0);else{var __group=[0,1,2,11];message.body.dialog?__group.indexOf(message.body.dialog.type)>-1?messageHtml=this.showDialogMessage(message):9==message.body.dialog.type?(message.body.text="面试时间到",messageHtml=this.showSystemMessage(message)):(message.body.text="收到一条消息，请在手机上查看。",messageHtml=this.showSystemMessage(message)):(message.body.text="",messageHtml=this.showSystemMessage(message))}break;case 12:var hyperLinkType=message.body.hyperLink?message.body.hyperLink.hyperLinkType:"";if(2==hyperLinkType&&(message.body.hyperLink.text.indexOf("面试提醒")>-1||message.body.hyperLink.text.indexOf("面试邀请")>-1)&&message.to.uid==Chat.myselfData.uid)message.body.text=message.body.hyperLink.text,messageHtml=this.showSystemMessage(message),Chat.opTopEls.find(".op-interview").css("display","inline-block"),PageSet.markerInfo[11]&&Chat.flashTip(Chat.opTopEls.find(".op-interview"),"在这里查看面试信息",11);else if(3==hyperLinkType&&message.to.uid==Chat.myselfData.uid)message.body.text=message.body.hyperLink.text,messageHtml=this.showSystemMessage(message);else if(1==hyperLinkType)message.body.text="附件简历已经发送到您的邮箱",messageHtml=this.showTextMessage(message),Chat.toggleTypeEl.find('span[data-target="attachment-container"]').removeClass("gray"),Chat.toggleTypeEl.find(".dropdown-wrap").css("display","none"),PageSet.markerInfo[10]&&Chat.flashTip(Chat.toggleTypeEl.find('span[data-target="attachment-container"]'),"在这里查看已收到的简历",10);else if(6===hyperLinkType){var p2=this.getRemarksAndTagType(message);this.joinSystemMessage(message,p2)}break;case 13:if(!(message.body.video&&message.body.video.videoText||message.body.video.text))break;var videoText=JSON.parse(message.body.video.videoText||message.body.video.text);if(message.body.video.videoType=message.body.video.videoType||message.body.video.type,!_PAGE.canInterviewOnline){message.body.text="对方发起了语音通话，请在新版App中查看",messageHtml=this.showSystemMessage(message);break}if(message.body.text=videoText.videoText,1==videoText.status&&message.from.uid==Chat.myselfData.uid||0==videoText.status&&message.to.uid==Chat.myselfData.uid){var tmp=message.from;message.from=message.to,message.to=tmp,message.isSelf=!message.isSelf}messageHtml=this.showTextMessage(message);var textTmp="";1==message.body.video.videoType?textTmp='<i class="iboss iboss-yuyin-miansvg"></i>':2==message.body.video.videoType&&(textTmp='<i class="iboss iboss-shipin-miansvg"></i>'),messageHtml=$(messageHtml).find(".text").find(".status").remove().end().prepend(textTmp).end().prop("outerHTML");break;case 14:messageHtml=this.showInterviewMessage(message);break;case 16:var article=message.body.articles.length?message.body.articles[0]:{};if(3==message.type&&1==message.body.templateId?message.body.text="收到一条消息，请在手机上查看。":8===article.templateId&&(message.body.text="该牛人正在使用提问加油卡寻求你的帮助，可登录app查看。"),8===article.templateId)messageHtml=this.showGreetQusMessage(message);else if(9===message.body.templateId){messageHtml=this.showGeekInviteInterviewMessage(message);try{Block.action({action:"interview-invite-sg",uid:_PAGE.uid,bg:1,p:_PAGE.uid,p2:Chat.usersData[message.from.uid].jobId})}catch(e){console.log(e)}}else messageHtml=this.showSystemMessage(message);break;case 20:if(message.style="sticker",3===message.status){var __from=message.from.uid==_PAGE.uid?"你":message.from.name;message.body.text=__from+"撤回了一条消息",messageHtml=this.showSystemMessage(message)}else if((1==message.body.templateId||20==message.body.type)&&message.body.sticker&&3!=message.status){var packId=message.body.sticker.packId,sid=message.body.sticker.sid;if(message.body.sticker.image){var originData=message.body.sticker.image.originImage,tinyData=message.body.sticker.image.tinyImage,extraStr="";if(0==packId){var isCollected=!1;if(Chat.storedEmtions)for(var k=0;k<Chat.storedEmtions.length;k++)Chat.storedEmtions[k].itemId==sid&&(isCollected=!0);isCollected||(extraStr='<span class="btn-store" data-origin="'+originData.url+'" data-packId="'+packId+'" data-sid="'+sid+'">添加表情</span>')}message.body.text='<img src="'+originData.url+'"  class="img-tiny" width="'+originData.width/2+'" height="'+originData.height/2+'"/>'+extraStr,messageHtml=this.showTextMessage(message)}}break;case 99:messageHtml=this.showSystemMessage(message);break;default:message.body.text=message.body.video?"":"收到一条消息，请在手机上查看。",messageHtml=this.showSystemMessage(message)}var __source=message.isSelf?message.to:message.from,__geek=Chat.getGeekById(__source.uid,__source.source);""!=messageHtml&&!message.tempID&&__geek&&(__geek.lastMsgId=Math.max(__geek.lastMsgId||0,message.mid)),99==message.body.type&&message.from.uid==Chat.curUserData.gid&&0==Chat.chatListCon.find("#temp-"+message.mid).length?($(messageHtml).appendTo(Chat.chatListCon),Chat.scrollToBottom()):(message.from.uid==Chat.myselfData.uid&&message.to&&message.to.uid==Chat.curUserData.gid||message.to&&message.to.uid==Chat.myselfData.uid&&message.from.uid==Chat.curUserData.gid)&&(messageHtml&&message.from.uid==Chat.curUserData.gid||message.from.uid==Chat.myselfData.uid)&&(Chat.curUserData.historyLastItem&&"history"==message.typeSource&&0==Chat.chatListCon.find("#temp-"+message.mid).length?($(messageHtml).prependTo(Chat.chatListCon),Chat.showTimeLine(message,!0)):message.offline||0!=Chat.chatListCon.find("#temp-"+message.mid).length||(Chat.showTimeLine(message),$(messageHtml).appendTo(Chat.chatListCon),Chat.scrollToBottom()),message.from.uid!=Chat.curUserData.uid||Chat.curUserData.lastMessage[message.mid]||(Chat.curUserData.lastMessage[message.mid]=!0))}},flashTip:function(e,t,i){var a=$('<div class="tooltip"><p class="gray">'+t+"</p></div>");if(e.find(".tooltip").length<1){e.prepend(a);var n=e.width()/2-a.width()/2;e.find(".tooltip").css({left:n,display:"inline-block"})}PageSet.markerInfo[i]&&$.ajax({url:"/setting/notify/set.json",type:"POST",data:{type:i},dataType:"JSON",timeout:5e3,success:function(e){},error:function(e){}}),setTimeout(function(){e.find(".tooltip").remove()},3e3),PageSet.markerInfo[i]=!1},showMessageOther:function(e){if(_PAGE.runChat&&e){var t=null;switch(e.body.type){case 1:1==e.body.templateId||0==e.body.templateId?Chat.showMessage(e):3==e.body.templateId||7==e.body.templateId||6==e.body.templateId?Chat.showMessage(e):5==e.body.templateId&&e.to.uid==Chat.myselfData.uid&&(e.body.text=(e.body.text||"").replace(/\<\/?[a-zA-Z]+\>/g,"").replace(/<\/?phone>/g,"").replace(/<\/?copy>/g,"").replace(/&lt;phone&gt;/g,"").replace(/&lt;\/phone&gt;/g,"").replace(/&lt;copy&gt;/g,"").replace(/&lt;\/copy&gt;/g,""),Chat.showMessageBase(e),t=Chat.showSystemMessage(e),e.body.text.indexOf("微信号")>-1?(Chat.opTopEls.find(".dropdown-weixin").css("display","inline-block"),PageSet.markerInfo[12]&&Chat.flashTip(Chat.opTopEls.find(".dropdown-weixin"),"在这里查看已经交换的微信",12)):e.body.text.indexOf("手机号")>-1&&(Chat.opTopEls.find(".dropdown-phone").css("display","inline-block"),PageSet.markerInfo[9]&&Chat.flashTip(Chat.opTopEls.find(".dropdown-phone"),"在这里查看已经交换的电话",9)));break;case 4:if(!e.body.action)break;if(30==e.body.action.aid)Chat.outputData[e.body.action.aid]=JSON.parse(e.body.action.extend);else if(31==e.body.action.aid)Chat.outputData[e.body.action.aid]=JSON.parse(e.body.action.extend);else if(35==e.body.action.aid)Chat.outputData[e.body.action.aid]=JSON.parse(e.body.action.extend);else if(47==e.body.action.aid||67==e.body.action.aid);else if(63==e.body.action.aid);else if(50==e.body.action.aid);else if(61==e.body.action.aid);else if(70==e.body.action.aid&&""!==e.body.action.extend)alert("您的账号当前处于不可使用状态，请登录BOSS直聘手机APP查看详情"),window.location.href="/logout/?toUrl=/user/security/blocktip.html";else if(85==e.body.action.aid){if(!_PAGE.canInterviewOnline){e.body.text="对方发起了语音通话，请在新版App中查看",t=this.showSystemMessage(e),Chat.showMessageBase(e);break}"history"==e.typeSource||e.presence||(Chat.canShowStickerMessage&&!e.isSelf&&Chat.Sticker.show(),PAGE_ACTIVITY&&(!PAGE_ACTIVITY||$(".side-menu .menu-chat").hasClass("cur"))||e.offline||chatNotification.show(e.from.name,e.from.avatar,e)),mediator.publish("INTERVIEW_ACTION",{type:"called",kind:"audio",data:e.body.action.extend})}else 98==e.body.action.aid?e.received||mediator.publish("INTERVIEW_ACTION",{type:"hang-up",data:e.body.action.extend}):99==e.body.action.aid&&(e.received||mediator.publish("INTERVIEW_ACTION",{type:"hang-up",data:e.body.action.extend}));break;case 7:if(!e.body.dialog)break;17===e.body.dialog.type&&(Chat.showMessageBase(e),t=Chat.showMapDialogMessage(e));break;case 9:case 8:Chat.showMessageBase(e);break;case 10:Chat.showMessageBase(e),e.isSelf?e.body.text="发出一个红包，请登录APP查看":e.body.text="收到红包消息，请登录APP端查收",t=Chat.showSystemMessage(e);break;case 12:6===util.get(e,"body.hyperLink.hyperLinkType","-1")&&(t=Chat.showHyperLinkMessage(e));break;case 13:case 14:Chat.showMessage(e);break;case 16:1==e.body.templateId&&Chat.showMessage(e)}99==e.body.type&&e.from.uid==Chat.curUserData.uid&&0==Chat.chatListCon.find("#temp-"+e.mid).length?($(t).appendTo(Chat.chatListCon),Chat.scrollToBottom()):(e.from.uid==Chat.myselfData.uid&&e.to.uid==Chat.curUserData.uid||e.to.uid==Chat.myselfData.uid&&e.from.uid==Chat.curUserData.uid)&&(t&&e.from.uid==Chat.curUserData.uid||e.from.uid==Chat.myselfData.uid)&&(Chat.curUserData.historyLastItem&&"history"==e.typeSource&&0==Chat.chatListCon.find("#temp-"+e.mid).length?($(t).prependTo(Chat.chatListCon),Chat.showTimeLine(e,!0)):e.offline||0!=Chat.chatListCon.find("#temp-"+e.mid).length||(Chat.showTimeLine(e),$(t).appendTo(Chat.chatListCon),Chat.scrollToBottom()),e.from.uid!=Chat.curUserData.uid||Chat.curUserData.lastMessage[e.mid]||(Chat.curUserData.lastMessage[e.mid]=!0))}},updateMessagePage:function(e){if(Chat.propMessages.push(e),window.location.href.indexOf("/boss/item/myItemList.html")>-1){var t=$(".frame-container").contents().find(".op-category"),i=t.find('a[data-type="notice"]'),a=null;if(!t.length)return;if(a=$(".frame-container").get(0).contentWindow,i.hasClass("cur"))return;if(i.append('<i class="dot"></i>'),a)try{a.ZhiBean.propNoticeList(1)}catch(e){}}},showInterviewMessage:function(e){if(4!=e.type&&e.body.interview){var t={1:'<i class="icon-interview-send"></i>',2:'<i class="icon-interview-cancel"></i>',3:'<i class="icon-interview-accept"></i>',4:'<i class="icon-interview-reject"></i>',5:'<i class="icon-interview-cancel"></i>',6:"",7:'<i class="icon-interview-arrive"></i>',8:'<i class="icon-interview-inquire"></i>',9:'<i class="icon-interview-response"></i>'},i=e.from.uid==Chat.myselfData.uid,a=i?"item-myself":"item-friend",n=e.pushText.replace(e.from.name,"").replace("给你",""),s="",o=t[e.body.interview.condition]||"",r=n+o;return i||(r=o+n,s='<div class="figure"><img src="'+e.from.avatar+'" alt=""></div>'),'<li data-type="interview" class="'+a+'">'+s+'<div class="text">'+r+"</div></li>"}},showTextMessage:function(e){var t=e.body.text?e.body.text:e.pushText;e.body.image||e.body.sticker||(t=Chat.XssText(t));var i="",a="",n="",s="",o=e.time,r=e.body.image||e.body.sticker?"bgf":"",c=this.messageConverToHtml(t).replace(/&amp;middot;/g,"&#183;").replace(/&amp;lt;/g,"&#60;").replace(/&amp;gt;/g,"&#62;"),l="temp-"+(e.tempID?e.tempID:o);if(e.from.uid==Chat.myselfData.uid){if("history"==e.typeSource)switch(a='<i class="status"></i>',e.status){case 0:case 1:i="status-delivery";break;case 2:i="status-read";break;default:i="",a=""}else"newSubmit"==e.typeSource?(n='id="'+l+'"',a='<i class="status"></i>'):e.from.uid==Chat.myselfData.uid&&(i="status-delivery",a='<i class="status"></i>');var d=Chat.messageStatusData[e.to.uid];return d||(d=Chat.messageStatusData[e.to.uid]={}),e.mid?(n='id="temp-'+e.mid+'"',d[e.mid]={}):(Chat.messageStatusDataTemp[e.tempID]=e.to.uid,d[e.tempID]={tempID:e.tempID}),'<li data-type="'+e.style+'" data-time="'+e.time+'" '+n+' class="item-myself item-interview '+i+'"><div class="figure"></div><div class="text '+r+'">'+a+c+"</div></li>"}return e.mid&&(n='id="temp-'+e.mid+'"'),3==e.body.type&&1==e.body.templateId&&e.body.image&&(s="item-image"),12==e.body.type&&1==e.body.templateId&&e.body.hyperLink&&1==e.body.hyperLink.hyperLinkType&&(s="item-file",c=Chat.revertFilenameToIcon(e.body.hyperLink.text)+'<p data-origin="'+e.body.hyperLink.url+'"><b>'+e.body.hyperLink.text+"</b>"+e.body.text+"</p>"),("您收到一条来自该牛人的消息"===c||"您收到了来自该牛人的消息"===c||e.encryptedBody)&&(c+='<a href="javascript:;" class="msg-item-unlock">点击解锁</a><i class="icon-msg-lock"></i>'),"<li "+n+' class="item-friend '+s+'"><div class="figure"><img src="'+(Chat.curUserData.avatar||e.from.avatar)+'" alt="" /></div><div class="text '+r+'">'+c+"</div></li>"},showHyperLinkMessage:function(e){if(!e.body.hyperLink.extraJson)return"";var t=e.mid||e.time,i=JSON.parse(e.body.hyperLink.extraJson||"{}"),a=e.body.hyperLink.text,n=i.highlightStart,s=i.highlightLength;return"smsNotice"!==getQueryParams(e.body.hyperLink.url).type?"":'<li class="item-system" id="temp-'+t+'"><div class="text">'+a.substr(0,n)+'<a href="javascript:;" class="message-note-entry">'+a.substr(n,s)+"</a>"+a.substr(n+s)+"</div></li>"},showGreetQusMessage:function(e){if(e.body.text){return'<li class="item-question" id="temp-'+(e.mid||e.time)+'"><div class="text"><p class="gray">您的新招呼问题</p>'+Chat.XssText(e.body.articles[0].subTitle)+"</div></li>"}},showGeekInviteInterviewMessage:function(e){var t=e.body.articles.length?e.body.articles[0]:{};return'<li class="item-article" id="temp-2"><div class="text"><div class="content"><img class="icon" alt="" src="'+t.picUrl+'"/><div class="title">'+t.title+'</div><div class="sub-title">'+t.subTitle+'</div></div><div class="footer"><a href="javascript:;" class="item-article-btn" data-url="'+t.url+'">'+t.bottomText+"</a></div></div></li>"},showSystemMessage:function(e){if(e.body.text){return'<li class="item-system" id="temp-'+(e.mid||e.time)+'"><div class="text">'+e.body.text+"</div></li>"}},showPicUploadingMessage:function(e){var t='<li data-type="image" data-time="'+Date.now()+'" id="'+e.id+'" class="item-myself"><div class="figure"></div><div class="text bgf"><i class="status"></i><img src="'+e.src+'" class="img-tiny" style="max-width: 200px;"/></div></li>';$(t).appendTo(Chat.chatListCon),Chat.scrollToBottom()},getRemarksAndTagType:function(e){var t=/&ba=([^&]+)/,i=decodeURIComponent(e.body.hyperLink.url);return(i.match(t)?JSON.parse(i.match(t)[1]):"").p2},joinSystemMessage:function(e,t){var i="",a=e.body.hyperLink.text.split(" ");a.length;a.pop();var n=a.join(" ");1===t?i="更新标签："+n:2===t?i="更新备注："+n:3===t&&(i="备注信息仅您自己可见"),e.body.text=i},showDialogMessage:function(e){var t,i,a="",n="",s="";switch(e.body.dialog.type){case 0:a="item-phone",n="icon-contact";break;case 1:a="item-weixin",n="icon-weixin";break;case 2:a="item-resume",n="icon-resume";break;case 11:a="item-phone",n="icon-contact"}Chat.setLatestDialog(e),e.body.dialog.operated&&(s="disabled"),t=$('<li class="item-friend '+a+'"><div class="figure"><img src="'+e.from.avatar+'" alt="" /></div><div class="text"><i class="'+n+'"></i>'+this.messageConverToHtml(e.body.dialog.text)+'<i class="icon-arow-right"></i><span class="op"><a href="javascript:;" class="link-agree '+s+'">同意</a><a href="javascript:;" class="link-refuse '+s+'">拒绝</a></span></div></li>'),e.body.dialog.operated||e.from.uid!=Chat.curUserData.uid||(i=$('<div class="notice-dialog" data-mid="'+e.mid+'" data-type="'+e.body.dialog.type+'"><div class="op"><span class="btn btn-refuse">拒绝</span><span class="btn btn-agree '+s+'">同意</span></div><div class="text">'+this.messageConverToHtml(e.body.dialog.text)+"</div></div>"),Chat.checkDialogMessage(e)&&(Chat.chatBox.find('.notice-dialog[data-type="'+e.body.dialog.type+'"]').remove(),i.appendTo(Chat.chatBox)));var o=function(n){var n=n;return!n.hasClass("disabled")&&(Chat.checkUserBlock()?GeekHotProp.shop(Chat.curUserData.infoData.page,{callBack:Chat.ublockBlockGeek}):(t.find(".link-agree,.link-refuse").addClass("disabled"),i.find(".btn-agree,.btn-refuse").addClass("disabled"),"item-phone"==a&&(n.hasClass("link-agree")||n.hasClass("btn-agree")?Chat.exchangePhone(1,e,i,t):Chat.exchangePhone(0,e,i,t)),"item-weixin"==a&&(n.hasClass("link-agree")||n.hasClass("btn-agree")?Chat.exchangeWeixin(1,e,i,t):Chat.exchangeWeixin(0,e,i,t)),void("item-resume"==a&&(n.hasClass("link-agree")||n.hasClass("btn-agree")?Chat.exchangeResume(1,e,i,t):Chat.exchangeResume(0,e,i,t)))))};return t.on("click",".link-agree,.link-refuse",function(e){o($(this))}),i&&(i.on("click",".btn",function(e){o($(this))}),i.on("click",".close",function(){i.remove()})),t},showMapDialogMessage:function(e){var t=e.body.dialog,i=JSON.parse(t.text),a=e.from.uid===Chat.myselfData.uid?" item-myself ":" item-friend ";return'<li data-type="map" data-time="'+Date.now()+'" id="temp-'+(e.mid||e.time)+'" class="'+a+'"><div class="figure"></div><div class="text bgf"><div class="chat-map-box"><img height="121" src="https://restapi.amap.com/v3/staticmap?size=243*121&amp;markers=small,0xFF0000,A:'+i.longitude+","+i.latitude+'&amp;key=21b56a6cc83fad7668dbb0e9564759a7" alt="公司地址"><div class="address">'+i.locationDesc+'</div><div class="map-tips">'+t.title+"</div></div></div></li>"},setLatestDialog:function(e){var t=e.body.dialog.type,i=e.body.dialog.operated,a=e.mid;i||Chat.curUserData&&(Chat.curUserData.latestDialogs||(Chat.curUserData.latestDialogs={}),Chat.curUserData.latestDialogs[t]||(Chat.curUserData.latestDialogs[t]={}),!i&&Chat.curUserData.latestDialogs[t].mid&&a<Chat.curUserData.latestDialogs[t].mid||(Chat.curUserData.latestDialogs[t].mid=a,Chat.curUserData.latestDialogs[t].operated=i))},checkDialogMessage:function(e){var t=e.body.dialog.type,i=e.body.dialog.operated,a=e.mid;return!(!i&&Chat.curUserData.latestDialogs&&Chat.curUserData.latestDialogs[t]&&Chat.curUserData.latestDialogs[t].mid&&a<Chat.curUserData.latestDialogs[t].mid)},showHistoryData:function(e){var e=e;if(Chat.chatHistoryData[e]){var t,i=Chat.chatHistoryData[e].chatList,a='<li class="item-time item-history-line"><span class="time">点此查看历史消息</span></li>';if(i.length>0){for(t=0;t<i.length;t++)a+=i[t];return $(a).appendTo(Chat.chatListCon),Chat.sendReadMessage({userData:Chat.curUserData,uid:e,mid:0}),Chat.scrollToBottom(),!0}}},setHistoryData:function(e,t){var i;e.typeSource,e.from.uid==Chat.myselfData.uid?i=e.to.uid:e.to.uid==Chat.myselfData.uid&&(i=e.from.uid),Chat.chatHistoryData[i]||(Chat.chatHistoryData[i]={chatList:[]});var a=Chat.chatHistoryData[i].chatList;a.length>10&&Chat.chatHistoryData[i].chatList.shift(),Chat.chatHistoryData[i].chatList.push(t)},setDialogMessageDomStatus:function(e,t){e&&Chat.chatListCon.find("#temp-"+e).find(".btn").addClass("disabled").unbind("click")},messageConverToHtml:function(e){if(!e)return"";var t=Emotion.textCodeToImg(e);if(/^<img src="/.test(t));else{var i=/^(?!(http|https)).*/.test(t)?"http://":"";t=t.replace(/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/g,"<a href='"+i+"$1' target='_blank'>$1</a>")}return e?t.replace(/\n/g,"<br/>").replace(/\\n/g,"<br/>"):""},setTextMessageDomStatus:function(e,t,i,a){if(Chat.curUserData.uid==e){var n,s=Chat.messageStatusData[Chat.curUserData.gid];if(s)if(t&&i&&(s[t]=s[i],n=Chat.chatListCon.find("#temp-"+s[i].tempID),delete s[i],delete Chat.messageStatusDataTemp[i]),t&&!i&&(n=Chat.chatListCon.find("#temp-"+t)),"read"==a)Chat.chatListCon.find(".status-delivery").removeClass("status-delivery").addClass("status-read");else if(a){var o=s[t||i];if(!o)return;n.attr("class",n.attr("class").replace(/status\-/g,"")).addClass("status-"+a),t&&n.attr("id","temp-"+t),"error"==a&&(delete s[o.tempID],delete s[t])}}},sendReadMessage:function(e){e.mid&&e.uid!=Chat.myselfData.uid&&ChatWebsocket.sendReadMessage({uid:e.userData.gid,mid:e.mid,userSource:e.userData.friendSource,callback:function(t){e.curUserData.maxMessageId=null}})},getOutputData:function(){return Chat.outputData},sendTextMessage:function(e){e.noWebsocket;if(PageSet.hasShowReplyTip||Chat.curUserData.groupId||5!=Chat.curUserData.infoData.relationType||Chat.chatListCon.find(".item-myself").length||Chat.curUserData.isFiltered||(Chat.workflowTip(null,1),PageSet.hasShowReplyTip=!0),Chat.checkUserBlock())return GeekHotProp.shop(Chat.curUserData.infoData.page,{callBack:Chat.ublockBlockGeek});Chat.curUserData.lastMsgInfo=Chat.curUserData.lastMsgInfo||{},Chat.curUserData.lastMsgInfo.fromId=_PAGE.uid,Chat.curUserData.groupId&&Chat.addGroupMessage(e),ImSocket.send(e),Chat.deleteDraft(Chat.curUserData.uid)},setUnReadMessage:function(e){Chat.unReadMessage[e.mid]||(Chat.unReadMessage[e.mid]=e)},checkUnreadMessage:function(){var e,t=Chat.unReadMessage;for(var i in t)e=t[i].from.uid,8==Chat.usersData[e].relationType&&Chat.setUnReadMessageCount(-1,Chat.usersData[e])},doTopCommonOp:function(t){var i=t.parent();switch(!0){case i.hasClass("op-interview"):Publisher.interview(t,"dialog-down-default interview-message-dialog");break;case i.hasClass("op-record"):!0===_PAGE.isInnerAccount?mediator.publish("REMARK_LIST_DIALOG",{geek:Chat.curUserData.uid}):!1===_PAGE.isInnerAccount?mediator.publish("COMMUNICATION_RECORD",{geek:Chat.curUserData.encryptUid}):$.ajax({url:"/wapi/zpboss/h5/inner/remark/isInnerAccount",type:"get",dataType:"json",success:function(e){0==e.code&&e.zpData?e.zpData.innerAccount?(_PAGE.isInnerAccount=!0,mediator.publish("REMARK_LIST_DIALOG",{geek:Chat.curUserData.uid})):(_PAGE.isInnerAccount=!1,mediator.publish("COMMUNICATION_RECORD",{geek:Chat.curUserData.encryptUid})):mediator.publish("COMMUNICATION_RECORD",{geek:Chat.curUserData.encryptUid})},error:function(){mediator.publish("COMMUNICATION_RECORD",{geek:Chat.curUserData.encryptUid})}});break;case i.hasClass("op-star"):Chat.setStar(i);break;case i.hasClass("op-settop"):Chat.setTop(i);break;case i.hasClass("op-forward"):mediator.publish("FORWARD_GEEK",{type:"forward_geek",geekList:[{encryptGeekId:Chat.curUserData.encryptUid,expectId:Chat.curUserData.infoData.expectId||0,jobId:Chat.curUserData.jobId}]});break;case i.hasClass("op-call"):$.ajax({type:"POST",url:"/wapi/zpboss/h5/inner/notice/phone/outCall",data:{geekId:Chat.curUserData.uid}}).success(function(e){$.toast({type:0===e.code?"info":"warning",content:e.message})}).error(function(){this.$toast("服务器异常","error")});break;case i.hasClass("op-sms"):
var a='<form action="/wapi/zpboss/h5/inner/notice/sms/sendSms"><div class="sub-title">输入短信内容(将同时发送站内信息)</div><div class="defined-form"><textarea type="text" name="content" class="ipt" data-range="1,40"></textarea><span class="count-num"></span></div><input type="hidden" name="geekId" value="'+Chat.curUserData.uid+'" /></form>';$.dialog({title:"",content:a,closeText:!0,confirmText:"确定",cancelText:!1,preKa:"",wrapClass:"dialog-prop-default dialog-send-sms",lock:!0,opacityLock:!0,onOpen:function(e){$.ajax({type:"GET",url:"/wapi/zpboss/h5/inner/notice/sms/getSmsMsg",data:{geekId:Chat.curUserData.uid}}).success(function(t){0===t.code?e.find("textarea[name=content]").val(t.zpData&&t.zpData.content||"你好，我对你的简历非常感兴趣。不知可否深入聊聊？"):(e.find(".dialog-con").html('<div class="tip-text">该牛人尚未开启接收短信通知</div>'),e.find(".btn-sure").off().on("click",function(){return e.remove(),!1}))}),e.find("textarea").on("input",function(){Chat.countAreaLength($(this))})},onConfirm:function(t){var i=t.find("textarea").val().length;return 0===i?($.toast({content:"不能为空",type:"error"}),!1):i>40?($.toast({content:"最多不能超出40字",type:"error"}),!1):($.ajax({type:"POST",url:"/wapi/zpboss/h5/inner/notice/sms/sendSms",dataType:"JSON",data:t.find("form").serialize(),success:function(e){0===e.code?($.toast({content:"发送成功",type:"success"}),t.remove()):$.toast({content:e.message,type:"error"})},error:function(){$.toast({content:"发送失败",type:"error"})}}),void e.preventDefault())}})}},exchangeWeixin:function(e,t,i){var a={tempID:_PAGE.uid+(new Date).getTime(),isSelf:!0,from:t.from,to:{},time:(new Date).getTime(),body:{type:99,text:""},mSource:"server",typeSource:"newSubmit",type:1},n="",s={},o="";switch(e){case 1:var r=t.body.dialog.buttons[0].url.match(/%3C(.+)%3E/);r&&(o=r[1]),n="/chat/acceptWeixin.json",s={to:t.from.uid,mid:t.mid,aid:33,action:0,extend:o};break;case 0:n="/chat/rejectWeixin.json",s={to:t.from.uid,mid:t.mid,aid:34,action:1};break;case 2:n="/chat/requestWeixin.json",s={to:t.from.uid}}$.ajax({url:n,data:s,dataType:"JSON",cache:!1,timeout:3e4,success:function(n){2==e&&1==n.result?(Chat.mids[n.mid]="RequestWeixin",Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:"请求交换微信已发送"}}),a.body.text="请求交换微信已发送"):2==n.result?Chat.showSetWeixin(function(){Chat.exchangeWeixin(e,t,i)}):(Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:n.msg}}),a.body.text=n.msg||"",i&&i.remove(),1==e&&1==n.result&&Chat.opTopEls.find(".dropdown-weixin").css("display","inline-block")),ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(a)})},error:function(e){Chat.showMessage({time:(new Date).getTime(),from:t.from,to:t.to,body:{type:99,text:"系统错误!"}}),a.body.text="系统错误",ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(a)})}})},exchangePhone:function(e,t,i){var a={tempID:_PAGE.uid+(new Date).getTime(),isSelf:!0,from:t.from,to:{},time:(new Date).getTime(),body:{type:99,text:""},mSource:"server",typeSource:"newSubmit",type:1},n="",s={};switch(e){case 1:n="/chat/acceptContact.json",s={to:t.from.uid,mid:t.mid,aid:28,action:0};break;case 0:n="/chat/rejectContact.json",s={to:t.from.uid,mid:t.mid,aid:29,action:1};break;case 2:n="/chat/requestContact.json",s={to:t.from.uid}}$.ajax({url:n,data:s,dataType:"JSON",cache:!1,timeout:3e4,success:function(n){2==e&&1==n.result?(Chat.mids[n.mid]="RequestPhone",Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:"请求交换联系方式已发送"}}),a.body.text="请求交换联系方式已发送",i&&i.remove()):1!=n.result?(Chat.showMessage({time:(new Date).getTime(),from:t.from,to:t.to,body:{type:99,text:n.msg}}),a.body.text=n.msg||"",i&&i.remove()):(i&&i.remove(),1==e&&1==n.result&&Chat.opTopEls.find(".dropdown-phone").css("display","inline-block")),ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(a)})},error:function(e){Chat.showMessage({time:(new Date).getTime(),from:t.from,to:t.to,body:{type:99,text:"系统错误!"}}),a.body.text="系统错误!",ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(a)})}})},exchangeResume:function(e,t,i,a){var n={tempID:_PAGE.uid+(new Date).getTime(),isSelf:!0,from:t.from,to:{},time:(new Date).getTime(),body:{type:99,text:""},mSource:"server",typeSource:"newSubmit",type:1},s="",o={},r="",a=a;switch(e){case 1:var c=t.body.dialog.buttons[0].url.match(/%3C(.+)%3E/);c&&(r=c[1]),s="/chat/acceptResume.json",o={to:t.from.uid,mid:t.mid,aid:41,action:0,extend:r};break;case 0:s="/chat/rejectResume.json",o={to:t.from.uid,mid:t.mid,aid:42,action:1};break;case 2:s="/chat/requestResume.json",o={to:t.from.uid}}$.ajax({url:s,data:o,dataType:"JSON",cache:!1,timeout:3e4,success:function(s){2==e&&1==s.result?(Chat.mids[s.mid]="RequestResume",Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:"简历请求已发送。如果牛人同意，TA的简历将发送到 {"+Chat.myselfData.email+"}"}}),n.body.text="简历请求已发送。如果牛人同意，TA的简历将发送到 {"+Chat.myselfData.email+"}",s.email&&(_PAGE.email=s.email,Chat.myselfData&&(Chat.myselfData.email=s.email))):2==s.result?Chat.showSetEmail(function(){Chat.exchangeResume(2,{from:{uid:Chat.curUserData.uid}})}):1==s.result?(a&&a.removeClass("item-resume"),Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:s.msg}}),n.body.text=s.msg,i&&i.remove()):(Chat.showMessage({time:(new Date).getTime(),from:t.from,body:{type:99,text:s.msg}}),n.body.text=s.msg||""),n.body.text&&ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(n)})},error:function(e){Chat.showMessage({time:(new Date).getTime(),from:t.from,to:t.to,body:{type:99,text:"系统错误!"}}),n.body.text="系统错误!",ImSocket.sendFromMy({type:"send",message:Chat.protobufMessage.createMessage.text(n)})}})},showSetWeixin:function(e){$.dialog({title:"输入微信",content:'<form action="/user/updateWeixin.json"><div class="form-row through-row"><input type="text" name="weixin" placeholder="输入您的微信" class="ipt" /></div><div class="tip-text">对方同意后，可以看到彼此的微信号，您也可以在个人信息中修改。</div></form>',closeText:!1,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-chat-default",lock:!0,opacityLock:!0,onOpen:function(t){t.find("form").on("submit",function(i){Chat.saveSetWeixin($(this),t,e),i.preventDefault()})},onConfirm:function(t){Chat.saveSetWeixin(t.find("form"),t,e)},onClose:function(e){}})},saveSetWeixin:function(e,t,i){var e=e,a=e.find(".ipt"),n=e.attr("action");return""==a.val().replace(/(^\s*)|(\s*$)/g,"")?($.toast({content:"请填写微信号",type:"warning"}),a.focus(),!1):/^[a-zA-Z\d_\-]{5,50}$/.test(a.val())?($.ajax({type:"POST",url:n,dataType:"JSON",data:e.serialize(),success:function(e){var e=e;1==e.rescode?i&&i():$.toast({content:"保存失败",type:"error"})},error:function(e){$.toast({content:"保存失败",type:"error"})}}),void t.remove()):($.toast({content:"请填写正确的微信号",type:"warning"}),a.focus(),!1)},showSetEmail:function(e){$.dialog({title:"输入您用于接收简历的邮箱",content:'<form action="/bossweb/saveresumeemail.json"><div class="form-row through-row"><input type="text" name="email" placeholder="例：aaron@zhipin.com" class="ipt" /></div><div class="tip-text">牛人发送的简历将发送到该邮箱，您可以在 App 的个人资料中修改，建议使用您的企业邮箱</div></form>',closeText:!1,confirmText:"确定",cancelText:"取消",preKa:"",wrapClass:"dialog-chat-default",lock:!0,opacityLock:!0,onOpen:function(t){t.find("form").on("submit",function(i){Chat.saveSetEmail($(this),t,e),i.preventDefault()})},onConfirm:function(t){Chat.saveSetEmail(t.find("form"),t,e)},onClose:function(e){}})},saveSetEmail:function(e,t,i){var e=e,a=e.find(".ipt"),n=e.attr("action");return""==a.val().replace(/(^\s*)|(\s*$)/g,"")?($.toast({content:"请填写邮箱",type:"warning"}),a.focus(),!1):/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/.test(a.val())?($.ajax({type:"POST",url:n,dataType:"JSON",data:e.serialize(),success:function(e){var e=e;1==e.rescode?i&&i():$.toast({content:"保存失败",type:"error"})},error:function(e){$.toast({content:"保存失败",type:"error"})}}),void t.remove()):($.toast({content:"请填写正确的邮箱",type:"warning"}),a.focus(),!1)},sendPositionMap:function(e,t){$.ajax({type:"POST",url:"/wapi/zpchat/message/sendJobLocation",data:{jobId:t,toUserId:e},dataType:"json",success:function(e){0===e.code||$.toast({type:"error",content:e.message||"服务器异常"})},error:function(e){$.toast({type:"error",content:"服务器异常"})}})},viewLargeImage:function(e,t){var e=e,i=e.attr("data-large")||e.attr("src"),a=e.attr("large-y"),n=t.hasPrev?'<div class="img-viewer-prev-btn"></div>':'<div class="img-viewer-prev-btn hide"></div>',s=t.hasNext?'<div class="img-viewer-next-btn"></div>':'<div class="img-viewer-next-btn hide"></div>',o=new Image;o.src=i,e.parent().append('<div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div>'),o.onload=function(){e.parent().find(".pre-loading").remove(),$.dialog({title:"",content:n+'<div class="img-viewer"><img src="'+i+'" /></div>'+s,closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-layer-full",lock:!0,onOpen:function(e){e.find(".dialog-con").on("click",".img-viewer-prev-btn",function(){"function"==typeof t.prevCallback&&t.prevCallback(e)}),e.find(".dialog-con").on("click",".img-viewer-next-btn",function(){"function"==typeof t.nextCallback&&t.nextCallback(e)}),e.find(".dialog-con").on("click",function(t){$(t.target).parents(".img-viewer").length||$(t.target).hasClass("img-viewer-prev-btn")||$(t.target).hasClass("img-viewer-next-btn")||e.remove()}),Chat.changeImgViewerCss(e,a)}})}},changeImgViewerCss:function(e,t){window.innerHeight<t?e.find(".img-viewer").css({position:"static",transform:"translate(0, 0)"}):e.find(".img-viewer").css({position:"absolute",transform:"translate(-50%, -50%)"})},viewFullResume:function(e,t,i){var t=t||"/resume/download4web?geekId="+Chat.curUserData.encryptUid,e=e,a={},n=i&&i.hasClass("link-fullscreen");a=n?i.closest(".attachment-view").find("img").clone():$('<img src="'+e+'" />'),$.dialog({title:'<a href="'+t+'" class="link-attachment"><span class="tooltip">下载</span></a><a href="javascript:;" class="close" ka="dialog-close"><i class="icon-close"></i><span class="tooltip">关闭</span></a>',content:'<div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div>',closeText:!1,confirmText:!1,cancelText:!1,wrapClass:"dialog-layer-full dialog-layer-resume",lock:!0,onOpen:function(e){n&&a.height()>0?(e.find(".dialog-con").html('<div class="img-viewer"></div>'),e.find(".img-viewer").append(a),window.innerHeight<a.height()&&e.find(".img-viewer").css({position:"static",transform:"translate(0, 0)"})):Resume.loadAttachment("/wapi/zpgeek/resume/preview4boss/check.json?geekId="+Chat.userList.find(".cur a").attr("data-eid"),e.find(".dialog-con")),e.find(".dialog-con").on("click",function(t){$(t.target).parents(".img-viewer").length||$(t.target).parents(".attachment-detail").length||e.remove()})}})},showOperateHelp:function(e){$.dialog({title:"帮助",content:'<div class="operate-help">\t\t\t\t\t\t<h4>牛人分类－工作流：</h4>\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t<li><span class="name"><i class="icon-category-all"></i>全部</span><p>正在与您沟通所有牛人，与app联系人列表一致</p></li>\t\t\t\t\t\t\t<li><span class="name"><i class="icon-category-newgeek"></i>新牛人</span><p>指主动与您沟通，且您<span class="text-blue">尚未查看</span>的新牛人</p></li>\t\t\t\t\t\t\t<li><span class="name"><i class="icon-category-communication"></i>沟通中</span><p>指主动与您沟通，且您<span class="text-communication">已回复</span>或点击了<span class="text-communication">待沟通</span>的牛人，以及您主动与对方沟通，且<span class="text-communication">对方已回复</span>的牛人</p></li>\t\t\t\t\t\t\t<li><span class="name"><i class="icon-category-pass"></i>合适</span><p>指已经被您点击了<span class="text-green">合适</span>的牛人</p></li>\t\t\t\t\t\t\t<li><span class="name"><i class="icon-category-fail"></i>不合适</span><p>指已经被您点击了<span class="text-red">不合适</span>的牛人</p></li>\t\t\t\t\t\t</ul>\t\t\t\t\t\t<h4>牛人分类－其他：</h4>\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t<li><span class="name">牛人发起</span><p>指由对方主动发起沟通的牛人</p></li>\t\t\t\t\t\t\t<li><span class="name">我发起</span><p>指由您主动发起与对方沟通的牛人</p></li>\t\t\t\t\t\t\t<li><span class="name">同事推荐</span><p>指您的同事通过转发给同事功能推荐给您的牛人</p></li>\t\t\t\t\t\t\t<li><span class="name">有附件简历的</span><p>指您已经获得对方附件简历的牛人</p></li>\t\t\t\t\t\t</ul>\t\t\t\t\t\t<div class="intro">\t\t\t\t\t\t\t<p>需要其他分类方式？</p>\t\t\t\t\t\t\t<p>反馈给产品经理（邮箱：zhanglei@bosszhipin.com）</p>\t\t\t\t\t\t</div>\t\t\t\t\t</div>',closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-chat-default dialog-chat-help",lock:!0,onOpen:function(e){}})},showTimeLine:function(e,t,i){if(4!=e.type&&4!=e.body.type&&!e.uncount){var a,n=new Date(e.time),s=Chat.curUserData.lastMessageTime||e.time;a=(new Date).getTime()-e.time>864e5?"MM-dd hh:mm":"Z hh:mm",s&&(i||Math.abs(n.getTime()-s)>3e5)&&0==Chat.chatListCon.find("#temp-time-"+e.time).length&&(t?$('<li class="item-time" id="temp-time-'+e.time+'"><span class="time">'+this.dateFormat(n,a)+"</span></li>").prependTo(Chat.chatListCon):$('<li class="item-time" id="temp-time-'+e.time+'"><span class="time">'+this.dateFormat(n,a)+"</span></li>").appendTo(Chat.chatListCon)),Chat.curUserData.lastMessageTime=e.time}},dateFormat:function(e,t){var i={Z:"","M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"H+":e.getHours()>12?e.getHours()-12:e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t},scrollToBottom:function(){Chat.chatList.scrollTop(Chat.chatListCon.outerHeight()+119)},verifyTalk:function(e,t){Chat.usersData[t];if(Chat.usersData[t]&&Chat.usersData[t].infoData){var i=Chat.usersData[t].infoData;i.bothTalked||(void 0==i.outCount&&(i.outCount=0),void 0==i.inCount&&(i.inCount=0),"my"==e?i.outCount++:"to"==e&&i.inCount++,i.outCount&&i.inCount&&(i.bothTalked=!0),Chat.setRelationStatus(i),Chat.setFuntionButton(i))}},setFuntionButton:function(e){var t=Chat.ControlsEl;e.bothTalked?(t.find(".btn-resume").removeClass("disabled").find("span").attr("data-text","求简历").text("求简历"),t.find(".btn-contact").removeClass("disabled").find("span").attr("data-text","求手机").text("求手机"),t.find(".btn-weixin").removeClass("disabled").find("span").attr("data-text","求微信").text("求微信"),t.find(".btn-video").removeClass("disabled").find("span").attr("data-text","视频面试").text("视频面试"),t.find(".btn-audio").removeClass("disabled").find("span").attr("data-text","语音通话").text("语音通话"),t.find(".btn-interview").removeClass("disabled").find("span").attr("data-text","约面试").text("约面试")):(t.find(".btn-resume").addClass("disabled").find("span").attr("data-text","求简历：双方回复后可用").text("求简历：双方回复后可用"),t.find(".btn-contact").addClass("disabled").find("span").attr("data-text","交换手机：双方回复后可用").text("交换手机：双方回复后可用"),t.find(".btn-weixin").addClass("disabled").find("span").attr("data-text","交换微信：双方回复后可用").text("交换微信：双方回复后可用"),t.find(".btn-video").addClass("disabled").find("span").attr("data-text","视频面试：双方回复后可用").text("视频面试：双方回复后可用"),t.find(".btn-audio").addClass("disabled").find("span").attr("data-text","语音通话：双方回复后可用").text("语音通话：双方回复后可用"),t.find(".btn-interview").addClass("disabled").find("span").attr("data-text","约面试：双方回复后可用").text("约面试：双方回复后可用"))},subtractPoint:function(e){if(Chat.notification[e.relationType]){!function(e){var t=Chat.notification[5];t.indexOf(e)>-1&&(t.splice(t.indexOf(e),1),Chat.totalNewGeek())}(e.uid),function(t,i){var a=t.indexOf(e.uid);if(a>-1&&(t.splice(a,1),t.length<1)){Chat.containerEl.find(".op-category").find("a[data-status="+i+"]").find(".dot").remove()}}(Chat.notification[e.relationType],e.relationType),e.newGeek}},setGroupPoint:function(e){if(Chat.usersData[e]){var t=Chat.usersData[e],i=t.relationType,a=(t.infoData?t.infoData.newGeek:t.newGeek,Chat.containerEl.find(".op-category").find("a[data-status="+i+"]"));t.newMsgCount&&(8!=i&&5!=i&&function(t,i){t&&t.find(".dot").length<1&&t.append($('<em class="dot"></em>')),i&&i.indexOf(e)<0&&i.push(e)}(a,Chat.notification[i]),5==i&&function(e){var t=Chat.notification[5];t.indexOf(e)<0&&!Chat.usersData[e].isFiltered&&t.push(e),Chat.totalNewGeek()}(e))}},setRelationStatus:function(e){var t=Chat.usersData[e.uid];if(e.friendSource&&(t=Chat.getGeekById(e.uid,e.friendSource)),t){var i=e.relationType?e.relationType:t.relationType,a="",n="";strTips="",curTabIdx=Chat.toggleTypeEl.find(".cur").index(),curTabType="",0==curTabIdx&&(curTabType="chat"),1==curTabIdx&&(curTabType="resume"),2==curTabIdx&&(curTabType="attachment"),(!i||i<5)&&t.infoData&&t.infoData.bothTalked&&(i=5);var s={6:"",7:"",8:'<a href="javascript:;"target-status="8" class="link-fail">不合适<div class="no-good-mask"></div><span class="no-reply-text">回复语设置</span></a>',9:'<a href="javascript:;" target-status="5" class="link-cancel-fail"><i class="iboss-quxiaobuheshi"></i> 取消不合适</a>',10:'<a ka="geek_chat_interview" href="javascript:;" class="btn-interview"><i class="iboss-interview"></i> 约面试<span data-text="约面试">约面试</span></a>'};switch(i){case 5:a=s[10]+s[8]+s[6],n='<span class="status-text">未处理</span>';break;case 8:a=s[10]+s[6]+s[7]+s[9],n='<span class="status-text">不合适</span>';break;case 9:a=s[10]+s[8],n='<span class="status-text">已约面</span>';break;default:a=s[10]+s[8]+s[6],n='<span class="status-text">等待回复</span>'}Chat.sendKaEvent("funcn_load_1_"+parseInt(e.cooperate)-1),2==e.cooperate||_PAGE.isInnerAccount&&1==e.cooperate?Chat.opTopEls.find(".op-record").css("display","inline-block"):void 0===_PAGE.isInnerAccount?$.ajax({url:"/wapi/zpboss/h5/inner/remark/isInnerAccount",type:"get",dataType:"json",success:function(e){0==e.code&&e.zpData?e.zpData.innerAccount?(_PAGE.isInnerAccount=!0,Chat.opTopEls.find(".op-record").css("display","inline-block")):(_PAGE.isInnerAccount=!1,Chat.opTopEls.find(".op-record").css("display","none")):Chat.opTopEls.find(".op-record").css("display","none")},error:function(){Chat.opTopEls.find(".op-record").css("display","none")}}):Chat.opTopEls.find(".op-record").css("display","none"),Chat.ControlsEl.find(".links").html(a),Chat.chatEl.find(".detail-bottom .btns").html(a+'<a href="javascript:;" class="link-chat">回复</a>');var o="";switch(e.toPositionId&&e.toPosition&&(o='<span class="link-job" data-jobid="'+e.toPositionId+'">'+filterXss(e.toPosition)+"</span>"),e.sourceType){case 1:strTips=n+"，"+e.initTime+"由您发起，沟通职位"+o,VersionStatus.isHunter&&(strTips=n+"，"+e.initTime+"由您发起");break;case 2:strTips=n+"，"+e.initTime+"向您发起沟通，沟通职位"+o,VersionStatus.isHunter&&(strTips=n+"，"+e.initTime+"向您发起沟通");break;case 3:e.toPositionId&&e.toPosition&&(o="，沟通职位"+o),strTips=n+"，"+e.initTime+"来自"+e.sourceExtend+o,VersionStatus.isHunter&&(strTips=n+"，"+e.initTime+"来自"+e.sourceExtend);break;case 4:strTips=n+"，"+e.initTime+"向您发起沟通，沟通职位"+o,VersionStatus.isHunter&&(strTips=n+"，"+e.initTime+"向您发起沟通");break;case 5:e.toPositionId&&e.toPosition&&(o="，沟通职位"+o),strTips=n+"，"+e.initTime+"由"+e.sourceExtend+"推荐"+o,VersionStatus.isHunter&&(strTips=n+"，"+e.initTime+"由"+e.sourceExtend+"推荐")}Chat.chatList.find(".chat-info .tip-text").html(strTips),Chat.chatEl.find(".detail-bottom .text").html(strTips),Chat.chatList.find(".chat-info .tip-text .link-job").attr("ka","chat_top_job"),Chat.chatEl.find(".detail-bottom .text .link-job").attr("ka","chat_bottom_job")}},changeUserView:function(e,t){var e=e,t=t||"down",i=!0,a=Chat.userList.find(".cur");if(a.length||(i=!1,a=Chat.userList.find("li").eq(0)),a.length){var n=a.height(),s=a.index(),o=Chat.toggleTypeEl.find(".cur").index();e&&e.hasClass("btn-prev")&&(t="up"),a.parent().hasClass("main-list")&&Chat.userListTop.find("li").length&&(s=a.index()+Chat.userListTop.find("li").length),"up"==t?(a.prev("li").length?(a.prev("li").addClass("cur").find("a").click(),a.removeClass("cur")):a.parent().hasClass("main-list")&&Chat.userListTop.find("li").length&&(a.removeClass("cur"),Chat.userListTop.find("li:last").addClass("cur").find("a").click()),0==o&&a.position().top<n&&setTimeout(function(){Chat.userList.scrollTop(n*s-n)},100),(1==o||2==o)&&a.position().top<n&&setTimeout(function(){Chat.userList.scrollTop(n*s-n)},100)):(a.next("li").length||!i?i?(a.removeClass("cur"),a.next("li").addClass("cur").find("a").click()):a.addClass("cur").find("a").click():a.parent().hasClass("top-list")&&Chat.userListMain.find("li").length&&(a.removeClass("cur"),Chat.userListMain.find("li:first").addClass("cur").find("a").click()),0==o&&a.position().top>Chat.userList.height()-2*n&&setTimeout(function(){Chat.userList.scrollTop(n*s-Chat.userList.height()+2*n)},100),(1==o||2==o)&&a.position().top>Chat.userList.height()-2*n-136&&setTimeout(function(){Chat.userList.scrollTop(n*s-Chat.userList.height()+3*n)},100)),Chat.sendKaEvent("tab-"+Chat.toggleTypeEl.find(".cur").index()+"-"+t)}},showMessageBase:function(e){var t;e.from.uid==Chat.myselfData.uid?e.isSelf=!0:e.isSelf=!1;var i=e.isSelf?e.to:e.from,a=0,n=Chat.getGeekById(i.uid,i.source);if(!n)return Chat.addUser(i.uid,i.encryptUid,e);if(!e.offline&&4!=e.type&&4!=e.body.type&&(Chat.curUserData&&Chat.curUserData.infoData&&!Chat.curUserData.infoData.bothTalked&&(e.isSelf?Chat.verifyTalk("my",e.to.uid):1!=e.body.type&&2!=e.body.type&&3!=e.body.type||Chat.verifyTalk("to",e.from.uid)),"history"!=e.typeSource&&e.isSelf&&!e.uncount)){var s=Chat.getGroupStatus();5==s&&(Chat.groupLastModify[s]=Chat.groupHistory[s])}if(Chat.curUserData.uid&&!e.offline&&(Chat.curUserData.gid==e.from.uid||e.to&&Chat.curUserData.gid==e.to.uid)){if(n=Chat.curUserData,99!=e.body.type&&"history"!=e.typeSource){e.isSelf||Chat.sendReadMessage({userData:n,uid:e.from.uid,mid:e.mid});if(!(4===e.type&&12===e.body.type&&3===e.body.templateId)){var o=Chat.userList.find('a[data-uid="'+Chat.curUserData.gid+'"]').parent();o.length&&o.prependTo(o.closest("ul"))}}t=n.uid}else{if(e.from.uid==Chat.myselfData.uid)var r=e.to;else if(e.to&&e.to.uid==Chat.myselfData.uid)var r=e.from;if(n=Chat.getGeekById(r.uid,r.source),n?(n.lastMsgInfo=n.lastMsgInfo||{},n.lastMsgInfo.toId=e.to.uid,n.lastMsgInfo.fromId=e.from.uid):Chat.addUser(r.uid,r.encryptUid,e),e.isSelf||(a=1),t=r.uid,!e.offline&&!e.received){var o=Chat.userList.find('a[data-uid="'+t+'"]').parent();o.length?o.prependTo(o.closest("ul")):Chat.usersData[t]&&Chat.addUser(t,Chat.usersData[t].encryptUid)}}if(function(){return!(4==e.body.type&&1==e.body.templateId&&!e.pushText)&&(!(!e.pushText&&!e.body.text)&&!(e.body&&[4,8,9].indexOf(e.body.type)>-1))}()&&a&&"history"!=e.typeSource&&4!=e.type&&!e.uncount){var c=Chat.getGeekById(n.uid,n.source),l=e.body,d=3==e.type&&1==l.type&&3==l.templateId;(!e.offline||!n.maxMessageId||e.offline&&n.maxMessageId&&e.mid>n.maxMessageId)&&(e.offline&&Chat.curUserData.uid==n.uid||c&&8!=c.relationType&&(c.newMsgCount||d?d||c.newMsgCount++:c.newMsgCount=1,d||1400400==e.from.uid||Chat.setUnReadMessageCount(1,c),Chat.setUnReadMessage(e),Chat.showMessageCountInfo(c)))}e.isSelf||n.maxMessageId&&!(n.maxMessageId<e.mid)||(n.maxMessageId=e.mid);var u=3==e.type&&14==e.body.type&&"history"!=e.typeSource,p=3==e.type&&13==e.body.type,h=12==e.body.type&&e.body.hyperLink&&1==e.body.hyperLink.hyperLinkType&&"history"!=e.typeSource,f=3==e.type&&7==e.body.type&&e.body.dialog&&17==e.body.dialog.type;u&&(e.body.text=e.pushText.replace(e.from.name,"").replace("给你",""));var m=filterXss(e.body.text);if(!e.body.text&&e.encryptedBody&&(m=e.pushText||"您收到一条来自该牛人的消息"),3===e.body.type&&e.body.image&&(m="[图片]"),m||16!=e.body.type||(m=e.pushText),p?_PAGE.canInterviewOnline?1==e.body.video.videoType?m="[语音通话]":2==e.body.video.videoType&&(m="[视频通话]"):m="对方发起了语音通话，请在新版App中查看":2!=e.body.type||e.body.text||(m="收到语音消息，请登录APP端查收"),f&&(m="您是否接受此工作地点？"),(m&&"history"!=e.typeSource&&4!=e.type||u||h)&&e.time>=n.lastTS){var g=(new Date(e.time),Chat.userList.find('a[data-uid="'+n.uid+'"]'));g.find(".time").text(Chat.getLastTime(e.time));var v="",b=n;b.lastMsgInfo||(b.lastMsgInfo={}),!e.isSelf||u||p||!m||f?(b.lastMsgInfo.status=0,b.lastMsgInfo.showText=m||""):(v='<span class="status status-delivery">[送达]</span>',b.lastMsgInfo.status=1,b.lastMsgInfo.showText=m),g.find(".gray").html(v+filterXss(m.substring(0,40))),e.time>=n.lastTS&&(n.lastTime=Chat.getLastTime(e.time),n.lastTS=e.time),n.lastMsg=m}return PAGE_ACTIVITY&&(!PAGE_ACTIVITY||$(".side-menu .menu-chat").hasClass("cur"))||e.offline||e.from.uid==Chat.myselfData.uid||e.from.uid==Chat.curUserData.uid||e.to.uid!=Chat.myselfData.uid||"history"==e.typeSource||!n||8==n.relationType||e.body.text&&e.body.text.indexOf("对方刚查看了您的主页")<0&&chatNotification.show(e.from.name,e.from.avatar,e),{userData:n,setUnReadMessageCount:Chat.setUnReadMessageCount}},setUnReadMessageCount:function(e,t){if(t&&t.isFiltered)return Chat.filterUnreadCount+=e,void $(".filter-tooltip a").eq(0).text("不符牛人（"+Chat.filterUnreadCount+"）");var i=Chat.usersID.map(function(e){var t=Chat.getGeekById(e.gid,e.friendSource);return t&&1400400!==t.uid?t.newMsgCount||0:0}).reduce(function(e,t){return e+t});Chat.unreadMessageCount=i,i>99?Chat.unreadCountBox.html('<i class="dot-plenty"></i>'):Chat.unreadCountBox.html(i),i&&i>0?Chat.unreadCountBox.css("display","inline-block"):Chat.unreadCountBox.hide(),"undefined"!=typeof DeskNotice&&DeskNotice.messageShow(i),Chat.unreadMessageCount>49&&Publisher.getState(function(){})},onChangeReadMessageCount:function(){},clearMessageCount:function(e,t){t&&(e.newMsgCount-t<0&&(t=e.newMsgCount),e.newMsgCount-=t,Chat.setUnReadMessageCount(-1*t,e),Chat.showMessageCountInfo(e))},showMessageCountInfo:function(e){var t=e.newMsgCount,i=Chat.userList.find('a[data-uid="'+e.uid+'"]');Chat.usersData[e.uid].newMsgCount=t,t?(t=t>999?999:t,Chat.usersData[e.uid]&&(i.find(".notice-badge").length?i.find(".notice-badge").text(t):i.find(".figure").append('<span class="notice-badge">'+t+"</span>")),Chat.setGroupPoint(e.uid)):(i.find(".notice-badge").remove(),Chat.subtractPoint(e))},addUserCount:function(e){Chat.usersData[e.from.uid]&&Chat.userList.find('a[data-uid="'+e.from.uid+'"]').find(".figure").prepend('<span class="notice-badge"></span>')},addMessageId:function(e,t){(!Chat.curUserData||Chat.curUserData&&Chat.curUserData.userId!=e)&&(Chat.usersData[e].mids||(Chat.usersData[e].mids=[]),Chat.usersData[e].mids.push(t))},setMessageMinId:function(e,t){Chat.usersData[e].messageMinId||(Chat.usersData[e].messageMinId=t)},setMessageMaxId:function(e,t){Chat.usersData[e].maxMessageId<t&&(Chat.usersData[e].maxMessageId=t)},getLastTime:function(e){this.lastMessageTime=e;var t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=i-e;return t.getFullYear()!=new Date(e).getFullYear()&&t.getFullYear()-new Date(e).getFullYear()>1?t.getFullYear()-new Date(e).getFullYear()+"年前":a>864e5?Chat.dateFormat(new Date(e),"MM月dd日"):a>0?"昨天":Chat.dateFormat(new Date(e),"hh:mm")},workflowTip:function(e,t,i){var a,e=e,n=e?parseInt(e.attr("target-status"),10):null,t=t||-1,s="",o="",r="",c=1==t,i=i,l=!1,d=!1,u=Chat.curUserData;switch(n){case 6:t=2,r="tochat";break;case 7:t=3,r="pass";break;case 8:t=4,r="fail"}if(s="/setting/notify/tip.json?type="+t,i&&(s+="&reasonType="+i),s+="&geekId="+u.uid,1!=t||n||(r="tochat"),$.ajax({url:s,type:"GET",data:null,dataType:"JSON",timeout:3e4,success:function(i){i.rescode&&3==t&&i.requireContact&&(l=!0),i.rescode&&3==t&&i.requireResume&&(d=!0),i.rescode&&1==i.showGuide&&i.html?$.confirm({content:i.html,title:"提示",closeIcon:!0,confirmButton:"确定",cancelButton:!1,buttonOther:1!=t?'<label class="checkbox"><input type="checkbox" name="noMoreShow" value="1" checked="checked" /><span>不再显示</span></label>':"",columnClass:"pop-default pop-default-workflow pop-default-"+t,onOpen:function(){var e=this,t=e.$body.find('.buttons input[type="checkbox"]'),i=e.$content.find('input[name="noMoreShow"]');1==i.val()?(t.val(1),t.attr("checked","checked")):(t.val(0),t.removeAttr("checked")),t.on("change",function(){$(this).is(":checked")?i.val(1):i.val(0)}),PageSet.bindEvent(e.$content),e.$body.find(".closeIcon").on("click",function(){Chat.sendKaEvent(r+"-close")})},confirm:function(){var i=this,n=i.$content.find("form").serialize();(t=3)&&(n+="&geekId="+u.uid),1!=t&&2!=t&&3!=t&&4!=t||$.ajax({url:"/setting/notify/set.json",type:"POST",data:n,dataType:"JSON",timeout:5e3,success:function(t){var t=t;t.rescode?(o=t.msg,a=t.requireType,t.requireContact&&(l=!0),t.requireResume&&(d=!0),Chat.setWorkflow(u,e,o,a,l,d,c),1==t.nextHtml&&"1"==i.$content.find('form input[name="noMoreShow"]').val()&&($("#guide-wrap").show(),$("#guide-wrap").find(".guide-box").eq(0).show())):$.toast({type:"error",content:t.resmsg||"设置失败"})},error:function(e){}});var s=r;i.$content.find('input[name="sendMsg"]').length&&(s+="-msg"+i.$content.find('input[name="sendMsg"]:checked').val()),i.$content.find('input[name="requireType"]').length&&(s+="-require"+i.$content.find('input[name="requireType"]:checked').val()),i.$content.find('input[name="noMoreShow"]').length&&(s+="-go"+i.$content.find('input[name="noMoreShow"]').val()),Chat.sendKaEvent(s)}}):i.rescode&&!i.showGuide&&(o=i.msg,a=i.requireType,Chat.setWorkflow(u,e,o,a,l,d,c))},error:function(e){}}),e){var p=e.attr("data-reason")?e.attr("data-reason"):"";Chat.sendKaEvent("Geekdeal_"+r+p+"_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+u.uid)}},setWorkflow:function(e,t,i,a,n,s,o,r){var e=e,c=t?parseInt(t.attr("target-status"),10):null;o&&(c=6);var l="/wapi/zprelation/relation/groupset.json",d={geekId:e.encryptUid,relationType:c};t&&t.attr("data-reason")&&(d.reason=t.attr("data-reason")),r&&(r.url&&(l=r.url),r.data&&(d=$.extend(d,r.data))),$.ajax({url:l,type:"POST",data:d,dataType:"JSON",timeout:5e3,success:function(a){var a=a,o=Chat.getGroupStatus(),r="";if(0==a.code&&a.zpData){if(ImFriends.publishSyncData({type:c,uid:e.uid,source:e.friendSource}),Chat.usersData[e.uid].infoData&&(Chat.usersData[e.uid].relationType=c,Chat.usersData[e.uid].infoData.relationType=c,(5!=o||6!=c||t)&&chatUserPresenter.setStatus(e.uid,c)),!t)return;var l=t.index();switch(t.closest(".detail-bottom").length?(Chat.ControlsEl.find(".links a").removeClass("cur"),Chat.ControlsEl.find(".links a").eq(l).addClass("cur")):t.closest(".chat-controls").length&&(Chat.chatEl.find(".detail-bottom .btns .btn,.detail-bottom .btns a").removeClass("cur"),Chat.chatEl.find(".detail-bottom .btns .btn,.detail-bottom .btns a").eq(l).addClass("cur")),t.parent().children().removeClass("cur"),t.addClass("cur"),c){case 5:r="新";break;case 6:r="沟通中";break;case 7:r="合适";break;case 8:r="不合适"}Chat.chatEl.find(".status-text").text(r);var o=Chat.getGroupStatus(),d=t.clone(),u=d.find("span").remove().end().text();if([5,6,7,8].indexOf(o)<0&&8!=c&&$.toast({content:"已置为"+u.replace("置为",""),type:"success"}),Chat.checkUserBlock())return!1;i&&Publisher.sendText(e,i),s&&Chat.exchangeResume(2,{from:{uid:e.uid}}),n&&Chat.exchangePhone(2,{from:{uid:e.uid}})}},error:function(e){}})},getResumedirectList:function(){$.ajax({type:"GET",url:"/chat/resumedirectList.json",dataType:"JSON",data:null,success:function(e){if(e&&1==e.status&&e.data.length>0){var t;for(t=0;t<e.data.length;t++){var i=e.data,a=Chat.userList.find('a[data-uid="'+i[t].geekId+'"]');a.find(".name .badge-resume").length||a.find(".name").append('<em class="badge-resume">直通车</em>'),a.attr("data-recordId",i[t].recordId),Chat.usersData[i[t].geekId]&&!Chat.usersData[i[t].geekId].resumeDirectAdded&&0==i[t].status&&(Chat.usersData[i[t].geekId].newMsgCount=1,Chat.showMessageCountInfo(Chat.usersData[i[t].geekId]),Chat.setUnReadMessageCount(1),Chat.usersData[i[t].geekId].resumeDirectAdded=!0)}}}})},readResumedirect:function(e){var e=e,t=e.attr("data-uid"),i=e.attr("data-recordId");Chat.usersData[t]&&i&&!Chat.usersData[t].resumeDirectMinus&&$.ajax({type:"POST",url:"/chat/readresumedirect.json",dataType:"JSON",data:{id:i},success:function(i){1==i.rescode&&(Chat.usersData[t].resumeDirectMinus||(e.find(".notice-badge").remove(),Chat.clearMessageCount(Chat.usersData[t],1),Chat.usersData[t].resumeDirectMinus=!0))}})},revertFilenameToIcon:function(e){var t=e.replace(/.+\./,"").toLowerCase();return e="",'<i class="icon-file icon-file-'+("jpeg"==t?"jpg":"docx"==t?"doc":"pptx"==t?"ppt":t)+'"></i>'},showFailedMessageTip:function(){
var e=$('<div class="notice-dialog" data-type="fail-message"><div class="op"><span class="btn btn-reload" ka="chat_sendfail_btn_reload_'+_PAGE.uid+'">刷新</span><a href="javascript:;" class="close" ka="chat_sendfail_btn_close_'+_PAGE.uid+'"><i class="icon-close"></i></a></div><div class="text"><i class="icon-fail-message"></i>消息发送失败，请刷新页面 或 重新登录</div></div>');e.find(".btn-reload").on("click",function(){window.location.reload()}),e.find(".close").on("click",function(){e.remove()}),Chat.chatEl.find('.notice-dialog[data-type="fail-message"]').remove(),Chat.chatEl.find(".chat-list ul").after(e),setTimeout(function(){e.fadeOut(function(){e&&e.remove()})},4e3)},getConGroup:function(){var e=Chat.containerChat.find(".op-category .cur"),t={"-1":"aaa",1:"nnn",5:"xxa",6:"xxb",7:"xxc",8:"xxd"},i={1:"dda",2:"ddb",3:"ddc",4:"ddd"};return e.attr("data-status")?t[e.attr("data-status")]:i[e.attr("data-origin")]},getPublicStatis:function(){var e=Chat.getConGroup(),t="0",i="0",a=Chat.toggleTypeEl.find(".cur").index(),n=["chatview","infoview","fileview"];return"全部职位"!=$(".top-chat .dropdown-select").text()&&(t="1"),"筛选"!=Chat.containerChat.find(".sel-filter .dropdown-select").eq(0).text()&&(i="1"),e+="0"+t+i,{context:e,view:n[a]}},getInterviewBtnStatus:function(e){return 1==e?'<a href="javascript:;" class="btn btn-add">添加到我的面试日程</a>':2==e||4==e?'<p class="has-interview">已添加，可在[面试]中查看</p>':3==e?'<a href="javascript:;" class="btn btn-grey">面试已结束</a>':void 0},getInterviewDetail:function(e){var t=this;$.ajax({type:"GET",url:"/bossweb/interview/sharedinterview/detail.json",dataType:"JSON",cache:!1,data:{interviewId:e},success:function(i){if(1==i.rescode){var a=i.detail,n="";n+='<div class = "interview-body">',n+='<div class="interview-userinfo">',n+='<img  class="avator" src="'+a.interviewerAvatar+'" >',n+="<p>"+a.interviewerName+'<br><span class="interview-position">'+a.jobName+"</span</p>",n+="</div>",n+='<p class="interview-time">'+a.appointTime+"</p>",n+='<p class="interview-addr">'+a.address+"</p>",""!=a.addition&&(n+='<p class="interview-remark">'+Chat.XssText(a.addition)+"</p>"),n+='<div class="btn-wrap">',n+=t.getInterviewBtnStatus(a.operateStatus),n+="</div>",n+="</div>",n+="</div>",window.top.$.dialog({title:a.title,content:n,closeText:!0,confirmText:"",cancelText:!1,wrapClass:"item-interview-wrap",lock:!0,onOpen:function(t){t.find(".btn-add").on("click",function(){Chat.addInterview(t,e)})}})}else $.toast({type:"error",content:"加载失败"})},error:function(e){$.toast({type:"error",content:e.resmsg})}})},addInterview:function(e,t){var i=e;$.ajax({type:"POST",url:"/bossweb/interview/accept/sharedinterview.json",dataType:"JSON",data:{interviewId:t},success:function(e){1==e.rescode?i.find(".btn-wrap").html(Chat.getInterviewBtnStatus(2)):$.toast({type:"error",content:e.resmsg})},error:function(e){$.toast({type:"error",content:"添加失败,请稍后再试"})}})},checkIsInner:function(e){var t=$.Deferred();return $.ajax({type:"POST",url:"/wapi/zpboss/h5/inner/remark/isInnerHR",dataType:"JSON",data:null,success:function(t){0==t.code&&t.zpData&&t.zpData.isInnerHR&&(Chat.isInnerHR=!0,"function"==typeof e&&e())},error:function(e){$.toast({type:"error",content:"添加失败,请稍后再试"})}}),t},showBrowserTips:function(){$.dialog({title:"为什么会发送消息失败？",content:'<p class="gray">实时聊天功能是一个频繁进行数据交互的过程，有的网络运营商或者网络管理员在不知情的情况下会限制BOSS直聘的聊天服务。</p><p>您可以通过以下方法尝试解决：</p><p>1、刷新网页重试；</p><p>2、如果使用的是IE浏览器或者是第三方浏览器的“兼容模式”，请切换到极速模式，具体如下：</p><div class="text-small"><p>· <span class="text-blue">360浏览器</span>在浏览器地址栏后边有个“e”的图标，那么可以切换到“闪电”的图标；</p><p>· <span class="text-blue">搜狗浏览器</span>在浏览器地址栏后边有个“e”的图标，那么可以切换到“闪电”的图标，也可以页面空白处点鼠标右键，选择“切换到极速模式”；</p><p>· <span class="text-blue">世界之窗浏览器</span>在页面空白处点击鼠标右键，选择“切换到极速模式”；</p><p>· <span class="text-blue">其他浏览器</span>可以参考以上的方法，也可以下载标准版的谷歌浏览器。</p></div><p>3、通过百度查询您所在地的DNS，或者点击下方链接使用推荐的DNS，并修改本地网络设置的首选DNS和备用DNS；</p><div class="text-small">国内优秀的DNS：<a href="http://zpurl.cn/qv2Rp" target="_blank" class="link-orange">http://zpurl.cn/qv2Rp</a></div><p>4、请联系公司网络管理员或宽带服务商排查是否限制了BOSS直聘的聊天服务，此服务域名为ws.zhipinc.com，请提供给网管排查。</p><p>5、通过点击网页顶部的“帮助与反馈”联系BOSS直聘工作人员。</p>',cancelText:"",confirmText:"知道了",wrapClass:"dialog-browser-tip",onConfirm:function(e){e.remove()}}),Chat.sendTrackEvent("chat_browser_dialog_"+_PAGE.uid+(new Date).getTime())},handleInnerInit:function(){Chat.opTopEls.find(".op-sms").removeClass("hide"),Chat.opTopEls.find(".op-call").removeClass("hide")},sendKaEvent:function(e){try{_T.sendEvent(e)}catch(e){}},sendTrackEvent:function(e){try{_T.sendTracking(e)}catch(e){}},satisfactionNPS:function(){return!1}},ChatWebsocket={init:function(e){this.settings={cid:"",token:"",password:"",receiveUrl:"",receiveStepTime:5e3,onSendMessage:function(e){},onRecevieMessage:function(e){},onlineDebug:!!getQueryString("debug")},this.Messages=[],this.cacheTimestamp=0,ChatWebsocket.failNum=0,ChatWebsocket.reConnectTimer;var t=e||(cookie.get("wt")||cookie.get("t"));t&&(ChatWebsocket.settings.password=t),this.uuid="ws-"+getUuid(16,16),this.client=new Paho.MQTT.Client(_PAGE.ws.server,_PAGE.ws.port,"/chatws",this.uuid),this.client.onConnectionLost=this.onConnectionLost,this.client.onMessageArrived=this.onMessageArrived,this.client.onMessageDelivered=this.onMessageDelivered,this.connection(!0),ChatWebsocket.isKickOut=!1,setTimeout(function(){Chat.sendTrackEvent("connect_init_"+_PAGE.uid+"_"+_PAGE.token)},1e3)},logCss:"font-weight:bold;color:#ff0000;",connection:function(e){this.client.connect({userName:_PAGE.token,password:ChatWebsocket.settings.password,timeout:60,keepAliveInterval:25,cleanSession:!0,onSuccess:this.onConnect,onFailure:this.onFailure,mqttVersion:3,useSSL:!!_PAGE.ws.useSSL});var t=e?"start":"retry";ChatWebsocket.failNum<5&&Chat.sendTrackEvent("connect_"+t+"_"+_PAGE.uid+"_"+(new Date).getTime())},reConnection:function(){this.connection()},changeLine:function(){ChatWebsocket.failNum=0,ChatWebsocket.hasChangedLine=!0,_PAGE.ws.server="39.106.163.102",$.get("/wapi/zppassport/get/wt").success(function(e){0==e.code&&""!==util.get(e,"zpData.wt","")&&ChatWebsocket.init(util.get(e,"zpData.wt",""))}),Chat.sendTrackEvent("connect_changeline_"+_PAGE.uid+"_"+(new Date).getTime())},sendPresence:function(){var e=cookie.get("__a").split("."),t=Chat.protobufMessage.createMessage.presence({type:1,lastMessageId:Chat.receiveMaxId<0?0:Chat.receiveMaxId,clientInfo:{version:"",system:"",systemVersion:"",model:cookie.get("sid")||"",uniqid:e[1]+""+e[0]||"",network:_PAGE.clientIP||"",appid:9018,platform:"web",channel:"-1",ssid:"",bssid:"",longitude:0,latitude:0}});ChatWebsocket.settings.onlineDebug&&(console.log("%cpresence:",ChatWebsocket.logCss),console.log(t)),ChatWebsocket.send(t,1)},onConnect:function(e){ChatWebsocket.settings.onlineDebug&&console.log("%cconnect:",ChatWebsocket.logCss),ChatWebsocket.sendPresence(),Chat.websocketConnected=!0,ChatWebsocket.failNum=0,Chat.sendTrackEvent("connect_success_"+_PAGE.uid+"_"+(new Date).getTime())},onFailure:function(e,t,i){if(ChatWebsocket.settings.onlineDebug&&(console.log("%conFailure:",ChatWebsocket.logCss),console.log(e,t,i)),ChatWebsocket.failNum<5)Chat.sendTrackEvent("connect_fail_"+_PAGE.uid+"_"+e.errorCode+"_"+(new Date).getTime());else if(!ChatWebsocket.hasChangedLine){if(!(UA.indexOf("Firefox")>-1||UA.indexOf("Safari")>-1&&-1==UA.indexOf("Chrome")))return void ChatWebsocket.changeLine();Chat.sendTrackEvent("connect_notchangeline_"+_PAGE.uid+(new Date).getTime())}if(ChatWebsocket.failNum++,"object"==typeof e&&6==e.errorCode){var a=e.errorMessage.match(/^AMQJS0006E Bad Connack return code:(\d).+$/);a&&(3==parseInt(a[1],10)?(ChatWebsocket.reConnectTimer&&clearTimeout(ChatWebsocket.reConnectTimer),ChatWebsocket.reConnectTimer=setTimeout(function(){ChatWebsocket.reConnection()},2e3)):(alert("登录信息失效，请重新登录"),window.location.href=isZpdesk?"/logoutToUrl?toUrl=/user/login.html":"/logout/"))}else ChatWebsocket.reConnectTimer&&clearTimeout(ChatWebsocket.reConnectTimer),ChatWebsocket.reConnectTimer=setTimeout(function(){ChatWebsocket.reConnection()},2e3)},onConnectionLost:function(e){this.onlineDebug&&(console.log("%conConnectionLost(data):"+new Date+" "+(new Date).getTime(),ChatWebsocket.logCss),console.log(e)),ChatWebsocket.failNum<5&&Chat.sendTrackEvent("connect_lost_"+_PAGE.uid+"_"+e.errorCode+"_"+(new Date).getTime()),8==e.errorCode&&!ChatWebsocket.isKickOut&&ChatWebsocket.failNum<10&&ChatWebsocket.reConnection(),0!==e.errorCode&&(console.log("%conConnectionLost(message):",ChatWebsocket.logCss),console.log(e.errorMessage))},onMessageArrived:function(e){try{var t=e.payloadBytes,i=Chat.protobufMessage.decode(t);i=ChatWebsocket.eachParseInt(i),ChatWebsocket.settings.onlineDebug&&(console.log("%conMessageArrived(data):",ChatWebsocket.logCss),console.log(e),console.log("%conMessageArrived(message):",ChatWebsocket.logCss),console.log(i));var a=i.messages.length>1;if(i.messages.map(function(e){return e.presence=a,e}),Chat.usersInitStatus)switch(ImSocket.publish(i),i.type){case 1:ChatWebsocket.receiveMessage(i);break;case 4:ChatWebsocket.receiveIqMessage(i);break;case 5:ChatWebsocket.receiveSyncMessage(i);break;case 6:ChatWebsocket.receiveStatusMessage(i)}else MessageGate.push(i)}catch(e){console.log("%conMessageArrived(try error):",ChatWebsocket.logCss),console.log(e)}},onMessageDelivered:function(e){var t=e.payloadBytes,i=Chat.protobufMessage.decode(t);switch(i=ChatWebsocket.eachParseInt(i),ImSocket.publishDelivered(i),i.type){case 1:for(var e=i.messages,a=0;a<e.length;a++)Chat.setTextMessageDomStatus(Chat.userList.find('a[data-eid="'+e[a].to.name+'"]').attr("data-uid"),e[a].mid,null,"delivery");break;case 6:for(var a=0;a<i.messageRead.length;a++){var n=Chat.usersData[i.messageRead[0].userId];n&&n.maxMessageId==i.messageRead[0].messageId&&(n.maxMessageId=null)}}ChatWebsocket.settings.onlineDebug&&(console.log("%conMessageDelivered(data):",ChatWebsocket.logCss),console.log(e),console.log("%conMessageDelivered(message):",ChatWebsocket.logCss),console.log(i))},send:function(e,t,i){ChatWebsocket.settings.onlineDebug&&(console.log("%csend:",ChatWebsocket.logCss),console.log(e)),this.client.isConnected()?this.client.send("chat",e.toArrayBuffer(),1,!0):1==e.type&&1==e.messages[0].type&&1==e.messages[0].body.type&&(ChatWebsocket.reConnection(),Chat.setTextMessageDomStatus(Chat.curUserData.uid,e.messages[0].cmid,null,"error"),Chat.showFailedMessageTip(),Chat.showBrowserTips(),Chat.sendTrackEvent("send_error_"+_PAGE.uid+"_"+(new Date).getTime()))},eachParseInt:function(e){for(var t in e){var i=e[t];i&&"object"==typeof i&&("boolean"==typeof i.unsigned&&"number"==typeof i.high&&"number"==typeof i.low?(longVal=new dcodeIO.Long(i.low,i.high),e[t]=parseInt(longVal.toString(),10)):this.eachParseInt(i))}return e},sendReadMessage:function(e){ImSocket.sendFromMy({type:"read",message:e});var e=Chat.protobufMessage.createMessage.read(e);ChatWebsocket.send(e,null)},sendIqMessage:function(e){var t=Chat.protobufMessage.createMessage.iq(e);ChatWebsocket.send(t)},receiveTextMessage:function(e){if(e.from&&e.to)if(e.from.uid>1e3){if(2===e.type||5===e.type||6===e.type)return e.body.action&&75==e.body.action.aid?Revocation.sync(e):(Chat.countGroupMessage(e),Chat.canShowStickerMessage&&!e.isSelf&&Chat.Sticker.show()),!0;3==e.type?Chat.showMessageOther(e):1!=e.type&&2!=e.type&&4!=e.type||(e.body.hyperLink&&Chat.showMessageOther(e),e.from.uid!=Chat.myselfData.uid&&e.to.uid!=Chat.myselfData.uid||(Chat.showMessage(e),Chat.canShowStickerMessage&&!e.isSelf&&Chat.Sticker.show()))}else 990===e.from.uid?Counselor.received(e):(3==e.type||1==e.type&&e.body.action&&70==e.body.action.aid&&""!=e.body.extend)&&(797==e.from.uid?Chat.updateMessagePage(e):998!=e.from.uid&&1e3!=e.from.uid||Chat.showMessageOther(e))},uniqueMessage:function(e){return!(this.Messages.indexOf(e.mid)<0)||(this.Messages.length&&e.time-this.cacheTimestamp>5e3&&(this.Messages.splice(0,1),this.cacheTimestamp=e.time),this.Messages.push(e.mid),!1)},receiveMessage:function(e){for(var t=0;t<e.messages.length;t++){var i=e.messages[t],a=util.get(i,"from.uid",0),n=util.get(i,"to.uid",0);if((1400400===a&&n===_PAGE.uid||a===_PAGE.uid&&1400400===n)&&ChatBot.receive(i),i.to.uid<=1e3)return!1;if(this.uniqueMessage(i))return!1;if(3==i.type&&4==i.body.type)if(i.body.action&&10==i.body.action.aid){var s=PAGE_ACTIVITY;alert("您的帐号已经登录过了，请勿重复登录。"),window.location.href=isZpdesk?"/logoutToUrl?toUrl=/user/login.html":s?"/logout/":INTERFACE_URLS.homeUrl,ChatWebsocket.isKickOut=!0}else if(i.body.action&&0==i.body.action.aid)switch(parseInt(i.body.action.extend,10)){case 1011:window.location.href=INTERFACE_URLS.homeUrl;break;case 1012:var o=cookie.get("wt"),r=cookie.get("t");if(r&&o&&r!=o)return void(window.location.href="/logout/");alert("您订购的网页版聊天服务已到期，请重新购买！"),window.location.reload();break;case 1013:alert("抱歉，您的账号因为身份信息绑定新账号被冻结。如需使用，请重新登录后认证。"),window.location.href="/logout/";break;case 1014:alert("抱歉，由于被多人举报，您需要认证身份后才可继续使用，请您打开BOSS直聘APP进行认证。"),window.location.href="/logout/"}else i.body.action&&75==i.body.action.aid&&Revocation.sync(i);Chat.receiveMaxId<i.mid&&(Chat.receiveMaxId=i.mid);var c=!1;for(var l in Chat.mids)l!=Chat.receiveMaxId?l<Chat.receiveMaxId&&delete Chat.mids[l]:c=!0;if(c){var d=Chat.usersData[i.to.uid];d&&Chat.setMessageMinId(i.to.uid,i.mid)}else if(i.mSource="server",ChatWebsocket.receiveTextMessage(i),i.mid&&i.from.uid>1e3){var d=Chat.usersData[i.from.uid];d&&(Chat.addMessageId(i.from.uid,i.mid),Chat.setMessageMinId(i.from.uid,i.mid),Chat.setMessageMaxId(i.from.uid,i.mid))}}},receiveIqMessage:function(e){if(e.iqResponse)switch(e.iqResponse.query){case"/message/suggest":ChatWebsocket.receiveNLPMessage(e)}},receiveNLPMessage:function(e){if(e.iqResponse){var t=e.iqResponse.results;if(t&&t.length&&!Chat.chatBox.find(".notice-dialog").length){var i=0,a=null,n=0;if($.each(t,function(e,t){"msg_id"===t.key&&(i=t.value),"suggestions"===t.key&&(a=JSON.parse(t.value)),"friendId"===t.key&&(n=Number(JSON.parse(t.value)))}),a.length&&n===Chat.curUserData.gid){var s="",o=[];$.each(a,function(e,t){if([3,4,5,7,8].indexOf(t.type)>=0){s+='<span data-mid="'+i+'" data-type="'+t.type+'"'+(t.value?'data-value="'+t.value+'"':"")+'><i class="close"><i class="iboss-close-hollow"></i><i class="iboss-close-solid"></i></i>'+t.label+"</span>",o.push(t.type);try{var a={action:"nlp-remind-active-show",bg:1,uid:_PAGE.uid,p:Chat.curUserData.uid,p2:t.label,p3:t.type};Block.action(a)}catch(e){}return!1}}),o.length&&(Chat.chatBox.find(".nlp-sug-container").remove(),Chat.chatBox.append('<div class="nlp-sug-container" style="display: none">'+s+"</div>"),Chat.chatBox.find(".nlp-sug-container").fadeIn())}}}},receiveStatusMessage:function(e){if(e.messageRead)for(var t=0;t<e.messageRead.length;t++){var i=e.messageRead[t],a=Chat.userList.find('a[data-uid="'+i.userId+'"]');e.messageRead[t].sync?1==a.attr("data-group")?Chat.wipeGroupMessages(i.userId):ChatWebsocket.synchReadMessage(e.messageRead[t].userId,e.messageRead[t].messageId):e.messageRead[t].userId==Chat.curUserData.uid?Chat.setTextMessageDomStatus(e.messageRead[t].userId,e.messageRead[t].messageId,null,"read"):Chat.usersData[e.messageRead[t].userId]&&Chat.usersData[e.messageRead[t].userId].maxMessageId&&(e.messageRead[t].messageId,Chat.usersData[e.messageRead[t].userId].maxMessageId);var n=Chat.userList.find('a[data-uid="'+e.messageRead[t].userId+'"]'),s=Chat.usersData[e.messageRead[t].userId];if(!e.messageRead[t].sync&&_PAGE.uid!=e.messageRead[t].userId){s&&(s.lastMsgInfo||(s.lastMsgInfo={}),["[语音通话]","[视频通话]"].indexOf(s.lastMsgInfo.showText)>-1?s.lastMsgInfo.status=0:s.lastMsgInfo.status=2);var o=util.get(s,"lastMsgInfo.messageId",0);n.length&&(!o||o<=e.messageRead[t].messageId)&&s.lastMsgInfo&&s.lastMsgInfo.fromId===_PAGE.uid&&n.find(".gray .status").removeClass("status-delivery").addClass("status-read").text("[已读]")}}},receiveSyncMessage:function(e){if(e.messageSync)for(var t=0;t<e.messageSync.length;t++){var i=e.messageSync[t],a=util.get(i,"from.uid",0),n=util.get(i,"to.uid",0);(1400400===a&&n===_PAGE.uid||a===_PAGE.uid&&1400400===n||i.clientMid&&i.serverMid)&&ChatBot.receive(i);var s=Chat.chatListCon.find("#temp-"+i.clientMid);s.length&&(s.attr("id","temp-"+i.serverMid),Chat.curUserData.lastMsgId=Math.max(Chat.curUserData.lastMsgId||0,i.serverMid));var o=Chat.messageStatusDataTemp[i.clientMid];o&&(Chat.mids[i.serverMid]="Text")}},synchReadMessage:function(e,t){var i=Chat.usersData[e];if(i){i.mids||(i.mids=[]),i.mids.sort(function(e,t){return e>t});for(var a=0,n=0;n<i.mids.length&&i.mids[n]<=t;n++)a++;i.mids.splice(0,a),Chat.clearMessageCount(i,a)}}},Resume={loadDetail:function(e,t,i){var a=t.find(".resume-content-load"),n=Chat.getGroupStatus();if(e){if(a.data("url")==e&&""!=a.html())return a.html(a.html()),Chat.chatEl.find(".chat-list").css("visibility","visible"),Chat.chatEl.find(".chat-wrap-mask").remove(),void(i||Chat.sendKaEvent("Geekshow_tab_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid));1!=n&&5!=n&&(Chat.resumeContainer.find(".resume-content-latest").html("").hide(),Chat.resumeContainer.find(".resume-content-load").html("")),Chat.xhrs.resume&&Chat.xhrs.resume.abort();var s=function(e,t){var t=$.trim(t)+"";return t.length>0&&(t='<div class="message-info"> <span>'+t+"</span> </div>"),5!=Chat.getGroupStatus()&&(t=""),e.replace("{{__LAST_MESSAGE__}}",t)};a.data("url",null),Chat.xhrs.resume=$.ajax({type:"GET",url:e,dataType:"text",data:null,success:function(n){var o={},r=$(n).find("input[name=blockPageData]"),c=$(n).find("input[name=dialog]");if(n&&(r.length||c.length)){if(""!=r.val()?o=JSON.parse(r.val()):""!=c.val()&&(o=JSON.parse(c.val())),BlockSence.include(o,{success:function(){Resume.loadDetail(e,t,i)}}))return!0;o.title&&Block.confirm({title:o.title,description:o.content,confirmText:"知道了"})}var l=Chat.curUserData.uid,d=Chat.usersData[l],u=s(n,d.lastMsg);a.data("url",e).html(u);var p=a.find(".resume-item.certificate-item");p.height()>60&&(p.addClass("fold"),p.find(".view-more").on("click",function(){p.toggleClass("fold").toggleClass("unfold")})),i||Chat.sendKaEvent("Geekshow_tab_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid);var h=Chat.chatEl.find(".detail-bottom .btns .icon-coop");h.length&&(a.find(".tip-closedata").length?(h.hide(),Chat.ControlsEl.find(".icon-coop").hide()):(h.show(),Chat.ControlsEl.find(".icon-coop").show())),Chat.chatEl.find(".chat-list").css("visibility","visible"),Chat.chatEl.find(".chat-wrap-mask").remove(),t.scrollTop(0)},error:function(){}})}},loadAttachment:function(e,t,i){t.html('<div class="data-tips"><div class="spinner spinner-circle"><div class="loader"></div><span>正在加载简历...</span></div></div>');var a=function(e){return Utemplate('<div class="attachment-detail"><%if (this.isResumeVisible) {%><%if (this.isCanPreview) {%><div class="attachment-view"><div class="attachment-download"><a href="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" target="_blank" ka="attachment-download1" class="link-attachment"><span class="tooltip">下载</span></a><a href="javascript:;" data-origin="" ka="attachment-fullscreen" class="link-fullscreen"><span class="tooltip">全屏</span></a></div><img data-src="/wapi/zpgeek/resume/preview4boss/<%this.geekId%>?d=<%this.d%>" data-download="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" alt=""></div><%} else {%><div class="attachment-blank"><i class="tip-noattachment"></i><b>请下载该简历</b><div class="btns"><a href="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" target="_blank" ka="attachment-download2" class="btn">立即下载</a></div></div><%}%><%} else {%><div class="attachment-blank"><i class="tip-noattachment"></i><b>尚未获得对方完整简历</b><%if (this.isCanRequest) {%><p class="gray">您可以一键请求获取对方完整简历</p><div class="btns"><button type="button" ka="request-resume" class="btn btn-resume">请求附件简历</button></div><%}%></div><%}%></div>',e)};$.ajax({type:"GET",url:e,dataType:"JSON",data:null,success:function(e){if(0==e.code&&e.zpData){t.html(a(e.zpData));var n=t.find(".attachment-view"),s=n.find("img"),o=s.attr("data-src")||s.attr("src"),r=t.find(".link-attachment").attr("href")||s.attr("data-download");Chat.chatEl.find(".chat-list").css("visibility","visible"),Chat.chatEl.find(".chat-wrap-mask").remove(),i||t.hasClass("dialog-con")||Chat.sendKaEvent("Geekshow_tab_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid),t.parent().find(".dialog-title .link-attachment").attr("href",r),t.find(".link-attachment").removeAttr("ka").on("click",function(){Chat.sendKaEvent("Geekshow_download_"+Chat.getPublicStatis().context+"_"+Chat.getPublicStatis().view+"_"+Chat.curUserData.uid)}),t.find(".link-fullscreen").on("click",function(){Chat.viewFullResume($(this).attr("data-origin"),$(this).parent().find(".link-attachment").attr("href"),$(this))}),t.find(".btn-resume").on("click",function(){var e=$(this);e.hasClass("disabled")||$.confirm({content:"向牛人索取简历吗？<p>如果牛人同意，TA的简历将发送到<br/>"+Chat.myselfData.email+"</p>",title:"温馨提示",closeIcon:!0,columnClass:"",onOpen:function(){},confirm:function(){Chat.exchangeResume(2,{from:{uid:Chat.curUserData.uid}}),e.text("已发出请求").addClass("disabled")},error:function(e){}})});var c=function(){if(s.length){var e=new Image;e.src=o,n.append('<div class="data-tips"><div class="spinner spinner-circle"><div class="loader"></div><span>正在加载简历...</span></div></div>'),e.onload=function(){var i=e.height||s.height();s.attr("src",o),n.find(".data-tips").remove(),t.hasClass("dialog-con")&&window.innerHeight<i&&(t.find(".attachment-detail").css({position:"static",transform:"translate(0, 0)",display:"inline-block"}),t.css({textAlign:"center"})),t.scrollTop(0)},e.onerror=function(){t.html('<div class="attachment-detail"><div class="attachment-blank"><b>此附件简历暂时无法预览，您可以</b><div class="btns"><a href="'+r+'" ka="attachment-download2" class="btn">下载附件简历</a></div><p><a href="javascript:;" class="link-refresh">重试预览</a></p></div></div>'),Chat.sendKaEvent("boss_attachment_error_"+o)}}};c(),t.on("click",".link-refresh",function(){c()}),n.hover(function(){n.find(".attachment-download").css({"margin-left":Chat.containerChat.width()/2-10+"px"}).show()},function(){n.find(".attachment-download").hide()})}},error:function(e){}})}},Revocation=function(){var e="",t=[],i=function(e){var t=$("<div>"+e+"</div>");t.find(".status").remove(),t.find(".emoj").each(function(e,t){var i=$(t),a=i.attr("class").split("emoj-")[1];$(this).replaceWith('<img class="emoj-insert" data-key="['+i.attr("title")+']" src="https://static.zhipin.com/library/emotions/2x/Expression_'+a+'@2x.png">')});var i=t.html().split("<br>"),e="";return $.each(i,function(t,i){e+=0==t?i:"<div>"+i+"</div>"}),e},a=function(e){var t=$(e).parents("li"),i=0;if(t.attr("id").split("-").length<2)return!1;i=t.attr("id").split("-")[1],$.toast({type:"loading",content:"正在撤回"}),$.post("/message/withdrawMessage.json",{messageId:i}).success(function(e){1==e.resCode?setTimeout(function(){$("#toast").remove()},200):$.toast({type:"error",content:e.resmsg})})},n=function(e){$.dialog({title:"您可撤回两分钟之内发送的消息。",content:'<p class="gray">（老版本不支持撤回功能）</p>',closeLayer:!1,wrapClass:"revocation-confirm-wrap",onConfirm:function(t){$(t).remove(),e()}}),PageSet.settings("revocation",1)},s=function(){Chat.chatListCon.on("click",".message-edit",function(){var e=$(this).parents("li"),a=e.attr("id").split("-")[1],n=t.find(function(e){return e.id==a});n&&(Publisher.editorInput.html(Publisher.editorInput.html()+i(n.text)),Publisher.submitBtn.removeClass("btn-disabled"),Publisher.setCursorEnd(Publisher.editorInput.get(0)))}),Chat.chatListCon.on("contextmenu",".item-myself .text",function(i){var s=$(this).parents("li"),o=["image","text","sound","sticker"].indexOf(s.attr("data-type"))>-1;if(!s.hasClass("status-error")&&o&&Chat.editorEl.offset().top>=s.offset().top+s.height()){e!=Chat.curUserData.uid&&(t=[]),e=Chat.curUserData.uid;$(i.target).dblclick({revocation:!1}).off("revocation.right").on("revocation.right",function(e,t){1==PageSet.settings("revocation")&&a(t),1!=PageSet.settings("revocation")&&n(function(){a(t),__conversion("dblclick_revocation")})}),i.preventDefault()}})},o=function(e,t,i,a){var n=Chat.userList.find('a[data-uid="'+e+'"]');if(!n.length)return!1;1==n.attr("data-group")&&t>=ChatGroups.get(e).lastMsgId?(n.find(".title .gray").text(a),ChatGroups.get(e).lastMsg=a):1!=n.attr("data-group")&&t>=Chat.usersData[e].lastMsgId&&(n.find(".title .gray").text(a),Chat.usersData[e].lastMsgInfo.status=0,Chat.usersData[e].lastMsg=a,Chat.usersData[e].lastMsgInfo.message=a)};return{sync:function(e){var i=e.body.action,a=JSON.parse(i.extend),n=Chat.chatListCon.find("#temp-"+a.mid),s=e.from.uid==_PAGE.uid,r="",c=parseInt(a.mid,10),l=(s?"你":e.from.name)+"撤回了一条消息",d=s?e.to.uid:e.from.uid;if(o(d,c,0,l),!n.length)return!1;n.length&&n.find("img").length<1&&n.hasClass("item-myself")&&"sound"!=n.attr("data-type")&&(r='<i class="message-edit">重新编辑</i>'),n.length&&(t.push({id:a.mid,text:n.find(".text").html()}),n.attr("class","item-system").html('<div class="text">'+l+r+"</div>"))},init:s}}(),mediator=mediator||new EventManger,ChatGuid=function(){var e=function(){$.dialog({title:"",bind:!0,content:'<div class="chat-guid-panel"><span class="guide-image"></span><div class="text"><p>给牛人添加的标签可以在这里筛选</p><p class="next"><a href="javascript:;">知道了</a> </p></div></div>',confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-down-default chat-guide-second",position:"around",lock:!0,element:$(".sec-operate .sel-filter"),opacityLock:!0,onOpen:function(e){var t=this;$(e).on("click",".next a",function(){t.close()}),PageSet.settings("chat-filter-guide",1)},onClose:function(){}})};return{first:function(){if($(".user-bar-filter").length){$.dialog({title:"",bind:!0,content:'<div class="chat-guid-panel"><span class="guide-image"></span><div class="text"><p>这里可以筛选未读的消息和 对话来源</p><p class="next"><a href="javascript:;">继续</a> </p></div></div>',confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-down-default chat-guide-first",position:"around",lock:!0,element:$(".user-bar-filter"),opacityLock:!0,onOpen:function(e){var t=this;$(e).on("click",".next a",function(){t.close()})},onClose:function(){e()}})}},transpond:function(){$.dialog({title:"",bind:!0,content:'<div class="chat-guid-panel"><span class="guide-image"></span><div class="text"><p>在这里，您可以将牛人转发给站内同事；或扫码转发给微信好友。</p><p class="next"><a href="javascript:;">知道了</a> </p></div></div>',confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-down-default chat-guide-third",position:"around",lock:!0,element:Chat.containerChat.find(".op-forward"),opacityLock:!0,onOpen:function(e){var t=this;$(e).on("click",".next a",function(){t.close()}),PageSet.settings("chat-transpond-guide",1)},onClose:function(){}})},star:function(){$.dialog({title:"",bind:!0,content:'<div class="chat-guid-panel"><span class="guide-image"></span><div class="text"><p>使用星标功能收藏牛人，方便快速查找</p><p class="next"><a href="javascript:;">我知道了 </a> </p></div></div>',confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-down-default chat-geek-star-guide",position:"around",lock:!0,element:Chat.setStarEl,opacityLock:!0,onOpen:function(e){var t=this;$(e).on("click",".next a",function(){t.close()})},onClose:function(){}})},starFilter:function(){$.dialog({title:"",bind:!0,content:'<div class="chat-guid-panel"><span class="guide-image"></span><div class="text"><p>这里可以筛选星标牛人</p><p class="next"><a href="javascript:;">我知道了 </a> </p></div></div>',confirmText:!1,cancelText:!1,preKa:"",wrapClass:"dialog-around-default dialog-down-default chat-star-filter-guide",position:"around",lock:!0,element:Chat.containerEl.find(".group-btns-star"),opacityLock:!0,onOpen:function(e){var t=this;$(e).on("click",".next a",function(){t.close()})},onClose:function(){}})}}}(),ImSocket=function(){var e=new EventManger,t=function(t){e.publish("IM_SOCKET_SERVICE",t)},i=function(t){e.subscribe("IM_SOCKET_SERVICE",t)},a=function(t){e.publish("IM_SOCKET_DELIVEREDSTATUS",t)},n=function(t){e.subscribe("IM_SOCKET_DELIVEREDSTATUS",t)},s=function(t){var i=(new Date).getTime();"read"===t.type&&(t.message=Chat.protobufMessage.createMessage.read(t.message),t.message.messageRead.map(function(e){e.sync=!1})),"send"===t.type&&t.message.messages.map(function(e){return e.time=i,e.status=0,e}),e.publish("SEND_FROM_MY",t)},o=function(e){1===e.type&&Chat.showMessage(e);var t={};t=e.body.sticker?Chat.protobufMessage.createMessage.graphic(e):e.body.image?Chat.protobufMessage.createMessage.image(e):Chat.protobufMessage.createMessage.text(e),console.log("发送消息"),s({type:"send",message:t}),ChatWebsocket.send(t)},r=function(t){e.subscribe("SEND_FROM_MY",t)};return{send:o,read:function(e){ChatWebsocket.sendReadMessage({uid:e.uid,mid:e.mid,userSource:e.userData.friendSource,callback:function(e){opts.curUserData.maxMessageId=null}})},sendFromMy:s,onSend:r,subscribe:i,publish:t,publishDelivered:a,subscribeDelivered:n}}();$(function(){Publisher.init(),Chat.init(),Revocation.init(),seriesLoadScripts("//static.zhipin.com/library/js/lib/f.min.js",function(){var e=function(e){var t=e.map(function(e){return e.value}),i=Fingerprint2.x64hash128(t.join(""),31);cookie.add("__f",i,1,"/",".zhipin.com")};window.requestIdleCallback?requestIdleCallback(function(){Fingerprint2.get(function(t){e(t)})}):setTimeout(function(){Fingerprint2.get(function(t){e(t)})},500)},function(){}),seriesLoadScripts("https://webapi.amap.com/maps?v=1.3&key=60085a6ee91616cf689ce0321e1f30c4&plugin=AMap.Geocoder")});var Safety={init:function(){if($(".safety").length){$(".safety-help").on("click",function(){$(this).parents(".help-box").toggleClass("tips-info-open")});var e=0,t=setInterval(function(){e++,e<50?$.get("/user/loginconfirm/check.json").success(function(e){if(e.rescode)switch(e.status){case-1:clearInterval(t);break;case 1:clearInterval(t),$(".safety-container").eq(0).addClass("hide"),$(".safety-container").eq(1).removeClass("hide"),setTimeout(function(){window.location.href=e.toUrl},2e3);break;case 2:clearInterval(t),setTimeout(function(){window.location.href=e.toUrl},2e3)}}):clearInterval(t)},2e3)}}};$(function(){Safety.init()});var Report={init:function(){Report.uploadCount=0,Report.setContent()},setContent:function(){var e=function(e){e.remove(),Report.uploadCount--};$("body").on("click",".icon-report,.link-report",function(){try{_T.sendEvent("report_geek_"+$(".icon-report").siblings(".icon-coop").attr("data-uid"))}catch(e){}var t=$(this).attr("data-eid")?$(this).attr("data-eid"):$(this).attr("data-uid")||"",i=$(this).attr("data-securityId"),a=$(this).attr("data-expect")||"",n=$(this).attr("data-source");$.get("/user/report/form.json",function(s){s.rescode?$.dialog({content:s.html,title:"举报",inline:!0,cancelButton:"取消",confirmButton:"确认",wrapClass:"pop-report",onOpen:function(t){"FormsUI"in window&&FormsUI.dropSelect(t),"DropDown"in window&&DropDown.init(t),t.find(".verify-box img").on("click",function(){$(this).attr("src","/captcha/?randomKey="+$(this).siblings(".randomkey").val()+"&_r="+(new Date).getTime())}),t.find("#fileupload").on("click",function(e){$(this).next(".verify-box")?Report.checkForm($(".verify-box"))?Report.uploadPictures($(this),t):e.preventDefault():Report.uploadPictures($(this),t)}),t.on("click",".link-close",function(){e($(this).parents("li"))})},onConfirm:function(e){return Report.submitForm(e,t,a,i,n)}}):1011==s.code&&"undefined"!=typeof Detail?Detail.showSign(1011):$.toast({content:s.resmsg,type:"error"})})})},reportHandle:function(e,t){try{_T.sendEvent("report_geek_"+$(".icon-report").siblings(".icon-coop").attr("data-uid"))}catch(e){}e||(e=""),t||(t=""),$.get("/user/report/form.json",function(i){i.rescode?$.dialog({content:i.html,title:"举报",inline:!0,cancelButton:"取消",confirmButton:"确认",wrapClass:"pop-report",onOpen:function(e){"FormsUI"in window&&FormsUI.dropSelect(e),"DropDown"in window&&DropDown.init(e),
e.find(".verify-box img").on("click",function(){$(this).attr("src","/captcha/?randomKey="+$(this).siblings(".randomkey").val()+"&_r="+(new Date).getTime())}),e.find("#fileupload").on("click",function(t){$(this).next(".verify-box")?Report.checkForm($(".verify-box"))?Report.uploadPictures($(this),e):t.preventDefault():Report.uploadPictures($(this),e)}),e.on("click",".link-close",function(){deletePicture($(this).parents("li"))})},onConfirm:function(i){return Report.submitForm(i,e,t)}}):1011==i.code&&"undefined"!=typeof Detail?Detail.showSign(1011):$.toast({content:i.resmsg,type:"error"})})},uploadPictures:function(el,popContent){var url="/faqfeedback/pc/upload/picture.json",typeRule=/(\.|\/)(png|jpg|jpeg)$/i,maxSize=3e6,el=el,previewEl=el.siblings(".preview"),uploadContainer=el.closest(".upload"),vertifyEl=popContent.find(".verify-box .ipt");el.fileupload({method:"POST",url:url,dataType:"text",acceptFileTypes:typeRule,maxChunkSize:maxSize,formData:{token:window.top._PAGE.token?window.top._PAGE.token.split("|")[0]:""},add:function(e,t){var i=t.files[0],a=i.name,n=i.size;return fileInfo=i,typeRule.test(a)?n>maxSize?void $.toast({content:"请上传3M以内的文件",type:"error"}):Report.uploadCount>=6?void popContent.find(".preview").siblings(".text-error").html("最多可以上传6张照片"):(popContent.find(".preview").siblings(".text-error").html(""),uploadContainer.find("a").html('上传图片<i class="icon-toast-loading"></i>'),t.formData={randomKey:popContent.find(".randomkey").val()||"",captcha:popContent.find(".verify-box input").val()||""},void t.submit()):void $.toast({content:"请上传png、jpg、jpeg 格式的文件",type:"error"})},done:function(e,data){var result=data.result;"string"==typeof result&&(result=eval("("+result+")")),1==result.rescode?(Report.uploadCount++,setTimeout(function(){previewEl.find("ul").append('<li><img src="'+result.url[0]+'" data-img="'+result.url[1]+'"/><i class="link-close"></i></li>'),popContent.addClass("upload-complate"),uploadContainer.find("a").html("上传图片")},500),popContent.addClass("upload-complate")):(uploadContainer.find("a").html("上传图片"),$.toast({content:result.resmsg,type:"error"}),"验证码错误"==result.resmsg&&(vertifyEl.val("").focus(),popContent.find(".verify-box img").click()))},fail:function(e,t){uploadContainer.find("a").html("上传图片"),$.toast({content:"上传失败",type:"error"})}})},submitForm:function(e,t,i,a,n){var s=e,o=$.trim(s.find("textarea").val()),r=!1,c=this,l="",d="",u="";if(s.find(".ipt-wrap").each(function(){return r=c.checkForm($(this)),c.checkForm($(this))}),r&&!s.find(".preview img").length)return e.find(".preview").siblings(".text-error").html("请上传照片！"),!1;s.find(".preview img").each(function(){l+=$(this).attr("data-img")+","}),l=l.substring(0,l.length-1),""!=t?(d=t,u=i):"_reportData"in window?(d=_reportData.reportedId,u=_reportData.targetId):(d=Chat.curUserData.uid,u=Chat.curUserData.infoData.expectId);var p={source:n,securityId:a,reportedId:d,reasonCode:$('input[name="reasonCode"]').val(),content:o,targetId:u,imgUrl:l||"",randomKey:s.find(".randomkey").val(),captcha:$(".verify-box input").val()};return r&&(r=!1,$.ajax({url:"/wapi/zprelation/report/save.json",type:"POST",data:p,dataType:"JSON",timeout:3e4,success:function(t){0===t.code?($.toast({content:"发送成功，感谢您的反馈 ：）",type:"success"}),Report.uploadCount=0,e.remove()):($.toast({content:t.resmsg,type:"error"}),"验证码错误"==t.message&&(s.find(".verify-box .ipt").val("").focus(),s.find(".verify-box img").click()))},error:function(e){}})),!1},checkForm:function(e){var t,i=e.find(".ipt").val();if(void 0!=e.find(".ipt").attr("data-range")){if(t=e.find(".ipt").attr("data-range").split(",")[1],i.length>t)return e.next(".text-error").html("请输入"+t+"个字以内的内容"),!1;e.next(".text-error").html("")}if(""==i){var a=e.find(".ipt").attr("data-blank");return e.find(".ipt").focus(),e.next(".text-error").html(a),!1}return e.next(".text-error").html(""),!0}};$(function(){Report.init()});var BossSettings={URL:{greeting:{url:"/boss/update/greeting.json",method:"POST"},greetingPage:{url:"/boss/account/greeting.json",method:"GET"}},count:0,init:function(){this.submitUsal(),this.switchGreetingStatus()},recruitmentSayHello:function(){var e=this;$(this).hasClass("boss-say-hello")&&$.ajax({url:$(".boss-say-hello").attr("data-url"),method:"get",dataType:"json",success:function(t){$(".set-sayhello-box").html(t),e.submitUsal()}})},submitUsal:function(){var e=this;$(".set-sayhello-box .radio-list").on("change",".radio input",function(t){t.preventDefault();var i=$(this).val();$.ajax({url:e.URL.greeting.url,method:e.URL.greeting.method,dataType:"json",data:{status:1,templateId:i},success:function(e){if(1==e.rescode)$.toast({content:"设置成功",lock:!0,type:"success",wrapClass:"",position:"top",time:3e3});else if(0==e.rescode){var t=e.resmsg;$.toast({content:t,lock:!0,type:"error",wrapClass:"",position:"top",time:3e3})}}})})},submitSwitch:function(e,t){if(!t.hasClass("disabled")){t.addClass("disabled");var i=this;$.ajax({url:i.URL.greeting.url,method:i.URL.greeting.method,dataType:"json",data:{status:e},success:function(a){1==a.rescode?(i.showModalToast("设置成功","success"),i.switchSuccessFn(e,t)):0==a.rescode&&i.showModalToast(a.resmsg,"error"),t.removeClass("disabled")},error:function(){t.removeClass("disabled")}})}},switchGreetingStatus:function(){var e=this;$(".set-sayhello-box .setting-switch").on("click",".switch-op .op-switch",function(){var t=$(this);t.hasClass("op-switch-on")?e.submitSwitch(0,t):e.submitSwitch(1,t)})},switchSuccessFn:function(e,t){var i=this,a=t.parents(".switch-op").siblings("p.gray"),n={0:"招呼语已关闭，系统将不再为您发出打招呼语，您可能会收到更少牛人的回复",1:"选择一个招呼语，在您和牛人发起聊天时，系统为您自动发出"};if(0==e){t.removeClass("op-switch-on").addClass("op-switch-off"),t.parents(".setting-switch").siblings().remove(),a.text(n[0]);try{_T.sendEvent("icebreaker_off")}catch(e){}}else i.getGreetingData().then(function(e){$(".set-sayhello-box .sayhello-form").empty().append($(e)),i.submitUsal(),i.switchGreetingStatus();try{_T.sendEvent("icebreaker_on")}catch(e){}})},getGreetingData:function(){var e=$.Deferred(),t=this;return $.ajax({url:t.URL.greetingPage.url,method:t.URL.greetingPage.method,dataType:"json",success:function(i){1==i.rescode?e.resolve(i.html):0==i.rescode&&(e.reject(),t.showModalToast(i.resmsg,"error"))}}),e},showModalToast:function(e,t){$.toast({content:e,lock:!0,type:t,wrapClass:"",position:"top",time:3e3})}},menuInterview=function(){var e={};e.list=function(){var e=$.Deferred();return $.get("/wapi/zprelation/boss/interview/schedule.json",function(t){setTimeout(function(){e.resolve(t.zpData)},500)}),e};var t={wrap:function(){return'<div class="interview-overlays"><div class="data-tips"><div class="spinner spinner-circle"><div class="loader"></div><span>正在加载数据...</span></div></div></div>'},statusDesc:{0:"待接受"},list:function(e){return Utemplate('<p class="subhead">面试安排<%if(0 < this.total){%>（<%this.total%>）<%}%></p><%if(!this.today.length && !this.others.length){%><div class="interview-list-empty"><p class="icon-empty"></p>你目前还没有面试安排</div><%}%><dl><%if (this.today.length){%><dt>今天<span class="gray"><%this.date%></span></dt><%}%><%for(var i=0;i<this.today.length;i++){%><dd data-uid="<%this.today[i].geekId%>"><div class="geek-intro"><p class="figure"><img src="<%this.today[i].avatar%>"><%if(this.today[i].gender == 1){%><i class="icon-gender men"></i><%}%><%if(this.today[i].gender == 0){%><i class="icon-gender women"></i><%}%></p><span class="name"><%this.today[i].geekName%></span><span class="phone"><i class="icon-phone"></i><%this.today[i].phone%></span></div><div class="date-intro"><p><span class="gray">时间：</span><%this.today[i].date%>   <%this.today[i].clock%></p><p><span class="gray">职位：</span><%this.today[i].jobName%></p></div><%if (this.today[i].status == 0){%><div class="status"><%this.today[i].statusDesc%></div><%}%><div class="btn-box"><%if (this.today[i].status == 0 || this.today[i].status == 1 || this.today[i].status == 7){%><a href="javascript:;" class="op-edit" data-uid="<%this.today[i].geekId%>" data-id="<%this.today[i].id%>" data-time="<%this.today[i].appointTime%>" data-time="<%this.today[i].appointTime%>"><i class="iboss-edit"></i><div class="tooltip"><p class="gray">编辑</p></div></a><a href="javascript:;" class="op-cancel" data-uid="<%this.today[i].geekId%>" data-status="<%this.today[i].status%>" data-id="<%this.today[i].id%>"><i class="iboss-close-hollow"></i><div class="tooltip"><p class="gray">取消面试</p></div></a><a href="javascript:;" class="op-forward" data-uid="<%this.today[i].geekId%>" data-id="<%this.today[i].id%>"><i class="iboss-zhuanfa"></i><div class="tooltip"><p class="gray">转发</p></div></a><%}%><%else if (this.today[i].status == 8){%><a href="javascript:;" class="op-absent" data-uid="<%this.today[i].geekId%>" data-id="<%this.today[i].id%>"><i class="iboss-niurenmeilai"></i><div class="tooltip"><p class="gray">牛人没来</p></div></a><%}%></div></dd><%}%><%if(this.others.length){%><dt>以后</dt><%}%><%for(var j=0;j<this.others.length;j++){%><dd data-uid="<%this.others[j].geekId%>"><div class="geek-intro"><p class="figure"><img src="<%this.others[j].avatar%>"><%if(this.others[j].gender == 1){%><i class="icon-gender men"></i><%}%><%if(this.others[j].gender == 0){%><i class="icon-gender women"></i><%}%></p><span class="name"><%this.others[j].geekName%></span><span class="phone"><i class="icon-phone"></i><%this.others[j].phone%></span></div><div class="date-intro"><p><span class="gray">时间：</span><%this.others[j].date%>   <%this.others[j].clock%></p><p><span class="gray">职位：</span><%this.others[j].jobName%></p></div><div class="status"><%this.others[j].statusDesc%></div><div class="btn-box"><%if (this.others[j].status == 0 || this.others[j].status == 1 || this.others[j].status == 7){%><a href="javascript:;" class="op-edit" data-uid="<%this.others[j].geekId%>" data-id="<%this.others[j].id%>"><i class="iboss-edit"></i><div class="tooltip"><p class="gray">编辑</p></div></a><a href="javascript:;" class="op-cancel" data-uid="<%this.others[j].geekId%>" data-status="<%this.others[j].status%>" data-id="<%this.others[j].id%>"><i class="iboss-close-hollow"></i><div class="tooltip"><p class="gray">取消面试</p></div></a><a href="javascript:;" class="op-forward" data-uid="<%this.others[j].geekId%>" data-id="<%this.others[j].id%>"><i class="iboss-zhuanfa"></i><div class="tooltip"><p class="gray">转发</p></div></a><%}%><%else if (this.others[j].status == 8){%><a href="javascript:;" class="op-absent" data-uid="<%this.others[j].geekId%>" data-id="<%this.others[j].id%>"><i class="iboss-niurenmeilai"></i><div class="tooltip"><p class="gray">牛人没来</p></div></a><%}%></div></dd><%}%></dl>',e)}},i=function(){var e=$(".link-vipaccount"),t=Math.floor(e.offset().left)+Math.floor(e.width()/2)-305,i={};return t+$(".interview-overlays").width()>=$("body").width()?i.right="10px":i.left=t+"px",i},a=function(){for(var e=document.getElementsByTagName("iframe"),t=0;t<e.length;t++)try{e[t].contentWindow.document.addEventListener("click",function(){$(".interview-overlays").remove()})}catch(e){}},n={0:"待接受"},s=function(){if(!$(".interview-overlays").length){var s=$(t.wrap());s.css(i()),$("body").append(s),a(),e.list().then(function(e){$(".interview-detail .dot").remove();var i=e.todayInterviewList.concat(e.futureInterviewList);$.each(i,function(e,t){var i=new Date(t.appointTime);t.date=i.getMonth()+1+"月"+i.getDate()+"日",t.clock=i.getHours()+"："+("0"+i.getMinutes()).substr(-2,2),!t.statusDesc&&(t.statusDesc=n[t.status])});var a=new Date;$(".interview-overlays").empty().html(t.list({today:e.todayInterviewList,others:e.futureInterviewList,date:a.getMonth()+1+"月"+a.getDate()+"日",total:e.interviewCount})),s.off("click"),s.on("click","dd",function(e){var t=$(this).attr("data-uid"),a=i.filter(function(e){return e.geekId==t});a.length&&$.post("/chat/addRelation.json",{gid:a[0].geekId,jid:a[0].jobId,lid:a[0].lid,expectId:a[0].expectId},function(){Chat.toggleUser({uid:t,eid:a[0].encryptGeekId,jid:a[0].jobId})})}),s.on("click",".op-absent",function(e){Publisher.geekAbsentInterview($(this)),e.stopPropagation()}),s.on("click",".op-edit",function(e){var t=$(this).data("id"),a=i.find(function(e){return e.id==t});a&&(a.appointmentTime=a.appointTime,a.edit=!0),Publisher.interview($(this),"dialog-interview-no-around",a),e.stopPropagation()}),s.on("click",".op-cancel",function(e){Publisher.cancelInterview($(this)),e.stopPropagation()}),s.on("click",".op-forward",function(e){var t=$(this).data("id"),a=i.find(function(e){return e.id==t});a&&mediator.publish("FORWARD_GEEK",{type:"interview",interviewId:a.id||"",geek:a.geekId,geekId:a.encryptGeekId,expectId:a.expectId,jobId:a.jobId}),e.stopPropagation()})})}};return $(document).on("click.interview",function(e){if($(".interview-overlays").length&&!$(e.target).hasClass("interview-detail")){var t=$(".interview-overlays"),i=t.offset(),a=e.clientX,n=e.clientY,s=Math.floor(i.left),o=Math.floor(t.width())+s,r=Math.floor(i.top),c=Math.floor(t.height())+r;a>s&&a<o&&n>r&&n<c||$(".interview-overlays").remove()}}),{view:s}}(),ChatRecord={initChatRecords:function(e){var t=$.Deferred(),i=this,a=e,n=a.attr("data-url");return a.hasClass("disabled")?t:(a.addClass("disabled"),$.ajax({type:"get",url:n,async:!0,dataType:"JSON",success:function(e){1==e.rescode?t.resolve(e):($.toast({content:e.resmsg,type:"error"}),t.reject(e)),i.requestThrottle(a)},error:function(e){$.toast({content:e.resmsg,type:"error"}),i.requestThrottle(a),t.reject()}}),t)},renderChatRecordsPopup:function(e){$.dialog({title:"",content:e,closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-view-records",lock:!0,onOpen:function(e){},onConfirm:function(e){}})},requestThrottle:function(e){setTimeout(function(){e.removeClass("disabled")},2e3)}},Feedback={_picCount:0,_limitPicCount:3,getContent:function(){var e=this;$.get("/faqfeedback/pc/create.json").success(function(t){$.dialog({content:t.html,title:'意见反馈<span class="tips">（登录用户，提交反馈后可在App端查看客服回复的消息）</span>',closeText:!0,cancelButton:"取消",confirmButton:"确认",inline:!0,wrapClass:"pop-feedback",onOpen:function(t){var i=t.find(".upload-pics"),a=t.find(".upload-pic-btn"),n=t.find(".upload-pic-btn-wrapper"),s=t.find(".verify-box");Feedback._picCount=0,s.find("img").on("click",function(){$(this).attr("src","/captcha/?randomKey="+$(this).siblings(".randomkey").val()+"&_r="+(new Date).getTime())}),a.on("click",function(a){if(i.children(".upload-pic").length>=Feedback._limitPicCount)return $.toast({content:"最多上传"+Feedback._limitPicCount+"张图片",type:"error"}),a.preventDefault(),!1;s?e.checkForm(s)?e.uploadPicture(i,t):a.preventDefault():e.uploadPicture(i,t)}),i.on("click",".remove-pic",function(e){$(this).closest(".upload-pic").remove(),--Feedback._picCount,i.children(".upload-pic").length<Feedback._limitPicCount&&n.show()})},onConfirm:function(t){return e.submitForm(t)},onCancel:function(e){try{_T.sendEvent("feedback_cancel")}catch(e){}e.remove()}})})},uploadPicture:function(elPicsWrap,popContent){var vertifyEl=popContent.find(".verify-box .ipt"),uploadWaringTimer=null,reg=/(\.|\/)(png|jpg|jpeg)$/i;elPicsWrap.fileupload({method:"POST",url:"/faqfeedback/pc/upload/picture.json",dataType:"text",acceptFileTypes:reg,maxChunkSize:2e6,formData:{randomKey:popContent.find(".randomkey").val()||"",captcha:popContent.find(".verify-box input").val()||""},add:function(e,t){var i=t.files[0],a=i.name,n=i.size;return reg.test(a)?n>2e6?void $.toast({content:"上传文件过大(最大2M)",type:"error"}):Feedback._picCount>=Feedback._limitPicCount?(clearTimeout(uploadWaringTimer),uploadWaringTimer=setTimeout(function(){$.toast({type:"warning",content:"最多上传3张图片"})},100),!1):(++Feedback._picCount,void t.submit()):void $.toast({content:"请上传png、jpg、jpeg 格式的文件",type:"error"})},done:function(e,data){var result=data.result;if("string"==typeof result&&(result=eval("("+result+")")),1==result.rescode){elPicsWrap.find(".upload-pic-btn-wrapper").before('<div class="upload-pic"><div class="remove-pic"></div><img src="'+result.url[0]+'" data-img="'+result.url[1]+'"/></div>'),elPicsWrap.find(".upload-pic").length>=Feedback._limitPicCount&&elPicsWrap.find(".upload-pic-btn-wrapper").hide();try{_T.sendEvent("feedback_pic")}catch(e){}}else clearTimeout(uploadWaringTimer),$.toast({content:result.resmsg?result.resmsg:result.message?result.message:"上传失败",type:"error"}),"验证码错误"==result.resmsg&&(vertifyEl.val("").focus(),popContent.find(".verify-box img").click()),--Feedback._picCount},fail:function(e,t){clearTimeout(uploadWaringTimer),$.toast({content:"上传失败",type:"error"}),--Feedback._picCount}})},submitForm:function(e){var t,i=e,a=i.find("textarea").val(),n=this;i.find(".ipt-wrap").each(function(){return t=n.checkForm($(this)),n.checkForm($(this))});var s={content:a,imgurl:i.find(".upload-pic img").map(function(e,t){return $(t).data("img")}).get()||null,screen:$(window).width()+"*"+$(window).height(),pk:$("#page_key_name").val(),randomKey:i.find(".randomkey").val(),captcha:$(".verify-box input").val()};return t&&(t=!1,$.ajax({url:"/faqfeedback/pc/save.json",type:"POST",data:s,traditional:!0,dataType:"JSON",timeout:3e4,success:function(t){if(t.rescode){$.toast({content:"反馈成功！我们会尽快核实处理",type:"success"});try{_T.sendEvent("feedback_success")}catch(e){}e.remove()}else{$.toast({content:t.resmsg||"提交失败，请稍后再试",type:"error"}),i.find(".verify-box .ipt").val(""),i.find(".verify-box img").click();try{_T.sendEvent("feedback_fail")}catch(e){}}},error:function(e){$.toast({content:"提交失败，请稍后再试",type:"error"});try{_T.sendEvent("feedback_fail")}catch(e){}}})),!1},checkForm:function(e){var t,i,a=e.find(".ipt").val();if(void 0!=e.find(".ipt").attr("data-range")){var n=e.find(".ipt").attr("data-range").split(",");if(i=n[0],t=n[1],a.length>t)return e.next(".text-error").html("请输入"+t+"个字以内的内容"),!1;if(e.next(".text-error").html(""),a.length<i)return e.next(".text-error").html("内容描述至少"+i+"个字"),!1;e.next(".text-error").html("")}if(""==a){var s=e.find(".ipt").attr("data-blank");return e.find(".ipt").focus(),e.next(".text-error").html(s),!1}return e.next(".text-error").html(""),!0}},PropMall=function(){var e=function(){var e={},t=function(e){return window.top.Utemplate('<p class="prop-consume-article"><%this.article%></p><div class="prop-consume-box"><div class="dropdown-wrap J_stickPosition"><span class="dropdown-select"><i class="icon-select-arrow"></i><input type="text" placeholder="未选择" class="ipt" readonly><p class="input-mask text-placeholder">未选择</p><input type="hidden" class="" ></span><div class="dropdown-menu"><ul></ul></div></div></div>',e)},i=function(e){if("buy"!=e.action)return"";return'<div class="prop-resume-info"><p class="prop-consume-article prop-cagegory-article">选择置顶职类 <span class="gray" style="display: none;">选择更多职类置顶，提升招聘效果，还可享受额外折扣</span></p></div><div class="prop-consume-box prop-stick-extend"><input type="hidden" class="J_categorySelected" ><div class="prop-category-range"></div></div>'};return e.stick=function(e){var a='<div class="prop-consume-wrap"><div>'+t({article:"选择需要使用的职位"})+'<div class="stick-flexible-panel">'+i(e)+'<div class="prop-consume-article prop-date-article">选择使用时间<i class="vline"></i><%this.month%>月<p class="gray">未来14日可预订使用，选择多日可享受折扣 <span class="discount-tip"></span></span></p></div><div class="prop-consume-box prop-date-range J_dateRange"><input type="hidden" class="J_dateRangeSelected" ><dl class="prop-date-week"><%for (var i=0;i<this.weeks.length; i++) {%><dd><%this.weeks[i]%></dd><%}%></dl><dl class="prop-date-list"></dl></div></div></div></div>';return window.top.Utemplate(a,e)},e.bombshell=function(){return'<div class="prop-consume-wrap">'+t({article:"选择需要使用牛人炸弹的职位"})+'<div class="prop-bombshell-box"></div></div>'},e.resume=function(){return'<div class="prop-consume-wrap">'+t({article:"选择使用简历加油包的职位"})+'<div class="prop-resume-box"></div></div>'},e.bomPosition=function(e){e.config=window.top._PAGE.uid%2==0;e.fill=function(){var t=["该职位可炸牛人较少"];return 0!=e.expandLowSalary&&0!=e.expandHighSalary&&e.config?"当前职位吸引力低，使用道具后效果可能较差，建议您适当提高职位薪资":0==e.expandDegree&&0==e.expandLowYear&&0==e.expandHighYear?"":(0==e.expandLowYear&&0==e.expandHighYear||t.push("将经验要求扩大至"+e.expandYearName),0!=e.expandDegree&&t.push("将学历要求扩大至"+e.expandDegreeName),t.join("，")+"以上后可以使用牛炸")}(),0!=e.expandDegree&&(e.degreeName=e.expandDegreeName),0==e.expandLowYear&&0==e.expandHighYear||(e.experienceName=e.expandYearName);return e.bombPositionList=e.bombPositionList||[],window.top.Utemplate('<%if (this.fill != "") {%><p class="prop-fill-tip"><%this.fill%></p><%}%><%if (this.expandDegree && this.config) {%><p class="extension-item"><i class="selected" data-type="degree"></i>同步修改职位信息中的最低学历</p><%}%><%if (this.expandLowSalary && this.config) {%><p class="extension-item"><i class="selected" data-type="salary"></i>修改职位薪资范围为：<%this.expandLowSalary%>K-<%this.expandHighSalary%>K</p><%}%><p class="prop-bombshell-article">将给满足以下条件的牛人发送推送</p><table class="prop-bombshell-infomation"><tr><td class="article">期望职位：</td><td class="description"><p><%this.positionCategory%></p></td><td class="article">最低学历：</td><td class="description"><p><%this.degreeName%></p></td></tr><tr><td class="article">工作地点：</td><td class="description"><p><%this.locationName%></p></td><td class="article">工作经验：</td><td class="description"><p><%this.experienceName%></p></td></tr></table><%if(this.bombPositionList.length != 0){%><div class="prop-bombshell-recommend"><p class="prop-bombshell-article">同时推荐给更多相似牛人（可选）<span class="gem-green J_recommendImprove">效果提升89%</span></p><dl><%for(var i=0;i<this.bombPositionList.length;i++){%><dd class="selected"><%this.bombPositionList[i].positionName%></dd><%}%></dl><div class="prop-error"><i class="prop-error"></i>当前牛人数量过少，为保证牛人炸弹效果，请选择相似牛人进行推送</div></div><%}%>',e)},e.position=function(e,t){var i=e.filter(function(e){return 0===e.tag||50==e.tag||5===e.tag||45===e.tag}),a=e.filter(function(e){return 0!==e.tag&&50!==e.tag&&5!==e.tag&&45!==e.tag}),n=$.extend({10:"审核中",15:"即将过期",20:"审核失败",30:"不可用",35:"不可用",40:"即将过期"},t),s=function(e){return window.top.Utemplate('<%if(this.usable.length == 0){%><li class="disabled">无可用职位</li><%}%><%for(var i=0;i<this.usable.length;i++){%><li data-val="<%this.usable[i].encryptId%>"><%this.usable[i].positionName%><em class="vline"></em><%this.usable[i].locationName%><em class="vline"></em><%this.usable[i].lowSalary%>-<%this.usable[i].highSalary%>K</li><%}%><%if(this.unable.length != 0){%><li class="J_showUnable pos-unable-article disabled"><span class="show">显示</span><span class="hide">隐藏</span>不可用职位<i class="icon-select-arrow fr"></i></li><%for(var j=0;j<this.unable.length;j++){%><li class="disabled unable"><p class="fr unable-status"><%this.message[this.unable[j].tag]%></p><p class="unable-position"><%this.unable[j].positionName%><em class="vline"></em><%this.unable[j].locationName%><em class="vline"></em><%this.unable[j].lowSalary%>-<%this.unable[j].highSalary%>K</p></li><%}%><%}%>',e)}({usable:i,unable:a,message:n});return $(".prop-consume").on("click",".pos-unable-article",function(){$(this).parents("ul").toggleClass("unfolded")}),$(".J_stickPosition").on("dropdown.selected",function(){var e=$(".J_stickPosition .dropdown-menu .cur");$(".J_stickPosition").find(".input-mask").removeClass("text-placeholder").html(e.html())}),s},e.dateRange=function(e,t){return window.top.Utemplate('<%for(var i in this.list){%><dd <%if(!this.list[i].disabled || this.list[i].status == "today"){%>class="<%this.list[i].status+this.list[i].checked%>"<%}%> data-price="<%this.list[i].price%>" data-date="<%i%>"><p><%i.substr(-2, 2)%></p><span><%if(this.list[i].disabled){%><%this.text[this.list[i].status]%><%}else if(this.list[i].price != 0 && this.showPrice){%>￥<%this.list[i].price%><%}%></span></dd><%}%>',{text:{today:"今天",disabled:"",expired:"职位过期",locking:"已占用"},showPrice:!0,list:function(){for(var i in e){var a=e[i];a.checked=t.indexOf(i)>-1&&!a.disabled?" selected":""}return e}()})},e.posCategory=function(e){return window.top.Utemplate('<dl><dt><%this.default.name%></dt><%for(var i=0;i<this.list.length;i++){%><dd data-code="<%this.list[i].code%>"><%this.list[i].name%></dd><%}%></dl>',e)},e.selCount=function(e){var t=""!=$.trim(e.expand.workYearDesc),i=""!=$.trim(e.expand.degreeName),a=t||i?"当前可邀请投递牛人较少，":"";t&&(a+="将经验要求扩大至<strong>"+e.expand.workYearDesc+"</strong>"),i&&(a+="将学历要求扩大至<strong>"+e.expand.degreeName+"</strong>"),(t||i)&&(a+="后使用简历加油包");var n='<%if (this.fill != "") {%><p class="prop-fill-tip">'+a+'</p><%}%><div class="prop-resume-info"><p class="prop-resume-article">邀请满足以下条件的牛人投递简历<i class="icon-resume-mark"></i></p><div class="prop-resume-tip"><p class="resume-tip-top">使用前请确认各项条件正确无误。</p><p>您可以通过修改职位条件的方式来变 <br />更牛人的匹配条件。<br />使用后24小时将无法修改职位。</p></div><ul><li class="article">期望职位：</li><li class="content"><%this.job.positionCategory%></li><li class="article">最低学历：</li><li class="content"><%this.job.degreeName%></li><li class="article">工作地点：</li><li class="content"><%this.job.locationName%></li><li class="article">工作经验：</li><li class="content"><%this.job.experienceName%></li></ul></div><div class="prop-resume-count"><p class="prop-resume-article">选择邀请牛人数量<%if (50 < this.inviteCount && this.inviteCount < 100) {%><span class="gray">可邀请人数较少，现在使用8折优惠</span><%}%></p><ul class="scale-wrap"><%for(var i=0; i<this.priceLevel.length; i++){%><li data-count="<%this.priceLevel[i].count%>"><%this.priceLevel[i].count%></li><%}%></ul></div>';return window.top.Utemplate(n,e)},e}();return{StickConsume:function(){var t,i=function(e,t){var i=this;i.get={},i.post={};var a=[],n=[];i.jobId="",i.categoryBase={},i.category=[];var s=function(){$("#toast").addClass("slideUp"),setTimeout(function(){$("#toast").remove()},500)};i.get.job=function(){var t=$.Deferred(),i={buy:"/boss/item/jobTopJobList.json",use:"/boss/item/useJobTopSelJob.json"};return $.get(i[e]).success(function(e){t.resolve(e.data)}).error(function(){$.toast({type:"error",content:"加载职位列表失败"})}),t},i.get.dateRange=function(a){var n=$.Deferred(),o="use"==e?t:{},r={buy:"/boss/item/jobTopSelDay/"+a+".json",use:"/boss/item/useJobTopSelDay/"+a+".json"};return $.toast({type:"loading",content:"正在加载"}),$.get(r[e],o).success(function(e){if(a!==i.jobId)return!1;$.isArray(e.dayBean)?(i.category=e.dayBean.slice(1),i.categoryBase=e.dayBean[0]):(i.category=[],i.categoryBase=e.dayBean),i.dayDiscount=e.dayDiscount||[],i.positionDiscount=e.positionDiscount||[],n.resolve(e.dayBean,e.jobTopCount),s()}).error(function(){s()}),n};i.post.buy=function(i,a,s){var o=$.Deferred(),r={buy:"/boss/item/pay/jobtop.json",use:"/boss/item/useJobTopBooking/"+i+".json"},c={encryptTargetId:i,date8:n.join(",")};"use"==e?c.endDate=t.endDate:c.Positions=a||"";var l=function(t){__conversion("prop_topcard_"+e+"_"+i),o.resolve(t)},d={url:r[e],description:"购买道具：「牛人直通卡」",amount:"use"==e?0:s,data:c,itemId:t.itemId||"89e3b4ba1117aca61XY~",success:l},u={buy:function(){},success:l};return window.top.Payment.purchase(d,u),o},i.post.consume=function(e){var i=$.Deferred(),a={date8:n.join(","),endDate:t.endDate};return $.ajax({method:"post",url:"/boss/item/useJobTopBooking/"+e+".json",data:a,cache:!1,success:function(t){1==t.rescode?(i.resolve(t),__conversion("prop_topcard_use_"+e)):$.toast({type:"error",content:t.resmsg})},error:function(){$.toast({type:"error",content:"使用失败"})}}),i},i.setRange=function(e){n=e},i.getRange=function(){return n},i.total=function(){var e=0,t=function(e){var t={};return $.each(a,function(i,a){a.date8==e&&(t=a)}),t};return $.each(n,function(i,a){e+=t(a).price}),e},Modal=function(){return i}},a=function(){var i=this;this.setTotal=function(){},this.consume=function(){},this.setTotal=function(){},i.formatDate=function(e){return{year:e.substring(0,4),month:e.substring(4,6),day:e.substring(6,8)}},i.message={10:"审核中",15:"即将过期",20:"审核失败",30:"不可用",7:"预定满"},this.formatMonth=function(){var e=new Date,t=e.getFullYear(),i=e.getMonth(),a=e.getDate(),n=0;return 11==i?(t+=1,i=0):i+=1,n=new Date(t,i,0),(n.getDate()-a<7?n.getMonth()+2:n.getMonth()+1)%12},this.addEvent=function(){$(".prop-consume").on("click",".canbuy",i.selectedJob),$(".prop-consume").on("click",".prop-category-range dd",i.selectCategory),$(".prop-stick-buy .icon-resume-mark").hover(function(){$(".prop-stick-buy .prop-resume-tip").show()},function(){$(".prop-stick-buy .prop-resume-tip").hide()})},this.toggleDisable=function(e){e?$(".prop-consume .btn-sure").addClass("disabled"):$(".prop-consume .btn-sure").removeClass("disabled")},this.close=function(){i.wrap.fadeOut("normal",function(){i.wrap.remove()})},this.select=function(e){$(e).toggleClass("selected");var t=$(".prop-consume .prop-date-list .selected"),a=[];$.each(t,function(e,t){a.push($(t).attr("data-date"))}),i.pick(a,$(e).index()%7)},this.pick=function(e,a){$(".J_dateRange .ipt");t.setSelectionRange(e),i.toggleDisable(e.length<1)},this.renderDateRange=function(i){$(".J_dateRange input[type=text]").val(""),$(".prop-consume .prop-date-list").empty().append(e.dateRange(i,t.getSelectionRange()))},this.renderCategory=function(t){t.list.length?$(".prop-resume-info .gray").show():$(".prop-resume-info .gray").hide(),$(".prop-consume .prop-category-range").empty().append(e.posCategory(t))},this.selectCategory=function(){$(this).toggleClass("selected");var e=[];$(".prop-category-range .selected").each(function(t,i){e.push($(i).attr("data-code"))}),$(".J_categorySelected").val(e.join(","));var a=t.getDateByCodes(e);i.setTotal(),i.renderDateRange(a);var n=t.counter();if(e.length){var s='置顶职类 <span class="discount-tip">招聘效果提升'+(e.length+1)+"倍 额外立减"+n.categoryDiscount+"%</span>";window.top.__conversion("topcard_position_"+e.join(",")),$(".prop-cagegory-article").html(s)}else $(".prop-cagegory-article").html('置顶职类 <span class="gray">选择更多职类置顶，提升招聘效果，还可享受额外折扣</span>')},this.getWeeks=function(){for(var e=(new Date).getDay()+1,t=["日","一","二","三","四","五","六"],i=[],a=0;a<7;a++)i.push(t[(e+a)%7]);return i}},n=function(i){var n={};return n.buy=function(){a.call(this,arguments);var i=this;this.render=function(a){ConsumeConfirm({title:"购买牛人直通卡",wrapClass:"prop-stick-buy",content:e.stick({action:"buy",weeks:i.getWeeks(),month:i.formatMonth()}),confirmText:"购买并预定",open:function(t){i.wrap=t,$(".J_stickPosition .dropdown-menu ul").append(e.position(a,i.message)),DropDown.init(t)},confirm:function(e){var i=t.counter();__conversion("topcard_pay_"+e.find(".J_stickPosition input[type=hidden]").val()+"_"+i.pay+"_"+i.save),$(".prop-consume .btn-sure").hasClass("disabled")||t.buy(),$(".prop-consume .btn-sure").addClass("disabled"),$(e).remove()}})},this.selectedJob=function(){i.select($(this))},this.setTotal=function(){var e=t.counter(),i=e.save>0?" multi-row":"";i+=e.vipSave>0?" prop-total-vip":"",$(".prop-consume .btns .prop-total").remove();var a='<p class="prop-total'+i+'">￥<em>'+e.pay+'</em><i class="vip-discount-sign"></i>';e.save>0&&(a+="<br><span>(已省"+e.save+")</span>"),a+="</p>",e.pay>0&&$(".prop-consume .btns").prepend(a);var n=e.dateDiscount&&e.categoryDiscount?"再减":"额外立减";e.dateDiscount?$(".prop-date-article .discount-tip").show().text(n+(e.dateDiscount+e.categoryDiscount)+"%"):$(".prop-date-article .discount-tip").hide().text("")}},n.use=function(){var i=this;a.call(this,arguments),this.render=function(a,n){ConsumeConfirm({title:"使用牛人直通卡",wrapClass:"prop-stick-buy",content:e.stick({action:"use",weeks:i.getWeeks(),month:i.formatMonth()}),confirmText:"使用",open:function(t){i.wrap=t,$(".J_stickPosition .dropdown-menu ul").append(e.position(a,i.message)),DropDown.init(t)},confirm:function(){$(".prop-consume .btn-sure").hasClass("disabled")||t.consume(),$(".prop-consume .btn-sure").addClass("disabled")}}),i.fromListEl=n},this.selectedJob=function(){var e=parseInt($(".J_dateRangeSelected").attr("data-max"));($(".J_dateRange .selected").length<e||$(this).hasClass("selected"))&&i.select($(this)),$(".J_dateRange .selected").length>=e?$(".J_dateRange .canbuy").not(".selected").addClass("disabled"):$(".J_dateRange .canbuy.disabled").removeClass("disabled")},this.consume=function(e){}},new n[i]},s=function(e,a,s){var o=this,r=new i(e,a),c=new n(e);o.action=e;o.buy=function(){
var t=$(".J_stickPosition input[type=hidden]").val(),i=$(".J_categorySelected").val(),a=this.counter(),n="use"!=e?getVipSaveText(a.vipSave):"";r.post.buy(t,i,a.pay).then(function(){c.close(),"use"==e&&c.consume(r.getRange().length),setTimeout(function(){window.top.Payment.success({article:"预定成功",text:"您可以在「我的道具」中查看使用效果"+n,close:function(){window.location.reload()}})},50)}),window.top.__conversion("topcard_pay_"+t+"_"+a.pay+"_"+a.save)},o.consume=function(){c.toggleDisable(!0);var e=$(".J_stickPosition input[type=hidden]").val();r.post.consume(e).then(function(){c.close(),c.consume(r.getRange().length),setTimeout(function(){window.top.Payment.success({article:"预定成功",text:"您可以在「我的道具」中查看使用效果"})},50)}),window.top.__conversion("topcard_pay_"+e+"_"+$(".prop-date-range .selected").length)},o.getDateByCodes=function(e){var t=r.category.filter(function(t){return e.indexOf(t.code)>-1}),i=function(e){var i="canbuy",a=0;return $.each(t,function(t,n){n.data[e].status&&"canbuy"!=n.data[e].status&&"canapply"!=n.data[e].status&&(i=n.data[e].status),a+=n.data[e].price}),{status:i,count:a}},a=$.extend(!0,{},r.categoryBase.data);return $.each(a,function(e,t){"object"==typeof t&&("canbuy"!==t.status&&"canapply"!==t.status||(t.price+=i(e).count,t.status=i(e).status),t.disabled=t.selected||"canbuy"!==t.status&&"canapply"!==t.status)}),a},o.counter=function(){if("use"==e)return{total:$(".J_dateRange dd.selected").length,discount:0,pay:$(".J_dateRange dd.selected").length,save:0};var t=function(e,t){return t<1?0:e[Math.min(e.length-1,t-1)]},i=0,a=0,n=r.getRange(),s=""!=$(".J_categorySelected").val()?$(".J_categorySelected").val().split(","):[],o=t(r.positionDiscount,s.length+1),c=t(r.dayDiscount,n.length),l=r.category.filter(function(e){return s.indexOf(e.code)>-1});$.each(n,function(e,t){i+=r.categoryBase.data[t].price,a+=r.categoryBase.data[t].oprice,$.each(l,function(e,n){i+=n.data[t].price,a+=n.data[t].oprice})});var d=100-100*o-100*c,u=Math.floor(i*d/100);return{total:i,discount:d/100,pay:u,vipSave:a-i,save:a>0?a-u:i-u,categoryDiscount:100*o,dateDiscount:100*c}},o.getSelectionRange=function(){return r.getRange()},o.setSelectionRange=function(i){var a=$(".J_stickPosition input[type=hidden]").val();r.setRange(i);var n=t.counter();"buy"==e&&c.setTotal(),i.length&&window.top.__conversion("topcard_date_"+a+"_"+n.pay)},r.get.job().then(function(e){c.render(e,s),c.toggleDisable(!0),c.addEvent(),$(".stick-flexible-panel").hide(),$(".J_stickPosition").on("dropdown.selected",function(){$(".dropdown-wrap").addClass("dropdown-disabled");var e=$(".J_stickPosition input[type=hidden]").val();r.jobId=e,r.get.dateRange(e).then(function(e,t){$(".J_categorySelected").val(""),$(".dropdown-wrap").removeClass("dropdown-disabled"),c.renderCategory({default:r.categoryBase,list:r.category}),c.renderDateRange(o.getDateByCodes([])),$(".J_dateRangeSelected").attr("data-max",t),$(".stick-flexible-panel").show()}),window.top.__conversion("topcard_job_"+e)})})};return{factory:function(e,i,a){t=new s(e,i,a)}}}()}}(),JobCompetitive={getEffect:function(e){var t=$.Deferred();return $.ajax({type:"get",url:"/wapi/zpblock/job/competitive/detail",dataType:"json",data:e,success:function(e){0===e.code?t.resolve(e.zpData):$.toast({type:"error",content:e.message||"服务器异常"})},error:function(){$.toast({type:"error",content:"服务器异常"})}}),t},show:function(e){JobCompetitive.getEffect(e).done(function(e){1==e.effect?e.vip?[1,2].indexOf(e.dataState)>=0?JobCompetitive.rendNoData(e):JobCompetitive.rendVip(e):JobCompetitive.rendNotVip(e):$.dialog({type:"warning",title:"提示",content:'<div class="tip-text">'+e.notEffectText+"</div>",closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-icons-default"})})},getVipHTML:function(e){return'<div class="job-competitive-content">   <div class="row">       <div class="box box-expect">           <div class="bg-logo"></div>           <div class="box-expect-inner">               <h5>求职意愿<div class="explain"><i class="iboss-wenhao"></i><span>与同期望牛人“近7日日均数据”进行对比</span></div></h5>               <canvas id="expect-canvas" width="100" height="80"></canvas>               <p class="content">沟通Boss数<br/>超过'+(e.geekConcatBossRank||0)+'%的牛人</p>           </div>           <div class="box-popular-inner">               <h5>受欢迎程度<div class="explain"><i class="iboss-wenhao"></i><span>与同期望牛人“近7日日均数据”进行对比</span></div></h5>               <canvas id="popular-canvas" width="100" height="80"></canvas>               <p class="content">被Boss沟通次数<br/>超过'+(e.bossConcatGeekRank||0)+'%的牛人</p>           </div>       </div>       <div class="box box-preference">           <h5>牛人偏好分析</h5>           <div class="preference-item">               <div class="item-title">沟通时间</div>               <div class="item-content">'+(e.geekPreference&&e.geekPreference.communicateTime||"——")+'</div>           </div>           <div class="preference-item">               <div class="item-title">办公区域</div>               <div class="item-content">'+(e.geekPreference&&e.geekPreference.workAddr||"——")+'</div>           </div>           <div class="preference-item">               <div class="item-title">公司规模</div>               <div class="item-content">'+(e.geekPreference&&e.geekPreference.comScale||"——")+'</div>           </div>           <div class="preference-item">               <div class="item-title">融资规模</div>               <div class="item-content">'+(e.geekPreference&&e.geekPreference.comStage||"——")+'</div>           </div>       </div>   </div>   <div class="row">       <div class="box box-salary">           <h5>沟通过Boss的薪资分布</h5>           <div class="sub-title">您超过 <span class="text-blue">'+(e.salaryRank||0)+'%</span>的竞争者</div>           <canvas id="salary-canvas" width="384" height="177"></canvas>       </div>       <div class="box box-comm">           <h5>与各Boss的沟通进度</h5>           <div class="sub-title">您超过 <span class="text-blue">'+(e.contactRank||0)+'%</span>的竞争者</div>           <canvas id="comm-stage-canvas" width="355" height="177"></canvas>       </div>   </div></div>'},rendVip:function(e){var t='<img src="'+e.geekInfo.geekAvatar+'" alt="" class="geek-avatar"/>';$.dialog({title:t+"牛人分析器",content:JobCompetitive.getVipHTML(e),closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-prop-default job-competitive-wrap",onOpen:function(t){BossCanvas.drawGauge1(document.querySelector("#expect-canvas"),{percent:e.geekConcatBossRank,text:[" 强 ","较强","一般"][e.expectLevel-1]},{speed:1}),BossCanvas.drawGauge1(document.querySelector("#popular-canvas"),{percent:e.bossConcatGeekRank,text:[" 高 ","较高","一般"][e.popularLevel-1]},{speed:1}),JobCompetitive.handleSalaryVipData(document.querySelector("#salary-canvas"),e.salaryList),JobCompetitive.handleCommVipData(document.querySelector("#comm-stage-canvas"),e.communicateList,t)}})},handleSalaryVipData:function(e,t){var i=["--","--","--","--","--"],a=[0,0,0,0,0],n=-1,s=-1;$.each(t,function(e,t){var o;o=0===t.low&&0===t.high?"面议":t.low+"-"+t.high+"K",i[e]=o,a[e]=t.percent,t.boss&&(n=e),t.geek&&(s=e)}),BossCanvas.drawLine1(e,{percentArr:a,labelArr:i,tipIndex:n,tipIndex2:s,isSame:n===s,tipText:"您在这里",tipText2:"牛人偏好",tipText3:"薪资符合牛人期望"},{speed:1})},handleCommVipData:function(e,t,i){var a=["--","--","--","--","--"],n=[0,0,0,0,0],s=-1;$.each(t,function(e,t){a[e]=t.stage,n[e]=t.percent,t.boss&&(s=e)}),s<0&&i.find(".box-comm .sub-title").html('您与该牛人<span class="text-blue">暂未产生沟通</span>'),BossCanvas.drawInterval1(e,{tipText:"您在这里",percentArr:n,labelArr:a,tipIndex:s},{speed:1})},rendNotVip:function(e){var t='<img src="'+e.geekInfo.geekAvatar+'" alt="" class="geek-avatar"/>';$.dialog({title:t+"牛人分析器",content:"",closeText:!0,confirmText:"开通VIP解锁该权益",cancelText:!1,wrapClass:"dialog-prop-default job-competitive-wrap job-competitive-blur",onConfirm:function(e){e.remove(),window.top.Commercial.vip({sf:14},function(){window.location.reload()})}})},rendNoData:function(e){var t,i,a='<img src="'+e.geekInfo.geekAvatar+'" alt="" class="geek-avatar"/>';1===e.dataState?(t=" job-competitive-new-geek ",i='<p class="no-data-text">该牛人为新牛人<br/><span class="sub-tip">第一批和牛人聊天的Boss，会额外增加好感哦～</span></p>'):(e.dataState,t=" job-competitive-no-data ",i='<p class="no-data-text">暂无数据<br/><span class="sub-tip">该牛人近期暂无偏好，获取更多数据后为您展示</span></p>'),$.dialog({title:a+"牛人分析器",content:i,closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-prop-default job-competitive-wrap "+t})}},mediator=window.mediator||new EventManger,rAF=rAF||window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3)},cAF=cAF||cancelAnimationFrame||webkitCancelAnimationFrame||mozCancelAnimationFrame||oCancelAnimationFrame||msCancelAnimationFrame||function(e){clearTimeout(e)},interviewOnlineDebug=!1;$(function(){var e=FmsWebSupport.BrowserCheck().isSupportWebrtc(navigator.userAgent);if(_PAGE.canInterviewOnline=e,e){var t=window.location.hostname;t.indexOf("boss-m.weizhipin.com")>-1?seriesLoadScripts("//static.weizhipin.com/zhipin/dev/web/boss/js/fmslive.js",interviewOnline):t.indexOf("boss-m-qa.weizhipin.com")>-1?seriesLoadScripts("//static.weizhipin.com/zhipin/mqa/web/boss/js/fmslive.js",interviewOnline):t.indexOf("boss-m-qa3.weizhipin.com")>-1?seriesLoadScripts("//static.weizhipin.com/zhipin/mqa/web/boss/js/fmslive.js",interviewOnline):t.indexOf("pre-www.zhipin.com")>-1?seriesLoadScripts("//static.weizhipin.com/zhipin/pre/web/boss/js/fmslive.js",interviewOnline):t.indexOf("www.zhipin.com")>-1&&seriesLoadScripts("//static.zhipin.com/fmslive/fmslive.js",interviewOnline)}else $(".chat-box").find(".chat-controls").find(".btn-audio").hide().end().find(".btn-video").hide().prev(".vline").hide()});var UA=window.navigator.userAgent,isIE,isZpdesk,isWebkit;(UA.indexOf("Edge/")>-1||UA.indexOf("MSIE ")>-1||UA.indexOf("Trident/")>-1)&&(isIE=!0),UA.indexOf("WebKit")>-1&&(isWebkit=!0),UA.indexOf("ZhipinDesktop/")>-1&&(isZpdesk=!0);var DEBUG=!0;isZpdesk&&seriesLoadScripts("js/zpdesk.js");var supportsCalcVh=!!window.CSS&&CSS.supports("height","calc(100vh - 0px)");"_PAGE"in window&&_PAGE.token?$.ajaxSettings.beforeSend=function(e,t){e.setRequestHeader("token",_PAGE.token)}:"_PAGE"in window.top&&window.top._PAGE.token&&($.ajaxSettings.beforeSend=function(e,t){e.setRequestHeader("token",window.top._PAGE.token)}),$.ajaxSettings.statusCode={200:function(e){if([31,32,35,36].indexOf(e.code)>=0&&mediator)return mediator.publish("WEB_GATE_INTERCEPTOR",{code:e.code,message:e.message}),!1},602:function(){try{_T.sendTracking("boss_code_602_logout")}catch(e){}},603:function(){window.top.location.href="/geek/complete/guide.html"},5003:function(){window.top.$&&window.top.$.dialog&&$.dialog({title:"",content:'<div class="captcha-pop-frame"><iframe src="/captcha/popUpCaptcha"></iframe></div>',closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-captcha-pop",lock:!0,onOpen:function(e){try{_T.sendEvent("captcha_dialog_show")}catch(e){}},onClose:function(){try{_T.sendEvent("captcha_dialog_hide")}catch(e){}},onConfirm:function(e){}})}};var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,qq:" qq"==e.match(/\sQQ/i)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},VerrifyCode=window.VerrifyCode||function(){var e=new Date,t=e.getFullYear()+""+e.getMonth()+e.getDay(),i=function(e,i){seriesLoadScripts("//g.alicdn.com/sd/ncpc/nc.js?t="+t,function(){var t=["BOSS_PC",(new Date).getTime(),Math.random().toString(16)].join(":"),a={renderTo:"#"+e.id,appkey:e.appkey||"FFFF0N00000000006DC1",scene:e.scene||"nc_login",token:t,customWidth:i.find(".row-code").width(),trans:{position:"sign-sms"},elementID:["sign-sms"],is_Opt:0,language:"cn",isEnabled:!0,timeout:3e3,times:5,apimap:{},callback:function(e){i.find("input[name=csig]").length||(i.find("form").append('<input type="hidden" name="csig" />'),i.find("form").append('<input type="hidden" name="ctoken" />'),i.find("form").append('<input type="hidden" name="csessionId" />'),i.find("form").append('<input type="hidden" value="FFFF0N00000000006DC1" name="cappKey" />'),i.find("form").append('<input type="hidden" value="nc_login" name="cscene" />')),i.find("input[name=csig]").val(e.sig),i.find("input[name=ctoken]").val(t),i.find("input[name=csessionId]").val(e.csessionid)}};new noCaptcha(a).upLang("cn",{_startTEXT:"请按住滑块，拖动到最右边",_yesTEXT:"验证通过",_error300:'哎呀，出错了，点击<a href="javascript:__nc.reset()">刷新</a>再来一次',_errorNetwork:'网络不给力，请<a href="javascript:__nc.reset()">点击刷新</a>'})})},a=function(e,i){seriesLoadScripts("//g.alicdn.com/sd/nch5/index.js?t="+t,function(){var t=["BOSS_H5",(new Date).getTime(),Math.random().toString(16)].join(":"),a=NoCaptcha.init({renderTo:"#"+e.id,appkey:e.appkey||"FFFF0N00000000006DC1",scene:"nc_login_h5",token:t,customWidth:"100%",trans:{position:"sign-h5"},elementID:["sign-h5"],is_Opt:0,language:"cn",timeout:1e4,retryTimes:5,errorTimes:5,inline:!1,apimap:{},bannerHidden:!1,initHidden:!1,callback:function(e){i.find("input[name=csig]").length||(i.find("form").append('<input type="hidden" name="csig" />'),i.find("form").append('<input type="hidden" name="ctoken" />'),i.find("form").append('<input type="hidden" name="csessionId" />'),i.find("form").append('<input type="hidden" value="FFFF0N00000000006DC1" name="cappKey" />'),i.find("form").append('<input type="hidden" value="nc_login" name="cscene" />')),i.find("input[name=csig]").val(e.sig),i.find("input[name=ctoken]").val(t),i.find("input[name=csessionId]").val(e.csessionid)},error:function(e){}});NoCaptcha.setEnabled(!0),a.reset(),NoCaptcha.upLang("cn",{LOADING:"加载中...",SLIDER_LABEL:"请向右滑动验证",CHECK_Y:"验证通过",CHECK_N:"验证未通过"})})},n=function(e,t){var n=e||{},s=t||$(".sign-form:visible");if(e||(n.id=s.find(".row-code").attr("id"),n.scene=s.find("input[name=cscene]").val(),n.appkey=s.find("input[name=cappKey]").val()),!n.id)return!1;browser.versions.mobile?a(n,s):i(n,s)},s=function(e){if(!e||!e.length)return!1;var t=e.parents(".sign-form").length?e.parents(".sign-form"):e.parents("form"),i="verrify"+Math.random().toString(32).substr(-6,6);t.find("input[name=csig]").val(""),t.find("input[name=ctoken]").val(""),t.find("input[name=csessionId]").val(""),e.empty(),e.attr("id",i),n({id:i,scene:t.find("input[name=cscene]").val(),appkey:t.find("input[name=cappKey]").val()},t)},o=function(){$(".sign-form .row-code").each(function(){s($(this))})};return o(),{build:o,reset:s}}(),Storage={get:function(e){var t=this._getStorage(),i="";if(t)return(i=t.getItem(e))&&JSON.parse(i)},set:function(e,t){var i=this._getStorage();e&&void 0!==t&&i.setItem(e,JSON.stringify(t))},del:function(e,t){var i=this._getStorage();if(i)if(e&&t)for(var e in i)0===e.indexOf(prefix)&&i.removeItem(e);else e?i.removeItem(e):i.clear()},_getStorage:function(){var e;try{e=window.localStorage}catch(e){}return e}},mediator=window.mediator,History=function(){function e(e){var t=[];return $.each(e,function(e,i){t.push(i.name)}),t}function t(e){var t=!0,n=e[0],s=0;$.each(d,function(e,i){i[0].name==n.name&&(s=e,t=!1)}),t?i(e):a(s,e)}function i(e){if(d.length<5)return void d.push(e);var t=0,i=e.length;$.each(d,function(e,a){a.length<i&&(i=a.length,t=e)}),a(t,e)}function a(e,t){var i=d[e];t.length>=i.length&&(d.splice(e,1),d.push(t))}function n(e){if(e.length<1)return!1;t(e),o()}function s(){d=[],localStorage.setItem("__Search__History","")}function o(){localStorage.setItem("__Search__History",__stringify(d))}function r(e){var t=function(e){var t=0;return $(e).children().each(function(e,i){t+=$(i).width(),$(i).hasClass("vline")&&(t+=32)}),t};d.length>0?(e.find("ul").empty().html(u()),e.find(".history-blank").hide(),e.find(".op-clear").show()):e.find(".history-blank").show(),e.on("click",".op-clear",function(){s(),e.find("ul").empty(),e.find(".op-clear").hide(),e.find(".history-blank").show()}),e.find("li").each(function(e,i){t(i)>540&&$(i).addClass("truncation ")})}function c(t,i){return e(t.filter(function(e){return e.type==i}))}function l(e){var t=e||0,i=d[t];return{jobs:c(i,"job"),companies:c(i,"company"),skills:c(i,"skill"),schools:c(i,"school"),keywords:c(i,"keyword"),condition:i}}var d=function(){var e=localStorage.getItem("__Search__History");return""==e||null==e||void 0==e?[]:$.parseJSON(e)}(),u=function(){var t="";return $.each(d,function(i,a){var n="<li><span>"+e(a).join('</span><em class="vline"></em><span>')+"</span></li>";t+=n}),t};return{add:n,render:r,clear:s,get:l}}(),ConditionSprite=function(){var e,t={city:$(".query-city .selected").attr("data-value")||"",experience:"",degree:"",salary:"",applyStatus:"",schoolLevel:"",returnees:"",age:""},i=[{code:"-1",text:"--"},{code:209,text:"初中及以下"},{code:208,text:"中专/中技"},{code:206,text:"高中"},{code:202,text:"大专"},{code:203,text:"本科"},{code:204,text:"硕士"},{code:205,text:"博士"},{code:201,text:"不限"}],a=["在校生","应届生","1年","2年","3年","4年","5年","6年","7年","8年","9年","10年","10年+"],n=$("input[name=experience]"),s=$(".query-filter-options"),o=s.find("input[name=age]"),r=function(){var e=[],i=s.find("input[name=age]").val(),a=i.split(","),n=a[0]+","+("36"==a[1]?1e4:a[1]),o=s.find("input[name=experience]").val(),r=o.split(","),c=("-1"==r[0]?-2:r[0])+","+("-1"==r[1]?-2:r[1]);s.find(".query-applyStatus .selected").each(function(t,i){e.push($(i).attr("data-value"))}),t={city:$(".query-city .selected").attr("data-value")||0,experience:c,degree:s.find(".degree-min .ipt").attr("data-value")+","+s.find(".degree-max .ipt").attr("data-value"),salary:s.find(".salary-min .ipt").attr("data-value")+","+s.find(".salary-max .ipt").attr("data-value"),applyStatus:e.join(","),schoolLevel:s.find(".query-school-level .selected").map(function(e,t){return $(t).attr("data-value")}).get().join(","),returnees:"",age:n},Search.getData(1)},c=function(){e&&clearTimeout(e),e=setTimeout(function(){s.find(".filter-error").hide()},3e3)},l=function(e){var t=function(){var t=[60,70,80,90,100,150,200];if(e){if(e<60){var i=function(t,i){for(var a=e,n=[a];a<t;)a+=i,n.push(a);return n}(2*e,1),a=t.filter(function(e){return e>i[i.length-1]});return i.concat(a)}return t.filter(function(t){return t>=e})}return t}(),i=t.map(function(e){return'<li data-value="'+e+'">'+e+"K</li>"});i.unshift('<li data-value="-1">--</li>'),s.find(".salary-max .ipt").val("--").attr("data-value","-1"),s.find(".salary-max .dropdown-menu ul").html(i.join(""))},d=function(e){e<0&&(e=0);var t=i.slice(e,i.length),a='<li data-value="-1">--</li>',n=t.map(function(e){return'<li data-value="'+e.code+'">'+e.text+"</li>"});t.indexOf("-1")>-1&&(a=""),s.find(".degree-max .ipt").val("--").attr("data-value","-1"),s.find(".degree-max .dropdown-menu ul").html(a+n.join("")),s.find(".degree-max .dropdown-menu ul").scrollTop(0)},u=function(e){var t=function(e,t){var a=t.split(","),n="."+e+"-min .ipt",o=i.find(function(e){return e.code==a[0]});i.find(function(e){return e.code==a[1]});s.find(n).val(o.text).attr("data-value",o.code),d(i.indexOf(o))};$.each(e,function(e,i){if("experience"==e){var a=i.split(","),s=(-2==a[0]?-1:a[0])+","+(-2==a[1]?-1:a[1]);n.jRange("setValue",s)}else if("degree"==e)t(e,i);else if("age"==e){var r=i.split(","),c=r[0]+","+(1e4==r[1]?36:r[1]);o.jRange("setValue",c)}})},p=function(e){return e&&(t=$.extend(t,e),u(e)),t},h=function(e){var t=$(".query-city"),i=t.find("dd[data-value="+e.code+"]");i.length||(i=$(".query-city dd").not(".more").last().text(e.name).attr("data-value",e.code)),i.siblings().removeClass("selected"),i.addClass("selected"),p({city:e.code})};s.on("click",".radio-item",function(){$(this).attr("data-value")&&($(this).siblings().removeClass("selected"),$(this).addClass("selected"),r()),$(this).hasClass("more")&&Search.setFilterCity()}),s.on("click",".salary-min li",function(){var e="不限"==$(this).text()?"":$(this).text();l(parseInt(e,10)),s.find(".salary-min .ipt").val($(this).text()).attr("data-value",$(this).attr("data-value")),r()}),s.on("click",".salary-max li",function(){s.find(".salary-max .ipt").val($(this).text()).attr("data-value",$(this).attr("data-value")),r()}),s.on("click",".degree-min li",function(){d($(this).index()),s.find(".degree-min .ipt").val($(this).text()).attr("data-value",$(this).attr("data-value")),r()}),s.on("click",".degree-max li",function(){var e=$(this).attr("data-value");["209","208","206","202"].indexOf(e)>-1?s.find(".query-school-level").find("dt span.gray").text("仅支持本科以上学历筛选").end().removeClass("unfold").addClass("disabled").find(".mix-item").removeClass("selected").filter('[data-value="-1"]').addClass("selected"):s.find(".query-school-level").addClass("unfold").removeClass("disabled"),s.find(".degree-max .ipt").val($(this).text()).attr("data-value",e),r()}),s.on("click",".check-item",function(){$(this).toggleClass("selected"),r()}),s.on("click",".mix-item",function(){switch($(this).attr("data-type")){case"radio":$(this).toggleClass("selected").siblings(".mix-item").removeClass("selected");break;case"checkbox":$(this).toggleClass("selected").siblings('.mix-item[data-type="radio"]').removeClass("selected");break;default:$(this).toggleClass("selected").siblings(".mix-item").removeClass("selected")}var e=$(this).parents("dl");!e.find(".selected").length&&e.find(".mix-item").eq(0).addClass("selected"),r()}),s.on("click",".radio",function(){["209","208","206","202"].indexOf(s.find(".degree-max .ipt").attr("data-value"))>-1?(s.find(".radio-dl .filter-error").show(),c()):(s.find(".radio-dl .filter-error").hide(),$(this).toggleClass("selected"),r())});var f=function(e,t){if("experience"==e){var n=parseInt(t)+1;return n<0&&(n=0),a[n]}return"salary"==e?t+"K":"degree"==e?i.find(function(e){return e.code==t}).text:"age"==e?t+"岁":void 0},m=function(e){var i=(t[e]||"").split(",");if(!i.length)return"不限";var a=i[0],n=i.length>1?i[1]:i[0];return-1==a&&-1==n||"experience"==e&&"-2,11"==t[e]||"age"==e&&"16,10000"==t[e]?"不限":a==n?f(e,a):"age"==e&&16==a||"experience"==e&&-2==a?f(e,n)+"及以下":-1!=a&&0!=a||"experience"==e?"age"==e&&1e4==n||"experience"==e&&11==n?f(e,a)+"及以上":-1==n?f(e,a)+"以上":f(e,a)+"-"+f(e,n):f(e,n)+"以下"};s.on("click","dt",function(){var e=$(this).parents("dl"),t=e.attr("data-type"),i="";if(e.hasClass("disabled"))return!1;if(e.toggleClass("unfold"),"experience"==t||"degree"==t||"salary"==t||"age"==t)i=m(t);else if("applyStatus"==t){var a=e.find(".selected").length;i=a&&a<4?e.find(".selected").eq(0).text():"不限",a>1&&a<4&&(i+="等")}else if("schoolLevel"==t){var a=e.find(".selected").length;i=a&&a<3?e.find(".selected").map(function(e,t){return t.innerText}).get().join("、"):"已选"+a+"项"}else i=e.find(".selected").text();e.find("dt span.gray").text(i)});var g=function(e){e?(s.find(".query-salary-disabled").show(),s.find(".query-salary").hide()):(s.find(".query-salary-disabled").hide(),s.find(".query-salary").show())},v=function(e){e?(s.find(".query-applyStatus-disabled").show(),s.find(".query-applyStatus").hide()):(s.find(".query-applyStatus-disabled").hide(),s.find(".query-applyStatus").show())};return function(e){n.jRange({from:-1,to:11,step:1,format:function(e){return a[parseInt(e)+1]},ondragend:r,onbarclicked:r,snap:!0,width:window.top.$("body").width()>=1360?274:234,showScale:!1,isRange:!0,onstatechange:function(e){var t=e.split(",");t[0]==t[1]?n.parent().addClass("overlap"):n.parent().removeClass("overlap"),-1==t[0]&&-1==t[1]?(g(!0),v(!0)):-1==t[0]&&0==t[1]||0==t[0]&&0==t[1]?(v(!0),g(!1)):(g(!1),v(!1))}}).jRange("setValue",e)}("-1,11"),function(e){o.jRange({from:16,to:36,step:1,format:function(e){return 36===e?"35岁+":e+"岁"},ondragend:r,onbarclicked:r,snap:!0,width:window.top.$("body").width()>=1360?274:234,showScale:!1,isRange:!0,onstatechange:function(e){var t=e.split(",");t[0]==t[1]?o.parent().addClass("overlap"):o.parent().removeClass("overlap")}}).jRange("setValue",e)}("16,36"),function(){var e=function(){var e,t=[];for(e=1;e<=50;e++)t.push(e);return t.concat([60,70,80,90,100,150,200])}().map(function(e){return'<li data-value="'+e+'">'+e+"K</li>"});e.unshift('<li data-value="-1">不限</li>'),s.find(".salary-min .dropdown-menu ul").html(e.join(""))}(),l(),function(){s.find(".query-salary").after("<dl class='query-salary-disabled'><span class='title'>薪资</span><span>非在校生时可用</span></dl>"),s.find(".query-salary-disabled").hide();s.find(".query-applyStatus").after("<dl class='query-applyStatus-disabled'>求职状态（多选）非在校生/应届生时可用</dl>"),s.find(".query-applyStatus-disabled").hide()}(),$(window).on("resize",function(){var e=window.top.$("body").width()>=1360?274:234;n.jRange("setWidth",e),o.jRange("setWidth",e)}),{data:p,setCity:h}},Search={init:function(){if(Search.isScriptLoaded=!0,Search.syncContainer=$(".search-container"),Search.listContainer=Search.syncContainer.find("#search-list"),Search.batchCheckEl=Search.syncContainer.find("#option"),Search.batchCheckCon=Search.syncContainer.find("#option-con"),Search.searchBox=$(".search-box"),Search.queryEl=$(".search-query"),Search.nowResume="",Search.xhrs={},Search.hasSlected=!1,$(document).on("click",function(){window.top.$(".dropdown-vipaccount").hasClass("dropdown-menu-open")&&window.top.$(".dropdown-vipaccount").removeClass("dropdown-menu-open")}),$(".condition-box ul").append('<li data-type="jobtext"></li>'),$(".link-manger-apply").length&&Search.syncContainer.addClass("search-ask-manger"),Search.para={page:0,jobId:"",jobs:[],companies:[],skills:[],schools:[],keywords:[],jobtext:[],condition:[],salary:"",experience:"",degree:"",city:$(".city-sel .label-text b").attr("data-val")},$(".condition-select").click(function(){$(this).toggleClass("dropdown-open"),$(this).siblings().removeClass("dropdown-open")}),$(document).on("click",function(e){$(e.target).parents(".dropdown-open").length||$(".dropdown-open").removeClass("dropdown-open")}),$(".position-list .show-all").on("click",function(){$(".position-list").toggleClass("height-auto")}),Search.listContainer.find(".btn-back").on("click",function(){window.location.reload()}),0==Search.listContainer.length)return void $(".data-tips").on("click",".link-topage",function(){var e=$(this),t=e.attr("data-url");$(window.parent.document).find(".side-menu dl").removeClass("cur"),$(window.parent.document).find(".side-menu .menu-position").addClass("cur"),$(window.parent.document).find(".side-menu .menu-position a").trigger("click"),location.href=t});Search.isLoading=!1,Search.type="list",Search.listWrap=Search.listContainer.find(".search-card"),Search.tipsContainer=Search.listWrap.find(".data-tips"),Search.listCon=Search.listWrap.find("ul"),Search.listMoreEl=Search.listWrap.find(".loadmore"),Search.listMoreEl.on("click",function(){Search.isLoading||Search.listMoreEl.hasClass("disabled")||Search.getData()});var e=(Search.listContainer.find(".candidate-preview .loadmore").get(0),Search.listContainer.find(".search-card .loadmore").get(0));$(window).on("scroll",function(){!Search.isLoading&&0!=Search.listContainer.find(".search-card li").length&&Search.syncContainer.hasClass("search-result-model")&&(Search.timer&&clearTimeout(Search.timer),Search.timer=setTimeout(function(){!Search.isLoading&&isVisiable(e)&&!Search.listMoreEl.hasClass("disabled")&&window.top.Menu.sideEl.find(".menu-geeksearch").hasClass("cur")&&Search.getData()},100))}),Search.listContainer.on("click",".user-list a",function(e){var t=$(this);Search.renderPreview(t,!1),e.preventDefault()}),Search.listContainer.on("click",".search-card li a",function(e){Search.showPopResume($(this)),e.preventDefault()}),Search.listContainer.on("click",".search-card .btn-getcontact,.candidate-preview .detail-box .detail-bottom .btn",function(e){var t,i=(Search.para,$(this));if(t="preview"==Search.type?Search.listContainer.find(".user-list .cur a"):i.closest("li").find("a"),i.hasClass("btn-batch-contact")&&(localStorage.getItem("batch-contact-guide")?Search.addBatchHistory(i):Search.showBatchGuide()),!i.hasClass("disabled")){if(i.hasClass("btn-getcontact")){var a=i.hasClass("btn-chat")?"chat":"call";propInit.init({suid:t.attr("data-suid")||"",lid:t.attr("data-lid")||"",jobId:t.attr("data-jid")||Search.para.jobId||"",expectId:t.attr("data-expect")||"",card:a,el:i}),window.top.__conversion(i.attr("ka")),e.stopPropagation()}e.preventDefault()}}),$(document).on("click",function(e){$(e.target).parents(".city-sel").length||Search.syncContainer.find(".city-sel").removeClass("dropdown-open"),$(e.target).closest(".suggest-result").length||$(e.target).closest(".search-form").length||$(".suggest-result").hide()}),Search.searchBox.find(".ipt-search").focus();var t=function(){Search.suggestTimer&&clearTimeout(Search.suggestTimer);var e=$(this);Search.suggestTimer=setTimeout(function(){Search.suggest(e)},200),""!=e.val()&&(e.parent().find(".icon-search-clear").show(),Search.syncContainer.hasClass("search-result-model")&&e.parent().find(".btn-search").hide()),Search.searchBox.find(".search-tip").is(":visible")&&Search.searchBox.find(".search-tip").hide()};Search.searchBox.find(".ipt-search").on("input",t),Search.queryEl.find(".query-input").on("input",t),Search.searchBox.find(".btn-search").on("click",function(){var e={type:"keywords",description:$(".ipt-search").val()};Search.keywordLibrary.add(e)});var i=-1,a=function(e){var t=$(".suggest-result li"),a=$(e.target);if(""!=a.val().trim())switch(e.which){case 38:t.removeClass("selected"),-1==i?(i=-1,i=t.length-1):i--,t.eq(i).addClass("selected"),Search.scrollVisiable(i,"up");break;case 40:e.preventDefault(),t.removeClass("selected"),i>t.length-2&&(i=-1),i++,t.eq(i).addClass("selected"),Search.scrollVisiable(i,"down");break;case 13:i=-1;var n=$(".suggest-result .selected"),s={};if(n.length){var o=["keywords","jobs","companies","skills","schools"],r=n.parents("dl").index();s.type=o[r],s.description=n.text()}else s.type="keywords",s.description=a.val();Search.keywordLibrary.add(s);break;case 27:i=-1,Search.searchBox.find(".ipt-search").val(""),Search.searchBox.find(".icon-search-clear").hide(),$(".suggest-result").hide(),Search.syncContainer.hasClass("search-result-model")&&Search.searchBox.find(".btn-search").show()}};Search.queryEl.find(".query-input").keydown(a),Search.searchBox.find(".ipt-search").keydown(a),$(".suggest-result").on("click","li",function(){var e=["keywords","jobs","companies","skills","schools"],t=$(this).parents("dl").index();Search.keywordLibrary.add({type:e[t],description:$(this).find(".name").text()})}),$(".condition-box").on("click",".icon-search-close",function(){Search.removeTag($(this))}),Search.searchBox.find(".icon-search-clear").on("click",function(){Search.searchBox.find(".ipt-search").val("").focus(),$(this).hide(),$(".suggest-result").hide(),Search.syncContainer.hasClass("search-result-model")&&$(this).parent().find(".btn-search").show(),Search.hasSlected=!1}),Search.searchBox.find(".search-tip").on("click",function(){$(this).hide()}),Search.syncContainer.find(".icon-search-batch-help").attr("ka","nd_search_contact_help"),Search.syncContainer.find(".icon-search-help").on("click",function(){$(this).hasClass("icon-search-batch-help")?Search.showBatchGuide():$.confirm({content:PropInitView(),confirmButton:"关闭",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',confirm:function(){}})}),$(".guide-search-layer").attr("ka","nd_search_batch_layer_close").on("click",function(){$("body").removeClass("show-batch-layer")}),$(".search-contact-history .btn").on("click",function(){$("body").hasClass("show-batch-layer")?$("body").removeClass("show-batch-layer"):localStorage.getItem("batch-contact-guide")&&$(".search-contact-history .figure-list img").length?Search.showBatchConfirm($(this)):Search.showBatchGuide()}),
$(".search-criteria").on("click",".link-manger-apply",function(){$.dialog({title:"向企业管理员申请牛人电话",content:'<div class="tip-text">管理员将会收到你的请求，如果对方同意，道具将转移到你的账号下</div><div class="search-prop-form"><div class="dropdown-wrap"><span class="dropdown-select"><input type="text" placeholder="选择牛人电话数量" class="ipt" value="1个" readonly><input type="hidden" class="required" value="1"></span><div class="dropdown-menu"><ul><li data-val="1" class="cur">1个</li><li data-val="2">2个</li><li data-val="3">3个</li><li data-val="4">4个</li><li data-val="5">5个</li></ul></div></div></div>',confirmText:"发送请求",cancelText:"",closeText:!0,preKa:"nd_search_manger",wrapClass:"dialog-search-prop",lock:!0,onOpen:function(e){DropDown.init(e),e.find(".btn-sure").attr("ka","nd_search_manger_1_dialog_sure"),e.find(".dialog-title .close").attr("ka","nd_search_manger_dialog_close"),e.find(".dialog-layer").attr("ka","nd_search_manger_dialog_layer"),e.find(".search-prop-form .dropdown-menu li").on("click",function(){e.find(".btn-sure").attr("ka","nd_search_manger_"+$(this).attr("data-val")+"_dialog_sure")})},onConfirm:function(e){$.toast({content:"申请已发送",type:"success"}),e.remove()},onClose:function(e){}})}),Search.goInitSearch()},goInitSearch:function(){var e=$(window.parent.document).find(".geeksearch-container .frame-container").attr("src");-1!=e.indexOf("jobId")&&($("#container").addClass("search-result-model"),Search.para.jobId=e.split("=")[1],Search.getData(1,{source:5}))},suggestKeywords:function(e){Search.xhrs=$.get("/boss/search/suggest.json?query="+e).success(function(e){e.rescode})},keywordLibrary:function(){var e=[],t=function(){Search.getData(1)},i=function(){localStorage.setItem("__Search_input_tip","1")},a=function(){return"1"!=localStorage.getItem("__Search_input_tip")&&e.length<2};addHint=function(){$(".search-query .query-input-wrap").append('<div class="input-tip">可以继续输入关键词<a href="javascript:">知道了</a><i></i></div>')},addEl=function(e){var t={jobs:"职位",skills:"技能",schools:"院校",companies:"公司",keywords:"关键词"};$(".query-input").val(""),$(".suggest-result").hide();var i=t[e.type],a=e.from?"data-from="+e.from:"",n="<li "+a+"><em>"+i+"</em>"+e.description+'<i class="icon-search-close" title="移除"></i></li>';Search.queryEl.find(".query-keywords ul").append(n)};var n=function(i){a()&&addHint(),e.length<20?(addEl(i),e.push(i),t()):$.toast({type:"info",content:"最多添加20个关键词"})},s=function(){var t=function(t){var i=e.filter(function(e){return e.type==t});return function(){var e=[];return $.each(i,function(t,i){i.from||e.push(i.description)}),e}};return{jobs:t("jobs")(),skills:t("skills")(),schools:t("schools")(),companies:t("companies")(),keywords:t("keywords")(),total:e.length}},o=function(t){return t&&($.each(t,function(e,t){addEl(t)}),e=e.concat(t),a()&&addHint()),s()};return $(".query-keywords").on("click",".icon-search-close",function(){var i=$(this).parent("li"),a=i.index();i.attr("data-from")&&(Search.para.lastJobId=Search.para.jobId,Search.para.jobId=""),i.remove(),e.splice(a,1),t()}),$(".search-query").hover(function(){$(".query-keywords li").length<2&&$(".search-query .input-tip").fadeIn(150),$(".search-query .query-mask").fadeOut(150)},function(){$(".search-query .input-tip").fadeOut(150),$(".search-query .query-mask").fadeIn(150)}),$(".search-query").on("click",".input-tip a",function(){i(),$(".search-query .input-tip").remove()}),{add:n,data:o}}(),setFilterCity:function(){var e=function(e){var t=$(".search-city-pop .searchcitybox>div").not(".tabs");$(".search-city-pop .tabs .cur").removeClass("cur"),$(".search-city-pop .tabs a").eq(e).addClass("cur"),t.hide(),t.eq(e).show()};$.dialog({title:"",content:$(".searchcitybox").prop("outerHTML"),confirmText:!1,cancelText:!1,wrapClass:"search-city-pop",inline:!1,onOpen:function(t){e(0),t.on("click",".zm a",function(){Search.filterSprite.setCity({code:$(this).attr("data-val"),name:$(this).text()}),t.remove(),Search.getData(1)}),t.on("click",".tabs a",function(){e($(this).index())})},onConfirm:function(e){},onClose:function(){}})},filterSprite:ConditionSprite(),showCancelFilter:function(){var e=Search.syncContainer.find(".sel-filter");e.find(".filter-cancel").remove(),e.prepend('<span class="filter-cancel" ka="search_filter_cancel"><i class="icon-category-filter"></i>取消筛选</span>'),e.find(".dropdown-select").html("&nbsp;")},cancelFilter:function(e){var e=e;e.parent().find(".dropdown-filter").find(".dropdown-select").html('<span class="dropdown-select"><i class="icon-category-filter"></i>筛选</span>'),e.remove(),Search.revertFilter(),Search.getData(1)},revertFilter:function(){Search.syncContainer.find(".condition-filter a").removeClass("cur"),Search.syncContainer.find(".filter-cancel").remove(),Search.syncContainer.find(".dropdown-filter .dropdown-select").attr("ka","search_filter"),Search.syncContainer.find(".dropdown-filter .dropdown-select").html('<i class="icon-category-filter"></i>筛选'),Search.syncContainer.find(".condition-filter dd").each(function(){$(this).find("a").eq(0).addClass("cur")}),Search.para.page=0,Search.para.salary=0,Search.para.experience=0,Search.para.degree=0},showNextResume:function(){if(""!=Search.nowResume){var e=Search.nowResume.parents("li").next("li");0!=e.length?Search.showPopResume(e.find("a")):($(window.top.document).find("#toast").remove(),window.top.$.toast({content:"已经是最后一份简历了",type:"info"}))}},showPrevResume:function(){if(""!=Search.nowResume){var e=Search.nowResume.parents("li").prev("li");0!=e.length?Search.showPopResume(e.find("a")):($(window.top.document).find("#toast").remove(),window.top.$.toast({content:"已经是第一份简历了",type:"info"}))}},showPopResume:function(e){Search.nowResume=e;var e=(Search.para,e),t=e.attr("data-url")||e.attr("href"),i=e.attr("data-contact"),a=(e.find(".btn-getvipcontact").attr("data-isvip"),e.find(".item-operate .btn-chat").length>0);window.top.$("#toast").remove(),window.top.$.toast({content:"正在加载简历...",type:"loading",parentWrap:window.top.document.body});var n=function(t){var n={title:"",content:t,closeText:!0,closeLayer:!1,wrapClass:"dialog-layer-full dialog-resume-full",lock:!0,onOpen:function(t){var i=t.find(".resume-item.certificate-item");i.height()>60&&(i.addClass("fold"),i.find(".view-more").on("click",function(){i.toggleClass("fold").toggleClass("unfold")})),t.find(".dialog-footer .btns").html(e.find(".item-operate").html()),t.find(".next-btn").on("click",function(){Search.showNextResume()}),t.find(".prev-btn").on("click",function(){Search.showPrevResume()}),t.on("click",".dialog-footer .btn-getcontact",function(){var i="."+$(this).attr("class").split(" ").join(".");e.find(i).click(),t.remove()}),t.find(".resume-lock").length&&t.find(".dialog-footer").hide(),t.find(".show-item").on("click",function(){$(this).hide(),$(this).parents(".item-container").addClass("item-all")}),t.find(".btns .btn-getvipcontact, .btns .btn-continue").on("click",function(){"0"==$(this).attr("data-isvip")?window.top.Commercial.vip({sf:14},function(){e.find(".btn-getvipcontact").attr("data-isvip","1"),e.trigger("click"),Search.nowResume="",$("#container").hasClass("search-result-model")&&($(".nav-info").html("<span>您已开通VIP账号，匿名牛人已全部解锁</span>").unbind("click"),Search.getData(1),$(".search-query .prop-buy").remove())}):"1"==$(this).attr("data-isvip")&&($(this).hasClass("btn-continue")?SearchGeekModified.continueChat($(this)):SearchGeekModified.greetChat(e,$(this)))}),t.find(".dialog-con").on("click",function(e){$(e.target).parents(".dialog-con").length||t.remove()}),$.ajax({method:"post",url:"/actionLog/search/geek/click.json",data:{city:Search.para.city,filterString:Search.formatFilterStr,geekId:e.attr("data-suid"),lid:e.attr("data-lid"),itemId:e.attr("data-itemid")},cache:!1,success:function(e){},error:function(){}})},onConfirm:function(t){1==i&&propInit.init({suid:e.attr("data-suid")||"",lid:e.attr("data-lid")||"",el:e,card:t.find(".btn-getcontact").hasClass("btn-chat")?"chat":"call"}),t.remove()}};a&&e.find(".item-operate .btn-getcontact").not(".btn-chat").length&&(n.onCancel=function(t){propInit.init({suid:e.attr("data-suid")||"",lid:e.attr("data-lid")||"",el:e,card:"call"}),t.remove()}),window.top.$.dialog(n)};$.get(t).success(function(e,i,a){var s;s="error"==i?'<div class="data-tips"><div class="data-blank"><i class="tip-errordata"></i><b>数据加载出错</b></div></div>':e,setTimeout(function(){if(window.top.$("#toast").remove(),$(s).find(".capcha-box").length)return void(window.top.location.href=t);s="<div class='prev-btn'></div><div class='next-btn'></div><div class=\"resume-dialog\">"+s+"</div>",lock=$(s).find(".block-intro img"),blockCode=lock.length?lock.attr("data-code"):"";var e;if($(s).find("input[name='ba']").length>0&&(e=window.top.Block.formatBA($(s).find("input[name='ba']").val()),window.top.Block.action(e)),SearchGeekModified.viewBlock(s))return!0;if($(s).find("input[name='vipPriceId']").length>0){var i=$(s).find("input[name='vipPriceId']").val(),a={sf:4,vipPriceId:i},o={title:"今日总查看数已达上限",description:$(s).find(".block-intro").text(),confirm:function(e){window.top.Purchase.vip({amount:e.pay,priceId:i},e),e.ba&&window.top.Block.action(window.top.Block.formatBA(e.ba)),window.top.__conversion("candidate_view_purchase_vip")}};return window.top.Block.vip(a,o),window.top.__conversion("candidate_view_vip"),!0}if($(s).find("input[name='jobId']").length>0){var r=$(s).find("input[name='view']").val(),c=$(s).find("input[name='employ']").val();return window.top.Upgrade.render({ba:e,content:s,jobId:$(s).find("input[name='jobId']").val(),priceId:$(s).find("input[name='priceId']").val(),restDays:$(s).find("input[name='restDays']").val(),targetId:$(s).find("input[name='targetId']").val(),targetType:$(s).find("input[name='targetType']").val(),pay:$(s).find("input[name='beanCount']").val(),business:$(s).find("input[name='business']").val(),positionName:$(s).find("input[name='positionName']").val(),view:-1==r?"无上限":r+"人",employ:-1==c?"无上限":c+"人"}),!0}$(s).find(".BlockLock").length>0?window.top.Block.confirm({content:s,ka:"block_detail_"+$(s).find(".BlockLock").attr("data-code")}):n(s)},500)}).error(function(e){5003==e.status?window.top.$("#toast").remove():window.top.$.toast({content:"请求错误"})})},searchCardChat:function(e,t){},continueChat:function(e){var e=e,t=e.attr("data-uid"),i=e.attr("data-eid"),a=e.attr("data-jid"),n=e.attr("data-expect");localStorageInstance("search-pos",$(document).scrollTop()),window.top.Chat.toggleUser({uid:t,eid:i,jid:a,expectId:n})},greetChat:function(e,t){var i="",a={gids:[],jids:[],expectIds:[]};if(e.each(function(){a.gids.push($(this).attr("data-uid")),a.jids.push($(this).attr("data-jid")),a.expectIds.push($(this).attr("data-expect"))}),!a.gids.length||!a.jids.length||!a.expectIds.length)return!1;t.addClass("disabled"),$.ajax({type:"POST",url:"/chat/batchAddRelation.json",dataType:"JSON",cache:!1,data:{gids:a.gids.join(","),jids:a.jids.join(","),expectIds:a.expectIds.join(",")},success:function(t){var a,t=t,n=0,s=_PAGE.uid+"-greet-edit";1==t.rescode?(t.data?(a=t.data,n=a[0].greetingTip):n=t.greetingTip,i=a?a[0].greeting:t.greeting,n?window.top.$.confirm({animation:"top",content:'<div class="default"><div class="tip-tit"><span>已向牛人发送招呼</span><a href="javascript:;" ka="'+s+'" class="fr edit">编辑</a></div><div class="tip-con">'+i+"</div></div> ",title:!1,confirmButton:"知道了",cancelButton:!1,columnClass:"pop-default",onOpen:function(){var e=this;e.$content.find(".edit").on("click",function(){0==e.$content.find(".auto-tip").length?e.$content.append('<div class="auto-tip">如需修改打招呼内容，请在【招聘设置-设置打招呼语】页面修改</div>'):e.$content.find(".auto-tip").show()}),e.$body.find(".buttons").prepend('<div class="op-text"><label class="checkbox"><input type="checkbox" name="notip"><span></span>不再显示</label></div>')},confirm:function(){this.$body.find('input[name="notip"]:checked').length&&$.ajax({type:"POST",url:"/chat/closegreetingtip.json",dataType:"JSON",data:null,success:function(e){}})},onClose:function(){},error:function(e){}}):window.top.$.confirm({animation:"top",content:'<div class="tip-content"><h4>打招呼成功</h4></div></div> ',title:!1,confirmButton:"知道了",cancelButton:!1,autoClose:"confirm|3000",columnClass:"pop-tip",confirm:function(){}}),e.parent().find(".btn-greet").each(function(){var e=$(this).attr("ka").replace("nd_","chat_");$(this).attr("ka",e)}),e.parent().find(".btn-greet").removeClass("btn-greet").removeClass("disabled").addClass("btn-continue").text("继续沟通"),e.attr("data-chat","1"),e.parent().find(".checkbox").remove(),"preview"==Search.type&&(Search.listWrap.find(".detail-bottom .btn-greet").removeClass("btn-greet").each(function(){var e=$(this).attr("ka").replace("nd_","chat_");$(this).attr("ka",e)}),Search.listWrap.find(".detail-bottom .btn-greet").removeClass("btn-greet").removeClass("disabled").addClass("btn-continue").text("继续沟通"))):window.top.$.toast({content:t.resmsg,type:"error"})},error:function(e){window.top.$.toast({content:"系统或网络故障，请稍后再试",type:"error"})}})},jobToKeyword:function(e){var t=["city","experience","degree","salary","gender","applyStatus"],i={};$.each(t,function(t,a){e[a]&&(i[a]=e[a])}),1==Search.para.page&&Search.filterSprite.data(i),e.jobtext&&!$(".query-keywords li[data-from=jobId]").length&&Search.keywordLibrary.data([{type:"jobs",description:e.jobtext,from:"jobId"}])},getData:function(e,t){var i=$.extend({source:1},t),a=Search.keywordLibrary.data(),n=Search.filterSprite.data();if(!a.total&&!Search.para.jobId)return Search.listCon.empty(),Search.listMoreEl.hide(),Search.syncContainer.addClass("search-result-model"),Search.tipsContainer.html('<div class="data-blank"><i class="tip-nodata"></i><b>搜索 职位、公司、学校、技能</b></div>').show(),!1;e?(Search.para.page=1,$.toast({content:"正在加载数据",type:"loading"}),Search.listWrap.find(".user-list").hide(),Search.listWrap.find(".detail-box").hide()):Search.para.page++,Search.isLoading=!0,Search.listMoreEl.addClass("disabled"),Search.listMoreEl.text("正在加载中...");var s;s="-2,-2"===n.experience||"-2,0"===n.experience||"0,0"===n.experience?"":n.applyStatus;var o;o="-2,-2"===n.experience?"":n.salary,$.ajax({type:"GET",url:"/boss/search/geeks.json",dataType:"JSON",cache:!1,data:{page:Search.para.page,source:i.source,jobId:Search.para.jobId,jobs:a.jobs.join(","),companies:a.companies.join(","),skills:a.skills.join(","),schools:a.schools.join(","),keywords:a.keywords.join(","),salary:o,experience:n.experience,degree:n.degree,returnees:n.returnees,applyStatus:s,city:$(".search-query").is(":visible")?n.city:"",schoolLevel:n.schoolLevel,age:n.age},success:function(t){var t=t,i="";if(1==t.rescode){if(!Search.queryEl.find(".query-city .selected").length&&t.city&&Search.filterSprite.setCity({code:t.city,name:t.cityName}),""==t.htmlList){if(e&&($(".search-query .query-keywords li").length&&Search.tipsContainer.html('<div class="data-blank"><i class="tip-nodata"></i><b>换个关键词试试？</b></div>').show(),Search.listCon.empty(),Search.syncContainer.addClass("search-result-model"),$(".link-manger-apply").length))try{_T.sendEvent("nd_search_manger_show_pv")}catch(e){}}else i+=t.htmlList,e?(Search.listCon.html(i),Search.nowResume=Search.listCon.find("li").eq(0).find("a")):Search.listCon.append(i),Search.tipsContainer.html("").hide(),t.isRcdGeek?Search.listContainer.find(".search-crumbs span").show():Search.listContainer.find(".search-crumbs span").hide(),"list"==Search.type&&Search.batchCheckCon.is(":visible")&&Search.listWrap.find(".btn-greet").closest("li").find(".checkbox").show();if(Search.syncContainer.addClass("search-result-model"),1==t.hasMore?Search.listMoreEl.removeClass("disabled").text("加载更多").show():Search.listMoreEl.addClass("disabled").text("没有更多了").show(),e&&Search.listCon.find("li").length<10&&Search.listMoreEl.hide(),e&&(window.scrollTo(0,0),$(".suggest-result").hide(),Search.searchBox.find(".icon-search-clear").hide(),setTimeout(function(){$("#toast").addClass("slideup"),setTimeout(function(){$("#toast").remove()},500)},500),$(".query-input-wrap").append($(".suggest-result")),$(".search-query").show()),Search.jobToKeyword(t),$(".link-manger-apply").length)try{_T.sendEvent("nd_search_manger_show_pv")}catch(e){}}else{var a={5001:"访问频繁，请稍后重试",5003:"访问频繁，请稍后重试"};$.toast({type:"error",content:a[t.rescode]||t.resmsg})}Search.isLoading=!1},error:function(t){Search.listMoreEl.removeClass("disabled").text("数据加载出错").show(),Search.isLoading=!1,e&&(Search.listMoreEl.hide(),$.toast({content:"数据加载出错",type:"error"}),Search.para.companies=[],Search.para.jobId="",Search.para.jobs=[],Search.para.keywords=[],Search.para.schools=[],Search.para.skills=[],Search.para.condition=[],$(".condition-box").find("li").html(""))}});try{_T.sendEvent("submit_search_"+Search.para.page,"jobs="+a.jobs.join(",")+"|companies="+a.companies.join(",")+"|skills="+a.skills.join(",")+"|schools="+a.schools.join(",")+"|salary="+n.salary+"|experience="+n.experience+"|degree="+n.degree+"|keywords="+a.keywords.join(",")+"|city="+n.city)}catch(e){}},suggest:function(e){var e=e,t=e.val().replace(/(^\s*)|(\s*$)/g,""),i=$(".suggest-result"),a=i.find(".suggest-job ul"),n=i.find(".suggest-company ul"),s=i.find(".suggest-skill ul"),o=i.find(".suggest-school ul"),r=i.find(".suggest-keyword ul");if(""==t)return i.hide(),Search.syncContainer.hasClass("search-result-model")&&(e.parent().find(".btn-search").show(),e.parent().find(".icon-search-clear").hide()),void(Search.hasSlected=!1);$.ajax({type:"GET",url:"/boss/search/suggest.json",dataType:"JSON",cache:!1,data:{query:t},success:function(e){var c,l,d,u,p,e=e,h="",f="",m="",g="";if(1==e.rescode){if(c=e.jobs,l=e.companies,d=e.schools,u=e.skills,$.isArray(c))for(p=0;p<c.length;p++)f+='<li><span class="name">'+c[p].hlname+"</span></li>";if($.isArray(l))for(p=0;p<l.length;p++)h+='<li><span class="name">'+l[p].hlname+"</span></li>";if($.isArray(d))for(p=0;p<d.length;p++)m+='<li><span class="name">'+d[p].hlname+"</span></li>";if($.isArray(u))for(p=0;p<u.length;p++)g+='<li><span class="name">'+u[p].hlname+"</span></li>";""==h&&""==f&&""==m&&""==g||i.show(),""!=f?a.html(f).closest("dl").show():a.html("").closest("dl").hide(),""!=h?n.html(h).closest("dl").show():n.html("").closest("dl").hide(),""!=m?o.html(m).closest("dl").show():o.html("").closest("dl").hide(),""!=g?s.html(g).closest("dl").show():s.html("").closest("dl").hide(),r.html('<li><span class="name"><em class="text-blue">'+t+"</em></span></li>").closest("dl").show()}Search.isLoading=!1,Search.hasSlected=!1},error:function(e){Search.isLoading=!1}})},hightLight:function(e,t){var t=t.replace(/(^\s*)|(\s*$)/g,"");if(""==t)return e;var i=t;return e.replace(t.toLowerCase(),'<em class="text-blue">'+i+"</em>").replace(t.toUpperCase(),'<em class="text-blue">'+i+"</em>")},addInput:function(e){var e=e,t="";e&&(t=e.find(".name").text(),Search.searchBox.find(".suggest-result").find("li").removeClass("cur"),e.addClass("cur"),Search.searchBox.find(".ipt-search").val(t)),Search.hasSlected=!0,Search.addTag()},addTag:function(){var e=Search.searchBox.find(".suggest-result li.cur"),t=e.find(".name").text(),i=$(".condition-box"),a="",n="";if(typeLabel="",arrType=[],""==Search.searchBox.find(".ipt-search").val())return void Search.searchBox.find(".ipt-search").focus();if(Search.hasSlected){switch(e.length||(a="关键词",n="keyword",t=Search.searchBox.find(".ipt-search").val().replace(/(^\s*)|(\s*$)/g,""),arrType=Search.para.keywords),e.closest("dl").attr("class")){case"suggest-job":a="职位",n="job",arrType=Search.para.jobs;break;case"suggest-company":a="公司",n="company",arrType=Search.para.companies;break;case"suggest-school":a="院校",n="school",arrType=Search.para.schools;break;case"suggest-skill":a="技能",n="skill",arrType=Search.para.skills;break;case"suggest-keyword":a="关键词",n="keyword",arrType=Search.para.keywords}if($.inArray(t,arrType)>-1)return $.toast({content:"该"+a+"名称已经存在了",type:"error"}),void Search.searchBox.find(".suggest-result").hide();arrType.push(t),Search.para.condition.push({type:n,name:t}),1==arrType.length?typeLabel=a:typeLabel="",i.find('li[data-type="'+n+'"]').append('<span data-type="'+n+'">'+typeLabel+'<em class="text-blue">'+t+'</em><i class="icon-search-close" title="移除"></i></span>'),Search.searchBox.find(".suggest-result").hide(),Search.searchBox.find(".ipt-search").val("").blur(),Search.searchBox.find(".icon-search-clear").hide(),Search.syncContainer.hasClass("search-result-model")&&Search.searchBox.find(".btn-search").show(),i.find(".icon-search-close").length>1&&i.find(".icon-search-close").css("display","inline-block"),Search.getData(1)}},autoCompleteTag:function(e,t){if(""==$.trim(t))return!1;var i,a=$(".condition-box"),n="",s=t.split(","),t="";switch(e){case"job":n="职位";break;case"company":n="公司";break;case"school":n="院校";break;case"skill":n="技能";break;case"keyword":n="关键词";break;case"jobtext":n="职位条件"}for(i=0;i<s.length;i++)t+='<span data-type="'+e+'">'+(0==i?n:"")+'<em class="text-blue">'+s[i]+'</em><i class="icon-search-close" title="移除"></i></span>';a.find('li[data-type="'+e+'"]').html(t),a.find(".icon-search-close").length>1&&a.find(".icon-search-close").css("display","inline-block")},removeTag:function(e){var t,e=e,i=e.parent().attr("data-type"),a=e.closest(".condition-box"),n=[],s="";switch(i){case"job":n=Search.para.jobs,s="职位";break;case"company":n=Search.para.companies,s="公司";break;case"school":n=Search.para.schools,s="院校";break;case"skill":n=Search.para.skills,s="技能";break;case"keyword":n=Search.para.keywords,s="关键词";break;case"jobtext":n=Search.para.jobtext,Search.para.jobId="",s="职位条件"}for(t=0;t<n.length;t++)n[t]==e.parent().find(".text-blue").text()&&n.splice(t,1);"jobtext"==i&&Search.syncContainer.find(".city-sel").removeClass("disabled"),$.each(Search.para.condition,function(t,a){a&&a.type==i&&a.name==e.parent().find(".text-blue").text()&&Search.para.condition.splice(t,1)}),Search.getData(1),0==e.parent().index()&&e.closest("li").find("span").eq(1).prepend(s),e.parent().remove(),1==a.find(".icon-search-close").length&&a.find(".icon-search-close").hide()},geContact:function(e,t){var e=e,i=t.attr("data-suid")||"",a=t.attr("data-lid")||"";$.ajax({method:"get",url:"/wapi/zpitem/web/userItem/jobList.json",dataType:"json",success:function(n){if(0===n.code){var s,o="",r=n.zpData.jobList,c="";for(var l in r)0==l&&(o="<dt><p><span>"+r[l].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>"+r[l].locationName+"</span><span>"+r[l].salaryDesc+'</span></p><span class="on"><i></i></span><input type="hidden" value="'+r[l].encryptId+'"/></dt>'),c+='<li data-val="'+r[l].encryptId+'"><span>'+r[l].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>"+r[l].locationName+"</span><span>"+r[l].salaryDesc+"</span></li>";c="<dd><ul>"+c+"</ul></dd>",s='<div class="select-list"><dl>'+o+c+"</dl></div>",$.confirm({content:'<div class="prop-layer">选择职位'+s+"</div>",title:!1,closeIcon:!1,cancelButton:"取消",cancelButtonClass:"btn btn-slight",confirmButton:"下一步",confirmButtonClass:"btn btn-next",buttonsReverse:!0,columnClass:"pop-stage prop-pop",title:'<img src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',onOpen:function(){this.$content.find(".select-list dl").DIYSelect({listSelector:"dd li",listCallback:function(e,t,i){var a=$(this).find("span");$show=$(i).find("dt p"),$show.find("span:eq(0)").text(a.eq(0).text()).end().find("span:eq(1)").text(a.eq(1).text()).end().find("span:eq(2)").text(a.eq(2).text())}}),this.$confirmButton.attr("ka","next_search_meritem_"+i)},confirm:function(){var n=this;if(n.$content.find(".select-list").length>0){var s=(n.$content.find(".select-list dl dt span:eq(0)").text(),n.$content.find(".select-list dl dt input:hidden").val()),o=(Search.para,Search.formatFilterStr());$.ajax({method:"get",url:"/boss/item/useGeekInfoRight/"+s+".json",data:{suid:i,lid:a,city:Search.para.city,filterStr:o},success:function(a){if(1==a.rescode)if(0==a.itemCount)n.$content.html('<div class="prop-text">您需要使用牛人道具，来联系牛人。<a class="link-toshop" href="/boss/item/myItemList.html?tab=mall" ka="link_search_meritem_'+i+'">立即去商城购买</a><div>'),n.$confirmButton.attr("ka","know_search_meritem_"+i).html("知道了");else{n.$content.html('<div class="prop-text"><h4>牛人电话使用成功</h4><p>直直已开始为您联系该牛人，牛人同意后会发送电话号码和简历给您。</p><p>如果该牛人拒绝联系或2天内无回复，道具将退还给您。</p><div>'),e.removeClass("btn-getcontact").addClass("disabled").text("联系中").removeAttr("ka"),t.attr("data-contact","0"),e.parent().find(".gray").text("道具使用成功，直直正在帮您联系牛人"),n.$confirmButton.attr("ka","close_search_meritem_"+i).html("关闭");try{_T.sendEvent("success_search_meritem_"+i,"")}catch(e){}}else n.content=a.resmsg;n.$cancelButton.hide(),n.$confirmButton.on("click",function(){n.close()}),n.$content.find(".link-toshop").on("click",function(e){$(window.top.document).find(".side-menu dl").removeClass("cur"),$(window.top.document).find(".side-menu .menu-prop").addClass("cur")})}})}return!1}})}}})},renderPreview:function(e,t){var e=e,i=e.attr("href"),a=e.attr("data-contact");e.closest("ul").find("li").removeClass("cur"),e.parent().addClass("cur"),$(".resume-container").load(i,function(){var i=Search.listContainer.find(".detail-box .detail-bottom .btn");1==a?i.removeClass("disabled").addClass("btn-getcontact").text("联系Ta").attr("ka","nd_search_prw_"+e.attr("data-suid")):i.removeClass("btn-getcontact").addClass("disabled").text("联系中").removeAttr("ka"),Search.listContainer.find(".detail-box").show(),Search.listContainer.find(".data-tips").hide(),Search.listContainer.find(".chat-wrap").show(),Search.listContainer.find(".resume-container").show(),t||$(window).scrollTop(Search.listContainer.find(".resume-container").offset().top)})},scrollVisiable:function(e,t){var i=$(".suggest-result"),a=i.find("li").eq(e),n=i.find("li").length,s=7;if(Search.syncContainer.hasClass("search-result-model")&&(s=9),!a)return!1;var o=e,r=o>s?o-s:0,c="down"==t&&(r<n-s||0===o),l="up"==t&&(o<n-s-1||o==n);"up"==t&&(r=o),(l||c)&&i.scrollTop(r*$(a).outerHeight())},showBatchGuide:function(){$("body").addClass("show-batch-layer"),localStorage.setItem("batch-contact-guide",1);try{_T.sendEvent("nd_search_batch_help_show")}catch(e){}},addBatchHistory:function(e){var t=$(".search-contact-history .figure-list"),i=$(".search-contact-history .btn"),a=e.closest("li"),n=a.find("a").attr("data-suid");if(t.find('img[data-suid="'+n+'"]').length)t.find('img[data-suid="'+n+'"]').remove(),e.removeClass("disabled").text("+ 批量联系"),i.attr("ka","nd_search_contact_btn_"+t.find("img").length),i.find("em").html(t.find("img").length+"/10");else{if(t.find("img").length>9)return void $.toast({content:"最多可以选择10位牛人",type:"warning"});t.append('<img src="'+a.find(".figure img").attr("src")+'" data-suid="'+n+'" alt="" />'),e.addClass("disabled").text("已添加"),i.attr("ka","nd_search_contact_btn_"+t.find("img").length),i.find("em").html(t.find("img").length+"/10")}},showBatchConfirm:function(e){var t=$(".search-contact-history .figure-list"),i=t.html(),a=t.find("img").length,n=10-a;$.dialog({title:"",content:'<div class="search-batch-dialog"><div class="figure-list">'+i+'</div><div class="tip-text">已选 <span class="num">'+a+'</num> 位牛人，您还可以再选择 <span class="lave">'+n+'</num> 位</div><div class="text"><p><span class="text-blue">十选一：</span>支付¥60，一次性向十位牛人发起邀约，第一位回复您的牛人，自动获得手机和简历</p><p><span class="text-blue">可追加：</span>后续回复您的牛人，如需要追加¥60即可获得一位牛人的手机和简历</p><p><span class="text-blue">无效退款：</span>如2天内无任何牛人回复您的邀约，你支付的 ¥60将自动退款</p></div><div class="btns"><button type="button" class="btn" ka="nd_search_contact_batch_'+a+'">联系牛人 ￥60</button><span class="gray">帮助邮箱：<a href="mailto:zhanglei@kanzhun.com">zhanglei@kanzhun.com</a></span></div></div>',confirmText:"提交",cancelText:"取消",closeText:!0,element:e,wrapClass:"dialog-search-batch",lock:!0,onOpen:function(e){a>9&&e.find(".search-batch-dialog .tip-text").hide(),e.find(".dialog-footer").hide(),e.find(".search-batch-dialog .btns .btn").on("click",function(){t.html(""),$(".search-contact-history .btn").attr("ka","nd_search_contact_btn"),$(".search-contact-history .btn em").html("0/10"),$(".search-card .info-footer .btn-batch-contact").text("+ 批量联系").removeClass("disabled"),$.dialog({title:"",content:'<div class="tip-text">该功能内测中，今日测试名额已满。正式发布后，我们会第一时间通知您，非常抱歉。</div>',confirmText:"关闭",cancelText:"",closeText:!0,wrapClass:"dialog-search-batch",lock:!0,onOpen:function(e){e.find(".dialog-container").css({"margin-top":"-100px"})},onConfirm:function(e){e.remove()}})})},onConfirm:function(e){},onClose:function(e){}})},prop:function(){var e=$(".search-query .prop-own i");return{add:function(t){var i=parseInt(e.text(),10),a=parseInt(t,10);e.text(i+a)},consume:function(){var t=parseInt(e.text(),10);t>0&&e.text(t-1)},count:function(){$.get("/wapi/zpitem/web/userItem/isShowAndItemCount.json",function(e){var t=e.zpData;t="string"==typeof t?$.parseJSON(t):t,Search.queryEl.find(".panel-call .item-left-count span").text(t.itemCount),Search.queryEl.find(".panel-chat .item-left-count span").text(t.allSearchChatCount),Search.listContainer.find(".item-operate").each(function(e,i){var a=$(i),n=a.parent("a"),s=a.find(".btn-getvipcontact"),o=t.searchChatCount>0||s.length,r={uid:n.attr("data-uid"),lid:n.attr("data-lid"),suid:n.attr("data-suid")};if(!a.find(".btn.disabled").length){if(!o)return a.html('<button type="button" class="btn btn-getcontact" data-uid="'+r.uid+'" data-lid="'+r.lid+'" ka="nd_search_lstvip_'+r.suid+'">联系Ta</button>'),!0;var c=[];(t.itemCount>0||0==s.attr("data-isvip"))&&1!=s.attr("data-isvip")&&$(".search-query .panel-call").length&&c.push('<button type="button" class="btn btn-outline btn-getcontact" data-uid="'+r.uid+'" data-lid="'+r.lid+'" ka="nd_search_lstvip_'+r.suid+'">牛人电话</button>'),a.find(".btn-getvipcontact").length&&c.push(a.find(".btn-getvipcontact").prop("outerHTML")),t.searchChatCount>0&&("1"==n.attr("data-elitegeek")?c.push('<button type="button" class="btn btn-getcontact btn-chat" data-lid="'+r.lid+'" ka="nd_search_lst_'+r.suid+'" data-uid="'+r.uid+'">搜索畅聊卡(2/'+t.searchChatCount+")</button>"):c.push('<button type="button" class="btn btn-getcontact btn-chat" data-lid="'+r.lid+'" ka="nd_search_lst_'+r.suid+'" data-uid="'+r.uid+'">搜索畅聊卡(1/'+t.searchChatCount+")</button>")),a.html(c.join(""))}})})}}}(),formatFilterStr:function(e){var t,i="";return t=e&&e.fromVueParams?e.fromVueParams:Search.keywordLibrary.data(),e&&e.jobId&&(i+="jid"+e.jobId),i+=[""].concat(t.jobs).join("j"),i+=[""].concat(t.companies).join("c"),i+=[""].concat(t.skills).join("s"),i+=[""].concat(t.schools).join("h"),i+=[""].concat(t.keywords).join("q"),i=i.replace(/^,+/,"").replace(/,+$/,"")}};$(function(){$.fn.extend({DIYSelect:function(e){var t=$.extend({listSelector:"dd>a",keepDefault:!1,listCallback:null,showCallback:null,hideCallback:null,clearValue:!1,hasSecond:!1,preventDefault:!0},e);this.each(function(i,a){var n=$(a),s=n.find('dt>[type="hidden"]');t.clearValue&&s.val(""),t.keepDefault||((t.hasSecond||n.hasClass("select-tree"))&&(t.listSelector=e&&e.listSelector?e.listSelector:"dd a",n.on("mouseenter","div.select-second-item",function(e){$(this).addClass("on")}).on("mouseleave","div.select-second-item",function(e){$(this).removeClass("on")})),n.on("click",t.listSelector,function(e){t.preventDefault&&e.preventDefault();var i=$(this);if(i.hasClass("select-opts-tt"))return e.stopPropagation(),!1;var a=n.find("dt>input:text, dt>input:button"),s=n.find("dd");a.val(i.html()),n.find('dt>[type="hidden"]').val(i.data("val")),t.listCallback&&t.listCallback.call(this,s,a,n,i.index())})),n.on("click","dt",function(e){e.preventDefault(),e.stopPropagation();var i=$(this).find("span"),a=n.find("dt>input:text, dt>input:button"),s=n.find("dd");$(document).trigger("click").one("click",function(){s.hide(),i.removeClass("on"),t.hideCallback&&t.hideCallback(s,a,n)}),i.addClass("on"),s.show(),t.showCallback&&t.showCallback.call(this,s,a,n)})})}}),Search.init()}),function(){var e=function(e,t){return t.replace(/<%([^%>]+)?%>/g,function(t,i){return e[i]})},t=function(){
return'<div class="prop-cont">        <h3>牛人电话</h3>        <p class="prop-cont-pay"><span class="fl">使用牛人电话道具联系牛人</span><span class="fr pay-num">￥60.00</span></p>        <ul class="intro-list">            <li>                <p>60直豆邀约一位牛人</p>使用1件牛人电话道具（60直豆）我们帮您邀约这位牛人            </li>            <li>                <p>邀约成功获得手机号＋简历 </p>牛人同意后，直接与对方沟通同时获得手机号和简历            </li>            <li>                <p>邀约失败自动退还 </p>如果牛人48小时内未同意您的邀约，道具将自动退还            </li>        </ul>    </div>'},i=function(e,a,n){var s=this,o=!1;s.transmit={},window.top.mediator.subscribe("searchDataSupplement",function(){Search&&Search.listCon&&Search.listMoreEl&&!Search.listMoreEl.hasClass("disabeld")&&Search.listCon.find("li").length<=12*Math.max(Search.para.page-1,1)&&Search.getData()}),window.top.mediator.subscribe("searchUsePropSuccess",function(e,t){var i=t.transmit;i.el.closest("li");"call"===t.cardType?window.top.mediator.publish("search_success_call",{action:"waiting",data:i}):"chat"===t.cardType&&window.top.SearchChatingCard.confirm({onClose:function(t,a){"cancel"==a&&window.top.Chat.toggleUser({uid:e.zpData.geekId}),window.top.mediator.publish("search_success_chat",{action:"delete_card",data:i}),t.remove()}});try{_T.sendEvent("search_list_nd_use_"+i.suid,"")}catch(e){}});var r=function(i){var a=s.transmit.itemCount>0?"联系牛人":"购买并联系牛人";e.confirm({content:t(),confirmButton:a,buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',onOpen:function(){this.$confirmButton.attr("ka","detail_search_prop_intro")},confirm:function(){s.transmit.itemCount>0||o?mediator.publish("PROP_INIT_END",s.transmit):mediator.publish("PROP_SELLS_INIT",s.transmit)}})},c=function(){var t={suid:s.transmit.suid,monitor:s.transmit.monitor?s.transmit.monitor:0,lid:s.transmit.lid,city:s.transmit.fromVueParams&&s.transmit.fromVueParams.city,filterStr:Search.formatFilterStr(s.transmit)};e.ajax({method:"get",url:"/wapi/zpitem/web/userItem/isShowAndItemCount.json",data:t,cache:!1,success:function(t){if(0!==t.code)return void e.toast({content:t.message,type:"error"});var i=t.zpData;i="string"==typeof i?e.parseJSON(i):i,s.transmit.itemCount=i.itemCount,s.transmit.searchChatCount=i.searchChatCount;var a=s.transmit.isElite;if(window.top.searchCardChatABGray){var n=s.transmit;return s.transmit.itemCount<1&&(n.card="chat"),void(n.el.find(".btn-getcontact").text().indexOf("联系Ta")>=0?mediator.publish("PROP_SELLS_INIT",s.transmit):window.top.CardChatProp&&window.top.CardChatProp.consumerCard({source:"search_connect_geek",transmit:n,cardType:n.card,success:function(e,t){window.top.mediator.publish("searchUsePropSuccess",e,t)},fail:function(t){0!==t.code&&e.toast({type:"warning",content:t.message})}}))}if(!i.isShow||o||i.canBuySearchCard){o=!1;var c=a?i.searchChatCount<2:i.searchChatCount<1;s.transmit.itemCount<1&&"call"===s.transmit.card||i.canBuySearchCard&&c?mediator.publish("PROP_SELLS_INIT",s.transmit):mediator.publish("PROP_INIT_END",s.transmit)}else r()}})};this.init=function(t){if(t&&(s.transmit=e.extend(s.transmit,t)),t.buyCount)return mediator.publish("PROP_INIT_END",s.transmit),!0;c()},i=function(){return s}},a=function(){var e=this,t=function(e){var t=$.Deferred();return $.ajax({method:"get",url:"/wapi/zpitem/web/userItem/jobList.json",dataType:"json",success:function(e){if(0===e.code){var i,a="",n=e.zpData.jobList,s="";for(var o in n)0==o&&(a="<dt><p><span>"+n[o].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>"+n[o].locationName+"</span><span>"+n[o].salaryDesc+'</span></p><span class="on"><i></i></span><input type="hidden" value="'+n[o].encryptId+'"/></dt>'),s+='<li data-val="'+n[o].encryptId+'"><span>'+n[o].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>"+n[o].locationName+"</span><span>"+n[o].salaryDesc+"</span></li>";s="<dd><ul>"+s+"</ul></dd>",i='<div class="select-list"><dl>'+a+s+"</dl></div>";var r='<div class="prop-layer prop-cont"><h3>待沟通职位：</h3>'+i+"</div>"}t.resolve(r,n)}}),t};this.render=function(){t().then(function(e,t){var i=0;$.confirm({content:e,confirmButton:"选择职位",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',onOpen:function(){this.$content.find(".select-list dl").DIYSelect({listSelector:"dd li",listCallback:function(e,t,a,n){i=n;var s=$(this).find("span");$(a).find("dt p").find("span:eq(0)").text(s.eq(0).text()).end().find("span:eq(1)").text(s.eq(1).text()).end().find("span:eq(2)").text(s.eq(2).text())}})},confirm:function(){this.$content.find(".select-list dt").eq(0);mediator.publish("PROP_SELECTED",t[i])}})})},PropSelectChange=function(){return e}},n=function(e,t,i){var a="chat"===i.card?"搜索畅聊卡":"牛人电话",n='<div class="prop-cont">        <h3>使用'+a+'道具联系牛人</h3><p class="gray">请选择与牛人沟通的职位</p><div class="dropdown-wrap J_stickPosition"><span class="dropdown-select"><i class="icon-select-arrow"></i><input type="text" placeholder="待沟通的职位" class="ipt" readonly="" /><p class="input-mask"></p><input type="hidden" class="" /></span><div class="dropdown-menu"><ul class="unfolded"><%for (var i=0;i<this.list.length; i++){%><li data-id="<%this.list[i].encryptId%>"><i class="space-letter"><%this.list[i].jobName%></i>|<i class="space-letter"><%this.list[i].salaryDesc%></i> |<i class="space-letter"><%this.list[i].locationName%></i> |<i class="space-letter"><%this.list[i].degreeName%></i> |<i class="space-letter"><%this.list[i].experienceName%></i></li><%}%></ul></div></div>    </div><button type="button" class="btn btn-next btn-mut-right" ka="next_search_meritem_af1929ef204341efCWzhi7vtgUH6gg~~">联系牛人</button>';return window.top.Utemplate(n,{list:t})},s=function(e,t){function i(e){return window.top.getQueryString("mu").indexOf("/vue/index/#/dashboard/candidate/recommend")>=0?u(e):d(e)}var n=this,o={},r=function(t){var i=e.Deferred();return e.get("/wapi/zpitem/web/geekInfoRight/getJobByGeekId.json?suid="+t).success(function(e){var t=e.zpData;i.resolve(t.job||{})}),i},c=function(){var t=e.Deferred();return e.get("/wapi/zpitem/web/userItem/jobList.json").success(function(e){t.resolve(e.zpData.jobList||[])}),t},l=function(){var t=e.Deferred(),i=Search.formatFilterStr(o),a="chat"===o.card?"/wapi/zpitem/web/searchChatCard/useCard":"/wapi/zpitem/web/geekInfoRight/use/"+o.job.encryptId;return e.ajax({method:"post",url:a,data:{suid:o.suid,lid:o.lid,encryptJobId:o.job&&o.job.encryptId,expectId:o.expectId,city:o.fromVueParams&&o.fromVueParams.city,securityId:o.securityId,filterStr:i},success:function(e){t.resolve(e)},complete:function(){window.top.$("#toast").length&&window.top.$("#toast").remove()}}),t},d=function(t){window.top.$("#toast").remove(),window.top.$.toast({content:"正在联系牛人...",type:"loading"}),e(".jconfirm .closeIcon").length>0&&e(".jconfirm .closeIcon").click();o.el.closest("li");l().then(function(e){if(0===e.code){Search.prop.count();var t;o.el.is("button")?(t=o.el,t.parents("li").find("a").attr("data-contact","0")):(o.el.attr("data-contact",0),t=o.el.closest("li").find(".btn-getcontact")),"chat"===o.card?window.top.SearchChatingCard.confirm({onClose:function(t,i){"cancel"==i&&window.top.Chat.toggleUser({uid:e.zpData.geekId}),window.top.mediator.publish("search_success_chat",{action:"delete_card",data:o}),t.remove()}}):"call"===o.card&&(mediator.publish("PROP_SELECT_END",e),window.top.mediator.publish("search_success_call",{action:"waiting",data:o}))}else"chat"===o.card&&0===e.code||mediator.publish("PROP_SELECT_END",e,o);try{_T.sendEvent("search_list_nd_use_"+o.suid,"")}catch(e){}})},u=function(t){window.top.$("#toast").remove(),window.top.$.toast({content:"正在联系牛人...",type:"loading"}),e(".jconfirm .closeIcon").length>0&&e(".jconfirm .closeIcon").click();var i=function(e){try{var t=Object.keys(e);if(!t.length)return e;for(var i={},a=0;a<t.length;a++){var n=t[a];if("el"===n)break;i[n]=e[n]}return i}catch(t){return e}};l().then(function(e){if(0===e.code){if("chat"===o.card)window.top.SearchChatingCard.confirm({onClose:function(t,a){"cancel"==a&&window.top.Chat.toggleUser({uid:e.zpData.geekId});var n=i(o);window.top.frames.syncFrame.postMessage({name:"card-chat-recommend-consume",data:n},"*"),t.remove()}});else if("call"===o.card){var t=i(o);mediator.publish("PROP_SELECT_END",e),window.top.frames.syncFrame.postMessage({name:"card-chat-recommend-consume",data:t},"*")}}else"chat"===o.card&&0===e.code||mediator.publish("PROP_SELECT_END",e,o)})},p=function(e,t){var i=t.filter(function(t){return t.encryptId==e});return i.length?t.indexOf(i[0]):0},h=function(n,s){e.confirm({content:t(n,s,o),confirmButton:!1,buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop search-props-job-select",confirmButtonClass:"btn btn-next btn-mut-right",cancelButtonClass:"btn-mut-left",title:"chat"===o.card?'<img class="card-joblist-prop-icon" src="https://img.bosszhipin.com/beijin/app/mobile/searchcard-7458d17f383e9a08c04965e49da3c239.png" alt="畅聊卡" class="title-icon">':'<img class="card-joblist-prop-icon" src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',onOpen:function(){this.$confirmButton=e(".search-props-job-select .btn-mut-right"),this.$confirmButton.attr("ka","next_search_meritem_"+o.suid),DropDown.init(this.$content),e(".J_stickPosition").on("dropdown.selected",function(){var t=e(".J_stickPosition .dropdown-menu .cur");e(".J_stickPosition").find(".input-mask").removeClass("text-placeholder").html(t.html());var i=p(t.attr("data-id"),s);o.job=s[i]}),e(".J_stickPosition .dropdown-menu li").eq(0).click(),e(".search-props-job-select .btn-mut-right").unbind("click").on("click",i)},cancel:function(e){e&&(new a).render()}})};mediator.subscribe("PROP_SELECTED",function(e){o.job=e,h(e)}),mediator.subscribe("PROP_INIT_END",function(t){o=e.extend({},t),e.when(r(t.suid),c()).then(function(e,t){if(t&&1===t.length)return o.job=e,void i();h(e,t),o.job=e})}),s=function(){return n}},o=function(t){return e(t,'<div class="prop-cont">        <div class="prop-end">            <p><%title%></p>            <%content%>         </div>    </div>')},r=function(e,t){var i=this,a=function(t,i){e.confirm({content:t,backgroundDismiss:!1,confirmButton:"关闭",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/succ.png" alt="牛人" class="title-icon">',confirm:function(){e(".search-resume").length>0&&e(".search-resume .icon-close").click()}})};mediator.subscribe("PROP_SELECT_END",function(e,t){a(0==e.itemCount||0!==e.code?o({title:"使用失败",content:e.message}):o({title:"使用成功",content:"正在为您联系该牛人，请耐心等待。若对方拒绝或在48小时内无回复，系统将退还牛人电话道具。"}))}),r=function(){return i}},c=function(t){return e(t,'<div class="prop-layer">    <div class="pay-title">        <span class="">使用微信扫码支付</span></div>    <div class="qrcode-area">        <img src="<%qrUrl%>" alt="二维码" class="loaded"></div>    <div class="pay-status-area">        <a href="javascript:" ka="search_list_nd_wxPay" class="status-btn">我已完成支付</a></div></div>')},l=function(e){var t=$.Deferred();return $.ajax({method:"get",url:"/boss/item/orderquery.json",data:{orderNo:e.orderNo,detailNo:e.detailNo},cache:!1,success:function(e){1==e.rescode&&t.resolve(e)}}),t},d=function(){var e=this,t=!1;this.render=function(e,i){$.confirm({content:c(e),confirmButton:!1,cancelButton:!1,buttonsReverse:!0,columnClass:"pop-stage prop-pop",title:'<img src="/v2/web/boss/images/layer/zhadan.png" alt="牛人" class="title-icon">',onOpen:function(){function a(){t&&l(e).then(function(e){1==e.payStatus?(n.close(),g.init({buyCount:!0}),_T.sendEvent(i.pka)):setTimeout(a,1500)})}t=!0;var n=this,s=this.$content;$(s).find(".status-btn").off("click").on("click",function(){var t=$(this);return"正在查询支付结果"!=t.text()&&(t.html('<i class="loader"></i>正在查询支付结果'),l(e).then(function(e){1==e.payStatus||t.html("您尚未支付成功，重新查询")}),!1)}),a()},onClose:function(){t=!1,clearTimeout(void 0)}})},d=function(){return e}},u=function(e,t,i,a,n){var s=$.Deferred(),o=t;o.pka=a;var r=function(){1!=o.block?g.init({buyCount:!0}):window.top.Payment.success({article:"道具购买成功",text:"您可以在「我的道具」中查看"}),_T.sendEvent(o.pka),Search.prop.count(),s.resolve()},c={1:"00600374da7d968b0XQ~",5:"8ec207f1048c76480XU~",10:"050bc25a6b5e08240XY~"},l={url:e,description:"购买道具：「牛人电话」- "+n+"个",amount:i,data:{buyCount:t.buyCount},itemId:c[n],success:r},d={success:r};return window.top.Payment.purchase(l,d),s},p=function(e){return window.top.Utemplate('<div class="prop-cont">        <div class="prop-sells">            <ul>                <li data-id="<%this.geekRights[0].id%>" data-pay="<%this.geekRights[0].price%>" data-count="1" ka="search_list_nd_packet_1" data-number="<%this.geekRights[0].count%>">                    <p class="fl">购买<%this.geekRights[0].count%>个牛人电话</p>                    <p class="fr text-orange">￥<%this.geekRights[0].price%>.00</p>                </li>                <li data-id="<%this.geekRights[1].id%>" data-pay="<%this.geekRights[1].price%>" data-count="1" ka="search_list_nd_packet_5" data-number="<%this.geekRights[1].count%>">                    <p class="fl">购买<%this.geekRights[1].count%>个牛人电话<i class="text-normal">（节省￥<%this.geekRights[1].economize%>）</i></p>                    <p class="fr text-orange">￥<%this.geekRights[1].price%>.00</p>                </li>                <li data-id="<%this.geekRights[2].id%>" data-pay="<%this.geekRights[2].price%>" data-count="1" ka="search_list_nd_packet_10" data-number="<%this.geekRights[2].count%>" class="selected hot">                    <p class="fl">购买<%this.geekRights[2].count%>个牛人电话<i class="text-normal">（节省￥<%this.geekRights[2].economize%>）</i></p>                    <p class="fr text-orange">￥<%this.geekRights[2].price%>.00</p>                </li>            </ul>            <div class="sells-pay">                <p class="fl"><span>金额：¥<%this.total%></span><span>余额：¥<%this.beanCount%></span></p>                <p class="fr">需要支付：<em class="text-orange">&nbsp;¥&nbsp;<%this.pay%></em></p>            </div>        </div>    </div>',e)},h=function(e,t,i){var a=this,n={},s=function(){var e=$.Deferred();return $.get("/wapi/zpitem/web/geekInfoRight/getGeekInfoRight.json").success(function(t){e.resolve(t.zpData)}),e},o=function(e){var t='<div class="prop-cont"><div class="prop-end"><p>购买成功</p><div>激活道具后30天内有效，到期后剩余沟通权限作废。'+(e.item?e.item.vipSaveText:"")+"</div></div></div>";$.confirm({content:t,confirmButton:"激活并使用",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/succ.png" alt="牛人" class="title-icon">',confirm:function(){if(this.close("confirm"),window.top.searchCardChatABGray)return void(window.top.CardChatProp&&window.top.CardChatProp.consumerCard({source:"search_connect_geek",transmit:e,cardType:"chat",success:function(e,t){window.top.mediator.publish("searchUsePropSuccess",e,t)},fail:function(e){0!==e.code&&$.toast({type:"warning",content:e.message})}}));mediator.publish("PROP_INIT_END",e)},cancel:function(){Search.prop.count()}})},r=function(){s().then(function(e){var e="string"==typeof e?$.parseJSON(e):e;return window.top.searchCardChatABGray?void window.top.SearchChatingCard.include({source:"search_connect_geek",left:n.itemCount,success:function(e){if(n=$.extend(n,e),e.isTipVipBuyChat){n.item.vipSaveText='<p class="vip-save-desc"><i class="vip-discount-sign"></i><span>为您节省</span><span class="vip-save-amount">¥40</span></p>'}else n.item.vipSaveText="";"chat"===n.card&&o(n),Search.prop.count()},transmit:n}):!(!0===n.block||!window.top.SearchChatingCard.include({source:"search_connect_geek",left:n.itemCount,data:e,success:function(e){n=$.extend(n,e),"chat"===e.card&&e.usableSearchItemCount>0?mediator.publish("PROP_INIT_END",n):"chat"===e.card?o(n):mediator.publish("PROP_INIT_END",n)}}))||void window.top.PropShop.geekPropCall.buy({success:function(e){1!=n.block?g.init({buyCount:!0}):window.top.Payment.success({article:"道具购买成功",text:"您可以在「我的道具」中查看"+e.vipSaveText}),window.top.mediator.publish("search_success_prop",{action:"buy",data:n}),Search.prop.add(n.amount)}})})};mediator.subscribe("PROP_SELLS_INIT",function(e){n=$.extend({},e),r()}),h=function(){return a}},f=function(t){return e(t,'<div class="prop-cont">        <div class="prop-sells-custom">            <div class="prop-layer">                <div class="niuren-buy">                    <ul>                      <li class="first">                        <span class="pull-left">输入购买数量</span>                        <div class="pull-right">                          <input maxlength="3" type="text" value="1" class="count">                          <span class="count-lower"></span>                          <span class="count-add"></span>                        </div>                      </li>                      <li class="money-item">                        <span class="pull-left">金额</span>                        <span class="pull-right money">￥60</span></li>                      <li class="balance-money-item">                        <span class="pull-left">直豆余额</span>                        <span class="pull-right balance-money">￥<%balance%></span></li>                      <li class="pay-money-item">                        <span class="pull-left">还需支付</span>                        <span class="pull-right orange pay-money">￥<%pay%></span></li>                    </ul>              </div>            </div>        </div>    </div>')},m=function(e,t){var i=this,a={};this.render=function(t,i,n){var s=t||0,o=parseInt(i,10),r="",c={balance:s,pay:Math.abs(t-o)};a=n,e.confirm({content:f(c),confirmButton:"确认购买",cancelButton:"取消",buttonsReverse:!0,columnClass:"pop-stage prop-pop",title:'<img src="/v2/web/boss/images/layer/zhadan.png" alt="牛人" class="title-icon">',onOpen:function(){var t=this.$content,i=e(t).find("input"),a=this;i.off("input").on("input",function(){var n=i.val(),c=n*o,l=s>c?0:c-s;e(t).find(".money").text("￥"+c),e(t).find(".pay-money").attr("data-pay",l).text("￥"+l),s>=c&&e(t).find(".pay-money-item").hide();var d=s>c?"search_list_nd_mall_"+n:"search_list_nd_mall_pay_"+n;a.$confirmButton.attr("ka",d),r="search_list_nd_mall_"+n}).trigger("input"),e(t).find(".count-lower").off("click").on("click",function(){var e=parseInt(i.val());e>1&&(e=--e,i.val(e).trigger("input"))}),e(t).find(".count-add").off("click").on("click",function(){var e=parseInt(i.val());e<1e3&&(e=++e,i.val(e).trigger("input"))}),0==s&&e(t).find(".balance-money-item").hide()},confirm:function(){var t=this,i=this.$content,n={amount:parseInt(e(i).find(".count").val()),buyCount:parseInt(e(i).find(".count").val())};n.block=a.block;var s=parseInt(e(i).find(".pay-money").attr("data-pay"),10);return u("/boss/item/buy/othItem/00600374da7d968b0XQ~.json",n,s,r,n.buyCount).then(function(e){t.close()}),!1}})},m=function(){return i}},g=new i($,{}),v=(new s($,n),new r($,{}),new d($)),b=new m($,v);new h(b,p,v);window.propInit=g,window.PropInitView=t}(),$(function(){function e(){var e=Search.keywordLibrary.data(),t=e.skills.length,i=e.companies.length,a=e.schools.length,n="search_sug_"+Search.para.jobId+"_s"+t+"_c"+i+"_h"+a;window.top.__conversion(n)}$(".query-filter").scrollbar({onScroll:function(e,t){e.scroll>0?$(".search-query .query-top").addClass("query-shadow"):$(".search-query .query-top").removeClass("query-shadow")}}),$(".search-flash-remind a").on("click",function(){$(".search-flash-remind").css({height:0}),$.ajax({url:"/setting/notify/set.json",type:"POST",data:{type:14},dataType:"JSON",timeout:5e3,success:function(e){},error:function(e){}})}),$(".condition-list .condition-item").one("click",function(){var e=$(this).find("dl").attr("data-type"),t=[],i=$(this).find("dd");$.each(i,function(i,a){t.push({type:e,description:$(a).text()})}),Search.para.jobId=$(".search-condition-related").attr("data-jobId"),Search.keywordLibrary.data(t),Search.getData(1,{source:2})}),$(".search-job-related").on("click","dd",function(){$(this).toggleClass("selected")}),$(".search-job-related .skip").on("click",function(t){var i=$(this).parents(".search-job-related"),a=[],n=i.find(".selected");$.each(n,function(e,t){var i=$(t).parents("dl").attr("data-type");a.push({type:i,description:$(t).text()})}),Search.para.jobId=i.attr("data-jobId"),Search.keywordLibrary.data(a),Search.getData(1,{source:3}),e()}),$(".position-list-box").on("click",".item-info",function(){var e=$(this),t=e.find(".info-labels").find("span").last().text().split("、"),i=[];$.each(t,function(e,t){i.push({type:"skills",description:t})}),Search.keywordLibrary.data(i),Search.para.jobId=e.attr("data-jobId"),Search.getData(1,{source:4})});$.when(function(){var e=$.Deferred();return $.ajax({url:"/wapi/zpitem/web/searchChatCard/getGray",success:function(t){t&&0===t.code?e.resolve(t.zpData.grayGroup):e.resolve(!1)}}),e}()).then(function(e){window.top.searchCardChatABGray=!!e})});var SearchGeekModified={init:function(){SearchGeekModified.hotGeekPay={},this.close($(".search-container .close")),this.close($(".search-container .iknow")),this.vipAccessConcat()},close:function(e){e.on("click",function(){$(this).parents(".update-tips").hide()})},vipAccessConcat:function(){$(".nav-updated-info, .update-tips .update-vip").on("click",function(e){window.top.Commercial.vip({sf:14},function(){$("#container").hasClass("search-result-model")?($(".nav-info").removeClass("nav-updated-info").html("<span>您已开通VIP账号，匿名牛人已全部解锁</span>").unbind("click"),Search.getData(1),$(".search-query .prop-buy").remove()):window.location.reload()}),e.preventDefault(),e.stopPropagation()}),Search.listContainer.on("click",".search-card .btn-getvipcontact,.search-card .btn-continue",function(e){var t=$(this),i=t.closest("li").find("a");"0"==t.attr("data-isvip")?window.top.Commercial.vip({sf:14},function(){$("#container").hasClass("search-result-model")?($(".nav-info").removeClass("nav-updated-info").html("<span>您已开通VIP账号，匿名牛人已全部解锁</span>").unbind("click"),Search.getData(1),$(".search-query .prop-buy").remove()):window.location.reload()}):"1"==t.attr("data-isvip")&&(t.hasClass("btn-continue")?SearchGeekModified.continueChat(i):SearchGeekModified.greetChat(i,t)),e.stopPropagation(),e.preventDefault()})},greetChat:function(e,t){var i={gids:[],jids:[],expectIds:[],lids:[],suids:[]};if(!t.hasClass("disabled")){if(e.each(function(){i.gids.push($(this).attr("data-uid")),i.jids.push($(this).attr("data-jid")),i.expectIds.push($(this).attr("data-expect")),i.lids.push($(this).attr("data-lid")),i.suids.push($(this).attr("data-suid"))}),!i.gids.length||!i.jids.length||!i.expectIds.length)return!1;var a={gids:i.gids.join(",")||"0",jids:i.jids.join(",")||"0",expectIds:i.expectIds.join(","),lids:i.lids.join(","),suids:i.suids.join(",")};t.addClass("disabled"),e.parent().find(".btn-getvipcontact").addClass("disabled"),$.ajax({type:"POST",url:"/chat/batchAddRelation.json",dataType:"JSON",cache:!1,data:a,success:function(i){function a(){t.removeClass("disabled"),e.parent().find(".btn-getvipcontact").removeClass("disabled")}var n,s,o,r,c,i=i;t.attr("ka");if(1==i.rescode){if(i.data?(n=i.data,n[0].greetingTip,s=n[0].status,o=n[0].stateDes,r=n[0].limitTitle,c=n[0]):(i.greetingTip,s=i.status,o=i.stateDes,r=i.limitTitle,c=i),c.ba&&window.top.Block.action(window.top.Block.formatBA(c.ba)),c.blockPageData&&""!=c.blockPageData)return SearchGeekModified.chatBlock(c),a(),!0;if(0==s)return a(),void window.top.Block.confirm({title:r,description:o,ka:"block_getvipcontact_"+c.limitCode});if(3==s){if(a(),1049==c.limitCode){var l={sf:3,vipPriceId:c.priceId},d={title:"今日总开聊数已达上限",description:c.stateDes,confirm:function(e){if(window.top.Purchase.vip({amount:e.pay,priceId:c.priceId},e),e.ba){var t=window.top.Block.formatBA(e.ba);window.top.Block.action(t)}window.top.__conversion("search_greet_purchase_vip")}};window.top.Block.vip(l,d),window.top.__conversion("search_greet_vip")}else window.top.Upgrade.render({ba:c.ba,business:c.business,title:c.limitTitle,description:c.stateDes,jobId:c.jobId,priceId:i.priceId,restDays:c.restDays,pay:c.beanCount,max:c.actionCount,targetId:c.targetId,targetType:c.targetType,positionName:c.positionName,view:-1==i.view?"无上限":i.view+"人",employ:-1==i.employ?"无上限":i.employ+"人"});return}t.text("已联系").addClass("disabled").attr("data-isvip","1").removeAttr("ka"),$.toast({type:"success",content:"已向牛人发送招呼"})}else i.data&&i.data.length?(t.removeClass("disabled"),SearchGeekModified.block(i.data)):(t.removeClass("disabled"),window.top.$.toast({content:"沟通失败，请稍后再试",type:"error"}))},error:function(i){t.removeClass("disabled"),e.parent().find(".btn-getvipcontact").removeClass("disabled"),window.$.toast({type:"error",content:"网络错误，请稍后再试"})}})}},continueChat:function(e){var e=e,t=e.attr("data-uid")||"0",i=e.attr("data-eid"),a=e.attr("data-jid")||"0",n=e.attr("data-expect"),s=e.attr("data-lid")||"";$.ajax({type:"POST",url:"/chat/addRelation.json",dataType:"JSON",cache:!1,data:{gid:t,jid:a,expectId:n,lid:s},success:function(e){1==e.rescode&&window.top.Chat.toggleUser({uid:t,eid:i,jid:a,expectId:n,lid:s})}})},chatBlock:function(e){SearchGeekModified.block(e.blockPageData)},viewBlock:function(e){if($(e).find("input[name='blockPageData']").length>0){var t=$(e).find("input[name='blockPageData']").val();return""!=t&&(SearchGeekModified.block(JSON.parse(t)),!0)}return!1},block:function(e){var t={parameter:{jobId:""},success:function(){window.location.reload()}};window.top.BlockSence.include(e,t)||window.top.Commercial.block(e,function(t,i){var a=$.extend({isPurchase:!0,jobId:t.jobId||"",business:t.business,targetType:t.targetType},i);window.top.Purchase.commercial({jobId:a.jobId,priceId:a.encryptPriceId,targetId:t.encryptTargetId,business:a.business||"",targetType:void 0!=e.targetType?e.targetType:a.targetType},{item:a,success:function(){window.location.reload()}})})}};$(function(){SearchGeekModified.init()});var CardChatProp=function(){function e(e){var a=e.target.dataset,n=p.getUseOrPayFromSelectRadio(),s=n&&n.encryptItemId;if(u.encryptItemId=s,a&&Object.keys(a).length)switch(a.proptype){case"card-go-buy-chat":t(),c.remove();break;case"card-go-use-chat":i({cardType:"chat"}),window.top._T.sendEvent("use-geek-chat"),c.remove();break;case"card-go-use-call":i({cardType:"call"}),window.top._T.sendEvent("use-geek-call"),c.remove()}}function t(){var e=p.getCardTypeFromSelectRadio(),t=p.getUseOrPayFromSelectRadio(),i=function(){var i;i=e.priceStatus&&d>0?1:0,u.buySuccess&&u.buySuccess({card:"chat",item:t,isTipVipBuyChat:i})},a="call"===u.cardType?"buy-geek-call":"buy-chating-card";window.top._T.sendEvent(a);var n={url:"/boss/item/buy/othItem/"+u.encryptItemId+".json",amount:t.count,itemId:u.encryptItemId,data:{source:u&&u.buySource},success:i};u.buyConfirm&&u.buyConfirm(),window.top.Payment.purchase(n,{success:i})}function i(e){h.dialogJobList({source:e&&e.source||u&&u.source,transmit:e&&e.transmit||u&&u.transmit,encryptItemId:e&&e.encryptItemId||u&&u.encryptItemId,cardType:e&&e.cardType||u&&u.cardType||"chat",confirm:u.consumerConfirm,fail:u.consumerFail,success:u.consumerSuccess})}function a(){var e=o;e&&e.length?e.forEach(function(e,t){e.selected&&(l=t)}):l=0}function n(){var e=o;e&&e.length&&e[l].optionList&&e[l].optionList.forEach(function(e,t){e.suggest&&(d=t)})}function s(e,t,i){if(!e||""===e)return"";var a=e.split(""),n='<a href="'+i.url+'" class="font-hightlight '+(i&&i.className||"")+' ">',s=i&&i.start?i.start:"startIndex",o=i&&i.end?i.end:"endIndex";return t&&t.forEach(function(e){var t=e[s],i=e[o]-1;a[t]=n+(a[t]||""),a[i]=(a[i]||"")+"</a>"}),a.join("")}var o,r,c,l=0,d=0,u={},p={header:function(){var e="";return o.length>1&&(e='<div class="card-chat-type clearfix"><div class="card-chat-search"><input type="radio" name="card-chat-type" value="0" '+(0===l?"checked":"")+' /><div>搜索畅聊卡</div></div><div class="card-chat-call"><input type="radio" name="card-chat-type" value="1" '+(1===l?"checked":"")+"/><div>牛人电话</div></div></div>"),e},body:function(){var e=p.getCardTypeFromSelectRadio();p.getUseOrPayFromSelectRadio();return'<div class="card-chat-des-content">'+p.cardDesText(e)+("call"===r?p.cardSelectCall(e):p.cardSelectSearchChat(e))+'<p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a >或<a href="javascript:;" class="J_call">请销售顾问联系我</a ></p ></div>'},footer:function(){var e=p.getCardTypeFromSelectRadio(),t=p.getUseOrPayFromSelectRadio(),i="";return"call"===r?i+=p.footerCall(e.needBzb):"chat"===r&&(0===e.needBzb?i+=p.footerChatUse():1===e.needBzb&&(i+=p.footerChatBuy(e.priceStatus,t))),i},getCardTypeFromSelectRadio:function(){return o?(19===o[l].itemType?r="chat":8===o[l].itemType&&(r="call"),o[l]):{}},getUseOrPayFromSelectRadio:function(){var e=p.getCardTypeFromSelectRadio();return e?e.optionList[d]:{}},cardDesText:function(e){var t={itemName:e.itemName,itemDesc:e.itemDesc,itemIcon:e.itemIcon,itemType:e.itemType,itemNote:e.itemNote,cardType:r};return Utemplate('<div class="card-chat-header"><div class="clearfix"><div class=" fl desc"><p class="title"> <% this.itemName %> </p><ul><% for(var i=0;i< this.itemDesc.length;i++){ %> <li>·<% this.itemDesc[i] %></li><% } %> </ul></div><div class="fr card-logo"><% if(this.cardType === "chat"){ %><img src="https://img.bosszhipin.com/beijin/app/android/searchchatcard-1e8d56b075426b4332e9ab09a9766999.png" alt=""><% }else if(this.cardType === "call"){ %><img src="https://img.bosszhipin.com/beijin/app/android/call_geek-ebcfdb7867f6edad2ac3f78fe0a91e21.png" alt=""><% } %></div></div><div class="card-chat-header-bottom"><% this.itemNote %></div></div>',t)},cardSelectCall:function(e){if(!e.optionList)return"";for(var t="",i=0;i<e.optionList.length;i++)t+=p.cardSelectCallLi(i,e.optionList[i]);return'<div class="card-chat-content clearfix"><ul class="card-select-items clearfix">'+t+"</ul></div>"},cardSelectCallLi:function(e,t){var i={title:t.title,count:t.count,unitName:t.unitName,desc:t.desc,suggest:t.suggest,index:e};return Utemplate('<li><input type="radio" name="card-chat-radio" value="<% this.index %>"  '+(d===e?"checked":"")+' ><div><p class="card-time"><% this.title %></p><p class="card-count"> <span class="card-count-num"><% this.count %></span> <span class="card-count-unit"><% this.unitName %></span> </p></div><i class="selected"></i></li>',i)},cardSelectSearchChat:function(e){if(!e.optionList)return"";for(var t="",i=0;i<e.optionList.length;i++)t+=p.cardSelectSearchChatLi(i,e.optionList[i]);var a=p.getUseOrPayFromSelectRadio(),n=p.cardChatDiscount(a),s="";return e.otherTip&&(s+='<p class="multi-prop-tip">其他待激活搜索畅聊卡可在道具商城-我的道具操作</p>'),'<div class="card-chat-content clearfix">'+(e.eliteGeekGrayBoss?'<p class="title">选择畅聊权益</p>':'<p class="title">选择沟通次数</p>')+s+'<ul class="card-select-items clearfix">'+t+"</ul>"+n+"</div>"},cardSelectSearchChatLi:function(e,t){var i={title:t.title,count:t.count,unitName:t.unitName,desc:t.desc,suggest:t.suggest,discountTag:t.discountTag,index:e};return Utemplate('<li><input type="radio" name="card-chat-radio" value="<% this.index %>"  '+(d===e?"checked":"")+'  /><div><p class="card-time"><% this.title %></p><p class="card-count"> <span class="card-count-num"><% this.count %></span> <span class="card-count-unit"><% this.unitName %></span> </p><p class="card-price"><% this.desc %><% if(this.discountTag){ %><span class="discount-tag">惠</span> <% } %></p></div><i class="selected"></i></li>',i)},cardChatDiscount:function(e){var t="";return e.discountList&&e.discountList.length&&(t='<div class="card-discount-desc clearfix"><div class="discount-title">优惠</div><div class="discount-detail">'+e.discountList.map(function(e,t){return'<div><span class="discount-tag">'+e.discountTag+"</span>"+(e.discount.url?s(e.discount.name,e.discount.highlightList,{url:e.discount.url}):"")+"</div>"}).join("")+"</div></div>"),t},footerCall:function(){return'<div class="card-chat-footer go-use " id="card-chat-footer"><div class="card-go-use" data-proptype="card-go-use-call">立即使用</div></div>'},
footerChatUse:function(){return'<div class="card-chat-footer go-use id="card-chat-footer""><div class="card-go-use" data-proptype="card-go-use-chat">激活并使用</div></div>'},footerChatBuy:function(e,t){var i={price:t.price,priceDesc:t.priceDesc,oprice:t.oprice},a='<div class="card-chat-footer" id="card-chat-footer"><div class="buy-price"> <span class="price-num"><% this.price %></span><span class="unit"><% this.priceDesc || "直豆" %></span> '+(e?'<span class="vip-icon"></span>':"")+(t.oprice?'<span class="old-price">'+t.oprice+"</span>":"")+'</div><div class="card-go-buy" data-proptype="card-go-buy-chat">去支付</div></div>';return Utemplate(a,i)}},h=function(){var e={},t=function(e,t){return t.replace(/<%([^%>]+)?%>/g,function(t,i){return e[i]})},i=function(t,i){var a=e.transmit||{},n={suid:a.suid,lid:a.lid,encryptJobId:i.encryptId,expectId:a.expectId,securityId:a.securityId};n.encryptItemId=e.encryptItemId,window.top.$("#toast").remove(),window.top.$.toast({content:"正在联系牛人...",type:"loading"}),$.ajax({method:"post",url:"/wapi/zpitem/web/searchChatCard/useCard/",data:n,success:function(t){0===t.code?e.success&&e.success(t,{cardType:e.cardType,transmit:e.transmit}):e.fail&&e.fail(t)},complete:function(){window.top.$("#toast").remove()}})},a=function(i,a){var n=function(e){return t(e,'<div class="prop-cont">        <div class="prop-end">            <p><%title%></p>            <%content%>         </div>    </div>')},s=function(e){$.confirm({content:e,backgroundDismiss:!1,confirmButton:"关闭",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop",confirmButtonClass:"btn btn-next",title:'<img src="/v2/web/boss/images/layer/succ.png" alt="牛人" class="title-icon">'})},o=e.transmit||{},r="/wapi/zpitem/web/geekInfoRight/use/"+a.encryptId,c={suid:o.suid,lid:o.lid,encryptJobId:a.encryptId,expectId:o.expectId,securityId:o.securityId};window.top.$("#toast").remove(),window.top.$.toast({content:"正在联系牛人...",type:"loading"}),$.ajax({method:"post",url:r,data:c,success:function(t){"call"===e.cardType&&(!t||0!=t.zpData.itemCount&&0===t.code?(s(n({title:"使用成功",content:"正在为您联系该牛人，请耐心等待。若对方拒绝或在48小时内无回复，系统将退还牛人电话道具。"})),e.success&&e.success(t,{cardType:e.cardType,transmit:e.transmit})):(s(n({title:"使用失败",content:t.resmsg})),e.fail&&e.fail(t)))},complete:function(){window.top.$("#toast").remove()}})},n=function(){var t=$.Deferred();return $.ajax({method:"get",url:"/wapi/zpitem/web/userItem/jobList.json",dataType:"json",success:function(i){if(0!==i.code)return void window.top.Block.confirm({title:"您暂时不能与这位牛人开聊！",description:"请至少发布一个开放职位"});for(var a,n="",s=i.zpData.jobList,o="",r="chat"===e.cardType?"搜索畅聊卡":"牛人电话",c=0;c<s.length;c++)0==c&&(n='<dt><p class="job-line-info"><span>'+s[c].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>| "+s[c].salaryDesc+"</span><span>| "+s[c].locationName+"</span><span>| "+s[c].degreeName+"</span><span>| "+s[c].experienceName+'</span></p><span class="on"><i></i></span><input type="hidden" value="'+s[c].encryptId+'"/></dt>'),o+='<li class="job-line-info" data-val="'+s[c].encryptId+'"><span>'+s[c].jobName.replace("<","&lt;").replace(">","&gt;")+"</span><span>| "+s[c].salaryDesc+"</span><span>| "+s[c].locationName+"</span><span>| "+s[c].degreeName+"</span><span>| "+s[c].experienceName+"</span></li>";o="<dd><ul>"+o+"</ul></dd>",a='<div class="select-list"><dl>'+n+o+"</dl></div>";var l='<div class="prop-layer prop-cont"><h3>使用'+r+'道具联系牛人</h3><p class="gray">请选择与牛人沟通的职位</p>'+a+"</div>";t.resolve(l,s)}}),t},s=function(){n().then(function(t,n){var s=0;if(n&&1===n.length)return void("chat"===e.cardType?i(0,n[s]):"call"===e.cardType&&a(0,n[s]));$.confirm({content:t,confirmButton:"联系牛人",buttonsReverse:!0,cancelButton:!1,columnClass:"pop-stage prop-pop prop-card-jobList",confirmButtonClass:"btn btn-next",title:"chat"===e.cardType?'<img class="card-joblist-prop-icon" src="https://img.bosszhipin.com/beijin/app/mobile/searchcard-7458d17f383e9a08c04965e49da3c239.png" alt="畅聊卡" class="title-icon">':'<img class="card-joblist-prop-icon" src="/v2/web/boss/images/layer/niuren.png" alt="牛人" class="title-icon">',onOpen:function(){$(".prop-card-jobList").find(".select-list dl").DIYSelect({listSelector:"dd li",listCallback:function(e,t,i,a){s=a;var n=$(this).find("span");$(i).find("dt p").find("span:eq(0)").text(n.eq(0).text()).end().find("span:eq(1)").text(n.eq(1).text()).end().find("span:eq(2)").text(n.eq(2).text())}}),"chat"===e.cardType&&window.top._T.sendEvent("position_choose","19"),"call"===e.cardType&&window.top._T.sendEvent("position_choose","8")},confirm:function(){var t=$(".prop-card-jobList"),o=(t.find(".select-list dt").eq(0),n[s]);e.confirm&&e.confirm(t,o),window.top._T.sendEvent("contact_confirm"),"chat"===e.cardType?i(0,o):"call"===e.cardType&&a(0,o)}})})};return{dialogJobList:function(t){e=t,s()}}}(),f=function(){var e='<div class="card-chat">';return e+=p.header(),e+=p.body(),e+=p.footer(),e+="</div>"},m=function(){o&&o.forEach(function(e,t){19===e.itemType&&(l=t)});for(var e=p.getUseOrPayFromSelectRadio(),t=p.getCardTypeFromSelectRadio(),i=t.priceStatus,a="",n=0;n<t.optionList.length;n++)a+=p.cardSelectSearchChatLi(n,t.optionList[n]);var s=p.cardChatDiscount(e);return'<div class="card-chat"><div class="card-chat-des-content">'+p.cardDesText(t)+'<div class="card-chat-content clearfix">'+(t.eliteGeekGrayBoss?'<p class="title">选择畅聊权益</p>':'<p class="title">选择沟通次数</p>')+'<ul class="card-select-items clearfix">'+a+"</ul>"+s+'</div><p class="business-meal">*组合套餐，高性价、低成本，详情：<a href="javascript:;" class="J_robot">在线咨询</a >或<a href="javascript:;" class="J_call">请销售顾问联系我</a ></p ></div>'+p.footerChatBuy(i,e)+"</div>"},g=function(){$(".card-chat-box").on("click",".card-chat-type",function(e){$(".card-chat-type input").each(function(e,t){$(this).length>0&&$(this)[0].checked&&(l=e,n())});var t=f();$(".dialog-con").html(t)}),$(".card-chat-box").on("click",".card-select-items",function(e){$(".card-select-items input").each(function(e,t){$(this).length>0&&$(this)[0].checked&&(d=e)});var t;t="buy"===u.templateType?m():f(),$(".dialog-con").html(t)}),$(".card-chat-box")[0].addEventListener("click",e),$(".card-chat-box").on("click",".J_robot",function(){ChatBot.open();try{var e=p.getUseOrPayFromSelectRadio(),t=e.itemId;Block.action({action:"help-robot-call",p2:3,p3:t})}catch(e){}}),$(".card-chat-box").on("click",".J_call",function(){CallMeDialog();try{var e=p.getUseOrPayFromSelectRadio(),t=e.itemId;Block.action({action:"help-passive-call-click",p2:3,p3:t})}catch(e){}})},v=function(t){if(!t)return!1;__dialogObject=$.dialog({bind:!0,title:"",closeLayer:!1,content:t,wrapClass:"card-chat-box",cancelText:"",confirmText:"",onOpen:function(e){c=e,g(),u.onOpen&&"function"==typeof u.onOpen&&u.onOpen(e)},onClose:function(){document.getElementsByClassName("card-chat-box")[0].removeEventListener("click",e),u.onClose&&"function"==typeof u.onClose&&u.onClose()}})};return{cardOpen:function(e){u.templateType=null,e&&(u.onOpen=e.open||function(){},u.onClose=e.close||function(){},u.transmit=e.transmit,u.buySource=e.source,u.consumerConfirm=e.confirm||function(){},u.consumerSuccess=e.success||function(){},u.consumerFail=e.fail||function(){},u.buySuccess=e.buySuccess||function(){}),$.ajax({url:"/wapi/zpitem/web/searchChatCard/getAdvanceSearchPageV2",success:function(e){if(0!==e.code)return void $.toast({type:"error",content:e.message});o=e.zpData.result,a(),n();var t=f();v(t)}})},consumerCard:function(e){u.templateType=null,e&&(u.consumerConfirm=e.confirm||function(){},u.consumerSuccess=e.success||function(){},u.consumerFail=e.fail||function(){},u.buySource=e.source),i(e)},buyChat:function(e){return e&&(u.onOpen=e.onOpen||function(){},u.onClose=e.onClose||function(){},u.buyConfirm=e.confirm||function(){},u.buySuccess=e.success||function(){},u.buySource=e.source),$.ajax({url:"/wapi/zpitem/web/searchChatCard/getAdvanceSearchPageV2",success:function(e){if(0!==e.code)return void $.toast({type:"error",content:e.message});o=e.zpData.result,a(),n();var t=m();u.templateType="buy",v(t)}}),this}}}(),MiniChatBox=function(e){function t(e,t,i){var a,n;return function(){var s=this,o=arguments,r=function(){a=null,i||(n=e.apply(s,o))},c=i&&!a;return clearTimeout(a),a=setTimeout(r,t),c&&(n=e.apply(s,o)),n}}function i(e){try{_T.sendEvent(e)}catch(e){}}function a(e){try{Block.action(e)}catch(e){}}var n,s=e.Chat,o=s.XssText,r=s.messageConverToHtml,c=s.revertFilenameToIcon,l=e.Emotion.data,d=e.Publisher.htmlConverToMessage,u=e.Publisher.setCursorEnd,p=e.Publisher.filterPicture,h={uid:0,source:0,userInfo:{},selfUid:_PAGE.uid,selfInfo:_PAGE},f={chatTop:function(e){var t="",i=[e.ageDesc,e.year,e.edu,e.city].filter(function(e){if(e)return e});i.forEach(function(e,a){e&&(t+="<span>"+e+"</span>",a<i.length-1&&(t+="<em></em>"))}),e.price?(i.push(e.price),e.priceStr='<span class="salary">'+e.price+"</span>"):e.priceStr="",e.infoTitle=i.join(","),e.infoStr=t,e.name=o(e.name),e.resume='<span class="resume"><span id="openResume"><i class="iboss iboss-editor-resume"></i>查看简历</span></span>',e.isShowMore?e.class="chat-info-hide":e.class="chat-info-show";return Utemplate('<div class="chatview-header-top"><%if(this.fixed) {%><span class="chatview-name" title="<% this.name %>"><% this.name %></span><div class="top-main" title="<% this.infoTitle %>"><% this.infoStr %><em></em></span><% this.priceStr %></div><i class="iboss iboss-editor-resume" id="openResume"><span class="resume-icon-tip" data-text="查看简历">查看简历</span> </i><% }else{ %><span class="chatview-name" title="<% this.name %>"><% this.name %></span><div class="top-main" title="<% this.infoTitle %>"><% this.infoStr %></div><% } %></div><%if(!this.fixed) {%><div class="chatview-more"><div class="chatview-header-except"><span class="except-name" title="<%this.position%>">期望：<%this.position%></span><%this.priceStr%></div><%if(this.lastCompany) {%><div class="chatview-header-now"><span class="except-name">现任：<span title="<% this.lastCompany %>"><% this.lastCompany %></span></span><em></em><span class="except-position" title="<% this.lastPosition %>"><% this.lastPosition %></span><% this.resume %></div><% }else if(this.lastCompany2){ %><div class="chatview-header-now"><span class="except-name">曾任：<span title="<% this.lastCompany2 %>"><% this.lastCompany2 %></span></span><em></em><span class="except-position" title="<% this.lastPosition2 %>"><% this.lastPosition2 %></span><% this.resume %></div><% }else{ %><div class="chatview-header-now"><span class="except-name">学校：<span title="<% this.school %>"><% this.school %></span></span><em></em><span class="except-position" title="<% this.major %>"><% this.major %></span><% this.resume %></div><% } %></div><% } %>',e)},chatBox:function(e){return Utemplate('<div class="chatview"><div id="sub" style="position:absolute;left:-9999px"></div><div class="chatview-dialog"><div class="iboss iboss-close"></div><div class="geek-fixed-top chat-userinfo"></div><div class="boss-chatview-main chat-wrap"><div class="boss-chatview-content chat-list"><div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div><div class="chat-list-top chat-userinfo"></div><ul></ul></div></div><div class="boss-chat-editor chat-editor"><div class="boss-chatview-editor chat-controls"><div class="chatview-editor-top"><a href="javascript:;" class="btn-emotion"><i class="iboss-editor-emoticon"></i><i class="iboss-biaoqing hover"></i><span data-text="表情" style="display: none;">表情</span></a><a href="javascript:;" class="btn-dict"><i class="iboss-sentence"></i><i class="iboss-changyongyu hover"></i><span data-text="常用语" style="display: none;">常用语</span></a><div class="chat-op"><span class="tip">按Enter键发送，按Ctrl+Enter键换行</span><button class="btn btn-send btn-disabled" type="submit">发送</button></div></div><div class="chat-message" contenteditable="true" data-placeholder="快速回复"></div></div></div></div></div>',e)},chatEmotion:function(e){var t="";return e.forEach(function(e,i){t+='<li><button class="emoj emoj-'+(i+1)+'" data-key="['+e+']" title="'+e+'"></button></li>'}),'<div class="emotion"><div class="emotion-box"><ul class="loaded">'+t+"</ul><div></div>"},chatPhrase:function(e){var t="";return e&&e.length?e.forEach(function(e,i){t+='<li title="'+filterXss(e)+'" data-index="'+i+'">'+filterXss(e)+"</li>"}):t='<li style="">暂无常用语</li>','<div class="sentence-pannel"><h3 class="title">常用语</h3><ul>'+t+"</ul></div>"},chatResume:function(e){return Utemplate('<div class="attachment-detail"><%if (this.isResumeVisible) {%><%if (this.isCanPreview) {%><div class="attachment-view"><div class="attachment-download"><a href="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" target="_blank" ka="attachment-download1" class="link-attachment"><span class="tooltip">下载</span></a><a href="javascript:;" data-origin="" ka="attachment-fullscreen" class="link-fullscreen"><span class="tooltip">全屏</span></a></div><img data-src="/wapi/zpgeek/resume/preview4boss/<%this.geekId%>?d=<%this.d%>" data-download="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" alt=""></div><%} else {%><div class="attachment-blank"><i class="tip-noattachment"></i><b>请下载该简历</b><div class="btns"><a href="<%if (this.isonline) {%>https://docdownload.zhipin.com<%}%>/wapi/zpgeek/resume/attachment/download4boss/<%this.geekId%>" target="_blank" ka="attachment-download2" class="btn">立即下载</a></div></div><%}%><%} else {%><div class="attachment-blank"><i class="tip-noattachment"></i><b>尚未获得对方完整简历</b><%if (this.isCanRequest) {%><p class="gray">您可以一键请求获取对方完整简历</p><div class="btns"><button type="button" ka="request-resume" class="btn btn-resume">请求附件简历</button></div><%}%></div><%}%></div>',e)},chatResumeLoading:function(){return'<div class="data-tips"><div class="spinner spinner-circle"><div class="loader"></div><span>正在加载简历...</span></div></div>'},chatMessage:function(e){e.isCenter=e.style.indexOf("item-center")>=0,e.isLeft=e.style.indexOf("item-friend")>=0;return Utemplate('<li id="temp-<% this.mid %>" class="message <% this.style %>  <% this.statusClass %>" data-timestamp="<% this.time %>"><%if (!this.isCenter) {%><div class="figure"><%if (this.isLeft) {%><img src="<% this.avatar %>" alt="" /><%}%></div><%}%><% this.content %></li>',e)}},m=function(e,t){var n=this;this.$parent=e,this.parent=t,this.render=function(){this.$chatTop=this.$parent.find(".chat-userinfo");var e=$(f.chatTop(h.userInfo));n.$chatTop.html(e),h.userInfo.fixed=!0;var e=$(f.chatTop(h.userInfo));n.parent.$fixedTop.html(e),this.bindEvents()},this.bindEvents=function(){this.$chatTop.on("click","#openResume",this.handleOpenResume),this.$chatTop.on("click",".semi-circle,.chat-info-show",this.handleToggleInfo)},this.unBindEvents=function(){this.$chatTop.off("click","#openResume",this.handleOpenResume),this.$chatTop.off("click",".semi-circle,.chat-info-show",this.handleToggleInfo)},this.handleToggleInfo=function(e){e.preventDefault(),e.stopPropagation();var t=h.userInfo;n.isShowMore=!n.isShowMore,t.isShowMore=n.isShowMore;var i=$.extend({},t),a=$(f.chatTop(i));n.$chatTop.html(a),n.isShowMore?(n.$chatTop.css("height","100px"),n.$chatTop.find(".chatview-more").show()):(n.$chatTop.css("height","64px"),n.$chatTop.find(".chatview-more").hide())},this.handleOpenResume=function(e){e.preventDefault(),e.stopPropagation(),n.openResume()},this.openResume=function(){$.toast({content:"正在加载简历...",type:"loading"}),$.ajax({url:"/chat/geek/chatinfo?gid="+h.uid+"&securityId="+h.userInfo.securityId,type:"get",success:function(e){setTimeout(function(){$("#toast").remove()},50);if(e&&$(e).find("input[name=blockPageData]").length){var t=$(e).find("input[name=blockPageData]"),s=$(e).find("input[name=dialog]"),o={};return t.val()?o=JSON.parse(t.val()):s.val()&&(o=JSON.parse(s.val())),!!BlockSence.include(o,{success:function(){n.openResume()}})||o.title&&Block.confirm({title:o.title,description:o.content,confirmText:"知道了"})}e=e.replace(/{{__LAST_MESSAGE__}}/,"");var r='<div class="resume-dialog" style="height:100vh">'+e+"</div>";$.dialog({title:"",content:r,closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-layer-full dialog-resume-full resume-look",lock:!0,onOpen:function(e){i("global_infoview_"+h.uid),a({action:"global-geek-detail"}),e.find(".show-item").on("click",function(e){$(this).hide(),$(this).parents(".item-container").addClass("item-all")})},onConfirm:function(e){}})},error:function(){}})},this.render()},g=function(e){var i=this;this.render=function(){this.historyPage=1,this.historyLoading=!1,this.timerHistory=null,this.messageMinId=0,this.parent=e,this.xhrs={},this.$chatList=this.parent.$chatview.find(".chat-list"),this.$chatListCon=this.$chatList.find("ul"),this.$chatEl=this.parent.$chatview.find(".chat-wrap"),this.$historyLoading=this.$chatList.find(".pre-loading"),this.$chatEl.show(),this.$chatListCon.empty(),this.getHistoryMessage(this.messageMinId,1),this.bindEvents()},this.bindEvents=function(){this.$chatList.on("scroll",this.handleMessageScroll),this.$chatList.on("click",".link-agree,.link-refuse",t(i.handleExchange,500,!0)),this.$chatList.on("click",".hyperLink .text",this.handleViewFullResume),this.$chatList.on("click",".img-tiny",this.handleViewLargeImage),this.$chatList.on("click",".message-note-entry",this.handleOpenSms),this.$chatList.on("contextmenu",".item-myself .text",this.handleShowContextmenu),this.$chatList.on("click",".msg-item-unlock",this.handleUnlockMessage),this.$chatList.on("click",".boss-chat-map",this.handleLookMap)},this.unBindEvents=function(){this.$chatList.off("scroll",this.handleMessageScroll),this.$chatList.off("click",".link-agree,.link-refuse",t(i.handleExchange,500,!0)),this.$chatList.off("click",".hyperLink .text",this.handleViewFullResume),this.$chatList.off("click",".img-tiny",this.handleViewLargeImage),this.$chatList.off("click",".message-note-entry",this.handleOpenSms),this.$chatList.off("contextmenu",".item-myself .text",this.handleShowContextmenu),this.$chatList.off("click",".msg-item-unlock",this.handleUnlockMessage),this.$chatList.off("click",".boss-chat-map",this.handleLookMap)},this.handleMessageScroll=function(){if(i.historyPage&&h.uid){i.timerHistory&&clearTimeout(i.timerHistory);var e=$(this).scrollTop();i.timerHistory=setTimeout(function(){e<=64?(i.parent.$fixedTop.hide(),i.historyLoading&&(i.historyPage++,i.getHistoryMessage(i.messageMinId,i.historyPage))):i.parent.$fixedTop.show()},100)}},this.handleExchange=function(){if($(this).hasClass("disabled"))return!1;$(this).parent().find("a").addClass("disabled");var e=0;$(this).hasClass("link-agree")&&(e=1);var t=parseInt($(this).parent().attr("data-type"),10),a=$(this).parent().parent().parent().attr("id").substr(5);i.exchange(t,e,a)},this.handleViewLargeImage=function(){var e=$(this),t=e.attr("data-large")||e.attr("src"),i=e.attr("large-y"),a=new Image;a.src=t,e.parent().append('<div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div>'),a.onload=function(){e.parent().find(".pre-loading").remove(),$.dialog({title:"",content:'<div class="img-viewer"><img src="'+t+'" /></div>',closeText:!0,confirmText:!1,cancelText:!1,wrapClass:"dialog-layer-full",lock:!0,onOpen:function(e){e.find(".dialog-con").on("click",function(t){$(t.target).parents(".img-viewer").length||e.remove()}),window.innerHeight<i&&e.find(".img-viewer").css({position:"static",transform:"translate(0, 0)"})}})}},this.handleViewFullResume=function(){var e=$(this).find("p").attr("data-origin"),t=h.userInfo.encryptUid,a="/resume/download4web?geekId="+t,e=e,n={};n=$('<img src="'+e+'" />'),$.dialog({title:'<a href="'+a+'" class="link-attachment"><span class="tooltip">下载</span></a><a href="javascript:;" class="close" ka="dialog-close"><i class="icon-close"></i><span class="tooltip">关闭</span></a>',content:'<div class="pre-loading"><span class="loading-more"><i></i><i></i><i></i></span></div>',closeText:!1,confirmText:!1,cancelText:!1,wrapClass:"dialog-layer-full dialog-layer-resume",lock:!0,onOpen:function(e){n.height()>0?(e.find(".dialog-con").html('<div class="img-viewer"></div>'),e.find(".img-viewer").append(n),window.innerHeight<n.height()&&e.find(".img-viewer").css({position:"static",transform:"translate(0, 0)"})):i.loadAttachment("/wapi/zpgeek/resume/preview4boss/check.json?geekId="+t,e.find(".dialog-con")),e.find(".dialog-con").on("click",function(t){$(t.target).parents(".img-viewer").length||$(t.target).parents(".attachment-detail").length||e.remove()})}})},this.loadAttachment=function(e,t){t.html(f.chatResumeLoading()),$.ajax({type:"GET",url:e,dataType:"JSON",data:null,success:function(e){if(0===e.code&&e.zpData){t.html(f.chatResume(e.zpData));var i=t.find(".attachment-view"),a=i.find("img"),n=a.attr("data-src")||a.attr("src"),s=t.find(".link-attachment").attr("href")||a.attr("data-download");t.parent().find(".dialog-title .link-attachment").attr("href",s);var o=function(){if(a.length){var e=new Image;e.src=n,i.append(f.chatResumeLoading()),e.onload=function(){var s=e.height||a.height();a.attr("src",n),i.find(".data-tips").remove(),t.hasClass("dialog-con")&&window.innerHeight<s&&(t.find(".attachment-detail").css({position:"static",transform:"translate(0, 0)",display:"inline-block"}),t.css({textAlign:"center"})),t.scrollTop(0)},e.onerror=function(){t.html('<div class="attachment-detail"><div class="attachment-blank"><b>此附件简历暂时无法预览，您可以</b><div class="btns"><a href="'+s+'" ka="attachment-download2" class="btn">下载附件简历</a></div><p><a href="javascript:;" class="link-refresh">重试预览</a></p></div></div>'),Chat.sendKaEvent("boss_attachment_error_"+n)}}};o(),t.on("click",".link-refresh",function(){o()}),i.hover(function(){i.find(".attachment-download").css({"margin-left":Chat.containerChat.width()/2-10+"px"}).show()},function(){i.find(".attachment-download").hide()})}},error:function(e){}})},this.handleOpenSms=function(){var e=$.extend({},h.userInfo);e.infoData=e,NodeMessage.use(e,{})},this.handleShowContextmenu=function(){},this.handleUnlockMessage=function(e){var t=h.userInfo,a={jobId:t.toPositionId,geekId:t.encryptUid,expectId:t.encryptExpectId};$.get("/bossweb/block/unlockchat.json",a,function(t){if(t.chatToast&&$.toast({type:"success",content:t.chatToast}),t.block&&t.blockPageData){var n={parameter:{jobId:a.jobId},success:function(){i.handleUnlockMessage(e)}};window.top.BlockSence.include(t.blockPageData,n)||Commercial.block(t.blockPageData,function(a,n){var s=$.extend({isPurchase:!0,jobId:a.jobId||param.jobId,business:a.business,targetType:a.targetType},n);Purchase.commercial({jobId:s.jobId,priceId:s.encryptPriceId,targetId:a.encryptTargetId,business:s.business||"",targetType:void 0!==t.blockPageData.targetType?t.blockPageData.targetType:s.targetType},{item:s,success:function(){i.handleUnlockMessage(e)}})})}else{if(!t.block&&1===t.rescode)return;$.toast({type:"error",content:t.resmsg})}})},this.handleLookMap=function(){var e=$(this).find("img").attr("src").match(/:([^&]+)/g),t=e[1].replace(":",""),i=$(this).find(".address").text(),a=['<div class="job-location-container">','<div class="job-location"><i class="iboss-dizhi"></i>'+i+"</div>",'<div id="job-map-container" class="job-map-container" data-long-lat="'+t+'"></div>',"</div>"];$.dialog({content:a.join(""),title:"",closeText:!0,cancelText:"",confirmText:"",wrapClass:"map-pop",onOpen:function(e){var a=t.split(","),n=new AMap.Map("job-map-container",{resizeEnable:!0,scrollWheel:!0,center:[a[0],a[1]],zoom:16}),s=new AMap.Marker({map:n,position:[a[0],a[1]],icon:new AMap.Icon({size:new AMap.Size(42,50),image:"https://static.zhipin.com/zhipin/v40/web/geek/images/icon-poi.png",imageOffset:new AMap.Pixel(0,-60)})});AMap.event.addListener(s,"click",function(){infoWindow.open(n,s.getPosition())}),AMap.plugin(["AMap.ToolBar","AMap.Scale"],function(){var e=new AMap.ToolBar,t=new AMap.Scale;n.addControl(e),n.addControl(t)}),infoWindow=new AMap.InfoWindow({content:i,offset:new AMap.Pixel(5,-25)}),infoWindow.open(n,n.getCenter()),e.find(".dialog-container").css({margin:"-250px 0 0 -330px"})}})},this.exchange=function(e,t,i){var a,n={to:h.uid,mid:i,aid:null,action:null};switch(e){case 0:case 11:1===t?(a="/chat/acceptContact.json",n.aid=28,n.action=0):(a="/chat/rejectContact.json",n.aid=29,n.action=1);break;case 1:1===t?(a="/chat/acceptWeixin.json",n.aid=33,n.action=0):(a="/chat/rejectWeixin.json",n.aid=34,n.action=1);break;case 2:1===t?(a="/chat/acceptResume.json",n.aid=41,n.action=0):(a="/chat/rejectResume.json",n.aid=42,n.action=1)}$.ajax({url:a,data:n,dataType:"JSON",cache:!1,timeout:3e4,success:function(e){},error:function(e){}})},this.getHistoryMessage=function(e,t){t>1&&((new Date).getTime(),this.$historyLoading.show()),this.xhrs.history&&this.xhrs.history.abort();var i=this,a=this.$chatListCon.outerHeight();this.xhrs.history=$.ajax({url:"/wapi/zpchat/boss/historyMsg",type:"GET",data:{src:h.source||0,gid:h.uid,maxMsgId:e,c:20,page:t},dataType:"JSON",timeout:2e4,success:function(e){var n=e.zpData;if(n.messages&&n.messages.length){var s,o,r=n.messages,c=r.length;if(c>0){if(t>1)for(o=c-1;o>=0;o--)i.parent.isShowTime(r[o])&&(s=r[o]),i.parent.showHistoryMessage(r[o]);else for(o=0;o<c;o++)!s&&i.parent.isShowTime(r[o])&&(s=r[o]),r[o].mid>i.parent.maxMessageId&&(i.parent.maxMessageId=r[o].mid),i.parent.showMessage(r[o]);s&&i.parent.showTimeLine(s,!0,!0),i.parent.maxMessageId&&(i.parent.sendReadMessage({uid:h.uid,mid:i.parent.maxMessageId,userData:{friendSource:h.source}}),i.parent.maxMessageId=null)}i.messageMinId=r[0].mid}if((!n.messages||n.messages.length<=19)&&(i.historyLoading=!1),1===t)i.$chatList.scrollTop(i.$chatListCon.outerHeight());else{var l=i.$chatListCon.outerHeight();i.$chatList.scrollTop(l-a)}i.parent.chatEditor.$editorInput.focus(),i.$historyLoading.hide(),i.$chatListCon.outerHeight()>360&&i.parent.$fixedTop.show(),i.parent.$chatview.find(".iboss-close").show(),i.$chatList.css("visibility","visible"),i.$chatEl.find(".chat-wrap-mask").remove()},error:function(e){i.historyLoading=!0,i.$historyLoading.hide(),i.parent.chatEditor.$editor.removeClass("disabled"),i.parent.chatEditor.$editorInput.focus()}}),this.historyLoading=!0},this.render()},v=function(e){var t=this;this.render=function(){this.uploadMaxSize=10485760,this.parent=e,this.$editor=this.parent.$chatview.find(".chat-editor"),this.$editorInput=this.$editor.find(".chat-message"),this.$btnSub=this.$editor.find(".btn-send"),this.$editorPlaceholder=this.$editor.find(".chat-placholder"),this.bindEvents();var i=this.getDraft(h.uid);h.uid&&i.content?(this.$editorInput.html(i.content),this.$btnSub.removeClass("btn-disabled"),u(this.$editorInput.get(0))):(this.$editorInput.html(""),this.$btnSub.addClass("btn-disabled")),this.$editorInput.focus(),isIE&&t.$editor.find(".tip").text("按Enter键发送，按shift+Enter键换行")},this.bindEvents=function(){this.$editor.on("click",".btn-emotion",this.handleShowEmotion),this.$editor.on("mouseover",".chat-controls a",this.handleShowToobarTip),this.$editor.on("mouseleave",".chat-controls a",this.handleHideToobarTip),this.$editor.on("click",".emotion .emoj",this.handleChooseEmotion),this.$editor.on("click",".btn-dict",this.handleShowPhrase),this.$editor.on("click",".sentence-pannel li",this.handleChoosePhrase),this.$editorInput.on("keyup",this.handleKeyup),this.$editorInput.on("click",this.handleSendEvent),this.$editorInput.on("keydown",this.handleKeydown),this.$btnSub.on("click",this.handleSendText),this.$editorInput.on("paste",this.handlePaste),this.$editorInput[0].addEventListener("drop",this.handleDrop),this.$editorInput[0].addEventListener("dropover",this.handleDropover),$(document).on("click",this.handleDomClick)},this.unBindEvents=function(){this.$editor.off("click",".btn-emotion",this.handleShowEmotion),this.$editor.off("mouseover",".chat-controls a",this.handleShowToobarTip),this.$editor.off("mouseleave",".chat-controls a",this.handleHideToobarTip),this.$editor.off("click",".emotion .emoj",this.handleChooseEmotion),this.$editor.off("click",".btn-dict",this.handleShowPhrase),this.$editor.off("click",".sentence-pannel li",this.handleChoosePhrase),this.$editorInput.off("keyup",this.handleKeyup),this.$editorInput.off("keydown",this.handleKeydown),this.$editorInput.on("click",this.handleSendEvent),this.$btnSub.off("click",this.handleSendText),this.$editorInput.off("paste",this.handlePaste)},this.handleShowEmotion=function(){$(this).find("span").hide(),t.renderEmotion(),t.$editor.find(".emotion").show(),t.$editor.find(".emotion").show()},this.handleShowToobarTip=function(e){$(e.target).hasClass("tips")||$(e.target).parents().hasClass("tips")||($(this).find("span").attr("data-text")&&$(this).find("span").text($(this).find("span").attr("data-text")),$(this).find('span[class!="no"]').show())},this.handleHideToobarTip=function(){$(this).find('span[class!="no"]').hide()},this.handleHideEmotion=function(){t.$editor.find(".emotion").hide()},this.handleChooseEmotion=function(e){var i=$(e.target),a=i.attr("class").split("emoj-")[1],n="https://static.zhipin.com/library/emotions/2x/Expression_"+a+"@2x.png";t.inserCurosrHtml(n,i.attr("data-key")),t.handleHideEmotion(),t.$editor.find(".btn-send").removeClass("btn-disabled"),t.$editor.find(".chat-message").focus()},this.handleShowPhrase=function(){$(this).find("span").hide(),i("global_dict_"+h.uid),t.renderPhrase()},this.handleHidePhrase=function(){t.$editor.find(".sentence-pannel").hide()},this.handleChoosePhrase=function(e){i("global_dict_"+(parseInt($(e.target).data("index"))+1));var a=t.$editorInput,n=r($(e.target).text());a.html(a.html()+n),t.$editor.find(".sentence-pannel").hide(),t.$btnSub.removeClass("btn-disabled"),u(a.get(0))},this.handleSendText=function(){t.sendText()},this.handleSendEvent=function(){i("global_input_"+h.uid)},this.handleKeyup=function(){var e=p($(this).html()),i=d(e.html);if(!e.picIds)return""!==i.replace(/[\n\s]/g,"")?void t.$btnSub.removeClass("btn-disabled"):void t.$btnSub.addClass("btn-disabled");if(t.$btnSub.removeClass("btn-disabled"),i.length>1e3)t.$editor.find(".tip").text("您输入的内容过长，请删减后再发送").addClass("error-tip"),t.$btnSub.addClass("btn-disabled");else{var a="按Enter键发送，按Ctrl+Enter键换行";isIE&&(a="按Enter键发送，按shift+Enter键换行"),t.$editor.find(".tip").text(a).removeClass("error-tip"),t.$btnSub.removeClass("btn-disabled")}},this.handleKeydown=function(e){13===e.which&&(e.ctrlKey||e.shiftKey?e.ctrlKey&&(/Apple/.test(navigator.vendor)||document.execCommand("insertText",!1,"\n")):(t.sendText(),e.preventDefault())),""!==t.$editorInput.html()&&t.$editorPlaceholder.hide()},this.handlePaste=function(e){var i=null,a=null;if(window.clipboardData&&clipboardData.setData)i=window.clipboardData.getData("text");else{var n=(e.originalEvent||e).clipboardData,s=n.items;$.each(s,function(e,s){switch(s.kind){case"file":if("image/png"===s.type&&(a=s.getAsFile()),a){if(a.size>=t.uploadMaxSize)return $.toast({content:"图片发送失败，最大不超过10兆",type:"error"});var o=new FileReader;o.onload=function(e){var i=e.target.result;t.uoloadImage(a,i)},o.readAsDataURL(a)}break;case"string":"text/plain"===s.type&&(i=n.getData("text/plain"));break;default:i=n.getData("text/plain")}})}if(document.body.createTextRange){if(document.selection)textRange=document.selection.createRange();else if(window.getSelection){var o=window.getSelection(),r=o.getRangeAt(0),c=document.createElement("span");c.innerHTML="&#FEFF;",r.deleteContents(),r.insertNode(c),textRange=document.body.createTextRange(),textRange.moveToElementText(c),c.parentNode.removeChild(c)}textRange.text=i,textRange.collapse(!1),textRange.select()}else{if(i){var l=document.createElement("div");l.innerText=i,document.execCommand("insertHTML",!1,l.innerHTML),l=null}i&&t.$btnSub.removeClass("btn-disabled")}e.preventDefault()},this.handleDrop=function(e){e.preventDefault();var i=e.dataTransfer.files;$.each(i,function(e,i){var a=new FileReader;a.onload=function(e){var a=e.target.result;t.uoloadImage(i,a)},a.readAsDataURL(i)})},this.handleDropover=function(e){e.preventDefault()},this.handleDomClick=function(e){
$(e.target).hasClass("btn-emotion")||$(e.target).parents(".btn-emotion").length||$(e.target).parents(".emotion").length||t.handleHideEmotion(),$(e.target).hasClass("btn-dict")||$(e.target).parents(".sentence-pannel").length||t.handleHidePhrase()},this.renderEmotion=function(){if(!this.parent.$chatview.find(".emotion").length){var e=$(f.chatEmotion(l));this.$editor.append(e)}},this.renderPhrase=function(){$.ajax({url:"/wapi/zpchat/setting/replyWord/list",type:"get",dataType:"json",success:function(e){if(0===e.code&&e.zpData){var i=$(f.chatPhrase(e.zpData));t.$editor.find(".sentence-pannel").length||t.$editor.append(i),t.$editor.find(".sentence-pannel").show()}},error:function(){}})},this.sendText=function(){if(this.parent.chatContainer.$chatList.find(".msg-item-unlock").length)return this.parent.chatContainer.handleUnlockMessage({from:"send"}),!1;if(this.$editorInput.hasClass("btn-disabled"))return!1;var e=this.$editorInput.html();if(e=d(e),""===e.replace(/[\n\s]/g,""))return this.$editorInput.html(""),!1;if(e.length>1e3)return alert("您输入的内容过长，请删减后再发送"),!1;if(e){var t={type:1,text:$.trim(e),sticker:null};this.sendMessageObj(t)}this.$editorInput.html(""),this.$btnSub.addClass("btn-disabled"),this.$editorPlaceholder.show()},this.uoloadImage=function(e,i){var a="pic_"+Date.now()+"_1";this.parent.showImageUploadMessage({src:i,id:a});var n=new FormData;n.append("source","chat"),n.append("file",e);var s=function(e){t.parent.$chatListCon.find("#"+e).removeClass("status-read status-delivery").addClass("status-error")};$.ajax({url:"/wapi/zpupload/image/uploadSingle",type:"POST",cache:!1,data:n,dataType:"json",processData:!1,contentType:!1}).done(function(e){function i(){if(n.failed)s(a);else if(n.loaded>=2){t.parent.$chatListCon.find("#"+a).remove();var e={image:{originImage:r,tinyImage:c},type:3,templateId:1,text:"[图片]"};t.sendMessageObj(e)}else o>0&&(o-=200,setTimeout(i,200))}if(0===e.code&&e.zpData){var n={loaded:0,failed:!1},o=2e3,r={},c={};t.getImageInfoAsync(r,e.zpData.url,n),t.getImageInfoAsync(c,e.zpData.tinyUrl,n),i()}else s(a)}).fail(function(){s(a)})},this.getImageInfoAsync=function(e,t,i){var a=new Image;a.onload=function(t){var a=t.path?t.path[0]:t.target;e.height=a.height,e.width=a.width,e.url=a.src,i.loaded+=1},a.onerror=function(){i.failed=!0},a.src=t},this.sendMessageObj=function(e){var t=(new Date).getTime(),i={tempID:h.selfUid+t,isSelf:!0,from:{uid:h.selfUid,name:h.selfInfo.name,avatar:h.selfInfo.face},to:{source:h.source,uid:h.uid,encryptUid:h.userInfo.encryptUid||h.userInfo.encryptGid},time:t,body:e,mSource:"server",typeSource:"newSubmit",type:1};this.parent.sendMessage(i)},this.inserCurosrHtml=function(e,t){var i=this.$editorInput.get(0);if("getSelection"in window){var a=window.getSelection();if(a&&1===a.rangeCount){i.focus();var n=a.getRangeAt(0),s=new Image;s.src=e,s.setAttribute("data-key",t),s.className="emoj-insert",s.setAttribute("title",t.replace("[","").replace("]","")),n.deleteContents(),n.insertNode(s),n.collapse(!1),a.removeAllRanges(),a.addRange(n)}}else if("selection"in document){i.focus();var n=document.selection.createRange();n.pasteHTML('<img class="emoj-insert" data-key="'+t+'" title="'+t.replace("[","").replace("]","")+'" src="'+e+'">'),i.focus()}},this.getDraft=function(e){this.drafts=function(){var e=sessionStorage.getItem("__Chatview__Drafts");return""===e||null===e||void 0===e?[]:$.parseJSON(e)}();var t=this.drafts.filter(function(t){return t.uid===e});return t.length?t[0]:{}},this.render()},b=function(e,t){var n=this;this.$chatBox=e,this.event=t||{},this.create=function(){this.protobufMessage=new ProtobufMessage(this),this.instantMessage=new InstantMessage(h.selfUid),ImSocket.subscribe(this.onMessage),ImSocket.subscribeDelivered(this.onMessageDelivered),this.bindEvents()},this.open=function(e,t,i){e=parseInt(e,10),t=parseInt(t,10),i=i||{},this.isOpen=!0,this.event.onOpen&&this.event.onOpen();var a=!0;h.uid!==e||i.unlock||(a=!1),a&&this.renderChatBox(e,t,i)},this.close=function(){this.handleChatClose()},this.destroyed=function(){},this.renderChatBox=function(e,t,i){h.uid=e,h.source=t,this.maxMessageId=0,this.options=$.extend({},i),this.render()},this.render=function(){var e=$(f.chatBox());this.$chatBox.html(e),this.$chatview=this.$chatBox.find(".chatview"),this.$fixedTop=this.$chatBox.find(".geek-fixed-top"),this.$chatEl=this.$chatview.find(".chat-wrap"),this.$chatList=this.$chatview.find(".chat-list"),this.$chatListCon=this.$chatList.find("ul"),this.options.className&&this.$chatview.addClass(this.options.className),this.options.style&&this.$chatview.css(this.options.style),this.$chatview.css("display","block"),this.$chatList.css("visibility","hidden"),this.$chatEl.find(".chat-wrap-mask").remove(),this.$chatEl.append($('<div class="chat-wrap-mask"></div>')),this.renderComponents()},this.renderComponents=function(){this.getFriendInfo(function(e){h.userInfo=e;var t=n.$chatview;n.chatTop=new m(t,n)}),this.chatContainer=new g(this),this.chatEditor=new v(this)},this.getFriendInfo=function(e){ImFriends.getFriendById(h.uid,h.source,function(t){$.ajax({type:"GET",url:"/wapi/zpboss/h5/chat/geek.json?uid="+h.uid+"&geekSource="+h.source+"&securityId="+t.securityId,dataType:"JSON",data:null,success:function(t){var i=t.zpData;if(i&&1===i.status){var a=t.zpData.data;e(a)}else $.toast({content:"数据加载失败，请稍后再试",type:"error"})},error:function(){}})})},this.bindEvents=function(){this.$chatBox.on("click",".iboss-close",this.handleChatClose)},this.unBindEvents=function(){this.$chatBox.off("click",".iboss-close",this.handleChatClose)},this.handleChatClose=function(){h.uid=null,h.source=null,h.userInfo={},n.isOpen=!1,n.options={},n.event.onClose&&n.event.onClose(),n.chatTop&&n.chatTop.unBindEvents(),n.chatContainer&&n.chatContainer.unBindEvents(),n.chatEditor&&n.chatEditor.unBindEvents(),n.$chatview&&n.$chatview.css("display","none")},this.onMessage=function(e){if(n.isOpen)switch(e.type){case 1:n.receiveMessage(e);break;case 6:n.receiveStatusMessage(e)}},this.onMessageDelivered=function(e){for(var t=e.messages,i=0;i<t.length;i++){var a=t[i];if(a.mid&&n.$chatListCon){n.$chatListCon.find("#temp-"+a.mid).length&&n.showStatusMessage(a,"delivery",a.to.uid,a.mid)}}},this.receiveMessage=function(e){for(var t=e.messages,i=0;i<t.length;i+=1){var a=t[i];if(a.to.uid<=1e3)return!1;if(h.uid!==a.to.uid&&h.uid!==a.from.uid)return!1;if(a.body.action)return void this.showActionMessage(a.body.action.aid,a);a.from.uid===h.uid&&99!==a.body.type&&this.sendReadMessage({uid:h.uid,mid:a.mid,userData:{friendSource:h.source}}),this.showMessage(a)}},this.showActionMessage=function(e,t){switch(e){case 75:this.renderRecallMessage(t);break;case 71:var i=h.uid,a=h.source;this.open(i,a,{unlock:!0})}},this.renderRecallMessage=function(e){var t=this.formateMessage(e),i=JSON.parse(t.action.extend),a=this.$chatListCon.find("#temp-"+i.mid);a.length&&a.attr("class","item-system").html('<div class="text">'+t.text+"</div>")},this.receiveStatusMessage=function(e){if(e.messageRead&&e.messageRead.length)for(var t=e.messageRead,i=0;i<t.length;i++){var a=t[i];this.showStatusMessage(a,"read",a.userId,a.messageId)}},this.showHistoryMessage=function(e){var t=this.renderMessage(e);this.chatContainer.$chatListCon.prepend(t),this.showTimeLine(e,!0)},this.showMessage=function(e){this.showTimeLine(e);var t=this.renderMessage(e);this.chatContainer.$chatListCon.append(t),this.scrollToBottom()},this.showImageUploadMessage=function(e){var t=new Image;t.src=e.src,t.onload=function(){var t='<li data-type="image" data-time="'+Date.now()+'" id="'+e.id+'" class="item-myself item-interview"><div class="figure"></div><div class="text bgf"><i class="status"></i><img src="'+e.src+'" class="img-tiny" style="max-width: 200px;"/></div></li>';$(t).appendTo(n.$chatListCon),n.scrollToBottom()},t.onerror=function(){}},this.showStatusMessage=function(e,t,i,a){if(!(i!==h.uid||e.sync&&e.userId===h.uid))if("read"===t)this.chatContainer.$chatListCon.find(".status-delivery").removeClass("status-delivery").addClass("status-read");else if(t){var n=this.chatContainer.$chatListCon.find("#temp-"+a);n.attr("class",n.attr("class").replace(/status\-/g,"")).addClass("status-"+t)}},this.sendReadMessage=function(e){ImSocket.read(e)},this.sendMessage=function(e){ImSocket.send(e);var t={};t=e.body.image?this.protobufMessage.createMessage.image(e):this.protobufMessage.createMessage.text(e);var n=t.messages[0];n.time=Date.now(),n.newSubmit=!0,this.showMessage(n),i("global_send_"+h.uid),a({action:"global-geek-reply",p:h.uid,p2:n.mid,p5:h.userInfo.jobId,p6:h.userInfo.expectId})},this.renderReadStatus=function(e,t){var i=this.chatContainer.$chatListCon.find("#temp-"+e.messageId);i.attr("class",i.attr("class").replace(/status\-/g,"")).addClass("status-"+t)},this.formateMessage=function(e){return this.instantMessage.formate(e)},this.getStatusClass=function(e,t,i){var a="",n=["status-loading","status-delivery","status-read"];return t?(a=n[e]||"hideStatus",i||"status-loading"!==a||(a="status-delivery")):a="hideStatus",a},this.isShowTime=function(e){var t=this.formateMessage(e);return!(4===e.type||4===e.body.type||e.uncount||"action"===t.type&&!t.text)},this.showTimeLine=function(e,t,i){if(this.isShowTime(e)){var a=this.formateMessage(e),n=this.lastMessageTime,s=Math.abs(e.time-n)>3e5;if(n&&(s||i)&&0===this.$chatListCon.find("#temp-time-"+e.time).length){var o='<li class="item-time" id="temp-time-'+e.time+'"><span class="time">'+a.formateTime+"</span></li>";t?this.$chatListCon.prepend(o):this.$chatListCon.append(o)}this.lastMessageTime=e.time}},this.renderTime=function(e,t){var i=this.formateMessage(e);return this.isShowTime(e,t)?'<li class="item-time" id="temp-time-'+e.time+'"><span class="time">'+i.formateTime+"</span></li>":""},this.renderByStrategy=function(e){var t=e.type,i={text:function(){return'<div class="text"><i class="status"></i>'+r(e.text).replace(/&amp;middot;/g,"&#183;")+"</div>"},audio:function(){return'<div class="text"><i class="status"></i>'+e.text+"</div>"},video:function(){var t,i,a=e.video;try{i=JSON.parse(a.text).videoText}catch(e){}return 1===a.type?t='<i class="iboss iboss-yuyin-miansvg"></i>':2===a.type&&(t='<i class="iboss iboss-shipin-miansvg"></i>'),'<div class="text">'+t+i+"</div>"},image:function(){var t=e.image;return'<div class="text bgf"><i class="status"></i><img class="img-tiny" data-large="'+t.originUrl+'" large-x="'+t.originWidth+'" large-y="'+t.originHeight+'" src="'+t.url+'" height="'+t.height+'"></div>'},interview:function(){var t={1:'<i class="icon-interview-send"></i>',2:'<i class="icon-interview-cancel"></i>',3:'<i class="icon-interview-accept"></i>',4:'<i class="icon-interview-reject"></i>',5:'<i class="icon-interview-cancel"></i>',6:"",7:'<i class="icon-interview-arrive"></i>',8:'<i class="icon-interview-inquire"></i>',9:'<i class="icon-interview-response"></i>'},i=t[e.interview.condition]||"",a=e.text;return'<div class="text"><i class="status"></i>'+(e.isSelf?a+i:i+a)+"</div>"},sticker:function(){return'<div class="text bgf"><i class="status"></i><img class="img-tiny" width="'+e.image.originWidth/2+'" src="'+e.image.originUrl+'" height="'+e.image.originHeight/2+'"></div>'},dialog:function(){if(17===e.dialog.type){var t=e.dialog,i=JSON.parse(t.text);return'<div class="text bgf"><div class="boss-chat-map"><img height="121" src="https://restapi.amap.com/v3/staticmap?size=243*121&amp;markers=small,0xFF0000,A:'+i.longitude+","+i.latitude+'&amp;key=21b56a6cc83fad7668dbb0e9564759a7" alt="公司地址"><div class="address">'+i.locationDesc+'</div><div class="map-tips">'+t.title+"</div></div></div>"}if(e.isSelf)return"";var a="",n="";switch(e.dialog.type){case 0:n="icon-contact";break;case 1:n="icon-weixin";break;case 2:n="icon-resume";break;case 11:n="icon-contact"}return e.dialog.operated&&(a="disabled"),'<div class="text"><i class="'+n+'"></i>'+r(e.text)+'<i class="icon-arow-right"></i><span class="op" data-type="'+e.dialog.type+'"><a href="javascript:;" class="link-agree '+a+'">同意</a><a href="javascript:;" class="link-refuse '+a+'">拒绝</a></span></div>'},hyperLink:function(){var t=e.hyperLink;return 1===t.hyperLinkType?'<div class="text">'+c(t.text)+'<p data-origin="'+t.url+'"><b>'+t.text+"</b>"+e.text+"</p><div>":""},articles:function(){if(!e.text)return"";var t=e.articles[0];return t&&8===t.templateId?'<div class="text"><p class="gray">您的新招呼问题</p>'+o(t.subTitle)+"</div>":'<div class="text"><i class="status"></i>'+e.text+"</div>"},action:function(){if(!e.action)return"";var t=e.action||{};if(75===t.aid)return"";if([28,29].indexOf(t.aid)>=0){var i=n.$chatList.find("#temp-"+e.mid);i.find("a").hasClass("disabled")||i.find("a").addClass("disabled")}return e.text?'<div class="text"><i class="status"></i>'+e.text+"</div>":""}};return i[t]?i[t]():""},this.renderSystemByStrategy=function(e){var t=e.type,i={text:function(){return'<div class="text">'+e.text+"</div>"},hyperLink:function(){var t=e.hyperLink;if(3===t.hyperLinkType)return'<div class="text">'+e.text+"</div>";if(6===t.hyperLinkType){if(!t.extraJson)return"";var i=JSON.parse(t.extraJson||"{}"),a=t.text,n=i.highlightStart,s=i.highlightLength;return'<div class="text">'+a.substr(0,n)+'<a href="javascript:;" class="message-note-entry">'+a.substr(n,s)+"</a>"+a.substr(n+s)+"</div>"}},dialog:function(){return""},action:function(){var t=e.action;if(75===t.aid)return"";if(37===t.aid){var i=h.selfInfo.email;try{var a=JSON.parse(t.extend).resumeEmail;a&&(i=a)}catch(e){}return'<div class="text">简历请求已发送。如果牛人同意，TA的简历将发送到{'+i+"}</div>"}return'<div class="text">'+e.text+"</div>"}};return i[t]?i[t]():i.text()},this.renderSystem=function(e,t){var i=this.renderSystemByStrategy(t);return i?'<li class="'+t.style+'" data-timestamp="'+e.time+'">'+i+"</li>":""},this.renderMessage=function(e){var t=this.formateMessage(e);if(e.newSubmit&&(t.style="item-myself",t.isSelf=!0,t.status=0),t.style.indexOf("item-system")>=0)return this.renderSystem(e,t);var i="";if(!(i=e.encryptedBody&&!e.isSelf?'<div class="text"><i class="status"></i>'+e.encryptedBody+'<a href="javascript:;" class="msg-item-unlock">点击解锁</a><i class="icon-msg-lock"></i></div>':this.renderByStrategy(t)))return"";var a={mid:e.mid,time:e.time,statusClass:this.getStatusClass(t.status,t.isSelf,e.newSubmit),content:i,avatar:e.from.avatar||h.userInfo.avatar,style:t.style};return f.chatMessage(a)},this.scrollToBottom=function(){this.$chatList.scrollTop(this.$chatListCon.outerHeight()+100)},this.create()};return function(e,t){return n||(n=new b(e,t)),n}}({Chat:Chat,Emotion:Emotion,Publisher:Publisher}),MiniFriends=function(){return function(e,t){var i={container:function(){return'<div class="chat-friend-list-container"><div class="title-container"><span class="back"><i class="iboss-left"></i></span>消息<span class="setting"><i class="iboss-shezhi"></i></span></div><div class="scroll-content-container scrollbar-macosx"><div class="list-container"><ul class="top-list"></ul><ul class="main-list"></ul><div class="load-more"></div><div class="no-data">暂无牛人</div></div></div></div>'},listItem:function(e){var t=e.gid?e.gid:e.uid,a=e.friendSource||0,n=e.newMsgCount>0?"active":"",s=util.get(e,"lastMsgInfo.showText","");""===s&&(s="您正在与牛人"+e.name+"沟通");var o=e.newMsgCount>999?999:e.newMsgCount;return'<li class="friend-list-item uid-'+t+'"   data-newsnum="'+e.newMsgCount+'"  data-uid="'+t+'"  data-source="'+a+'"><div class="figure"><img src="'+e.avatar+'"><span class="news-count '+n+'">'+o+'</span></div><div class="text"><div class="title"><span class="time">'+e.lastTime+"</span>"+i.getSourceTitle(e)+'<span class="name">'+e.name+'</span><p class="gray">'+i.getStatusStr(e)+' <span class="push-text">'+s+"</span></p></div></div></li>"},msgTipSetting:function(){if("close"===t.getMsgTipState())var e='<div class="setting-container"><span>打开消息提醒</span><div isopen="false"  class="btn-outer"><div class="change-btn"></div></div></div>';else var e='<div class="setting-container"><span>打开消息提醒</span><div isopen="false"  class="btn-outer active"><div class="change-btn" style="left:22px;"></div></div></div>';return e},getSourceTitle:function(e){return e.sourceTitle?'<span class="source-title">'+e.sourceTitle+"</span>":""},getStatusStr:function(e,t){var i="",a="",n="",s=0,o=function(e){return{0:"",1:"送达",2:"已读"}[e]||""},c=function(e){return{0:"",1:"status-delivery",2:"status-read"}[e]||""};if("message"===t){if(e.style.indexOf("item-myself")>-1){i=c(e.status);var l=o(e.status);n=""===l?"":"["+l+"]",a='<span class="status '+i+'">'+n+"</span>"}}else{var d=util.get(e,"lastMsgInfo.showText","");e.lastMsgInfo&&e.lastMsgInfo.status&&(s=e.lastMsgInfo.status),s&&d&&util.get(e,"lastMsgInfo.fromId","")===r.selfUid&&(n=o(s),i=c(s),a='<span class="status '+i+'">['+n+"]</span>")}return a}},a=1,n=!0,s=!1,o=!1,r=this,c=[],l=ImFriends.getFriendsByPage,d=ImFriends.getFriendById,u=!1,p={scroll:function(){if(!s&&n){$(this).scrollTop()+$(this).height()>=r.$listContainer.find(".list-container").height()&&(a+=1,s=!0,$(".load-more").html("正在加载中"),h())}},openChatBox:function(){var e=$(this).attr("data-uid"),i=$(this).attr("data-source"),a=$(this).attr("data-newsnum"),n=parseInt(a,10),s="";r.$listContainer.find(".friend-list-item").removeClass("active"),$(this).addClass("active"),t.openChatBox(e,i),s=n>0?"global_chatview_"+e+"_red":"global_chatview_"+e,ImFriends.sendKaEvent(s),ImFriends.getFriendById(e,i,function(t){var i={action:"global-geek-click",p:e,p3:n>0?1:2,p4:2,p5:t.jobId,p6:t.expectId};ImFriends.action(i)})},close:function(){t.close()},settingToggle:function(){$(this).find("i").hasClass("active")?($(this).find("i").removeClass("active"),r.$listContainer.find(".setting-container").hide()):($(this).find("i").addClass("active"),r.$listContainer.find(".setting-container").show())}},h=function(){var e=function(e,t){var i=$.Deferred();return $.post("/wapi/zpchat/boss/userLastMsg",{friendIds:e.join(","),src:t},function(e){$.isArray(e.zpData)||i.resolve([]),i.resolve(e.zpData)}),i},t=function(t,i){for(var a=[],n=[],s=0;s<t.length;s++)1===t[s].friendSource?n.push(t[s].uid):a.push(t[s].uid);n.length?$.when(e(a,0),e(n,1)).then(i):e(a,0).then(i)},o=function(e){for(var t="",n="",s=0;s<e.length;s++){var o=e[s];$li=$(".uid-"+e[s].uid),0===$li.length&&(1===o.isTop?t+=i.listItem(o):n+=i.listItem(o))}r.$listContainer.find(".top-list").append(t),r.$listContainer.find(".main-list").append(n),1===a&&(r.$listContainer.find(".data-tips").remove(),u=!0),f()};(function(){var e=$.Deferred();return l(a,function(i){var a=i.filter(function(e){return e.uid>1e3&&1400400!==e.uid&&!e.isFiltered&&8!==e.relationType&&-1===c.indexOf(e.uid)});t(a,function(t){for(var i={},n=0;n<t.length;n++){var s=t[n];i[s.uid]=s}for(var o=0;o<a.length;o++){var r=a[o],c={uid:r.uid,lastTS:r.lastTS,lastTime:r.lastTime},l=i[r.uid];(!r.lastTS||!r.lastMsg||r.lastTS<=s.lastTS)&&(r=$.extend(r,l,c)),r.lastMsgInfo||(r.lastMsgInfo={})}e.resolve(a)})}),e})().then(function(e){if(s=!1,0===e.length){if(1===a)return $(".load-more").hide(),r.$listContainer.find(".data-tips").remove(),f(),u=!0,!1;n=!1,$(".load-more").html("没有更多了")}else $(".load-more").html("");o(e)})},f=function(){r.$listContainer.find(".friend-list-item ").length?$(".no-data").hide():$(".no-data").show()},m=function(e,t,a){var n="",s="",o=function(e,t){var i=$(".uid-"+e),a=i.attr("data-newsnum"),n=i.find(".news-count"),s=parseInt(a,10)+t;i.attr("data-newsnum",s),s>999&&(s=999),n.html(s),s>0?n.addClass("active"):n.removeClass("active")};"read"===t?function(){n=e.userId,s=e.userSource,d(n,s,function(t){if(8!==t.relationType&&!t.isFiltered){var i=$(".uid-"+n),s=util.get(t,"lastMsgInfo.msgId",0),c=util.get(t,"lastMsgInfo.fromId",0),l=i.attr("data-newsnum"),d=-1*parseInt(l,10);if(s<=e.messageId&&c===r.selfUid&&"selfSend"!==a&&i.find(".gray .status-delivery").attr("class","status status-read").text("[已读]"),"selfSend"===a&&o(n,d),e.sync){t.mids||(t.mids=[]),t.mids.sort(function(e,t){return e>t});for(var u=0,p=0;p<t.mids.length&&t.mids[p]<=e.messageId;p++)u++;o(n,-1*u)}}})}():function(){e.isSelf&&!e.selfVideo?(n=e.toId,s=e.toSource):(n=e.fromId,s=e.fromSource),d(n,s,function(t){if(8!==t.relationType&&!t.isFiltered){var s=$(".uid-"+n);if(0!==s.length||e.received||e.online){var c=util.get(t,"lastMsgInfo.msgTime",0);if(e.time>c&&!e.received&&!e.online&&s.parent().prepend(s),e.isSelf){if(e.pushText&&4!==e.messageType)if(e.isLocation)var l='<span class="push-text"> '+e.pushText+"</span>";else{var d=3===e.messageType&&"interview"===e.type;d||"video"===e.type||(e.status=1);var l=i.getStatusStr(e,"message")+'<span class="push-text"> '+e.pushText+"</span>"}}else{if(e.pushText&&4!==e.messageType)var l='<span class="push-text"> '+e.pushText+"</span>";!s.hasClass("active")&&"selfSend"!==a&&e.needSetUnRead&&o(n,e.count)}s.find(".gray").html(l),s.find(".time").html(e.timeText)}else t.lastMsgInfo||(t.newMsgCount=e.count,t.lastMsgInfo={status:e.status,showText:e.pushText}),1===t.isTop?r.$listContainer.find(".top-list").prepend(i.listItem(t)):r.$listContainer.find(".main-list").prepend(i.listItem(t)),f()}})}()},g=function(e){ImFriends.geekListLoaded&&u&&function(e){return{1:function(e){if(e.messages&&e.messages.length)for(var t=e.messages,i=0;i<t.length;i++){var a=t[i],a=r.formateMessage(a);a.fromId>1e3&&1400400!==a.fromId&&m(a,"message")}},6:function(e){if(e.messageRead&&e.messageRead.length)for(var t=e.messageRead,i=0;i<t.length;i++){var a=t[i];r.selfUid!==a.userId&&a.userId>1e3&&1400400!==a.userId&&m(a,"read")}}}[e]||function(){}}(e.type)(e)},v=function(e){if("read"===e.type){if(e.message.messageRead&&e.message.messageRead.length)for(var t=e.message.messageRead,i=0;i<t.length;i++){var a=t[i];m(a,"read","selfSend")}}else if(e.message.messages&&e.message.messages.length)for(var t=e.message.messages,i=0;i<t.length;i++){var a=t[i],a=r.formateMessage(a);m(a,"message","selfSend")}},b=function(e){var t={5:function(e,t){d(e,t,function(e){e.relationType=5,1===e.isTop?r.$listContainer.find(".top-list").prepend(i.listItem(e)):r.$listContainer.find(".main-list").prepend(i.listItem(e))})},8:function(e,t){c.push(e),$(".uid-"+e).remove(),f()},delete:function(e,t){c.push(e),$(".uid-"+e).remove(),f()},setTop:function(e,t){c.push(e);var a=$(".uid-"+e);a.length>0?r.$listContainer.find(".top-list").prepend(a):d(e,t,function(e){r.$listContainer.find(".top-list").prepend(i.listItem(e))})},cancelTop:function(e,t){c.push(e);var a=$(".uid-"+e);a.length>0?r.$listContainer.find(".main-list").prepend(a):d(e,t,function(e){r.$listContainer.find(".main-list").prepend(i.listItem(e))})}};t[e.type]&&t[e.type](e.uid,e.source)};this.selfUid=_PAGE.uid,this.loaded=!1,this.formateMessage=t.formateMessage,this.init=function(){r.defaults={onClose:function(){},onMsgTipChange:function(){},openBox:function(){}}},this.syncMsgTipChange=function(){"open"===t.getMsgTipState()?(r.$listContainer.find(".btn-outer").attr("isopen","true").addClass("active"),r.$listContainer.find(".change-btn").css("left","22px")):(r.$listContainer.find(".btn-outer").attr("isopen","false").removeClass("active"),r.$listContainer.find(".change-btn").css("left","2px"))},this.msgTipChange=function(e){o||(o=!0,"open"===t.getMsgTipState()?(r.$listContainer.find(".btn-outer").attr("isopen","false").removeClass("active"),r.$listContainer.find(".change-btn").animate({left:"2px"},function(){o=!1,t.setMsgTipState("close");var e={action:"global-setting-change",p:2,p2:2};ImFriends.action(e)})):(r.$listContainer.find(".btn-outer").attr("isopen","true").addClass("active"),r.$listContainer.find(".change-btn").animate({left:"22px"},function(){o=!1,t.setMsgTipState("open");var e={action:"global-setting-change",p:1,p2:2};ImFriends.action(e)})),setTimeout(function(){r.$listContainer.find(".setting i").removeClass("active"),r.$listContainer.find(".setting-container").hide()},1e3))},this.changeCurTo=function(e,t){var i=$(".uid-"+e);r.$listContainer.find(".friend-list-item").removeClass("active"),i.addClass("active")},this.closeChatBox=function(){r.$listContainer.find(".friend-list-item").removeClass("active")},this.render=function(){e.append(i.container()),r.$listContainer=$(".chat-friend-list-container"),r.$listContainer.append(' <div class="data-tips"><div class="spinner spinner-circle"><div class="loader"></div><span>正在加载数据...</span></div></div>'),r.$listTitle=$(".chat-friend-list-container .title-container"),r.$scrollContainer=$(".scroll-content-container"),r.$listTitle.append(i.msgTipSetting()),h(),r.$scrollContainer.scrollbar()},this.bindEvents=function(){r.$scrollContainer.on("scroll",p.scroll),r.$listContainer.on("click",".friend-list-item",p.openChatBox),r.$listTitle.find(".back").on("click",p.close),r.$listTitle.find(".setting").on("click",p.settingToggle),r.$listTitle.find(".btn-outer").on("click",r.msgTipChange)},this.create=function(){this.render(),this.bindEvents(),ImSocket.subscribe(g),ImSocket.onSend(v),ImFriends.subscribeSyncData(b),this.loaded=!0},this.init(),this.create()}}(),Guide=function(e,t){var i=function(){return'<div class="mchat-guide"><span class="guide-close"><i class="iboss-close"></i></span><div class="guide-image"></div><div class="guide-content"><div class="guide-title">可以在这快速和牛人沟通</div><div class="geek-card"><div class="geek-info"><div class="geek-image"></div><p class="geek-name">刘亦菲</p></div><div class="message-info">Boss您好，刚刚看了您发布的这个 职位，我挺感兴趣的，希望您可…</div></div><div class="guide-change">有消息即时提醒，快速处理<b>打开提醒</b><div isopen="false" class="btn-outer"><div class="change-btn"></div></div></div></div></div>'},a=this,n=!1,s=function(){localStorage.setItem("mini-chat-guid","noFirst"),a.$guide.remove()},o=function(){n||(n=!0,localStorage.setItem("mini-chat-guid","noFirst"),"open"===t.getMsgTipState()?($(this).attr("isopen","false").removeClass("active"),a.$guide.find(".change-btn").animate({left:"2px"},function(){t.setMsgTipState("close"),n=!1;var e={action:"global-setting-change",p:2,p2:1};ImFriends.action(e)})):($(this).attr("isopen","true").addClass("active"),a.$guide.find(".change-btn").animate({left:"22px"},function(){t.setMsgTipState("open"),n=!1;var e={action:"global-setting-change",p:1,p2:1};ImFriends.action(e)})),setTimeout(function(){s()},500))};this.render=function(){e.append(i()),a.$guide=$(".mchat-guide")},this.bindEvents=function(){a.$guide.find(".guide-close").on("click",s),a.$guide.find(".btn-outer").on("click",o)},this.create=function(){localStorage.getItem("mini-chat-guid")||(this.render(),this.bindEvents(),ImFriends.sendKaEvent("global_tip_show"))},this.create()},ChatTray=function(e,t){var i=this,a=function(){if("close"===t.getChatFriendsState()){$(".mchat-container").animate({right:"3px"}),t.setFriendsState("open");var e=ImFriends.getTotalNewMsgCount();if(e>0)var i="global_active_"+e;else var i="global_active_unred";ImFriends.sendKaEvent(i)}else t.closeChatFriends(),t.setFriendsState("close")};this.setMsgTotalCount=function(){var e=ImFriends.getTotalNewMsgCount();e>99?$(".mchat-entry-container .news-count").html('<i class="dot-plenty"></i>'):$(".mchat-entry-container .news-count").html(e),e>0?$(".mchat-entry-container .news-count").show():$(".mchat-entry-container .news-count").hide()},this.render=function(){e.append('<div class="mchat-entry-container"><span class="news-count"></span></div>'),i.$chatTray=$(".mchat-entry-container")},this.bindEvents=function(){i.$chatTray.on("click",a)},this.create=function(){i.render(),i.bindEvents(),i.setMsgTotalCount()},this.create()},NewMsgTip=function(e,t){var i=function(e){return e.pushText&&e.pushText.length&&e.pushText.length>30&&(e.pushText=e.pushText.substring(0,26)+"..."),'<div class="geek-info" data-uid='+e.fromId+" data-mid="+e.mid+"  data-source="+e.fromSource+'><div class="geek-image"><img src="'+e.fromAvatar+'"></div><p class="geek-name">'+e.fromName+'</p></div><div class="msg-info">'+e.pushText+"</div>"},a=this,n=0,s=function(e){if(0===(n-=1))return void e();setTimeout(function(){s(e)},1e3)},o=function(){var e=a.$newMsgTip.find(".geek-info").attr("data-uid"),i=a.$newMsgTip.find(".geek-info").attr("data-source"),n=a.$newMsgTip.find(".geek-info").attr("data-mid");t.openChatBox(e,i),a.$newMsgTip.hide(200);var s="global_click_"+e;ImFriends.sendKaEvent(s),ImFriends.getFriendById(e,i,function(t){var i={action:"global-geek-click",p:e,p2:parseInt(n,10),p3:2,p4:3,p5:t.jobId,p6:t.expectId};ImFriends.action(i)})};this.open=function(e){a.$newMsgTip.html(i(e)),0===n&&(a.$newMsgTip.show(),s(function(){a.$newMsgTip.hide(200)})),n=3;var t="global_arrive_"+e.fromId;ImFriends.sendKaEvent(t)},this.render=function(){e.append('<div class="mchat-msg-tip-container"></div>'),a.$newMsgTip=$(".mchat-msg-tip-container")},this.bindEvents=function(){a.$newMsgTip.on("click",o)},this.create=function(){a.render(),a.bindEvents()},this.create()},MChat=function(){var e=this,t="close",i="close",a=_PAGE.uid,n=new InstantMessage(a);this.formateMessage=n.formate;var s={isOpen:localStorage.getItem("mini-chat-open-msg-tip")||"close",set:function(e){s.isOpen=e,localStorage.setItem("mini-chat-open-msg-tip",e)},get:function(){return s.isOpen}},o=function(){t="close",e.miniChatFriends.loaded&&e.miniChatFriends.closeChatBox()},r=function(){t="open"},c=function(a){if(setTimeout(function(){e.chatTray.setMsgTotalCount()},700),1===a.type&&a.messages.length)for(var n=0;n<a.messages.length;n++){var o=a.messages[n],r=e.formateMessage(o),c="close"===t&&"close"===i&&"open"===s.isOpen&&r.fromId>1e3&&1400400!==r.fromId&&!r.isSelf&&""!==r.pushText&&!r.received&&r.count&&4!==r.messageType;c&&ImFriends.getFriendById(r.fromId,r.fromSource,function(t){if(8!==t.relationType&&!t.isFiltered){var i={action:"global-message-show",p:t.uid};ImFriends.action(i),e.newMsgTip.open(r)}})}},l=function(){setTimeout(function(){e.chatTray.setMsgTotalCount()},200)},d=function(t){setTimeout(function(){e.chatTray.setMsgTotalCount()},200)},u=function(){e.close(),"menu-im"===$(this).attr("ka")?$(".mchat-container").hide():$(".mchat-container").show()},p=function(){e.miniChatFriends.loaded&&e.miniChatFriends.syncMsgTipChange()};this.close=function(){i="close",e.miniChatBox.close(),e.$warp.animate({right:"-303px"})},this.openChatBox=function(t,i){e.miniChatBox.open(t,i),e.miniChatFriends.loaded&&e.miniChatFriends.changeCurTo(t,i)},this.bindEvents=function(){$(".side-menu").on("click","a",u),$(".side-menu").find("dl.cur").hasClass("menu-chat")&&$(".mchat-container").hide()},this.create=function(){var t={getMsgTipState:s.get,setMsgTipState:function(e){s.set(e),p()}},a={setMsgTipState:s.set,getChatFriendsState:function(){return i},closeChatFriends:e.close,setFriendsState:function(e){i=e}},n={openChatBox:e.openChatBox},u={getMsgTipState:s.get,setMsgTipState:s.set,formateMessage:e.formateMessage,close:e.close,openChatBox:e.openChatBox},h={onOpen:r,onClose:o};ImFriends.complete(function(){$(window).height()<700?$("#main").parent().append('<div class="small-screen mchat-container"></div>'):$("#main").parent().append('<div class="mchat-container"></div>'),$(".mchat-container").append('<div class="mchat-view-container"></div>'),e.$warp=$(".mchat-container"),e.$chatBoxContainer=$(".mchat-view-container"),e.guide=new Guide(e.$warp,t),e.chatTray=new ChatTray(e.$warp,a),e.newMsgTip=new NewMsgTip(e.$warp,n),e.miniChatBox=new MiniChatBox(e.$chatBoxContainer,h),e.miniChatFriends=new MiniFriends(e.$warp,u),ImSocket.subscribe(c),ImSocket.onSend(l),ImFriends.subscribeSyncData(d),e.bindEvents()})},this.create()},testBossIds=[6201400,17840,36848557,62153641,4714671,210011,4069,428447,30704663,26842526,21813037,33218623,58353398,58348906,26510390,11553938,6457608],uidString=_PAGE.uid.toString(),hasMiniChat=testBossIds.indexOf(_PAGE.uid)>-1||"1"===uidString.charAt(uidString.length-1),MiniChat=null;hasMiniChat&&(MiniChat=new MChat);var PositionCheckDialog=function(){var e={content:function(e){
return Utemplate('<div class="success-wrap"><h3 class="success-title"><%this.title%></h3><%if(!(this.auditProgressRate < 0)){%><p class="success-process J_process">正在审核中<span class="process-num"><%this.auditProgressRate%>%</span><span class="process-wrap"><i style="width: <%this.auditProgressRate%>%;"></i></span></p><%}%><%if(this.content && !(this.content.length <= 0)) {%><%if(this.content.length === 1){%><p class="success-description"><%this.content[0]%></p><%}else{%><ul class="success-list"><%for(var i=0;i<this.content.length;i++){%><li><%this.content[i]%></li><%}%></ul><%}%><%}%></div>',e)}},t={auditInfo:function(e){return $.get("/wapi/zpboss/h5/job/audit/info?jobId="+e)}},i=function(e,i,a){var n=null;$.dialog({bind:!0,title:"",closeLayer:!1,content:i,wrapClass:"flex-dialog-wrap position-manage-success",cancelText:"",confirmText:"确定",onOpen:function(i){var a=!1,s=$(i).find(".J_process"),o=s.find(".process-num"),r=s.find(".process-wrap i");n=setInterval(function(){a||(a=!0,t.auditInfo(e).done(function(e){var t=e.zpData;if(0===e.code){if(3===t.auditStatus)return s.empty().html("当前职位已通过审核"),void clearInterval(n);if(2===t.auditStatus)return s.empty().html("当前职位未通过审核"),void clearInterval(n);if(8===t.auditStatus)return s.empty().html("职位未通过审核，请修改后重新提交"),void clearInterval(n);if(t.auditProgressRate>0)return o.html(t.auditProgressRate+"%"),void r.width(t.auditProgressRate+"%")}}).always(function(){a=!1}))},3e3)},onConfirm:function(){a&&"function"==typeof a&&a(),this.close()},onClose:function(){n&&clearInterval(n),a&&"function"==typeof a&&a()}})};return{jobSave:function(a,n){a&&t.auditInfo(a).done(function(t){var s=t.zpData;if(0===t.code){var o={title:s.dialog.title,content:[].concat(s.dialog.content.split(/[\s\n\↵]/)),auditProgressRate:s.auditProgressRate};i(a,e.content(o),n)}else $.toast({type:"error",content:t.message})}).fail(function(){$.toast({type:"error",content:"请求数据错误"})})}}}(),CallMeDialog=function(){var e=null,t=null,i={content:function(e){return Utemplate('<h3 class="title">请确认联系电话，销售顾问会在第一时间与您联系</h3><div class="input-wrap"><p class="error-tips J_error"></p><div class="phone-wrap"><p class="encrypt-phone J_phone"><%this.encryptPhone%><a href="javascript:;" class="edit-btn J_edit"></a></p><input type="text" name="phone" class="input-ele J_input" maxlength="11" autocomplete="off" /></div></div><div class="footer"><a href="javascript:;" class="btn J_submit">确认</a></div>',{encryptPhone:e})}},a={getPhone:function(){return $.get("/wapi/zpitem/web/userItem/getPhone")},postPhone:function(e){return $.post("/wapi/zpitem/web/userItem/reserveTel",e)}},n=function(){var e=1,t="",i="";this.getEdit=function(){return e},this.setEdit=function(t){e=t},this.getEncryptPhone=function(){return t},this.setEncryptPhone=function(e){t=e},this.getPhone=function(){return i},this.setPhone=function(e){i=e},this.getParams=function(){return e?{edit:e,phone:t}:{edit:e,phone:i}}},s=function(e){return i.content(e)},o=function(){var i=e.getParams();a.postPhone(i).then(function(e){var t=e.zpData;0===e.code&&t?$.toast({type:"success",content:"信息已提交，请确保手机畅通，销售顾问稍后与您联系！"}):$.toast({type:"error",content:e.message})},function(){$.toast({type:"error",content:"请求数据错误"})}).always(function(){t.close()});try{Block.action({action:"help-passive-call-confirm",p:e.getEdit()})}catch(e){}},r=function(t){if(t){var i=$(t),a=i.find(".J_error"),n=i.find(".J_phone"),s=i.find(".J_input"),r=i.find(".J_submit");i.on("click",".J_edit",function(){n.hide(),s.show().focus(),e.setEdit(0),r.addClass("disabled");try{Block.action({action:"help-passive-call-edit"})}catch(e){}}).on("input",".J_input",function(){var t=$(this).val();/[^\d]/g.test(t)?$(this).val(t.replace(/[^\d]/g,"")):/^1[3456789]\d{9}$/.test(t)?(e.setPhone(t),r.removeClass("disabled"),a.text("")):(r.addClass("disabled"),a.text("请输入正确的手机号码"))}).on("blur",".J_input",function(){if(!$(this).val()){n.show(),s.hide(),e.setEdit(1),r.removeClass("disabled"),a.text("");try{Block.action({action:"help-passive-call-back"})}catch(e){}}}).on("click",".J_submit",function(){$(this).hasClass("disabled")||o()})}},c=function(i){i&&(e=new n,e.setEncryptPhone(i.encryptPhone),t=$.dialog({bind:!0,title:"",closeLayer:!1,content:s(i.phone),wrapClass:"flex-dialog-wrap call-me-dialog",cancelText:"",confirmText:"",inline:!0,onOpen:function(e){r(e)},onClose:function(){e=null,t=null}}))};return function(){a.getPhone().then(function(e){var t=e.zpData;0===e.code?c(t):$.toast({type:"error",content:e.message})},function(){$.toast({type:"error",content:"请求数据错误"})})}}(),mediator=window.mediator||new EventManger,BatchWapiOnLoad={addOnLoad:function(){sessionStorage.getItem("startsProject")||BatchWapi.add("onLoadBatch","/wapi/zpitem/web/userItem/compensateItem2CEO",null,Activity.startsProjectCallback),BatchWapi.add("onLoadBatch","/wapi/zpCommon/ts.json",null,Clock.setMistiming)}};$(document).ready(function(){BatchWapiOnLoad.addOnLoad(),BatchWapi.request("onLoadBatch")});